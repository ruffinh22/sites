function KW(e,g){for(var t=0;t<g.length;t++){const l=g[t];if(typeof l!="string"&&!Array.isArray(l)){for(const n in l)if(n!=="default"&&!(n in e)){const I=Object.getOwnPropertyDescriptor(l,n);I&&Object.defineProperty(e,n,I.get?I:{enumerable:!0,get:()=>l[n]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const g=document.createElement("link").relList;if(g&&g.supports&&g.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))l(n);new MutationObserver(n=>{for(const I of n)if(I.type==="childList")for(const o of I.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&l(o)}).observe(document,{childList:!0,subtree:!0});function t(n){const I={};return n.integrity&&(I.integrity=n.integrity),n.referrerPolicy&&(I.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?I.credentials="include":n.crossOrigin==="anonymous"?I.credentials="omit":I.credentials="same-origin",I}function l(n){if(n.ep)return;n.ep=!0;const I=t(n);fetch(n.href,I)}})();var UC=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ZC(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Rh={exports:{}},qr={},Xh={exports:{}},Ie={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hC=Symbol.for("react.element"),FW=Symbol.for("react.portal"),xW=Symbol.for("react.fragment"),EW=Symbol.for("react.strict_mode"),DW=Symbol.for("react.profiler"),MW=Symbol.for("react.provider"),zW=Symbol.for("react.context"),TW=Symbol.for("react.forward_ref"),LW=Symbol.for("react.suspense"),UW=Symbol.for("react.memo"),QW=Symbol.for("react.lazy"),Km=Symbol.iterator;function jW(e){return e===null||typeof e!="object"?null:(e=Km&&e[Km]||e["@@iterator"],typeof e=="function"?e:null)}var kh={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Jh=Object.assign,Yh={};function EI(e,g,t){this.props=e,this.context=g,this.refs=Yh,this.updater=t||kh}EI.prototype.isReactComponent={};EI.prototype.setState=function(e,g){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,g,"setState")};EI.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function wh(){}wh.prototype=EI.prototype;function pu(e,g,t){this.props=e,this.context=g,this.refs=Yh,this.updater=t||kh}var Gu=pu.prototype=new wh;Gu.constructor=pu;Jh(Gu,EI.prototype);Gu.isPureReactComponent=!0;var Fm=Array.isArray,Hh=Object.prototype.hasOwnProperty,yu={current:null},Nh={key:!0,ref:!0,__self:!0,__source:!0};function Kh(e,g,t){var l,n={},I=null,o=null;if(g!=null)for(l in g.ref!==void 0&&(o=g.ref),g.key!==void 0&&(I=""+g.key),g)Hh.call(g,l)&&!Nh.hasOwnProperty(l)&&(n[l]=g[l]);var C=arguments.length-2;if(C===1)n.children=t;else if(1<C){for(var a=Array(C),r=0;r<C;r++)a[r]=arguments[r+2];n.children=a}if(e&&e.defaultProps)for(l in C=e.defaultProps,C)n[l]===void 0&&(n[l]=C[l]);return{$$typeof:hC,type:e,key:I,ref:o,props:n,_owner:yu.current}}function PW(e,g){return{$$typeof:hC,type:e.type,key:g,ref:e.ref,props:e.props,_owner:e._owner}}function Bu(e){return typeof e=="object"&&e!==null&&e.$$typeof===hC}function OW(e){var g={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(t){return g[t]})}var xm=/\/+/g;function ps(e,g){return typeof e=="object"&&e!==null&&e.key!=null?OW(""+e.key):g.toString(36)}function wa(e,g,t,l,n){var I=typeof e;(I==="undefined"||I==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(I){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case hC:case FW:o=!0}}if(o)return o=e,n=n(o),e=l===""?"."+ps(o,0):l,Fm(n)?(t="",e!=null&&(t=e.replace(xm,"$&/")+"/"),wa(n,g,t,"",function(r){return r})):n!=null&&(Bu(n)&&(n=PW(n,t+(!n.key||o&&o.key===n.key?"":(""+n.key).replace(xm,"$&/")+"/")+e)),g.push(n)),1;if(o=0,l=l===""?".":l+":",Fm(e))for(var C=0;C<e.length;C++){I=e[C];var a=l+ps(I,C);o+=wa(I,g,t,a,n)}else if(a=jW(e),typeof a=="function")for(e=a.call(e),C=0;!(I=e.next()).done;)I=I.value,a=l+ps(I,C++),o+=wa(I,g,t,a,n);else if(I==="object")throw g=String(e),Error("Objects are not valid as a React child (found: "+(g==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":g)+"). If you meant to render a collection of children, use an array instead.");return o}function QC(e,g,t){if(e==null)return e;var l=[],n=0;return wa(e,l,"","",function(I){return g.call(t,I,n++)}),l}function $W(e){if(e._status===-1){var g=e._result;g=g(),g.then(function(t){(e._status===0||e._status===-1)&&(e._status=1,e._result=t)},function(t){(e._status===0||e._status===-1)&&(e._status=2,e._result=t)}),e._status===-1&&(e._status=0,e._result=g)}if(e._status===1)return e._result.default;throw e._result}var Zg={current:null},Ha={transition:null},qW={ReactCurrentDispatcher:Zg,ReactCurrentBatchConfig:Ha,ReactCurrentOwner:yu};Ie.Children={map:QC,forEach:function(e,g,t){QC(e,function(){g.apply(this,arguments)},t)},count:function(e){var g=0;return QC(e,function(){g++}),g},toArray:function(e){return QC(e,function(g){return g})||[]},only:function(e){if(!Bu(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ie.Component=EI;Ie.Fragment=xW;Ie.Profiler=DW;Ie.PureComponent=pu;Ie.StrictMode=EW;Ie.Suspense=LW;Ie.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=qW;Ie.cloneElement=function(e,g,t){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var l=Jh({},e.props),n=e.key,I=e.ref,o=e._owner;if(g!=null){if(g.ref!==void 0&&(I=g.ref,o=yu.current),g.key!==void 0&&(n=""+g.key),e.type&&e.type.defaultProps)var C=e.type.defaultProps;for(a in g)Hh.call(g,a)&&!Nh.hasOwnProperty(a)&&(l[a]=g[a]===void 0&&C!==void 0?C[a]:g[a])}var a=arguments.length-2;if(a===1)l.children=t;else if(1<a){C=Array(a);for(var r=0;r<a;r++)C[r]=arguments[r+2];l.children=C}return{$$typeof:hC,type:e.type,key:n,ref:I,props:l,_owner:o}};Ie.createContext=function(e){return e={$$typeof:zW,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:MW,_context:e},e.Consumer=e};Ie.createElement=Kh;Ie.createFactory=function(e){var g=Kh.bind(null,e);return g.type=e,g};Ie.createRef=function(){return{current:null}};Ie.forwardRef=function(e){return{$$typeof:TW,render:e}};Ie.isValidElement=Bu;Ie.lazy=function(e){return{$$typeof:QW,_payload:{_status:-1,_result:e},_init:$W}};Ie.memo=function(e,g){return{$$typeof:UW,type:e,compare:g===void 0?null:g}};Ie.startTransition=function(e){var g=Ha.transition;Ha.transition={};try{e()}finally{Ha.transition=g}};Ie.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};Ie.useCallback=function(e,g){return Zg.current.useCallback(e,g)};Ie.useContext=function(e){return Zg.current.useContext(e)};Ie.useDebugValue=function(){};Ie.useDeferredValue=function(e){return Zg.current.useDeferredValue(e)};Ie.useEffect=function(e,g){return Zg.current.useEffect(e,g)};Ie.useId=function(){return Zg.current.useId()};Ie.useImperativeHandle=function(e,g,t){return Zg.current.useImperativeHandle(e,g,t)};Ie.useInsertionEffect=function(e,g){return Zg.current.useInsertionEffect(e,g)};Ie.useLayoutEffect=function(e,g){return Zg.current.useLayoutEffect(e,g)};Ie.useMemo=function(e,g){return Zg.current.useMemo(e,g)};Ie.useReducer=function(e,g,t){return Zg.current.useReducer(e,g,t)};Ie.useRef=function(e){return Zg.current.useRef(e)};Ie.useState=function(e){return Zg.current.useState(e)};Ie.useSyncExternalStore=function(e,g,t){return Zg.current.useSyncExternalStore(e,g,t)};Ie.useTransition=function(){return Zg.current.useTransition()};Ie.version="18.2.0";Xh.exports=Ie;var u=Xh.exports;const D=ZC(u),_W=KW({__proto__:null,default:D},[u]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ev=u,gv=Symbol.for("react.element"),tv=Symbol.for("react.fragment"),lv=Object.prototype.hasOwnProperty,nv=ev.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Iv={key:!0,ref:!0,__self:!0,__source:!0};function Fh(e,g,t){var l,n={},I=null,o=null;t!==void 0&&(I=""+t),g.key!==void 0&&(I=""+g.key),g.ref!==void 0&&(o=g.ref);for(l in g)lv.call(g,l)&&!Iv.hasOwnProperty(l)&&(n[l]=g[l]);if(e&&e.defaultProps)for(l in g=e.defaultProps,g)n[l]===void 0&&(n[l]=g[l]);return{$$typeof:gv,type:e,key:I,ref:o,props:n,_owner:nv.current}}qr.Fragment=tv;qr.jsx=Fh;qr.jsxs=Fh;Rh.exports=qr;var A=Rh.exports,xh={exports:{}},Fg={},Eh={exports:{}},Dh={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function g(N,F){var H=N.length;N.push(F);e:for(;0<H;){var E=H-1>>>1,z=N[E];if(0<n(z,F))N[E]=F,N[H]=z,H=E;else break e}}function t(N){return N.length===0?null:N[0]}function l(N){if(N.length===0)return null;var F=N[0],H=N.pop();if(H!==F){N[0]=H;e:for(var E=0,z=N.length,U=z>>>1;E<U;){var j=2*(E+1)-1,ge=N[j],$=j+1,ae=N[$];if(0>n(ge,H))$<z&&0>n(ae,ge)?(N[E]=ae,N[$]=H,E=$):(N[E]=ge,N[j]=H,E=j);else if($<z&&0>n(ae,H))N[E]=ae,N[$]=H,E=$;else break e}}return F}function n(N,F){var H=N.sortIndex-F.sortIndex;return H!==0?H:N.id-F.id}if(typeof performance=="object"&&typeof performance.now=="function"){var I=performance;e.unstable_now=function(){return I.now()}}else{var o=Date,C=o.now();e.unstable_now=function(){return o.now()-C}}var a=[],r=[],i=1,s=null,c=3,d=!1,Z=!1,G=!1,y=typeof setTimeout=="function"?setTimeout:null,p=typeof clearTimeout=="function"?clearTimeout:null,h=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(N){for(var F=t(r);F!==null;){if(F.callback===null)l(r);else if(F.startTime<=N)l(r),F.sortIndex=F.expirationTime,g(a,F);else break;F=t(r)}}function B(N){if(G=!1,b(N),!Z)if(t(a)!==null)Z=!0,x(S);else{var F=t(r);F!==null&&Y(B,F.startTime-N)}}function S(N,F){Z=!1,G&&(G=!1,p(m),m=-1),d=!0;var H=c;try{for(b(F),s=t(a);s!==null&&(!(s.expirationTime>F)||N&&!W());){var E=s.callback;if(typeof E=="function"){s.callback=null,c=s.priorityLevel;var z=E(s.expirationTime<=F);F=e.unstable_now(),typeof z=="function"?s.callback=z:s===t(a)&&l(a),b(F)}else l(a);s=t(a)}if(s!==null)var U=!0;else{var j=t(r);j!==null&&Y(B,j.startTime-F),U=!1}return U}finally{s=null,c=H,d=!1}}var X=!1,k=null,m=-1,v=5,R=-1;function W(){return!(e.unstable_now()-R<v)}function J(){if(k!==null){var N=e.unstable_now();R=N;var F=!0;try{F=k(!0,N)}finally{F?f():(X=!1,k=null)}}else X=!1}var f;if(typeof h=="function")f=function(){h(J)};else if(typeof MessageChannel<"u"){var V=new MessageChannel,K=V.port2;V.port1.onmessage=J,f=function(){K.postMessage(null)}}else f=function(){y(J,0)};function x(N){k=N,X||(X=!0,f())}function Y(N,F){m=y(function(){N(e.unstable_now())},F)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(N){N.callback=null},e.unstable_continueExecution=function(){Z||d||(Z=!0,x(S))},e.unstable_forceFrameRate=function(N){0>N||125<N?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):v=0<N?Math.floor(1e3/N):5},e.unstable_getCurrentPriorityLevel=function(){return c},e.unstable_getFirstCallbackNode=function(){return t(a)},e.unstable_next=function(N){switch(c){case 1:case 2:case 3:var F=3;break;default:F=c}var H=c;c=F;try{return N()}finally{c=H}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(N,F){switch(N){case 1:case 2:case 3:case 4:case 5:break;default:N=3}var H=c;c=N;try{return F()}finally{c=H}},e.unstable_scheduleCallback=function(N,F,H){var E=e.unstable_now();switch(typeof H=="object"&&H!==null?(H=H.delay,H=typeof H=="number"&&0<H?E+H:E):H=E,N){case 1:var z=-1;break;case 2:z=250;break;case 5:z=1073741823;break;case 4:z=1e4;break;default:z=5e3}return z=H+z,N={id:i++,callback:F,priorityLevel:N,startTime:H,expirationTime:z,sortIndex:-1},H>E?(N.sortIndex=H,g(r,N),t(a)===null&&N===t(r)&&(G?(p(m),m=-1):G=!0,Y(B,H-E))):(N.sortIndex=z,g(a,N),Z||d||(Z=!0,x(S))),N},e.unstable_shouldYield=W,e.unstable_wrapCallback=function(N){var F=c;return function(){var H=c;c=F;try{return N.apply(this,arguments)}finally{c=H}}}})(Dh);Eh.exports=Dh;var ov=Eh.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Mh=u,Hg=ov;function M(e){for(var g="https://reactjs.org/docs/error-decoder.html?invariant="+e,t=1;t<arguments.length;t++)g+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+e+"; visit "+g+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var zh=new Set,Eo={};function Xn(e,g){XI(e,g),XI(e+"Capture",g)}function XI(e,g){for(Eo[e]=g,e=0;e<g.length;e++)zh.add(g[e])}var Ot=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Rc=Object.prototype.hasOwnProperty,Cv=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Em={},Dm={};function av(e){return Rc.call(Dm,e)?!0:Rc.call(Em,e)?!1:Cv.test(e)?Dm[e]=!0:(Em[e]=!0,!1)}function rv(e,g,t,l){if(t!==null&&t.type===0)return!1;switch(typeof g){case"function":case"symbol":return!0;case"boolean":return l?!1:t!==null?!t.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function iv(e,g,t,l){if(g===null||typeof g>"u"||rv(e,g,t,l))return!0;if(l)return!1;if(t!==null)switch(t.type){case 3:return!g;case 4:return g===!1;case 5:return isNaN(g);case 6:return isNaN(g)||1>g}return!1}function hg(e,g,t,l,n,I,o){this.acceptsBooleans=g===2||g===3||g===4,this.attributeName=l,this.attributeNamespace=n,this.mustUseProperty=t,this.propertyName=e,this.type=g,this.sanitizeURL=I,this.removeEmptyString=o}var Ig={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Ig[e]=new hg(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var g=e[0];Ig[g]=new hg(g,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Ig[e]=new hg(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Ig[e]=new hg(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Ig[e]=new hg(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Ig[e]=new hg(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Ig[e]=new hg(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Ig[e]=new hg(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Ig[e]=new hg(e,5,!1,e.toLowerCase(),null,!1,!1)});var fu=/[\-:]([a-z])/g;function Su(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var g=e.replace(fu,Su);Ig[g]=new hg(g,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var g=e.replace(fu,Su);Ig[g]=new hg(g,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var g=e.replace(fu,Su);Ig[g]=new hg(g,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Ig[e]=new hg(e,1,!1,e.toLowerCase(),null,!1,!1)});Ig.xlinkHref=new hg("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Ig[e]=new hg(e,1,!1,e.toLowerCase(),null,!0,!0)});function Vu(e,g,t,l){var n=Ig.hasOwnProperty(g)?Ig[g]:null;(n!==null?n.type!==0:l||!(2<g.length)||g[0]!=="o"&&g[0]!=="O"||g[1]!=="n"&&g[1]!=="N")&&(iv(g,t,n,l)&&(t=null),l||n===null?av(g)&&(t===null?e.removeAttribute(g):e.setAttribute(g,""+t)):n.mustUseProperty?e[n.propertyName]=t===null?n.type===3?!1:"":t:(g=n.attributeName,l=n.attributeNamespace,t===null?e.removeAttribute(g):(n=n.type,t=n===3||n===4&&t===!0?"":""+t,l?e.setAttributeNS(l,g,t):e.setAttribute(g,t))))}var ll=Mh.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,jC=Symbol.for("react.element"),eI=Symbol.for("react.portal"),gI=Symbol.for("react.fragment"),Wu=Symbol.for("react.strict_mode"),Xc=Symbol.for("react.profiler"),Th=Symbol.for("react.provider"),Lh=Symbol.for("react.context"),vu=Symbol.for("react.forward_ref"),kc=Symbol.for("react.suspense"),Jc=Symbol.for("react.suspense_list"),Ru=Symbol.for("react.memo"),ul=Symbol.for("react.lazy"),Uh=Symbol.for("react.offscreen"),Mm=Symbol.iterator;function eo(e){return e===null||typeof e!="object"?null:(e=Mm&&e[Mm]||e["@@iterator"],typeof e=="function"?e:null)}var Xe=Object.assign,Gs;function mo(e){if(Gs===void 0)try{throw Error()}catch(t){var g=t.stack.trim().match(/\n( *(at )?)/);Gs=g&&g[1]||""}return`
`+Gs+e}var ys=!1;function Bs(e,g){if(!e||ys)return"";ys=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(g)if(g=function(){throw Error()},Object.defineProperty(g.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(g,[])}catch(r){var l=r}Reflect.construct(e,[],g)}else{try{g.call()}catch(r){l=r}e.call(g.prototype)}else{try{throw Error()}catch(r){l=r}e()}}catch(r){if(r&&l&&typeof r.stack=="string"){for(var n=r.stack.split(`
`),I=l.stack.split(`
`),o=n.length-1,C=I.length-1;1<=o&&0<=C&&n[o]!==I[C];)C--;for(;1<=o&&0<=C;o--,C--)if(n[o]!==I[C]){if(o!==1||C!==1)do if(o--,C--,0>C||n[o]!==I[C]){var a=`
`+n[o].replace(" at new "," at ");return e.displayName&&a.includes("<anonymous>")&&(a=a.replace("<anonymous>",e.displayName)),a}while(1<=o&&0<=C);break}}}finally{ys=!1,Error.prepareStackTrace=t}return(e=e?e.displayName||e.name:"")?mo(e):""}function sv(e){switch(e.tag){case 5:return mo(e.type);case 16:return mo("Lazy");case 13:return mo("Suspense");case 19:return mo("SuspenseList");case 0:case 2:case 15:return e=Bs(e.type,!1),e;case 11:return e=Bs(e.type.render,!1),e;case 1:return e=Bs(e.type,!0),e;default:return""}}function Yc(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case gI:return"Fragment";case eI:return"Portal";case Xc:return"Profiler";case Wu:return"StrictMode";case kc:return"Suspense";case Jc:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Lh:return(e.displayName||"Context")+".Consumer";case Th:return(e._context.displayName||"Context")+".Provider";case vu:var g=e.render;return e=e.displayName,e||(e=g.displayName||g.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Ru:return g=e.displayName||null,g!==null?g:Yc(e.type)||"Memo";case ul:g=e._payload,e=e._init;try{return Yc(e(g))}catch{}}return null}function cv(e){var g=e.type;switch(e.tag){case 24:return"Cache";case 9:return(g.displayName||"Context")+".Consumer";case 10:return(g._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=g.render,e=e.displayName||e.name||"",g.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return g;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Yc(g);case 8:return g===Wu?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof g=="function")return g.displayName||g.name||null;if(typeof g=="string")return g}return null}function Fl(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Qh(e){var g=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(g==="checkbox"||g==="radio")}function dv(e){var g=Qh(e)?"checked":"value",t=Object.getOwnPropertyDescriptor(e.constructor.prototype,g),l=""+e[g];if(!e.hasOwnProperty(g)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var n=t.get,I=t.set;return Object.defineProperty(e,g,{configurable:!0,get:function(){return n.call(this)},set:function(o){l=""+o,I.call(this,o)}}),Object.defineProperty(e,g,{enumerable:t.enumerable}),{getValue:function(){return l},setValue:function(o){l=""+o},stopTracking:function(){e._valueTracker=null,delete e[g]}}}}function PC(e){e._valueTracker||(e._valueTracker=dv(e))}function jh(e){if(!e)return!1;var g=e._valueTracker;if(!g)return!0;var t=g.getValue(),l="";return e&&(l=Qh(e)?e.checked?"true":"false":e.value),e=l,e!==t?(g.setValue(e),!0):!1}function gr(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function wc(e,g){var t=g.checked;return Xe({},g,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??e._wrapperState.initialChecked})}function zm(e,g){var t=g.defaultValue==null?"":g.defaultValue,l=g.checked!=null?g.checked:g.defaultChecked;t=Fl(g.value!=null?g.value:t),e._wrapperState={initialChecked:l,initialValue:t,controlled:g.type==="checkbox"||g.type==="radio"?g.checked!=null:g.value!=null}}function Ph(e,g){g=g.checked,g!=null&&Vu(e,"checked",g,!1)}function Hc(e,g){Ph(e,g);var t=Fl(g.value),l=g.type;if(t!=null)l==="number"?(t===0&&e.value===""||e.value!=t)&&(e.value=""+t):e.value!==""+t&&(e.value=""+t);else if(l==="submit"||l==="reset"){e.removeAttribute("value");return}g.hasOwnProperty("value")?Nc(e,g.type,t):g.hasOwnProperty("defaultValue")&&Nc(e,g.type,Fl(g.defaultValue)),g.checked==null&&g.defaultChecked!=null&&(e.defaultChecked=!!g.defaultChecked)}function Tm(e,g,t){if(g.hasOwnProperty("value")||g.hasOwnProperty("defaultValue")){var l=g.type;if(!(l!=="submit"&&l!=="reset"||g.value!==void 0&&g.value!==null))return;g=""+e._wrapperState.initialValue,t||g===e.value||(e.value=g),e.defaultValue=g}t=e.name,t!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,t!==""&&(e.name=t)}function Nc(e,g,t){(g!=="number"||gr(e.ownerDocument)!==e)&&(t==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+t&&(e.defaultValue=""+t))}var bo=Array.isArray;function BI(e,g,t,l){if(e=e.options,g){g={};for(var n=0;n<t.length;n++)g["$"+t[n]]=!0;for(t=0;t<e.length;t++)n=g.hasOwnProperty("$"+e[t].value),e[t].selected!==n&&(e[t].selected=n),n&&l&&(e[t].defaultSelected=!0)}else{for(t=""+Fl(t),g=null,n=0;n<e.length;n++){if(e[n].value===t){e[n].selected=!0,l&&(e[n].defaultSelected=!0);return}g!==null||e[n].disabled||(g=e[n])}g!==null&&(g.selected=!0)}}function Kc(e,g){if(g.dangerouslySetInnerHTML!=null)throw Error(M(91));return Xe({},g,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Lm(e,g){var t=g.value;if(t==null){if(t=g.children,g=g.defaultValue,t!=null){if(g!=null)throw Error(M(92));if(bo(t)){if(1<t.length)throw Error(M(93));t=t[0]}g=t}g==null&&(g=""),t=g}e._wrapperState={initialValue:Fl(t)}}function Oh(e,g){var t=Fl(g.value),l=Fl(g.defaultValue);t!=null&&(t=""+t,t!==e.value&&(e.value=t),g.defaultValue==null&&e.defaultValue!==t&&(e.defaultValue=t)),l!=null&&(e.defaultValue=""+l)}function Um(e){var g=e.textContent;g===e._wrapperState.initialValue&&g!==""&&g!==null&&(e.value=g)}function $h(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Fc(e,g){return e==null||e==="http://www.w3.org/1999/xhtml"?$h(g):e==="http://www.w3.org/2000/svg"&&g==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var OC,qh=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(g,t,l,n){MSApp.execUnsafeLocalFunction(function(){return e(g,t,l,n)})}:e}(function(e,g){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=g;else{for(OC=OC||document.createElement("div"),OC.innerHTML="<svg>"+g.valueOf().toString()+"</svg>",g=OC.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;g.firstChild;)e.appendChild(g.firstChild)}});function Do(e,g){if(g){var t=e.firstChild;if(t&&t===e.lastChild&&t.nodeType===3){t.nodeValue=g;return}}e.textContent=g}var Vo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},uv=["Webkit","ms","Moz","O"];Object.keys(Vo).forEach(function(e){uv.forEach(function(g){g=g+e.charAt(0).toUpperCase()+e.substring(1),Vo[g]=Vo[e]})});function _h(e,g,t){return g==null||typeof g=="boolean"||g===""?"":t||typeof g!="number"||g===0||Vo.hasOwnProperty(e)&&Vo[e]?(""+g).trim():g+"px"}function ep(e,g){e=e.style;for(var t in g)if(g.hasOwnProperty(t)){var l=t.indexOf("--")===0,n=_h(t,g[t],l);t==="float"&&(t="cssFloat"),l?e.setProperty(t,n):e[t]=n}}var Av=Xe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function xc(e,g){if(g){if(Av[e]&&(g.children!=null||g.dangerouslySetInnerHTML!=null))throw Error(M(137,e));if(g.dangerouslySetInnerHTML!=null){if(g.children!=null)throw Error(M(60));if(typeof g.dangerouslySetInnerHTML!="object"||!("__html"in g.dangerouslySetInnerHTML))throw Error(M(61))}if(g.style!=null&&typeof g.style!="object")throw Error(M(62))}}function Ec(e,g){if(e.indexOf("-")===-1)return typeof g.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Dc=null;function Xu(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Mc=null,fI=null,SI=null;function Qm(e){if(e=yC(e)){if(typeof Mc!="function")throw Error(M(280));var g=e.stateNode;g&&(g=li(g),Mc(e.stateNode,e.type,g))}}function gp(e){fI?SI?SI.push(e):SI=[e]:fI=e}function tp(){if(fI){var e=fI,g=SI;if(SI=fI=null,Qm(e),g)for(e=0;e<g.length;e++)Qm(g[e])}}function lp(e,g){return e(g)}function np(){}var fs=!1;function Ip(e,g,t){if(fs)return e(g,t);fs=!0;try{return lp(e,g,t)}finally{fs=!1,(fI!==null||SI!==null)&&(np(),tp())}}function Mo(e,g){var t=e.stateNode;if(t===null)return null;var l=li(t);if(l===null)return null;t=l[g];e:switch(g){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(l=!l.disabled)||(e=e.type,l=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!l;break e;default:e=!1}if(e)return null;if(t&&typeof t!="function")throw Error(M(231,g,typeof t));return t}var zc=!1;if(Ot)try{var go={};Object.defineProperty(go,"passive",{get:function(){zc=!0}}),window.addEventListener("test",go,go),window.removeEventListener("test",go,go)}catch{zc=!1}function mv(e,g,t,l,n,I,o,C,a){var r=Array.prototype.slice.call(arguments,3);try{g.apply(t,r)}catch(i){this.onError(i)}}var Wo=!1,tr=null,lr=!1,Tc=null,bv={onError:function(e){Wo=!0,tr=e}};function Zv(e,g,t,l,n,I,o,C,a){Wo=!1,tr=null,mv.apply(bv,arguments)}function hv(e,g,t,l,n,I,o,C,a){if(Zv.apply(this,arguments),Wo){if(Wo){var r=tr;Wo=!1,tr=null}else throw Error(M(198));lr||(lr=!0,Tc=r)}}function kn(e){var g=e,t=e;if(e.alternate)for(;g.return;)g=g.return;else{e=g;do g=e,g.flags&4098&&(t=g.return),e=g.return;while(e)}return g.tag===3?t:null}function op(e){if(e.tag===13){var g=e.memoizedState;if(g===null&&(e=e.alternate,e!==null&&(g=e.memoizedState)),g!==null)return g.dehydrated}return null}function jm(e){if(kn(e)!==e)throw Error(M(188))}function pv(e){var g=e.alternate;if(!g){if(g=kn(e),g===null)throw Error(M(188));return g!==e?null:e}for(var t=e,l=g;;){var n=t.return;if(n===null)break;var I=n.alternate;if(I===null){if(l=n.return,l!==null){t=l;continue}break}if(n.child===I.child){for(I=n.child;I;){if(I===t)return jm(n),e;if(I===l)return jm(n),g;I=I.sibling}throw Error(M(188))}if(t.return!==l.return)t=n,l=I;else{for(var o=!1,C=n.child;C;){if(C===t){o=!0,t=n,l=I;break}if(C===l){o=!0,l=n,t=I;break}C=C.sibling}if(!o){for(C=I.child;C;){if(C===t){o=!0,t=I,l=n;break}if(C===l){o=!0,l=I,t=n;break}C=C.sibling}if(!o)throw Error(M(189))}}if(t.alternate!==l)throw Error(M(190))}if(t.tag!==3)throw Error(M(188));return t.stateNode.current===t?e:g}function Cp(e){return e=pv(e),e!==null?ap(e):null}function ap(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var g=ap(e);if(g!==null)return g;e=e.sibling}return null}var rp=Hg.unstable_scheduleCallback,Pm=Hg.unstable_cancelCallback,Gv=Hg.unstable_shouldYield,yv=Hg.unstable_requestPaint,Ke=Hg.unstable_now,Bv=Hg.unstable_getCurrentPriorityLevel,ku=Hg.unstable_ImmediatePriority,ip=Hg.unstable_UserBlockingPriority,nr=Hg.unstable_NormalPriority,fv=Hg.unstable_LowPriority,sp=Hg.unstable_IdlePriority,_r=null,vt=null;function Sv(e){if(vt&&typeof vt.onCommitFiberRoot=="function")try{vt.onCommitFiberRoot(_r,e,void 0,(e.current.flags&128)===128)}catch{}}var mt=Math.clz32?Math.clz32:vv,Vv=Math.log,Wv=Math.LN2;function vv(e){return e>>>=0,e===0?32:31-(Vv(e)/Wv|0)|0}var $C=64,qC=4194304;function Zo(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Ir(e,g){var t=e.pendingLanes;if(t===0)return 0;var l=0,n=e.suspendedLanes,I=e.pingedLanes,o=t&268435455;if(o!==0){var C=o&~n;C!==0?l=Zo(C):(I&=o,I!==0&&(l=Zo(I)))}else o=t&~n,o!==0?l=Zo(o):I!==0&&(l=Zo(I));if(l===0)return 0;if(g!==0&&g!==l&&!(g&n)&&(n=l&-l,I=g&-g,n>=I||n===16&&(I&4194240)!==0))return g;if(l&4&&(l|=t&16),g=e.entangledLanes,g!==0)for(e=e.entanglements,g&=l;0<g;)t=31-mt(g),n=1<<t,l|=e[t],g&=~n;return l}function Rv(e,g){switch(e){case 1:case 2:case 4:return g+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return g+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Xv(e,g){for(var t=e.suspendedLanes,l=e.pingedLanes,n=e.expirationTimes,I=e.pendingLanes;0<I;){var o=31-mt(I),C=1<<o,a=n[o];a===-1?(!(C&t)||C&l)&&(n[o]=Rv(C,g)):a<=g&&(e.expiredLanes|=C),I&=~C}}function Lc(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function cp(){var e=$C;return $C<<=1,!($C&4194240)&&($C=64),e}function Ss(e){for(var g=[],t=0;31>t;t++)g.push(e);return g}function pC(e,g,t){e.pendingLanes|=g,g!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,g=31-mt(g),e[g]=t}function kv(e,g){var t=e.pendingLanes&~g;e.pendingLanes=g,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=g,e.mutableReadLanes&=g,e.entangledLanes&=g,g=e.entanglements;var l=e.eventTimes;for(e=e.expirationTimes;0<t;){var n=31-mt(t),I=1<<n;g[n]=0,l[n]=-1,e[n]=-1,t&=~I}}function Ju(e,g){var t=e.entangledLanes|=g;for(e=e.entanglements;t;){var l=31-mt(t),n=1<<l;n&g|e[l]&g&&(e[l]|=g),t&=~n}}var ce=0;function dp(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var up,Yu,Ap,mp,bp,Uc=!1,_C=[],vl=null,Rl=null,Xl=null,zo=new Map,To=new Map,pl=[],Jv="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Om(e,g){switch(e){case"focusin":case"focusout":vl=null;break;case"dragenter":case"dragleave":Rl=null;break;case"mouseover":case"mouseout":Xl=null;break;case"pointerover":case"pointerout":zo.delete(g.pointerId);break;case"gotpointercapture":case"lostpointercapture":To.delete(g.pointerId)}}function to(e,g,t,l,n,I){return e===null||e.nativeEvent!==I?(e={blockedOn:g,domEventName:t,eventSystemFlags:l,nativeEvent:I,targetContainers:[n]},g!==null&&(g=yC(g),g!==null&&Yu(g)),e):(e.eventSystemFlags|=l,g=e.targetContainers,n!==null&&g.indexOf(n)===-1&&g.push(n),e)}function Yv(e,g,t,l,n){switch(g){case"focusin":return vl=to(vl,e,g,t,l,n),!0;case"dragenter":return Rl=to(Rl,e,g,t,l,n),!0;case"mouseover":return Xl=to(Xl,e,g,t,l,n),!0;case"pointerover":var I=n.pointerId;return zo.set(I,to(zo.get(I)||null,e,g,t,l,n)),!0;case"gotpointercapture":return I=n.pointerId,To.set(I,to(To.get(I)||null,e,g,t,l,n)),!0}return!1}function Zp(e){var g=rn(e.target);if(g!==null){var t=kn(g);if(t!==null){if(g=t.tag,g===13){if(g=op(t),g!==null){e.blockedOn=g,bp(e.priority,function(){Ap(t)});return}}else if(g===3&&t.stateNode.current.memoizedState.isDehydrated){e.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Na(e){if(e.blockedOn!==null)return!1;for(var g=e.targetContainers;0<g.length;){var t=Qc(e.domEventName,e.eventSystemFlags,g[0],e.nativeEvent);if(t===null){t=e.nativeEvent;var l=new t.constructor(t.type,t);Dc=l,t.target.dispatchEvent(l),Dc=null}else return g=yC(t),g!==null&&Yu(g),e.blockedOn=t,!1;g.shift()}return!0}function $m(e,g,t){Na(e)&&t.delete(g)}function wv(){Uc=!1,vl!==null&&Na(vl)&&(vl=null),Rl!==null&&Na(Rl)&&(Rl=null),Xl!==null&&Na(Xl)&&(Xl=null),zo.forEach($m),To.forEach($m)}function lo(e,g){e.blockedOn===g&&(e.blockedOn=null,Uc||(Uc=!0,Hg.unstable_scheduleCallback(Hg.unstable_NormalPriority,wv)))}function Lo(e){function g(n){return lo(n,e)}if(0<_C.length){lo(_C[0],e);for(var t=1;t<_C.length;t++){var l=_C[t];l.blockedOn===e&&(l.blockedOn=null)}}for(vl!==null&&lo(vl,e),Rl!==null&&lo(Rl,e),Xl!==null&&lo(Xl,e),zo.forEach(g),To.forEach(g),t=0;t<pl.length;t++)l=pl[t],l.blockedOn===e&&(l.blockedOn=null);for(;0<pl.length&&(t=pl[0],t.blockedOn===null);)Zp(t),t.blockedOn===null&&pl.shift()}var VI=ll.ReactCurrentBatchConfig,or=!0;function Hv(e,g,t,l){var n=ce,I=VI.transition;VI.transition=null;try{ce=1,wu(e,g,t,l)}finally{ce=n,VI.transition=I}}function Nv(e,g,t,l){var n=ce,I=VI.transition;VI.transition=null;try{ce=4,wu(e,g,t,l)}finally{ce=n,VI.transition=I}}function wu(e,g,t,l){if(or){var n=Qc(e,g,t,l);if(n===null)Hs(e,g,l,Cr,t),Om(e,l);else if(Yv(n,e,g,t,l))l.stopPropagation();else if(Om(e,l),g&4&&-1<Jv.indexOf(e)){for(;n!==null;){var I=yC(n);if(I!==null&&up(I),I=Qc(e,g,t,l),I===null&&Hs(e,g,l,Cr,t),I===n)break;n=I}n!==null&&l.stopPropagation()}else Hs(e,g,l,null,t)}}var Cr=null;function Qc(e,g,t,l){if(Cr=null,e=Xu(l),e=rn(e),e!==null)if(g=kn(e),g===null)e=null;else if(t=g.tag,t===13){if(e=op(g),e!==null)return e;e=null}else if(t===3){if(g.stateNode.current.memoizedState.isDehydrated)return g.tag===3?g.stateNode.containerInfo:null;e=null}else g!==e&&(e=null);return Cr=e,null}function hp(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Bv()){case ku:return 1;case ip:return 4;case nr:case fv:return 16;case sp:return 536870912;default:return 16}default:return 16}}var fl=null,Hu=null,Ka=null;function pp(){if(Ka)return Ka;var e,g=Hu,t=g.length,l,n="value"in fl?fl.value:fl.textContent,I=n.length;for(e=0;e<t&&g[e]===n[e];e++);var o=t-e;for(l=1;l<=o&&g[t-l]===n[I-l];l++);return Ka=n.slice(e,1<l?1-l:void 0)}function Fa(e){var g=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&g===13&&(e=13)):e=g,e===10&&(e=13),32<=e||e===13?e:0}function ea(){return!0}function qm(){return!1}function xg(e){function g(t,l,n,I,o){this._reactName=t,this._targetInst=n,this.type=l,this.nativeEvent=I,this.target=o,this.currentTarget=null;for(var C in e)e.hasOwnProperty(C)&&(t=e[C],this[C]=t?t(I):I[C]);return this.isDefaultPrevented=(I.defaultPrevented!=null?I.defaultPrevented:I.returnValue===!1)?ea:qm,this.isPropagationStopped=qm,this}return Xe(g.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=ea)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=ea)},persist:function(){},isPersistent:ea}),g}var DI={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Nu=xg(DI),GC=Xe({},DI,{view:0,detail:0}),Kv=xg(GC),Vs,Ws,no,ei=Xe({},GC,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ku,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==no&&(no&&e.type==="mousemove"?(Vs=e.screenX-no.screenX,Ws=e.screenY-no.screenY):Ws=Vs=0,no=e),Vs)},movementY:function(e){return"movementY"in e?e.movementY:Ws}}),_m=xg(ei),Fv=Xe({},ei,{dataTransfer:0}),xv=xg(Fv),Ev=Xe({},GC,{relatedTarget:0}),vs=xg(Ev),Dv=Xe({},DI,{animationName:0,elapsedTime:0,pseudoElement:0}),Mv=xg(Dv),zv=Xe({},DI,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Tv=xg(zv),Lv=Xe({},DI,{data:0}),eb=xg(Lv),Uv={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Qv={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},jv={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Pv(e){var g=this.nativeEvent;return g.getModifierState?g.getModifierState(e):(e=jv[e])?!!g[e]:!1}function Ku(){return Pv}var Ov=Xe({},GC,{key:function(e){if(e.key){var g=Uv[e.key]||e.key;if(g!=="Unidentified")return g}return e.type==="keypress"?(e=Fa(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Qv[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ku,charCode:function(e){return e.type==="keypress"?Fa(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Fa(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),$v=xg(Ov),qv=Xe({},ei,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),gb=xg(qv),_v=Xe({},GC,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ku}),eR=xg(_v),gR=Xe({},DI,{propertyName:0,elapsedTime:0,pseudoElement:0}),tR=xg(gR),lR=Xe({},ei,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),nR=xg(lR),IR=[9,13,27,32],Fu=Ot&&"CompositionEvent"in window,vo=null;Ot&&"documentMode"in document&&(vo=document.documentMode);var oR=Ot&&"TextEvent"in window&&!vo,Gp=Ot&&(!Fu||vo&&8<vo&&11>=vo),tb=" ",lb=!1;function yp(e,g){switch(e){case"keyup":return IR.indexOf(g.keyCode)!==-1;case"keydown":return g.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Bp(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var tI=!1;function CR(e,g){switch(e){case"compositionend":return Bp(g);case"keypress":return g.which!==32?null:(lb=!0,tb);case"textInput":return e=g.data,e===tb&&lb?null:e;default:return null}}function aR(e,g){if(tI)return e==="compositionend"||!Fu&&yp(e,g)?(e=pp(),Ka=Hu=fl=null,tI=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(g.ctrlKey||g.altKey||g.metaKey)||g.ctrlKey&&g.altKey){if(g.char&&1<g.char.length)return g.char;if(g.which)return String.fromCharCode(g.which)}return null;case"compositionend":return Gp&&g.locale!=="ko"?null:g.data;default:return null}}var rR={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function nb(e){var g=e&&e.nodeName&&e.nodeName.toLowerCase();return g==="input"?!!rR[e.type]:g==="textarea"}function fp(e,g,t,l){gp(l),g=ar(g,"onChange"),0<g.length&&(t=new Nu("onChange","change",null,t,l),e.push({event:t,listeners:g}))}var Ro=null,Uo=null;function iR(e){Hp(e,0)}function gi(e){var g=II(e);if(jh(g))return e}function sR(e,g){if(e==="change")return g}var Sp=!1;if(Ot){var Rs;if(Ot){var Xs="oninput"in document;if(!Xs){var Ib=document.createElement("div");Ib.setAttribute("oninput","return;"),Xs=typeof Ib.oninput=="function"}Rs=Xs}else Rs=!1;Sp=Rs&&(!document.documentMode||9<document.documentMode)}function ob(){Ro&&(Ro.detachEvent("onpropertychange",Vp),Uo=Ro=null)}function Vp(e){if(e.propertyName==="value"&&gi(Uo)){var g=[];fp(g,Uo,e,Xu(e)),Ip(iR,g)}}function cR(e,g,t){e==="focusin"?(ob(),Ro=g,Uo=t,Ro.attachEvent("onpropertychange",Vp)):e==="focusout"&&ob()}function dR(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return gi(Uo)}function uR(e,g){if(e==="click")return gi(g)}function AR(e,g){if(e==="input"||e==="change")return gi(g)}function mR(e,g){return e===g&&(e!==0||1/e===1/g)||e!==e&&g!==g}var Zt=typeof Object.is=="function"?Object.is:mR;function Qo(e,g){if(Zt(e,g))return!0;if(typeof e!="object"||e===null||typeof g!="object"||g===null)return!1;var t=Object.keys(e),l=Object.keys(g);if(t.length!==l.length)return!1;for(l=0;l<t.length;l++){var n=t[l];if(!Rc.call(g,n)||!Zt(e[n],g[n]))return!1}return!0}function Cb(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ab(e,g){var t=Cb(e);e=0;for(var l;t;){if(t.nodeType===3){if(l=e+t.textContent.length,e<=g&&l>=g)return{node:t,offset:g-e};e=l}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=Cb(t)}}function Wp(e,g){return e&&g?e===g?!0:e&&e.nodeType===3?!1:g&&g.nodeType===3?Wp(e,g.parentNode):"contains"in e?e.contains(g):e.compareDocumentPosition?!!(e.compareDocumentPosition(g)&16):!1:!1}function vp(){for(var e=window,g=gr();g instanceof e.HTMLIFrameElement;){try{var t=typeof g.contentWindow.location.href=="string"}catch{t=!1}if(t)e=g.contentWindow;else break;g=gr(e.document)}return g}function xu(e){var g=e&&e.nodeName&&e.nodeName.toLowerCase();return g&&(g==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||g==="textarea"||e.contentEditable==="true")}function bR(e){var g=vp(),t=e.focusedElem,l=e.selectionRange;if(g!==t&&t&&t.ownerDocument&&Wp(t.ownerDocument.documentElement,t)){if(l!==null&&xu(t)){if(g=l.start,e=l.end,e===void 0&&(e=g),"selectionStart"in t)t.selectionStart=g,t.selectionEnd=Math.min(e,t.value.length);else if(e=(g=t.ownerDocument||document)&&g.defaultView||window,e.getSelection){e=e.getSelection();var n=t.textContent.length,I=Math.min(l.start,n);l=l.end===void 0?I:Math.min(l.end,n),!e.extend&&I>l&&(n=l,l=I,I=n),n=ab(t,I);var o=ab(t,l);n&&o&&(e.rangeCount!==1||e.anchorNode!==n.node||e.anchorOffset!==n.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(g=g.createRange(),g.setStart(n.node,n.offset),e.removeAllRanges(),I>l?(e.addRange(g),e.extend(o.node,o.offset)):(g.setEnd(o.node,o.offset),e.addRange(g)))}}for(g=[],e=t;e=e.parentNode;)e.nodeType===1&&g.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<g.length;t++)e=g[t],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var ZR=Ot&&"documentMode"in document&&11>=document.documentMode,lI=null,jc=null,Xo=null,Pc=!1;function rb(e,g,t){var l=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;Pc||lI==null||lI!==gr(l)||(l=lI,"selectionStart"in l&&xu(l)?l={start:l.selectionStart,end:l.selectionEnd}:(l=(l.ownerDocument&&l.ownerDocument.defaultView||window).getSelection(),l={anchorNode:l.anchorNode,anchorOffset:l.anchorOffset,focusNode:l.focusNode,focusOffset:l.focusOffset}),Xo&&Qo(Xo,l)||(Xo=l,l=ar(jc,"onSelect"),0<l.length&&(g=new Nu("onSelect","select",null,g,t),e.push({event:g,listeners:l}),g.target=lI)))}function ga(e,g){var t={};return t[e.toLowerCase()]=g.toLowerCase(),t["Webkit"+e]="webkit"+g,t["Moz"+e]="moz"+g,t}var nI={animationend:ga("Animation","AnimationEnd"),animationiteration:ga("Animation","AnimationIteration"),animationstart:ga("Animation","AnimationStart"),transitionend:ga("Transition","TransitionEnd")},ks={},Rp={};Ot&&(Rp=document.createElement("div").style,"AnimationEvent"in window||(delete nI.animationend.animation,delete nI.animationiteration.animation,delete nI.animationstart.animation),"TransitionEvent"in window||delete nI.transitionend.transition);function ti(e){if(ks[e])return ks[e];if(!nI[e])return e;var g=nI[e],t;for(t in g)if(g.hasOwnProperty(t)&&t in Rp)return ks[e]=g[t];return e}var Xp=ti("animationend"),kp=ti("animationiteration"),Jp=ti("animationstart"),Yp=ti("transitionend"),wp=new Map,ib="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function zl(e,g){wp.set(e,g),Xn(g,[e])}for(var Js=0;Js<ib.length;Js++){var Ys=ib[Js],hR=Ys.toLowerCase(),pR=Ys[0].toUpperCase()+Ys.slice(1);zl(hR,"on"+pR)}zl(Xp,"onAnimationEnd");zl(kp,"onAnimationIteration");zl(Jp,"onAnimationStart");zl("dblclick","onDoubleClick");zl("focusin","onFocus");zl("focusout","onBlur");zl(Yp,"onTransitionEnd");XI("onMouseEnter",["mouseout","mouseover"]);XI("onMouseLeave",["mouseout","mouseover"]);XI("onPointerEnter",["pointerout","pointerover"]);XI("onPointerLeave",["pointerout","pointerover"]);Xn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Xn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Xn("onBeforeInput",["compositionend","keypress","textInput","paste"]);Xn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Xn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Xn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ho="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),GR=new Set("cancel close invalid load scroll toggle".split(" ").concat(ho));function sb(e,g,t){var l=e.type||"unknown-event";e.currentTarget=t,hv(l,g,void 0,e),e.currentTarget=null}function Hp(e,g){g=(g&4)!==0;for(var t=0;t<e.length;t++){var l=e[t],n=l.event;l=l.listeners;e:{var I=void 0;if(g)for(var o=l.length-1;0<=o;o--){var C=l[o],a=C.instance,r=C.currentTarget;if(C=C.listener,a!==I&&n.isPropagationStopped())break e;sb(n,C,r),I=a}else for(o=0;o<l.length;o++){if(C=l[o],a=C.instance,r=C.currentTarget,C=C.listener,a!==I&&n.isPropagationStopped())break e;sb(n,C,r),I=a}}}if(lr)throw e=Tc,lr=!1,Tc=null,e}function Ze(e,g){var t=g[ed];t===void 0&&(t=g[ed]=new Set);var l=e+"__bubble";t.has(l)||(Np(g,e,2,!1),t.add(l))}function ws(e,g,t){var l=0;g&&(l|=4),Np(t,e,l,g)}var ta="_reactListening"+Math.random().toString(36).slice(2);function jo(e){if(!e[ta]){e[ta]=!0,zh.forEach(function(t){t!=="selectionchange"&&(GR.has(t)||ws(t,!1,e),ws(t,!0,e))});var g=e.nodeType===9?e:e.ownerDocument;g===null||g[ta]||(g[ta]=!0,ws("selectionchange",!1,g))}}function Np(e,g,t,l){switch(hp(g)){case 1:var n=Hv;break;case 4:n=Nv;break;default:n=wu}t=n.bind(null,g,t,e),n=void 0,!zc||g!=="touchstart"&&g!=="touchmove"&&g!=="wheel"||(n=!0),l?n!==void 0?e.addEventListener(g,t,{capture:!0,passive:n}):e.addEventListener(g,t,!0):n!==void 0?e.addEventListener(g,t,{passive:n}):e.addEventListener(g,t,!1)}function Hs(e,g,t,l,n){var I=l;if(!(g&1)&&!(g&2)&&l!==null)e:for(;;){if(l===null)return;var o=l.tag;if(o===3||o===4){var C=l.stateNode.containerInfo;if(C===n||C.nodeType===8&&C.parentNode===n)break;if(o===4)for(o=l.return;o!==null;){var a=o.tag;if((a===3||a===4)&&(a=o.stateNode.containerInfo,a===n||a.nodeType===8&&a.parentNode===n))return;o=o.return}for(;C!==null;){if(o=rn(C),o===null)return;if(a=o.tag,a===5||a===6){l=I=o;continue e}C=C.parentNode}}l=l.return}Ip(function(){var r=I,i=Xu(t),s=[];e:{var c=wp.get(e);if(c!==void 0){var d=Nu,Z=e;switch(e){case"keypress":if(Fa(t)===0)break e;case"keydown":case"keyup":d=$v;break;case"focusin":Z="focus",d=vs;break;case"focusout":Z="blur",d=vs;break;case"beforeblur":case"afterblur":d=vs;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":d=_m;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":d=xv;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":d=eR;break;case Xp:case kp:case Jp:d=Mv;break;case Yp:d=tR;break;case"scroll":d=Kv;break;case"wheel":d=nR;break;case"copy":case"cut":case"paste":d=Tv;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":d=gb}var G=(g&4)!==0,y=!G&&e==="scroll",p=G?c!==null?c+"Capture":null:c;G=[];for(var h=r,b;h!==null;){b=h;var B=b.stateNode;if(b.tag===5&&B!==null&&(b=B,p!==null&&(B=Mo(h,p),B!=null&&G.push(Po(h,B,b)))),y)break;h=h.return}0<G.length&&(c=new d(c,Z,null,t,i),s.push({event:c,listeners:G}))}}if(!(g&7)){e:{if(c=e==="mouseover"||e==="pointerover",d=e==="mouseout"||e==="pointerout",c&&t!==Dc&&(Z=t.relatedTarget||t.fromElement)&&(rn(Z)||Z[$t]))break e;if((d||c)&&(c=i.window===i?i:(c=i.ownerDocument)?c.defaultView||c.parentWindow:window,d?(Z=t.relatedTarget||t.toElement,d=r,Z=Z?rn(Z):null,Z!==null&&(y=kn(Z),Z!==y||Z.tag!==5&&Z.tag!==6)&&(Z=null)):(d=null,Z=r),d!==Z)){if(G=_m,B="onMouseLeave",p="onMouseEnter",h="mouse",(e==="pointerout"||e==="pointerover")&&(G=gb,B="onPointerLeave",p="onPointerEnter",h="pointer"),y=d==null?c:II(d),b=Z==null?c:II(Z),c=new G(B,h+"leave",d,t,i),c.target=y,c.relatedTarget=b,B=null,rn(i)===r&&(G=new G(p,h+"enter",Z,t,i),G.target=b,G.relatedTarget=y,B=G),y=B,d&&Z)g:{for(G=d,p=Z,h=0,b=G;b;b=zn(b))h++;for(b=0,B=p;B;B=zn(B))b++;for(;0<h-b;)G=zn(G),h--;for(;0<b-h;)p=zn(p),b--;for(;h--;){if(G===p||p!==null&&G===p.alternate)break g;G=zn(G),p=zn(p)}G=null}else G=null;d!==null&&cb(s,c,d,G,!1),Z!==null&&y!==null&&cb(s,y,Z,G,!0)}}e:{if(c=r?II(r):window,d=c.nodeName&&c.nodeName.toLowerCase(),d==="select"||d==="input"&&c.type==="file")var S=sR;else if(nb(c))if(Sp)S=AR;else{S=dR;var X=cR}else(d=c.nodeName)&&d.toLowerCase()==="input"&&(c.type==="checkbox"||c.type==="radio")&&(S=uR);if(S&&(S=S(e,r))){fp(s,S,t,i);break e}X&&X(e,c,r),e==="focusout"&&(X=c._wrapperState)&&X.controlled&&c.type==="number"&&Nc(c,"number",c.value)}switch(X=r?II(r):window,e){case"focusin":(nb(X)||X.contentEditable==="true")&&(lI=X,jc=r,Xo=null);break;case"focusout":Xo=jc=lI=null;break;case"mousedown":Pc=!0;break;case"contextmenu":case"mouseup":case"dragend":Pc=!1,rb(s,t,i);break;case"selectionchange":if(ZR)break;case"keydown":case"keyup":rb(s,t,i)}var k;if(Fu)e:{switch(e){case"compositionstart":var m="onCompositionStart";break e;case"compositionend":m="onCompositionEnd";break e;case"compositionupdate":m="onCompositionUpdate";break e}m=void 0}else tI?yp(e,t)&&(m="onCompositionEnd"):e==="keydown"&&t.keyCode===229&&(m="onCompositionStart");m&&(Gp&&t.locale!=="ko"&&(tI||m!=="onCompositionStart"?m==="onCompositionEnd"&&tI&&(k=pp()):(fl=i,Hu="value"in fl?fl.value:fl.textContent,tI=!0)),X=ar(r,m),0<X.length&&(m=new eb(m,e,null,t,i),s.push({event:m,listeners:X}),k?m.data=k:(k=Bp(t),k!==null&&(m.data=k)))),(k=oR?CR(e,t):aR(e,t))&&(r=ar(r,"onBeforeInput"),0<r.length&&(i=new eb("onBeforeInput","beforeinput",null,t,i),s.push({event:i,listeners:r}),i.data=k))}Hp(s,g)})}function Po(e,g,t){return{instance:e,listener:g,currentTarget:t}}function ar(e,g){for(var t=g+"Capture",l=[];e!==null;){var n=e,I=n.stateNode;n.tag===5&&I!==null&&(n=I,I=Mo(e,t),I!=null&&l.unshift(Po(e,I,n)),I=Mo(e,g),I!=null&&l.push(Po(e,I,n))),e=e.return}return l}function zn(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function cb(e,g,t,l,n){for(var I=g._reactName,o=[];t!==null&&t!==l;){var C=t,a=C.alternate,r=C.stateNode;if(a!==null&&a===l)break;C.tag===5&&r!==null&&(C=r,n?(a=Mo(t,I),a!=null&&o.unshift(Po(t,a,C))):n||(a=Mo(t,I),a!=null&&o.push(Po(t,a,C)))),t=t.return}o.length!==0&&e.push({event:g,listeners:o})}var yR=/\r\n?/g,BR=/\u0000|\uFFFD/g;function db(e){return(typeof e=="string"?e:""+e).replace(yR,`
`).replace(BR,"")}function la(e,g,t){if(g=db(g),db(e)!==g&&t)throw Error(M(425))}function rr(){}var Oc=null,$c=null;function qc(e,g){return e==="textarea"||e==="noscript"||typeof g.children=="string"||typeof g.children=="number"||typeof g.dangerouslySetInnerHTML=="object"&&g.dangerouslySetInnerHTML!==null&&g.dangerouslySetInnerHTML.__html!=null}var _c=typeof setTimeout=="function"?setTimeout:void 0,fR=typeof clearTimeout=="function"?clearTimeout:void 0,ub=typeof Promise=="function"?Promise:void 0,SR=typeof queueMicrotask=="function"?queueMicrotask:typeof ub<"u"?function(e){return ub.resolve(null).then(e).catch(VR)}:_c;function VR(e){setTimeout(function(){throw e})}function Ns(e,g){var t=g,l=0;do{var n=t.nextSibling;if(e.removeChild(t),n&&n.nodeType===8)if(t=n.data,t==="/$"){if(l===0){e.removeChild(n),Lo(g);return}l--}else t!=="$"&&t!=="$?"&&t!=="$!"||l++;t=n}while(t);Lo(g)}function kl(e){for(;e!=null;e=e.nextSibling){var g=e.nodeType;if(g===1||g===3)break;if(g===8){if(g=e.data,g==="$"||g==="$!"||g==="$?")break;if(g==="/$")return null}}return e}function Ab(e){e=e.previousSibling;for(var g=0;e;){if(e.nodeType===8){var t=e.data;if(t==="$"||t==="$!"||t==="$?"){if(g===0)return e;g--}else t==="/$"&&g++}e=e.previousSibling}return null}var MI=Math.random().toString(36).slice(2),St="__reactFiber$"+MI,Oo="__reactProps$"+MI,$t="__reactContainer$"+MI,ed="__reactEvents$"+MI,WR="__reactListeners$"+MI,vR="__reactHandles$"+MI;function rn(e){var g=e[St];if(g)return g;for(var t=e.parentNode;t;){if(g=t[$t]||t[St]){if(t=g.alternate,g.child!==null||t!==null&&t.child!==null)for(e=Ab(e);e!==null;){if(t=e[St])return t;e=Ab(e)}return g}e=t,t=e.parentNode}return null}function yC(e){return e=e[St]||e[$t],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function II(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(M(33))}function li(e){return e[Oo]||null}var gd=[],oI=-1;function Tl(e){return{current:e}}function pe(e){0>oI||(e.current=gd[oI],gd[oI]=null,oI--)}function Ae(e,g){oI++,gd[oI]=e.current,e.current=g}var xl={},dg=Tl(xl),Sg=Tl(!1),yn=xl;function kI(e,g){var t=e.type.contextTypes;if(!t)return xl;var l=e.stateNode;if(l&&l.__reactInternalMemoizedUnmaskedChildContext===g)return l.__reactInternalMemoizedMaskedChildContext;var n={},I;for(I in t)n[I]=g[I];return l&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=g,e.__reactInternalMemoizedMaskedChildContext=n),n}function Vg(e){return e=e.childContextTypes,e!=null}function ir(){pe(Sg),pe(dg)}function mb(e,g,t){if(dg.current!==xl)throw Error(M(168));Ae(dg,g),Ae(Sg,t)}function Kp(e,g,t){var l=e.stateNode;if(g=g.childContextTypes,typeof l.getChildContext!="function")return t;l=l.getChildContext();for(var n in l)if(!(n in g))throw Error(M(108,cv(e)||"Unknown",n));return Xe({},t,l)}function sr(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||xl,yn=dg.current,Ae(dg,e),Ae(Sg,Sg.current),!0}function bb(e,g,t){var l=e.stateNode;if(!l)throw Error(M(169));t?(e=Kp(e,g,yn),l.__reactInternalMemoizedMergedChildContext=e,pe(Sg),pe(dg),Ae(dg,e)):pe(Sg),Ae(Sg,t)}var Dt=null,ni=!1,Ks=!1;function Fp(e){Dt===null?Dt=[e]:Dt.push(e)}function RR(e){ni=!0,Fp(e)}function Ll(){if(!Ks&&Dt!==null){Ks=!0;var e=0,g=ce;try{var t=Dt;for(ce=1;e<t.length;e++){var l=t[e];do l=l(!0);while(l!==null)}Dt=null,ni=!1}catch(n){throw Dt!==null&&(Dt=Dt.slice(e+1)),rp(ku,Ll),n}finally{ce=g,Ks=!1}}return null}var CI=[],aI=0,cr=null,dr=0,Qg=[],jg=0,Bn=null,zt=1,Tt="";function ln(e,g){CI[aI++]=dr,CI[aI++]=cr,cr=e,dr=g}function xp(e,g,t){Qg[jg++]=zt,Qg[jg++]=Tt,Qg[jg++]=Bn,Bn=e;var l=zt;e=Tt;var n=32-mt(l)-1;l&=~(1<<n),t+=1;var I=32-mt(g)+n;if(30<I){var o=n-n%5;I=(l&(1<<o)-1).toString(32),l>>=o,n-=o,zt=1<<32-mt(g)+n|t<<n|l,Tt=I+e}else zt=1<<I|t<<n|l,Tt=e}function Eu(e){e.return!==null&&(ln(e,1),xp(e,1,0))}function Du(e){for(;e===cr;)cr=CI[--aI],CI[aI]=null,dr=CI[--aI],CI[aI]=null;for(;e===Bn;)Bn=Qg[--jg],Qg[jg]=null,Tt=Qg[--jg],Qg[jg]=null,zt=Qg[--jg],Qg[jg]=null}var wg=null,Jg=null,ye=!1,ut=null;function Ep(e,g){var t=Og(5,null,null,0);t.elementType="DELETED",t.stateNode=g,t.return=e,g=e.deletions,g===null?(e.deletions=[t],e.flags|=16):g.push(t)}function Zb(e,g){switch(e.tag){case 5:var t=e.type;return g=g.nodeType!==1||t.toLowerCase()!==g.nodeName.toLowerCase()?null:g,g!==null?(e.stateNode=g,wg=e,Jg=kl(g.firstChild),!0):!1;case 6:return g=e.pendingProps===""||g.nodeType!==3?null:g,g!==null?(e.stateNode=g,wg=e,Jg=null,!0):!1;case 13:return g=g.nodeType!==8?null:g,g!==null?(t=Bn!==null?{id:zt,overflow:Tt}:null,e.memoizedState={dehydrated:g,treeContext:t,retryLane:1073741824},t=Og(18,null,null,0),t.stateNode=g,t.return=e,e.child=t,wg=e,Jg=null,!0):!1;default:return!1}}function td(e){return(e.mode&1)!==0&&(e.flags&128)===0}function ld(e){if(ye){var g=Jg;if(g){var t=g;if(!Zb(e,g)){if(td(e))throw Error(M(418));g=kl(t.nextSibling);var l=wg;g&&Zb(e,g)?Ep(l,t):(e.flags=e.flags&-4097|2,ye=!1,wg=e)}}else{if(td(e))throw Error(M(418));e.flags=e.flags&-4097|2,ye=!1,wg=e}}}function hb(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;wg=e}function na(e){if(e!==wg)return!1;if(!ye)return hb(e),ye=!0,!1;var g;if((g=e.tag!==3)&&!(g=e.tag!==5)&&(g=e.type,g=g!=="head"&&g!=="body"&&!qc(e.type,e.memoizedProps)),g&&(g=Jg)){if(td(e))throw Dp(),Error(M(418));for(;g;)Ep(e,g),g=kl(g.nextSibling)}if(hb(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(M(317));e:{for(e=e.nextSibling,g=0;e;){if(e.nodeType===8){var t=e.data;if(t==="/$"){if(g===0){Jg=kl(e.nextSibling);break e}g--}else t!=="$"&&t!=="$!"&&t!=="$?"||g++}e=e.nextSibling}Jg=null}}else Jg=wg?kl(e.stateNode.nextSibling):null;return!0}function Dp(){for(var e=Jg;e;)e=kl(e.nextSibling)}function JI(){Jg=wg=null,ye=!1}function Mu(e){ut===null?ut=[e]:ut.push(e)}var XR=ll.ReactCurrentBatchConfig;function st(e,g){if(e&&e.defaultProps){g=Xe({},g),e=e.defaultProps;for(var t in e)g[t]===void 0&&(g[t]=e[t]);return g}return g}var ur=Tl(null),Ar=null,rI=null,zu=null;function Tu(){zu=rI=Ar=null}function Lu(e){var g=ur.current;pe(ur),e._currentValue=g}function nd(e,g,t){for(;e!==null;){var l=e.alternate;if((e.childLanes&g)!==g?(e.childLanes|=g,l!==null&&(l.childLanes|=g)):l!==null&&(l.childLanes&g)!==g&&(l.childLanes|=g),e===t)break;e=e.return}}function WI(e,g){Ar=e,zu=rI=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&g&&(fg=!0),e.firstContext=null)}function gt(e){var g=e._currentValue;if(zu!==e)if(e={context:e,memoizedValue:g,next:null},rI===null){if(Ar===null)throw Error(M(308));rI=e,Ar.dependencies={lanes:0,firstContext:e}}else rI=rI.next=e;return g}var sn=null;function Uu(e){sn===null?sn=[e]:sn.push(e)}function Mp(e,g,t,l){var n=g.interleaved;return n===null?(t.next=t,Uu(g)):(t.next=n.next,n.next=t),g.interleaved=t,qt(e,l)}function qt(e,g){e.lanes|=g;var t=e.alternate;for(t!==null&&(t.lanes|=g),t=e,e=e.return;e!==null;)e.childLanes|=g,t=e.alternate,t!==null&&(t.childLanes|=g),t=e,e=e.return;return t.tag===3?t.stateNode:null}var Al=!1;function Qu(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function zp(e,g){e=e.updateQueue,g.updateQueue===e&&(g.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Qt(e,g){return{eventTime:e,lane:g,tag:0,payload:null,callback:null,next:null}}function Jl(e,g,t){var l=e.updateQueue;if(l===null)return null;if(l=l.shared,Ce&2){var n=l.pending;return n===null?g.next=g:(g.next=n.next,n.next=g),l.pending=g,qt(e,t)}return n=l.interleaved,n===null?(g.next=g,Uu(l)):(g.next=n.next,n.next=g),l.interleaved=g,qt(e,t)}function xa(e,g,t){if(g=g.updateQueue,g!==null&&(g=g.shared,(t&4194240)!==0)){var l=g.lanes;l&=e.pendingLanes,t|=l,g.lanes=t,Ju(e,t)}}function pb(e,g){var t=e.updateQueue,l=e.alternate;if(l!==null&&(l=l.updateQueue,t===l)){var n=null,I=null;if(t=t.firstBaseUpdate,t!==null){do{var o={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};I===null?n=I=o:I=I.next=o,t=t.next}while(t!==null);I===null?n=I=g:I=I.next=g}else n=I=g;t={baseState:l.baseState,firstBaseUpdate:n,lastBaseUpdate:I,shared:l.shared,effects:l.effects},e.updateQueue=t;return}e=t.lastBaseUpdate,e===null?t.firstBaseUpdate=g:e.next=g,t.lastBaseUpdate=g}function mr(e,g,t,l){var n=e.updateQueue;Al=!1;var I=n.firstBaseUpdate,o=n.lastBaseUpdate,C=n.shared.pending;if(C!==null){n.shared.pending=null;var a=C,r=a.next;a.next=null,o===null?I=r:o.next=r,o=a;var i=e.alternate;i!==null&&(i=i.updateQueue,C=i.lastBaseUpdate,C!==o&&(C===null?i.firstBaseUpdate=r:C.next=r,i.lastBaseUpdate=a))}if(I!==null){var s=n.baseState;o=0,i=r=a=null,C=I;do{var c=C.lane,d=C.eventTime;if((l&c)===c){i!==null&&(i=i.next={eventTime:d,lane:0,tag:C.tag,payload:C.payload,callback:C.callback,next:null});e:{var Z=e,G=C;switch(c=g,d=t,G.tag){case 1:if(Z=G.payload,typeof Z=="function"){s=Z.call(d,s,c);break e}s=Z;break e;case 3:Z.flags=Z.flags&-65537|128;case 0:if(Z=G.payload,c=typeof Z=="function"?Z.call(d,s,c):Z,c==null)break e;s=Xe({},s,c);break e;case 2:Al=!0}}C.callback!==null&&C.lane!==0&&(e.flags|=64,c=n.effects,c===null?n.effects=[C]:c.push(C))}else d={eventTime:d,lane:c,tag:C.tag,payload:C.payload,callback:C.callback,next:null},i===null?(r=i=d,a=s):i=i.next=d,o|=c;if(C=C.next,C===null){if(C=n.shared.pending,C===null)break;c=C,C=c.next,c.next=null,n.lastBaseUpdate=c,n.shared.pending=null}}while(!0);if(i===null&&(a=s),n.baseState=a,n.firstBaseUpdate=r,n.lastBaseUpdate=i,g=n.shared.interleaved,g!==null){n=g;do o|=n.lane,n=n.next;while(n!==g)}else I===null&&(n.shared.lanes=0);Sn|=o,e.lanes=o,e.memoizedState=s}}function Gb(e,g,t){if(e=g.effects,g.effects=null,e!==null)for(g=0;g<e.length;g++){var l=e[g],n=l.callback;if(n!==null){if(l.callback=null,l=t,typeof n!="function")throw Error(M(191,n));n.call(l)}}}var Tp=new Mh.Component().refs;function Id(e,g,t,l){g=e.memoizedState,t=t(l,g),t=t==null?g:Xe({},g,t),e.memoizedState=t,e.lanes===0&&(e.updateQueue.baseState=t)}var Ii={isMounted:function(e){return(e=e._reactInternals)?kn(e)===e:!1},enqueueSetState:function(e,g,t){e=e._reactInternals;var l=bg(),n=wl(e),I=Qt(l,n);I.payload=g,t!=null&&(I.callback=t),g=Jl(e,I,n),g!==null&&(bt(g,e,n,l),xa(g,e,n))},enqueueReplaceState:function(e,g,t){e=e._reactInternals;var l=bg(),n=wl(e),I=Qt(l,n);I.tag=1,I.payload=g,t!=null&&(I.callback=t),g=Jl(e,I,n),g!==null&&(bt(g,e,n,l),xa(g,e,n))},enqueueForceUpdate:function(e,g){e=e._reactInternals;var t=bg(),l=wl(e),n=Qt(t,l);n.tag=2,g!=null&&(n.callback=g),g=Jl(e,n,l),g!==null&&(bt(g,e,l,t),xa(g,e,l))}};function yb(e,g,t,l,n,I,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(l,I,o):g.prototype&&g.prototype.isPureReactComponent?!Qo(t,l)||!Qo(n,I):!0}function Lp(e,g,t){var l=!1,n=xl,I=g.contextType;return typeof I=="object"&&I!==null?I=gt(I):(n=Vg(g)?yn:dg.current,l=g.contextTypes,I=(l=l!=null)?kI(e,n):xl),g=new g(t,I),e.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,g.updater=Ii,e.stateNode=g,g._reactInternals=e,l&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=n,e.__reactInternalMemoizedMaskedChildContext=I),g}function Bb(e,g,t,l){e=g.state,typeof g.componentWillReceiveProps=="function"&&g.componentWillReceiveProps(t,l),typeof g.UNSAFE_componentWillReceiveProps=="function"&&g.UNSAFE_componentWillReceiveProps(t,l),g.state!==e&&Ii.enqueueReplaceState(g,g.state,null)}function od(e,g,t,l){var n=e.stateNode;n.props=t,n.state=e.memoizedState,n.refs=Tp,Qu(e);var I=g.contextType;typeof I=="object"&&I!==null?n.context=gt(I):(I=Vg(g)?yn:dg.current,n.context=kI(e,I)),n.state=e.memoizedState,I=g.getDerivedStateFromProps,typeof I=="function"&&(Id(e,g,I,t),n.state=e.memoizedState),typeof g.getDerivedStateFromProps=="function"||typeof n.getSnapshotBeforeUpdate=="function"||typeof n.UNSAFE_componentWillMount!="function"&&typeof n.componentWillMount!="function"||(g=n.state,typeof n.componentWillMount=="function"&&n.componentWillMount(),typeof n.UNSAFE_componentWillMount=="function"&&n.UNSAFE_componentWillMount(),g!==n.state&&Ii.enqueueReplaceState(n,n.state,null),mr(e,t,n,l),n.state=e.memoizedState),typeof n.componentDidMount=="function"&&(e.flags|=4194308)}function Io(e,g,t){if(e=t.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(M(309));var l=t.stateNode}if(!l)throw Error(M(147,e));var n=l,I=""+e;return g!==null&&g.ref!==null&&typeof g.ref=="function"&&g.ref._stringRef===I?g.ref:(g=function(o){var C=n.refs;C===Tp&&(C=n.refs={}),o===null?delete C[I]:C[I]=o},g._stringRef=I,g)}if(typeof e!="string")throw Error(M(284));if(!t._owner)throw Error(M(290,e))}return e}function Ia(e,g){throw e=Object.prototype.toString.call(g),Error(M(31,e==="[object Object]"?"object with keys {"+Object.keys(g).join(", ")+"}":e))}function fb(e){var g=e._init;return g(e._payload)}function Up(e){function g(p,h){if(e){var b=p.deletions;b===null?(p.deletions=[h],p.flags|=16):b.push(h)}}function t(p,h){if(!e)return null;for(;h!==null;)g(p,h),h=h.sibling;return null}function l(p,h){for(p=new Map;h!==null;)h.key!==null?p.set(h.key,h):p.set(h.index,h),h=h.sibling;return p}function n(p,h){return p=Hl(p,h),p.index=0,p.sibling=null,p}function I(p,h,b){return p.index=b,e?(b=p.alternate,b!==null?(b=b.index,b<h?(p.flags|=2,h):b):(p.flags|=2,h)):(p.flags|=1048576,h)}function o(p){return e&&p.alternate===null&&(p.flags|=2),p}function C(p,h,b,B){return h===null||h.tag!==6?(h=Ts(b,p.mode,B),h.return=p,h):(h=n(h,b),h.return=p,h)}function a(p,h,b,B){var S=b.type;return S===gI?i(p,h,b.props.children,B,b.key):h!==null&&(h.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===ul&&fb(S)===h.type)?(B=n(h,b.props),B.ref=Io(p,h,b),B.return=p,B):(B=La(b.type,b.key,b.props,null,p.mode,B),B.ref=Io(p,h,b),B.return=p,B)}function r(p,h,b,B){return h===null||h.tag!==4||h.stateNode.containerInfo!==b.containerInfo||h.stateNode.implementation!==b.implementation?(h=Ls(b,p.mode,B),h.return=p,h):(h=n(h,b.children||[]),h.return=p,h)}function i(p,h,b,B,S){return h===null||h.tag!==7?(h=bn(b,p.mode,B,S),h.return=p,h):(h=n(h,b),h.return=p,h)}function s(p,h,b){if(typeof h=="string"&&h!==""||typeof h=="number")return h=Ts(""+h,p.mode,b),h.return=p,h;if(typeof h=="object"&&h!==null){switch(h.$$typeof){case jC:return b=La(h.type,h.key,h.props,null,p.mode,b),b.ref=Io(p,null,h),b.return=p,b;case eI:return h=Ls(h,p.mode,b),h.return=p,h;case ul:var B=h._init;return s(p,B(h._payload),b)}if(bo(h)||eo(h))return h=bn(h,p.mode,b,null),h.return=p,h;Ia(p,h)}return null}function c(p,h,b,B){var S=h!==null?h.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return S!==null?null:C(p,h,""+b,B);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case jC:return b.key===S?a(p,h,b,B):null;case eI:return b.key===S?r(p,h,b,B):null;case ul:return S=b._init,c(p,h,S(b._payload),B)}if(bo(b)||eo(b))return S!==null?null:i(p,h,b,B,null);Ia(p,b)}return null}function d(p,h,b,B,S){if(typeof B=="string"&&B!==""||typeof B=="number")return p=p.get(b)||null,C(h,p,""+B,S);if(typeof B=="object"&&B!==null){switch(B.$$typeof){case jC:return p=p.get(B.key===null?b:B.key)||null,a(h,p,B,S);case eI:return p=p.get(B.key===null?b:B.key)||null,r(h,p,B,S);case ul:var X=B._init;return d(p,h,b,X(B._payload),S)}if(bo(B)||eo(B))return p=p.get(b)||null,i(h,p,B,S,null);Ia(h,B)}return null}function Z(p,h,b,B){for(var S=null,X=null,k=h,m=h=0,v=null;k!==null&&m<b.length;m++){k.index>m?(v=k,k=null):v=k.sibling;var R=c(p,k,b[m],B);if(R===null){k===null&&(k=v);break}e&&k&&R.alternate===null&&g(p,k),h=I(R,h,m),X===null?S=R:X.sibling=R,X=R,k=v}if(m===b.length)return t(p,k),ye&&ln(p,m),S;if(k===null){for(;m<b.length;m++)k=s(p,b[m],B),k!==null&&(h=I(k,h,m),X===null?S=k:X.sibling=k,X=k);return ye&&ln(p,m),S}for(k=l(p,k);m<b.length;m++)v=d(k,p,m,b[m],B),v!==null&&(e&&v.alternate!==null&&k.delete(v.key===null?m:v.key),h=I(v,h,m),X===null?S=v:X.sibling=v,X=v);return e&&k.forEach(function(W){return g(p,W)}),ye&&ln(p,m),S}function G(p,h,b,B){var S=eo(b);if(typeof S!="function")throw Error(M(150));if(b=S.call(b),b==null)throw Error(M(151));for(var X=S=null,k=h,m=h=0,v=null,R=b.next();k!==null&&!R.done;m++,R=b.next()){k.index>m?(v=k,k=null):v=k.sibling;var W=c(p,k,R.value,B);if(W===null){k===null&&(k=v);break}e&&k&&W.alternate===null&&g(p,k),h=I(W,h,m),X===null?S=W:X.sibling=W,X=W,k=v}if(R.done)return t(p,k),ye&&ln(p,m),S;if(k===null){for(;!R.done;m++,R=b.next())R=s(p,R.value,B),R!==null&&(h=I(R,h,m),X===null?S=R:X.sibling=R,X=R);return ye&&ln(p,m),S}for(k=l(p,k);!R.done;m++,R=b.next())R=d(k,p,m,R.value,B),R!==null&&(e&&R.alternate!==null&&k.delete(R.key===null?m:R.key),h=I(R,h,m),X===null?S=R:X.sibling=R,X=R);return e&&k.forEach(function(J){return g(p,J)}),ye&&ln(p,m),S}function y(p,h,b,B){if(typeof b=="object"&&b!==null&&b.type===gI&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case jC:e:{for(var S=b.key,X=h;X!==null;){if(X.key===S){if(S=b.type,S===gI){if(X.tag===7){t(p,X.sibling),h=n(X,b.props.children),h.return=p,p=h;break e}}else if(X.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===ul&&fb(S)===X.type){t(p,X.sibling),h=n(X,b.props),h.ref=Io(p,X,b),h.return=p,p=h;break e}t(p,X);break}else g(p,X);X=X.sibling}b.type===gI?(h=bn(b.props.children,p.mode,B,b.key),h.return=p,p=h):(B=La(b.type,b.key,b.props,null,p.mode,B),B.ref=Io(p,h,b),B.return=p,p=B)}return o(p);case eI:e:{for(X=b.key;h!==null;){if(h.key===X)if(h.tag===4&&h.stateNode.containerInfo===b.containerInfo&&h.stateNode.implementation===b.implementation){t(p,h.sibling),h=n(h,b.children||[]),h.return=p,p=h;break e}else{t(p,h);break}else g(p,h);h=h.sibling}h=Ls(b,p.mode,B),h.return=p,p=h}return o(p);case ul:return X=b._init,y(p,h,X(b._payload),B)}if(bo(b))return Z(p,h,b,B);if(eo(b))return G(p,h,b,B);Ia(p,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,h!==null&&h.tag===6?(t(p,h.sibling),h=n(h,b),h.return=p,p=h):(t(p,h),h=Ts(b,p.mode,B),h.return=p,p=h),o(p)):t(p,h)}return y}var YI=Up(!0),Qp=Up(!1),BC={},Rt=Tl(BC),$o=Tl(BC),qo=Tl(BC);function cn(e){if(e===BC)throw Error(M(174));return e}function ju(e,g){switch(Ae(qo,g),Ae($o,e),Ae(Rt,BC),e=g.nodeType,e){case 9:case 11:g=(g=g.documentElement)?g.namespaceURI:Fc(null,"");break;default:e=e===8?g.parentNode:g,g=e.namespaceURI||null,e=e.tagName,g=Fc(g,e)}pe(Rt),Ae(Rt,g)}function wI(){pe(Rt),pe($o),pe(qo)}function jp(e){cn(qo.current);var g=cn(Rt.current),t=Fc(g,e.type);g!==t&&(Ae($o,e),Ae(Rt,t))}function Pu(e){$o.current===e&&(pe(Rt),pe($o))}var We=Tl(0);function br(e){for(var g=e;g!==null;){if(g.tag===13){var t=g.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return g}else if(g.tag===19&&g.memoizedProps.revealOrder!==void 0){if(g.flags&128)return g}else if(g.child!==null){g.child.return=g,g=g.child;continue}if(g===e)break;for(;g.sibling===null;){if(g.return===null||g.return===e)return null;g=g.return}g.sibling.return=g.return,g=g.sibling}return null}var Fs=[];function Ou(){for(var e=0;e<Fs.length;e++)Fs[e]._workInProgressVersionPrimary=null;Fs.length=0}var Ea=ll.ReactCurrentDispatcher,xs=ll.ReactCurrentBatchConfig,fn=0,Re=null,je=null,$e=null,Zr=!1,ko=!1,_o=0,kR=0;function Cg(){throw Error(M(321))}function $u(e,g){if(g===null)return!1;for(var t=0;t<g.length&&t<e.length;t++)if(!Zt(e[t],g[t]))return!1;return!0}function qu(e,g,t,l,n,I){if(fn=I,Re=g,g.memoizedState=null,g.updateQueue=null,g.lanes=0,Ea.current=e===null||e.memoizedState===null?HR:NR,e=t(l,n),ko){I=0;do{if(ko=!1,_o=0,25<=I)throw Error(M(301));I+=1,$e=je=null,g.updateQueue=null,Ea.current=KR,e=t(l,n)}while(ko)}if(Ea.current=hr,g=je!==null&&je.next!==null,fn=0,$e=je=Re=null,Zr=!1,g)throw Error(M(300));return e}function _u(){var e=_o!==0;return _o=0,e}function ft(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return $e===null?Re.memoizedState=$e=e:$e=$e.next=e,$e}function tt(){if(je===null){var e=Re.alternate;e=e!==null?e.memoizedState:null}else e=je.next;var g=$e===null?Re.memoizedState:$e.next;if(g!==null)$e=g,je=e;else{if(e===null)throw Error(M(310));je=e,e={memoizedState:je.memoizedState,baseState:je.baseState,baseQueue:je.baseQueue,queue:je.queue,next:null},$e===null?Re.memoizedState=$e=e:$e=$e.next=e}return $e}function eC(e,g){return typeof g=="function"?g(e):g}function Es(e){var g=tt(),t=g.queue;if(t===null)throw Error(M(311));t.lastRenderedReducer=e;var l=je,n=l.baseQueue,I=t.pending;if(I!==null){if(n!==null){var o=n.next;n.next=I.next,I.next=o}l.baseQueue=n=I,t.pending=null}if(n!==null){I=n.next,l=l.baseState;var C=o=null,a=null,r=I;do{var i=r.lane;if((fn&i)===i)a!==null&&(a=a.next={lane:0,action:r.action,hasEagerState:r.hasEagerState,eagerState:r.eagerState,next:null}),l=r.hasEagerState?r.eagerState:e(l,r.action);else{var s={lane:i,action:r.action,hasEagerState:r.hasEagerState,eagerState:r.eagerState,next:null};a===null?(C=a=s,o=l):a=a.next=s,Re.lanes|=i,Sn|=i}r=r.next}while(r!==null&&r!==I);a===null?o=l:a.next=C,Zt(l,g.memoizedState)||(fg=!0),g.memoizedState=l,g.baseState=o,g.baseQueue=a,t.lastRenderedState=l}if(e=t.interleaved,e!==null){n=e;do I=n.lane,Re.lanes|=I,Sn|=I,n=n.next;while(n!==e)}else n===null&&(t.lanes=0);return[g.memoizedState,t.dispatch]}function Ds(e){var g=tt(),t=g.queue;if(t===null)throw Error(M(311));t.lastRenderedReducer=e;var l=t.dispatch,n=t.pending,I=g.memoizedState;if(n!==null){t.pending=null;var o=n=n.next;do I=e(I,o.action),o=o.next;while(o!==n);Zt(I,g.memoizedState)||(fg=!0),g.memoizedState=I,g.baseQueue===null&&(g.baseState=I),t.lastRenderedState=I}return[I,l]}function Pp(){}function Op(e,g){var t=Re,l=tt(),n=g(),I=!Zt(l.memoizedState,n);if(I&&(l.memoizedState=n,fg=!0),l=l.queue,eA(_p.bind(null,t,l,e),[e]),l.getSnapshot!==g||I||$e!==null&&$e.memoizedState.tag&1){if(t.flags|=2048,gC(9,qp.bind(null,t,l,n,g),void 0,null),qe===null)throw Error(M(349));fn&30||$p(t,g,n)}return n}function $p(e,g,t){e.flags|=16384,e={getSnapshot:g,value:t},g=Re.updateQueue,g===null?(g={lastEffect:null,stores:null},Re.updateQueue=g,g.stores=[e]):(t=g.stores,t===null?g.stores=[e]:t.push(e))}function qp(e,g,t,l){g.value=t,g.getSnapshot=l,eG(g)&&gG(e)}function _p(e,g,t){return t(function(){eG(g)&&gG(e)})}function eG(e){var g=e.getSnapshot;e=e.value;try{var t=g();return!Zt(e,t)}catch{return!0}}function gG(e){var g=qt(e,1);g!==null&&bt(g,e,1,-1)}function Sb(e){var g=ft();return typeof e=="function"&&(e=e()),g.memoizedState=g.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:eC,lastRenderedState:e},g.queue=e,e=e.dispatch=wR.bind(null,Re,e),[g.memoizedState,e]}function gC(e,g,t,l){return e={tag:e,create:g,destroy:t,deps:l,next:null},g=Re.updateQueue,g===null?(g={lastEffect:null,stores:null},Re.updateQueue=g,g.lastEffect=e.next=e):(t=g.lastEffect,t===null?g.lastEffect=e.next=e:(l=t.next,t.next=e,e.next=l,g.lastEffect=e)),e}function tG(){return tt().memoizedState}function Da(e,g,t,l){var n=ft();Re.flags|=e,n.memoizedState=gC(1|g,t,void 0,l===void 0?null:l)}function oi(e,g,t,l){var n=tt();l=l===void 0?null:l;var I=void 0;if(je!==null){var o=je.memoizedState;if(I=o.destroy,l!==null&&$u(l,o.deps)){n.memoizedState=gC(g,t,I,l);return}}Re.flags|=e,n.memoizedState=gC(1|g,t,I,l)}function Vb(e,g){return Da(8390656,8,e,g)}function eA(e,g){return oi(2048,8,e,g)}function lG(e,g){return oi(4,2,e,g)}function nG(e,g){return oi(4,4,e,g)}function IG(e,g){if(typeof g=="function")return e=e(),g(e),function(){g(null)};if(g!=null)return e=e(),g.current=e,function(){g.current=null}}function oG(e,g,t){return t=t!=null?t.concat([e]):null,oi(4,4,IG.bind(null,g,e),t)}function gA(){}function CG(e,g){var t=tt();g=g===void 0?null:g;var l=t.memoizedState;return l!==null&&g!==null&&$u(g,l[1])?l[0]:(t.memoizedState=[e,g],e)}function aG(e,g){var t=tt();g=g===void 0?null:g;var l=t.memoizedState;return l!==null&&g!==null&&$u(g,l[1])?l[0]:(e=e(),t.memoizedState=[e,g],e)}function rG(e,g,t){return fn&21?(Zt(t,g)||(t=cp(),Re.lanes|=t,Sn|=t,e.baseState=!0),g):(e.baseState&&(e.baseState=!1,fg=!0),e.memoizedState=t)}function JR(e,g){var t=ce;ce=t!==0&&4>t?t:4,e(!0);var l=xs.transition;xs.transition={};try{e(!1),g()}finally{ce=t,xs.transition=l}}function iG(){return tt().memoizedState}function YR(e,g,t){var l=wl(e);if(t={lane:l,action:t,hasEagerState:!1,eagerState:null,next:null},sG(e))cG(g,t);else if(t=Mp(e,g,t,l),t!==null){var n=bg();bt(t,e,l,n),dG(t,g,l)}}function wR(e,g,t){var l=wl(e),n={lane:l,action:t,hasEagerState:!1,eagerState:null,next:null};if(sG(e))cG(g,n);else{var I=e.alternate;if(e.lanes===0&&(I===null||I.lanes===0)&&(I=g.lastRenderedReducer,I!==null))try{var o=g.lastRenderedState,C=I(o,t);if(n.hasEagerState=!0,n.eagerState=C,Zt(C,o)){var a=g.interleaved;a===null?(n.next=n,Uu(g)):(n.next=a.next,a.next=n),g.interleaved=n;return}}catch{}finally{}t=Mp(e,g,n,l),t!==null&&(n=bg(),bt(t,e,l,n),dG(t,g,l))}}function sG(e){var g=e.alternate;return e===Re||g!==null&&g===Re}function cG(e,g){ko=Zr=!0;var t=e.pending;t===null?g.next=g:(g.next=t.next,t.next=g),e.pending=g}function dG(e,g,t){if(t&4194240){var l=g.lanes;l&=e.pendingLanes,t|=l,g.lanes=t,Ju(e,t)}}var hr={readContext:gt,useCallback:Cg,useContext:Cg,useEffect:Cg,useImperativeHandle:Cg,useInsertionEffect:Cg,useLayoutEffect:Cg,useMemo:Cg,useReducer:Cg,useRef:Cg,useState:Cg,useDebugValue:Cg,useDeferredValue:Cg,useTransition:Cg,useMutableSource:Cg,useSyncExternalStore:Cg,useId:Cg,unstable_isNewReconciler:!1},HR={readContext:gt,useCallback:function(e,g){return ft().memoizedState=[e,g===void 0?null:g],e},useContext:gt,useEffect:Vb,useImperativeHandle:function(e,g,t){return t=t!=null?t.concat([e]):null,Da(4194308,4,IG.bind(null,g,e),t)},useLayoutEffect:function(e,g){return Da(4194308,4,e,g)},useInsertionEffect:function(e,g){return Da(4,2,e,g)},useMemo:function(e,g){var t=ft();return g=g===void 0?null:g,e=e(),t.memoizedState=[e,g],e},useReducer:function(e,g,t){var l=ft();return g=t!==void 0?t(g):g,l.memoizedState=l.baseState=g,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:g},l.queue=e,e=e.dispatch=YR.bind(null,Re,e),[l.memoizedState,e]},useRef:function(e){var g=ft();return e={current:e},g.memoizedState=e},useState:Sb,useDebugValue:gA,useDeferredValue:function(e){return ft().memoizedState=e},useTransition:function(){var e=Sb(!1),g=e[0];return e=JR.bind(null,e[1]),ft().memoizedState=e,[g,e]},useMutableSource:function(){},useSyncExternalStore:function(e,g,t){var l=Re,n=ft();if(ye){if(t===void 0)throw Error(M(407));t=t()}else{if(t=g(),qe===null)throw Error(M(349));fn&30||$p(l,g,t)}n.memoizedState=t;var I={value:t,getSnapshot:g};return n.queue=I,Vb(_p.bind(null,l,I,e),[e]),l.flags|=2048,gC(9,qp.bind(null,l,I,t,g),void 0,null),t},useId:function(){var e=ft(),g=qe.identifierPrefix;if(ye){var t=Tt,l=zt;t=(l&~(1<<32-mt(l)-1)).toString(32)+t,g=":"+g+"R"+t,t=_o++,0<t&&(g+="H"+t.toString(32)),g+=":"}else t=kR++,g=":"+g+"r"+t.toString(32)+":";return e.memoizedState=g},unstable_isNewReconciler:!1},NR={readContext:gt,useCallback:CG,useContext:gt,useEffect:eA,useImperativeHandle:oG,useInsertionEffect:lG,useLayoutEffect:nG,useMemo:aG,useReducer:Es,useRef:tG,useState:function(){return Es(eC)},useDebugValue:gA,useDeferredValue:function(e){var g=tt();return rG(g,je.memoizedState,e)},useTransition:function(){var e=Es(eC)[0],g=tt().memoizedState;return[e,g]},useMutableSource:Pp,useSyncExternalStore:Op,useId:iG,unstable_isNewReconciler:!1},KR={readContext:gt,useCallback:CG,useContext:gt,useEffect:eA,useImperativeHandle:oG,useInsertionEffect:lG,useLayoutEffect:nG,useMemo:aG,useReducer:Ds,useRef:tG,useState:function(){return Ds(eC)},useDebugValue:gA,useDeferredValue:function(e){var g=tt();return je===null?g.memoizedState=e:rG(g,je.memoizedState,e)},useTransition:function(){var e=Ds(eC)[0],g=tt().memoizedState;return[e,g]},useMutableSource:Pp,useSyncExternalStore:Op,useId:iG,unstable_isNewReconciler:!1};function HI(e,g){try{var t="",l=g;do t+=sv(l),l=l.return;while(l);var n=t}catch(I){n=`
Error generating stack: `+I.message+`
`+I.stack}return{value:e,source:g,stack:n,digest:null}}function Ms(e,g,t){return{value:e,source:null,stack:t??null,digest:g??null}}function Cd(e,g){try{console.error(g.value)}catch(t){setTimeout(function(){throw t})}}var FR=typeof WeakMap=="function"?WeakMap:Map;function uG(e,g,t){t=Qt(-1,t),t.tag=3,t.payload={element:null};var l=g.value;return t.callback=function(){Gr||(Gr=!0,bd=l),Cd(e,g)},t}function AG(e,g,t){t=Qt(-1,t),t.tag=3;var l=e.type.getDerivedStateFromError;if(typeof l=="function"){var n=g.value;t.payload=function(){return l(n)},t.callback=function(){Cd(e,g)}}var I=e.stateNode;return I!==null&&typeof I.componentDidCatch=="function"&&(t.callback=function(){Cd(e,g),typeof l!="function"&&(Yl===null?Yl=new Set([this]):Yl.add(this));var o=g.stack;this.componentDidCatch(g.value,{componentStack:o!==null?o:""})}),t}function Wb(e,g,t){var l=e.pingCache;if(l===null){l=e.pingCache=new FR;var n=new Set;l.set(g,n)}else n=l.get(g),n===void 0&&(n=new Set,l.set(g,n));n.has(t)||(n.add(t),e=qR.bind(null,e,g,t),g.then(e,e))}function vb(e){do{var g;if((g=e.tag===13)&&(g=e.memoizedState,g=g!==null?g.dehydrated!==null:!0),g)return e;e=e.return}while(e!==null);return null}function Rb(e,g,t,l,n){return e.mode&1?(e.flags|=65536,e.lanes=n,e):(e===g?e.flags|=65536:(e.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(g=Qt(-1,1),g.tag=2,Jl(t,g,1))),t.lanes|=1),e)}var xR=ll.ReactCurrentOwner,fg=!1;function Ag(e,g,t,l){g.child=e===null?Qp(g,null,t,l):YI(g,e.child,t,l)}function Xb(e,g,t,l,n){t=t.render;var I=g.ref;return WI(g,n),l=qu(e,g,t,l,I,n),t=_u(),e!==null&&!fg?(g.updateQueue=e.updateQueue,g.flags&=-2053,e.lanes&=~n,_t(e,g,n)):(ye&&t&&Eu(g),g.flags|=1,Ag(e,g,l,n),g.child)}function kb(e,g,t,l,n){if(e===null){var I=t.type;return typeof I=="function"&&!rA(I)&&I.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(g.tag=15,g.type=I,mG(e,g,I,l,n)):(e=La(t.type,null,l,g,g.mode,n),e.ref=g.ref,e.return=g,g.child=e)}if(I=e.child,!(e.lanes&n)){var o=I.memoizedProps;if(t=t.compare,t=t!==null?t:Qo,t(o,l)&&e.ref===g.ref)return _t(e,g,n)}return g.flags|=1,e=Hl(I,l),e.ref=g.ref,e.return=g,g.child=e}function mG(e,g,t,l,n){if(e!==null){var I=e.memoizedProps;if(Qo(I,l)&&e.ref===g.ref)if(fg=!1,g.pendingProps=l=I,(e.lanes&n)!==0)e.flags&131072&&(fg=!0);else return g.lanes=e.lanes,_t(e,g,n)}return ad(e,g,t,l,n)}function bG(e,g,t){var l=g.pendingProps,n=l.children,I=e!==null?e.memoizedState:null;if(l.mode==="hidden")if(!(g.mode&1))g.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ae(sI,Xg),Xg|=t;else{if(!(t&1073741824))return e=I!==null?I.baseLanes|t:t,g.lanes=g.childLanes=1073741824,g.memoizedState={baseLanes:e,cachePool:null,transitions:null},g.updateQueue=null,Ae(sI,Xg),Xg|=e,null;g.memoizedState={baseLanes:0,cachePool:null,transitions:null},l=I!==null?I.baseLanes:t,Ae(sI,Xg),Xg|=l}else I!==null?(l=I.baseLanes|t,g.memoizedState=null):l=t,Ae(sI,Xg),Xg|=l;return Ag(e,g,n,t),g.child}function ZG(e,g){var t=g.ref;(e===null&&t!==null||e!==null&&e.ref!==t)&&(g.flags|=512,g.flags|=2097152)}function ad(e,g,t,l,n){var I=Vg(t)?yn:dg.current;return I=kI(g,I),WI(g,n),t=qu(e,g,t,l,I,n),l=_u(),e!==null&&!fg?(g.updateQueue=e.updateQueue,g.flags&=-2053,e.lanes&=~n,_t(e,g,n)):(ye&&l&&Eu(g),g.flags|=1,Ag(e,g,t,n),g.child)}function Jb(e,g,t,l,n){if(Vg(t)){var I=!0;sr(g)}else I=!1;if(WI(g,n),g.stateNode===null)Ma(e,g),Lp(g,t,l),od(g,t,l,n),l=!0;else if(e===null){var o=g.stateNode,C=g.memoizedProps;o.props=C;var a=o.context,r=t.contextType;typeof r=="object"&&r!==null?r=gt(r):(r=Vg(t)?yn:dg.current,r=kI(g,r));var i=t.getDerivedStateFromProps,s=typeof i=="function"||typeof o.getSnapshotBeforeUpdate=="function";s||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(C!==l||a!==r)&&Bb(g,o,l,r),Al=!1;var c=g.memoizedState;o.state=c,mr(g,l,o,n),a=g.memoizedState,C!==l||c!==a||Sg.current||Al?(typeof i=="function"&&(Id(g,t,i,l),a=g.memoizedState),(C=Al||yb(g,t,C,l,c,a,r))?(s||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(g.flags|=4194308)):(typeof o.componentDidMount=="function"&&(g.flags|=4194308),g.memoizedProps=l,g.memoizedState=a),o.props=l,o.state=a,o.context=r,l=C):(typeof o.componentDidMount=="function"&&(g.flags|=4194308),l=!1)}else{o=g.stateNode,zp(e,g),C=g.memoizedProps,r=g.type===g.elementType?C:st(g.type,C),o.props=r,s=g.pendingProps,c=o.context,a=t.contextType,typeof a=="object"&&a!==null?a=gt(a):(a=Vg(t)?yn:dg.current,a=kI(g,a));var d=t.getDerivedStateFromProps;(i=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(C!==s||c!==a)&&Bb(g,o,l,a),Al=!1,c=g.memoizedState,o.state=c,mr(g,l,o,n);var Z=g.memoizedState;C!==s||c!==Z||Sg.current||Al?(typeof d=="function"&&(Id(g,t,d,l),Z=g.memoizedState),(r=Al||yb(g,t,r,l,c,Z,a)||!1)?(i||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(l,Z,a),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(l,Z,a)),typeof o.componentDidUpdate=="function"&&(g.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(g.flags|=1024)):(typeof o.componentDidUpdate!="function"||C===e.memoizedProps&&c===e.memoizedState||(g.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||C===e.memoizedProps&&c===e.memoizedState||(g.flags|=1024),g.memoizedProps=l,g.memoizedState=Z),o.props=l,o.state=Z,o.context=a,l=r):(typeof o.componentDidUpdate!="function"||C===e.memoizedProps&&c===e.memoizedState||(g.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||C===e.memoizedProps&&c===e.memoizedState||(g.flags|=1024),l=!1)}return rd(e,g,t,l,I,n)}function rd(e,g,t,l,n,I){ZG(e,g);var o=(g.flags&128)!==0;if(!l&&!o)return n&&bb(g,t,!1),_t(e,g,I);l=g.stateNode,xR.current=g;var C=o&&typeof t.getDerivedStateFromError!="function"?null:l.render();return g.flags|=1,e!==null&&o?(g.child=YI(g,e.child,null,I),g.child=YI(g,null,C,I)):Ag(e,g,C,I),g.memoizedState=l.state,n&&bb(g,t,!0),g.child}function hG(e){var g=e.stateNode;g.pendingContext?mb(e,g.pendingContext,g.pendingContext!==g.context):g.context&&mb(e,g.context,!1),ju(e,g.containerInfo)}function Yb(e,g,t,l,n){return JI(),Mu(n),g.flags|=256,Ag(e,g,t,l),g.child}var id={dehydrated:null,treeContext:null,retryLane:0};function sd(e){return{baseLanes:e,cachePool:null,transitions:null}}function pG(e,g,t){var l=g.pendingProps,n=We.current,I=!1,o=(g.flags&128)!==0,C;if((C=o)||(C=e!==null&&e.memoizedState===null?!1:(n&2)!==0),C?(I=!0,g.flags&=-129):(e===null||e.memoizedState!==null)&&(n|=1),Ae(We,n&1),e===null)return ld(g),e=g.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(g.mode&1?e.data==="$!"?g.lanes=8:g.lanes=1073741824:g.lanes=1,null):(o=l.children,e=l.fallback,I?(l=g.mode,I=g.child,o={mode:"hidden",children:o},!(l&1)&&I!==null?(I.childLanes=0,I.pendingProps=o):I=ri(o,l,0,null),e=bn(e,l,t,null),I.return=g,e.return=g,I.sibling=e,g.child=I,g.child.memoizedState=sd(t),g.memoizedState=id,e):tA(g,o));if(n=e.memoizedState,n!==null&&(C=n.dehydrated,C!==null))return ER(e,g,o,l,C,n,t);if(I){I=l.fallback,o=g.mode,n=e.child,C=n.sibling;var a={mode:"hidden",children:l.children};return!(o&1)&&g.child!==n?(l=g.child,l.childLanes=0,l.pendingProps=a,g.deletions=null):(l=Hl(n,a),l.subtreeFlags=n.subtreeFlags&14680064),C!==null?I=Hl(C,I):(I=bn(I,o,t,null),I.flags|=2),I.return=g,l.return=g,l.sibling=I,g.child=l,l=I,I=g.child,o=e.child.memoizedState,o=o===null?sd(t):{baseLanes:o.baseLanes|t,cachePool:null,transitions:o.transitions},I.memoizedState=o,I.childLanes=e.childLanes&~t,g.memoizedState=id,l}return I=e.child,e=I.sibling,l=Hl(I,{mode:"visible",children:l.children}),!(g.mode&1)&&(l.lanes=t),l.return=g,l.sibling=null,e!==null&&(t=g.deletions,t===null?(g.deletions=[e],g.flags|=16):t.push(e)),g.child=l,g.memoizedState=null,l}function tA(e,g){return g=ri({mode:"visible",children:g},e.mode,0,null),g.return=e,e.child=g}function oa(e,g,t,l){return l!==null&&Mu(l),YI(g,e.child,null,t),e=tA(g,g.pendingProps.children),e.flags|=2,g.memoizedState=null,e}function ER(e,g,t,l,n,I,o){if(t)return g.flags&256?(g.flags&=-257,l=Ms(Error(M(422))),oa(e,g,o,l)):g.memoizedState!==null?(g.child=e.child,g.flags|=128,null):(I=l.fallback,n=g.mode,l=ri({mode:"visible",children:l.children},n,0,null),I=bn(I,n,o,null),I.flags|=2,l.return=g,I.return=g,l.sibling=I,g.child=l,g.mode&1&&YI(g,e.child,null,o),g.child.memoizedState=sd(o),g.memoizedState=id,I);if(!(g.mode&1))return oa(e,g,o,null);if(n.data==="$!"){if(l=n.nextSibling&&n.nextSibling.dataset,l)var C=l.dgst;return l=C,I=Error(M(419)),l=Ms(I,l,void 0),oa(e,g,o,l)}if(C=(o&e.childLanes)!==0,fg||C){if(l=qe,l!==null){switch(o&-o){case 4:n=2;break;case 16:n=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:n=32;break;case 536870912:n=268435456;break;default:n=0}n=n&(l.suspendedLanes|o)?0:n,n!==0&&n!==I.retryLane&&(I.retryLane=n,qt(e,n),bt(l,e,n,-1))}return aA(),l=Ms(Error(M(421))),oa(e,g,o,l)}return n.data==="$?"?(g.flags|=128,g.child=e.child,g=_R.bind(null,e),n._reactRetry=g,null):(e=I.treeContext,Jg=kl(n.nextSibling),wg=g,ye=!0,ut=null,e!==null&&(Qg[jg++]=zt,Qg[jg++]=Tt,Qg[jg++]=Bn,zt=e.id,Tt=e.overflow,Bn=g),g=tA(g,l.children),g.flags|=4096,g)}function wb(e,g,t){e.lanes|=g;var l=e.alternate;l!==null&&(l.lanes|=g),nd(e.return,g,t)}function zs(e,g,t,l,n){var I=e.memoizedState;I===null?e.memoizedState={isBackwards:g,rendering:null,renderingStartTime:0,last:l,tail:t,tailMode:n}:(I.isBackwards=g,I.rendering=null,I.renderingStartTime=0,I.last=l,I.tail=t,I.tailMode=n)}function GG(e,g,t){var l=g.pendingProps,n=l.revealOrder,I=l.tail;if(Ag(e,g,l.children,t),l=We.current,l&2)l=l&1|2,g.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=g.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&wb(e,t,g);else if(e.tag===19)wb(e,t,g);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===g)break e;for(;e.sibling===null;){if(e.return===null||e.return===g)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}l&=1}if(Ae(We,l),!(g.mode&1))g.memoizedState=null;else switch(n){case"forwards":for(t=g.child,n=null;t!==null;)e=t.alternate,e!==null&&br(e)===null&&(n=t),t=t.sibling;t=n,t===null?(n=g.child,g.child=null):(n=t.sibling,t.sibling=null),zs(g,!1,n,t,I);break;case"backwards":for(t=null,n=g.child,g.child=null;n!==null;){if(e=n.alternate,e!==null&&br(e)===null){g.child=n;break}e=n.sibling,n.sibling=t,t=n,n=e}zs(g,!0,t,null,I);break;case"together":zs(g,!1,null,null,void 0);break;default:g.memoizedState=null}return g.child}function Ma(e,g){!(g.mode&1)&&e!==null&&(e.alternate=null,g.alternate=null,g.flags|=2)}function _t(e,g,t){if(e!==null&&(g.dependencies=e.dependencies),Sn|=g.lanes,!(t&g.childLanes))return null;if(e!==null&&g.child!==e.child)throw Error(M(153));if(g.child!==null){for(e=g.child,t=Hl(e,e.pendingProps),g.child=t,t.return=g;e.sibling!==null;)e=e.sibling,t=t.sibling=Hl(e,e.pendingProps),t.return=g;t.sibling=null}return g.child}function DR(e,g,t){switch(g.tag){case 3:hG(g),JI();break;case 5:jp(g);break;case 1:Vg(g.type)&&sr(g);break;case 4:ju(g,g.stateNode.containerInfo);break;case 10:var l=g.type._context,n=g.memoizedProps.value;Ae(ur,l._currentValue),l._currentValue=n;break;case 13:if(l=g.memoizedState,l!==null)return l.dehydrated!==null?(Ae(We,We.current&1),g.flags|=128,null):t&g.child.childLanes?pG(e,g,t):(Ae(We,We.current&1),e=_t(e,g,t),e!==null?e.sibling:null);Ae(We,We.current&1);break;case 19:if(l=(t&g.childLanes)!==0,e.flags&128){if(l)return GG(e,g,t);g.flags|=128}if(n=g.memoizedState,n!==null&&(n.rendering=null,n.tail=null,n.lastEffect=null),Ae(We,We.current),l)break;return null;case 22:case 23:return g.lanes=0,bG(e,g,t)}return _t(e,g,t)}var yG,cd,BG,fG;yG=function(e,g){for(var t=g.child;t!==null;){if(t.tag===5||t.tag===6)e.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===g)break;for(;t.sibling===null;){if(t.return===null||t.return===g)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};cd=function(){};BG=function(e,g,t,l){var n=e.memoizedProps;if(n!==l){e=g.stateNode,cn(Rt.current);var I=null;switch(t){case"input":n=wc(e,n),l=wc(e,l),I=[];break;case"select":n=Xe({},n,{value:void 0}),l=Xe({},l,{value:void 0}),I=[];break;case"textarea":n=Kc(e,n),l=Kc(e,l),I=[];break;default:typeof n.onClick!="function"&&typeof l.onClick=="function"&&(e.onclick=rr)}xc(t,l);var o;t=null;for(r in n)if(!l.hasOwnProperty(r)&&n.hasOwnProperty(r)&&n[r]!=null)if(r==="style"){var C=n[r];for(o in C)C.hasOwnProperty(o)&&(t||(t={}),t[o]="")}else r!=="dangerouslySetInnerHTML"&&r!=="children"&&r!=="suppressContentEditableWarning"&&r!=="suppressHydrationWarning"&&r!=="autoFocus"&&(Eo.hasOwnProperty(r)?I||(I=[]):(I=I||[]).push(r,null));for(r in l){var a=l[r];if(C=n!=null?n[r]:void 0,l.hasOwnProperty(r)&&a!==C&&(a!=null||C!=null))if(r==="style")if(C){for(o in C)!C.hasOwnProperty(o)||a&&a.hasOwnProperty(o)||(t||(t={}),t[o]="");for(o in a)a.hasOwnProperty(o)&&C[o]!==a[o]&&(t||(t={}),t[o]=a[o])}else t||(I||(I=[]),I.push(r,t)),t=a;else r==="dangerouslySetInnerHTML"?(a=a?a.__html:void 0,C=C?C.__html:void 0,a!=null&&C!==a&&(I=I||[]).push(r,a)):r==="children"?typeof a!="string"&&typeof a!="number"||(I=I||[]).push(r,""+a):r!=="suppressContentEditableWarning"&&r!=="suppressHydrationWarning"&&(Eo.hasOwnProperty(r)?(a!=null&&r==="onScroll"&&Ze("scroll",e),I||C===a||(I=[])):(I=I||[]).push(r,a))}t&&(I=I||[]).push("style",t);var r=I;(g.updateQueue=r)&&(g.flags|=4)}};fG=function(e,g,t,l){t!==l&&(g.flags|=4)};function oo(e,g){if(!ye)switch(e.tailMode){case"hidden":g=e.tail;for(var t=null;g!==null;)g.alternate!==null&&(t=g),g=g.sibling;t===null?e.tail=null:t.sibling=null;break;case"collapsed":t=e.tail;for(var l=null;t!==null;)t.alternate!==null&&(l=t),t=t.sibling;l===null?g||e.tail===null?e.tail=null:e.tail.sibling=null:l.sibling=null}}function ag(e){var g=e.alternate!==null&&e.alternate.child===e.child,t=0,l=0;if(g)for(var n=e.child;n!==null;)t|=n.lanes|n.childLanes,l|=n.subtreeFlags&14680064,l|=n.flags&14680064,n.return=e,n=n.sibling;else for(n=e.child;n!==null;)t|=n.lanes|n.childLanes,l|=n.subtreeFlags,l|=n.flags,n.return=e,n=n.sibling;return e.subtreeFlags|=l,e.childLanes=t,g}function MR(e,g,t){var l=g.pendingProps;switch(Du(g),g.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ag(g),null;case 1:return Vg(g.type)&&ir(),ag(g),null;case 3:return l=g.stateNode,wI(),pe(Sg),pe(dg),Ou(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(e===null||e.child===null)&&(na(g)?g.flags|=4:e===null||e.memoizedState.isDehydrated&&!(g.flags&256)||(g.flags|=1024,ut!==null&&(pd(ut),ut=null))),cd(e,g),ag(g),null;case 5:Pu(g);var n=cn(qo.current);if(t=g.type,e!==null&&g.stateNode!=null)BG(e,g,t,l,n),e.ref!==g.ref&&(g.flags|=512,g.flags|=2097152);else{if(!l){if(g.stateNode===null)throw Error(M(166));return ag(g),null}if(e=cn(Rt.current),na(g)){l=g.stateNode,t=g.type;var I=g.memoizedProps;switch(l[St]=g,l[Oo]=I,e=(g.mode&1)!==0,t){case"dialog":Ze("cancel",l),Ze("close",l);break;case"iframe":case"object":case"embed":Ze("load",l);break;case"video":case"audio":for(n=0;n<ho.length;n++)Ze(ho[n],l);break;case"source":Ze("error",l);break;case"img":case"image":case"link":Ze("error",l),Ze("load",l);break;case"details":Ze("toggle",l);break;case"input":zm(l,I),Ze("invalid",l);break;case"select":l._wrapperState={wasMultiple:!!I.multiple},Ze("invalid",l);break;case"textarea":Lm(l,I),Ze("invalid",l)}xc(t,I),n=null;for(var o in I)if(I.hasOwnProperty(o)){var C=I[o];o==="children"?typeof C=="string"?l.textContent!==C&&(I.suppressHydrationWarning!==!0&&la(l.textContent,C,e),n=["children",C]):typeof C=="number"&&l.textContent!==""+C&&(I.suppressHydrationWarning!==!0&&la(l.textContent,C,e),n=["children",""+C]):Eo.hasOwnProperty(o)&&C!=null&&o==="onScroll"&&Ze("scroll",l)}switch(t){case"input":PC(l),Tm(l,I,!0);break;case"textarea":PC(l),Um(l);break;case"select":case"option":break;default:typeof I.onClick=="function"&&(l.onclick=rr)}l=n,g.updateQueue=l,l!==null&&(g.flags|=4)}else{o=n.nodeType===9?n:n.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=$h(t)),e==="http://www.w3.org/1999/xhtml"?t==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof l.is=="string"?e=o.createElement(t,{is:l.is}):(e=o.createElement(t),t==="select"&&(o=e,l.multiple?o.multiple=!0:l.size&&(o.size=l.size))):e=o.createElementNS(e,t),e[St]=g,e[Oo]=l,yG(e,g,!1,!1),g.stateNode=e;e:{switch(o=Ec(t,l),t){case"dialog":Ze("cancel",e),Ze("close",e),n=l;break;case"iframe":case"object":case"embed":Ze("load",e),n=l;break;case"video":case"audio":for(n=0;n<ho.length;n++)Ze(ho[n],e);n=l;break;case"source":Ze("error",e),n=l;break;case"img":case"image":case"link":Ze("error",e),Ze("load",e),n=l;break;case"details":Ze("toggle",e),n=l;break;case"input":zm(e,l),n=wc(e,l),Ze("invalid",e);break;case"option":n=l;break;case"select":e._wrapperState={wasMultiple:!!l.multiple},n=Xe({},l,{value:void 0}),Ze("invalid",e);break;case"textarea":Lm(e,l),n=Kc(e,l),Ze("invalid",e);break;default:n=l}xc(t,n),C=n;for(I in C)if(C.hasOwnProperty(I)){var a=C[I];I==="style"?ep(e,a):I==="dangerouslySetInnerHTML"?(a=a?a.__html:void 0,a!=null&&qh(e,a)):I==="children"?typeof a=="string"?(t!=="textarea"||a!=="")&&Do(e,a):typeof a=="number"&&Do(e,""+a):I!=="suppressContentEditableWarning"&&I!=="suppressHydrationWarning"&&I!=="autoFocus"&&(Eo.hasOwnProperty(I)?a!=null&&I==="onScroll"&&Ze("scroll",e):a!=null&&Vu(e,I,a,o))}switch(t){case"input":PC(e),Tm(e,l,!1);break;case"textarea":PC(e),Um(e);break;case"option":l.value!=null&&e.setAttribute("value",""+Fl(l.value));break;case"select":e.multiple=!!l.multiple,I=l.value,I!=null?BI(e,!!l.multiple,I,!1):l.defaultValue!=null&&BI(e,!!l.multiple,l.defaultValue,!0);break;default:typeof n.onClick=="function"&&(e.onclick=rr)}switch(t){case"button":case"input":case"select":case"textarea":l=!!l.autoFocus;break e;case"img":l=!0;break e;default:l=!1}}l&&(g.flags|=4)}g.ref!==null&&(g.flags|=512,g.flags|=2097152)}return ag(g),null;case 6:if(e&&g.stateNode!=null)fG(e,g,e.memoizedProps,l);else{if(typeof l!="string"&&g.stateNode===null)throw Error(M(166));if(t=cn(qo.current),cn(Rt.current),na(g)){if(l=g.stateNode,t=g.memoizedProps,l[St]=g,(I=l.nodeValue!==t)&&(e=wg,e!==null))switch(e.tag){case 3:la(l.nodeValue,t,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&la(l.nodeValue,t,(e.mode&1)!==0)}I&&(g.flags|=4)}else l=(t.nodeType===9?t:t.ownerDocument).createTextNode(l),l[St]=g,g.stateNode=l}return ag(g),null;case 13:if(pe(We),l=g.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(ye&&Jg!==null&&g.mode&1&&!(g.flags&128))Dp(),JI(),g.flags|=98560,I=!1;else if(I=na(g),l!==null&&l.dehydrated!==null){if(e===null){if(!I)throw Error(M(318));if(I=g.memoizedState,I=I!==null?I.dehydrated:null,!I)throw Error(M(317));I[St]=g}else JI(),!(g.flags&128)&&(g.memoizedState=null),g.flags|=4;ag(g),I=!1}else ut!==null&&(pd(ut),ut=null),I=!0;if(!I)return g.flags&65536?g:null}return g.flags&128?(g.lanes=t,g):(l=l!==null,l!==(e!==null&&e.memoizedState!==null)&&l&&(g.child.flags|=8192,g.mode&1&&(e===null||We.current&1?Pe===0&&(Pe=3):aA())),g.updateQueue!==null&&(g.flags|=4),ag(g),null);case 4:return wI(),cd(e,g),e===null&&jo(g.stateNode.containerInfo),ag(g),null;case 10:return Lu(g.type._context),ag(g),null;case 17:return Vg(g.type)&&ir(),ag(g),null;case 19:if(pe(We),I=g.memoizedState,I===null)return ag(g),null;if(l=(g.flags&128)!==0,o=I.rendering,o===null)if(l)oo(I,!1);else{if(Pe!==0||e!==null&&e.flags&128)for(e=g.child;e!==null;){if(o=br(e),o!==null){for(g.flags|=128,oo(I,!1),l=o.updateQueue,l!==null&&(g.updateQueue=l,g.flags|=4),g.subtreeFlags=0,l=t,t=g.child;t!==null;)I=t,e=l,I.flags&=14680066,o=I.alternate,o===null?(I.childLanes=0,I.lanes=e,I.child=null,I.subtreeFlags=0,I.memoizedProps=null,I.memoizedState=null,I.updateQueue=null,I.dependencies=null,I.stateNode=null):(I.childLanes=o.childLanes,I.lanes=o.lanes,I.child=o.child,I.subtreeFlags=0,I.deletions=null,I.memoizedProps=o.memoizedProps,I.memoizedState=o.memoizedState,I.updateQueue=o.updateQueue,I.type=o.type,e=o.dependencies,I.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),t=t.sibling;return Ae(We,We.current&1|2),g.child}e=e.sibling}I.tail!==null&&Ke()>NI&&(g.flags|=128,l=!0,oo(I,!1),g.lanes=4194304)}else{if(!l)if(e=br(o),e!==null){if(g.flags|=128,l=!0,t=e.updateQueue,t!==null&&(g.updateQueue=t,g.flags|=4),oo(I,!0),I.tail===null&&I.tailMode==="hidden"&&!o.alternate&&!ye)return ag(g),null}else 2*Ke()-I.renderingStartTime>NI&&t!==1073741824&&(g.flags|=128,l=!0,oo(I,!1),g.lanes=4194304);I.isBackwards?(o.sibling=g.child,g.child=o):(t=I.last,t!==null?t.sibling=o:g.child=o,I.last=o)}return I.tail!==null?(g=I.tail,I.rendering=g,I.tail=g.sibling,I.renderingStartTime=Ke(),g.sibling=null,t=We.current,Ae(We,l?t&1|2:t&1),g):(ag(g),null);case 22:case 23:return CA(),l=g.memoizedState!==null,e!==null&&e.memoizedState!==null!==l&&(g.flags|=8192),l&&g.mode&1?Xg&1073741824&&(ag(g),g.subtreeFlags&6&&(g.flags|=8192)):ag(g),null;case 24:return null;case 25:return null}throw Error(M(156,g.tag))}function zR(e,g){switch(Du(g),g.tag){case 1:return Vg(g.type)&&ir(),e=g.flags,e&65536?(g.flags=e&-65537|128,g):null;case 3:return wI(),pe(Sg),pe(dg),Ou(),e=g.flags,e&65536&&!(e&128)?(g.flags=e&-65537|128,g):null;case 5:return Pu(g),null;case 13:if(pe(We),e=g.memoizedState,e!==null&&e.dehydrated!==null){if(g.alternate===null)throw Error(M(340));JI()}return e=g.flags,e&65536?(g.flags=e&-65537|128,g):null;case 19:return pe(We),null;case 4:return wI(),null;case 10:return Lu(g.type._context),null;case 22:case 23:return CA(),null;case 24:return null;default:return null}}var Ca=!1,sg=!1,TR=typeof WeakSet=="function"?WeakSet:Set,L=null;function iI(e,g){var t=e.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(l){He(e,g,l)}else t.current=null}function dd(e,g,t){try{t()}catch(l){He(e,g,l)}}var Hb=!1;function LR(e,g){if(Oc=or,e=vp(),xu(e)){if("selectionStart"in e)var t={start:e.selectionStart,end:e.selectionEnd};else e:{t=(t=e.ownerDocument)&&t.defaultView||window;var l=t.getSelection&&t.getSelection();if(l&&l.rangeCount!==0){t=l.anchorNode;var n=l.anchorOffset,I=l.focusNode;l=l.focusOffset;try{t.nodeType,I.nodeType}catch{t=null;break e}var o=0,C=-1,a=-1,r=0,i=0,s=e,c=null;g:for(;;){for(var d;s!==t||n!==0&&s.nodeType!==3||(C=o+n),s!==I||l!==0&&s.nodeType!==3||(a=o+l),s.nodeType===3&&(o+=s.nodeValue.length),(d=s.firstChild)!==null;)c=s,s=d;for(;;){if(s===e)break g;if(c===t&&++r===n&&(C=o),c===I&&++i===l&&(a=o),(d=s.nextSibling)!==null)break;s=c,c=s.parentNode}s=d}t=C===-1||a===-1?null:{start:C,end:a}}else t=null}t=t||{start:0,end:0}}else t=null;for($c={focusedElem:e,selectionRange:t},or=!1,L=g;L!==null;)if(g=L,e=g.child,(g.subtreeFlags&1028)!==0&&e!==null)e.return=g,L=e;else for(;L!==null;){g=L;try{var Z=g.alternate;if(g.flags&1024)switch(g.tag){case 0:case 11:case 15:break;case 1:if(Z!==null){var G=Z.memoizedProps,y=Z.memoizedState,p=g.stateNode,h=p.getSnapshotBeforeUpdate(g.elementType===g.type?G:st(g.type,G),y);p.__reactInternalSnapshotBeforeUpdate=h}break;case 3:var b=g.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(M(163))}}catch(B){He(g,g.return,B)}if(e=g.sibling,e!==null){e.return=g.return,L=e;break}L=g.return}return Z=Hb,Hb=!1,Z}function Jo(e,g,t){var l=g.updateQueue;if(l=l!==null?l.lastEffect:null,l!==null){var n=l=l.next;do{if((n.tag&e)===e){var I=n.destroy;n.destroy=void 0,I!==void 0&&dd(g,t,I)}n=n.next}while(n!==l)}}function Ci(e,g){if(g=g.updateQueue,g=g!==null?g.lastEffect:null,g!==null){var t=g=g.next;do{if((t.tag&e)===e){var l=t.create;t.destroy=l()}t=t.next}while(t!==g)}}function ud(e){var g=e.ref;if(g!==null){var t=e.stateNode;switch(e.tag){case 5:e=t;break;default:e=t}typeof g=="function"?g(e):g.current=e}}function SG(e){var g=e.alternate;g!==null&&(e.alternate=null,SG(g)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(g=e.stateNode,g!==null&&(delete g[St],delete g[Oo],delete g[ed],delete g[WR],delete g[vR])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function VG(e){return e.tag===5||e.tag===3||e.tag===4}function Nb(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||VG(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Ad(e,g,t){var l=e.tag;if(l===5||l===6)e=e.stateNode,g?t.nodeType===8?t.parentNode.insertBefore(e,g):t.insertBefore(e,g):(t.nodeType===8?(g=t.parentNode,g.insertBefore(e,t)):(g=t,g.appendChild(e)),t=t._reactRootContainer,t!=null||g.onclick!==null||(g.onclick=rr));else if(l!==4&&(e=e.child,e!==null))for(Ad(e,g,t),e=e.sibling;e!==null;)Ad(e,g,t),e=e.sibling}function md(e,g,t){var l=e.tag;if(l===5||l===6)e=e.stateNode,g?t.insertBefore(e,g):t.appendChild(e);else if(l!==4&&(e=e.child,e!==null))for(md(e,g,t),e=e.sibling;e!==null;)md(e,g,t),e=e.sibling}var tg=null,ct=!1;function rl(e,g,t){for(t=t.child;t!==null;)WG(e,g,t),t=t.sibling}function WG(e,g,t){if(vt&&typeof vt.onCommitFiberUnmount=="function")try{vt.onCommitFiberUnmount(_r,t)}catch{}switch(t.tag){case 5:sg||iI(t,g);case 6:var l=tg,n=ct;tg=null,rl(e,g,t),tg=l,ct=n,tg!==null&&(ct?(e=tg,t=t.stateNode,e.nodeType===8?e.parentNode.removeChild(t):e.removeChild(t)):tg.removeChild(t.stateNode));break;case 18:tg!==null&&(ct?(e=tg,t=t.stateNode,e.nodeType===8?Ns(e.parentNode,t):e.nodeType===1&&Ns(e,t),Lo(e)):Ns(tg,t.stateNode));break;case 4:l=tg,n=ct,tg=t.stateNode.containerInfo,ct=!0,rl(e,g,t),tg=l,ct=n;break;case 0:case 11:case 14:case 15:if(!sg&&(l=t.updateQueue,l!==null&&(l=l.lastEffect,l!==null))){n=l=l.next;do{var I=n,o=I.destroy;I=I.tag,o!==void 0&&(I&2||I&4)&&dd(t,g,o),n=n.next}while(n!==l)}rl(e,g,t);break;case 1:if(!sg&&(iI(t,g),l=t.stateNode,typeof l.componentWillUnmount=="function"))try{l.props=t.memoizedProps,l.state=t.memoizedState,l.componentWillUnmount()}catch(C){He(t,g,C)}rl(e,g,t);break;case 21:rl(e,g,t);break;case 22:t.mode&1?(sg=(l=sg)||t.memoizedState!==null,rl(e,g,t),sg=l):rl(e,g,t);break;default:rl(e,g,t)}}function Kb(e){var g=e.updateQueue;if(g!==null){e.updateQueue=null;var t=e.stateNode;t===null&&(t=e.stateNode=new TR),g.forEach(function(l){var n=eX.bind(null,e,l);t.has(l)||(t.add(l),l.then(n,n))})}}function at(e,g){var t=g.deletions;if(t!==null)for(var l=0;l<t.length;l++){var n=t[l];try{var I=e,o=g,C=o;e:for(;C!==null;){switch(C.tag){case 5:tg=C.stateNode,ct=!1;break e;case 3:tg=C.stateNode.containerInfo,ct=!0;break e;case 4:tg=C.stateNode.containerInfo,ct=!0;break e}C=C.return}if(tg===null)throw Error(M(160));WG(I,o,n),tg=null,ct=!1;var a=n.alternate;a!==null&&(a.return=null),n.return=null}catch(r){He(n,g,r)}}if(g.subtreeFlags&12854)for(g=g.child;g!==null;)vG(g,e),g=g.sibling}function vG(e,g){var t=e.alternate,l=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(at(g,e),yt(e),l&4){try{Jo(3,e,e.return),Ci(3,e)}catch(G){He(e,e.return,G)}try{Jo(5,e,e.return)}catch(G){He(e,e.return,G)}}break;case 1:at(g,e),yt(e),l&512&&t!==null&&iI(t,t.return);break;case 5:if(at(g,e),yt(e),l&512&&t!==null&&iI(t,t.return),e.flags&32){var n=e.stateNode;try{Do(n,"")}catch(G){He(e,e.return,G)}}if(l&4&&(n=e.stateNode,n!=null)){var I=e.memoizedProps,o=t!==null?t.memoizedProps:I,C=e.type,a=e.updateQueue;if(e.updateQueue=null,a!==null)try{C==="input"&&I.type==="radio"&&I.name!=null&&Ph(n,I),Ec(C,o);var r=Ec(C,I);for(o=0;o<a.length;o+=2){var i=a[o],s=a[o+1];i==="style"?ep(n,s):i==="dangerouslySetInnerHTML"?qh(n,s):i==="children"?Do(n,s):Vu(n,i,s,r)}switch(C){case"input":Hc(n,I);break;case"textarea":Oh(n,I);break;case"select":var c=n._wrapperState.wasMultiple;n._wrapperState.wasMultiple=!!I.multiple;var d=I.value;d!=null?BI(n,!!I.multiple,d,!1):c!==!!I.multiple&&(I.defaultValue!=null?BI(n,!!I.multiple,I.defaultValue,!0):BI(n,!!I.multiple,I.multiple?[]:"",!1))}n[Oo]=I}catch(G){He(e,e.return,G)}}break;case 6:if(at(g,e),yt(e),l&4){if(e.stateNode===null)throw Error(M(162));n=e.stateNode,I=e.memoizedProps;try{n.nodeValue=I}catch(G){He(e,e.return,G)}}break;case 3:if(at(g,e),yt(e),l&4&&t!==null&&t.memoizedState.isDehydrated)try{Lo(g.containerInfo)}catch(G){He(e,e.return,G)}break;case 4:at(g,e),yt(e);break;case 13:at(g,e),yt(e),n=e.child,n.flags&8192&&(I=n.memoizedState!==null,n.stateNode.isHidden=I,!I||n.alternate!==null&&n.alternate.memoizedState!==null||(IA=Ke())),l&4&&Kb(e);break;case 22:if(i=t!==null&&t.memoizedState!==null,e.mode&1?(sg=(r=sg)||i,at(g,e),sg=r):at(g,e),yt(e),l&8192){if(r=e.memoizedState!==null,(e.stateNode.isHidden=r)&&!i&&e.mode&1)for(L=e,i=e.child;i!==null;){for(s=L=i;L!==null;){switch(c=L,d=c.child,c.tag){case 0:case 11:case 14:case 15:Jo(4,c,c.return);break;case 1:iI(c,c.return);var Z=c.stateNode;if(typeof Z.componentWillUnmount=="function"){l=c,t=c.return;try{g=l,Z.props=g.memoizedProps,Z.state=g.memoizedState,Z.componentWillUnmount()}catch(G){He(l,t,G)}}break;case 5:iI(c,c.return);break;case 22:if(c.memoizedState!==null){xb(s);continue}}d!==null?(d.return=c,L=d):xb(s)}i=i.sibling}e:for(i=null,s=e;;){if(s.tag===5){if(i===null){i=s;try{n=s.stateNode,r?(I=n.style,typeof I.setProperty=="function"?I.setProperty("display","none","important"):I.display="none"):(C=s.stateNode,a=s.memoizedProps.style,o=a!=null&&a.hasOwnProperty("display")?a.display:null,C.style.display=_h("display",o))}catch(G){He(e,e.return,G)}}}else if(s.tag===6){if(i===null)try{s.stateNode.nodeValue=r?"":s.memoizedProps}catch(G){He(e,e.return,G)}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===e)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===e)break e;for(;s.sibling===null;){if(s.return===null||s.return===e)break e;i===s&&(i=null),s=s.return}i===s&&(i=null),s.sibling.return=s.return,s=s.sibling}}break;case 19:at(g,e),yt(e),l&4&&Kb(e);break;case 21:break;default:at(g,e),yt(e)}}function yt(e){var g=e.flags;if(g&2){try{e:{for(var t=e.return;t!==null;){if(VG(t)){var l=t;break e}t=t.return}throw Error(M(160))}switch(l.tag){case 5:var n=l.stateNode;l.flags&32&&(Do(n,""),l.flags&=-33);var I=Nb(e);md(e,I,n);break;case 3:case 4:var o=l.stateNode.containerInfo,C=Nb(e);Ad(e,C,o);break;default:throw Error(M(161))}}catch(a){He(e,e.return,a)}e.flags&=-3}g&4096&&(e.flags&=-4097)}function UR(e,g,t){L=e,RG(e)}function RG(e,g,t){for(var l=(e.mode&1)!==0;L!==null;){var n=L,I=n.child;if(n.tag===22&&l){var o=n.memoizedState!==null||Ca;if(!o){var C=n.alternate,a=C!==null&&C.memoizedState!==null||sg;C=Ca;var r=sg;if(Ca=o,(sg=a)&&!r)for(L=n;L!==null;)o=L,a=o.child,o.tag===22&&o.memoizedState!==null?Eb(n):a!==null?(a.return=o,L=a):Eb(n);for(;I!==null;)L=I,RG(I),I=I.sibling;L=n,Ca=C,sg=r}Fb(e)}else n.subtreeFlags&8772&&I!==null?(I.return=n,L=I):Fb(e)}}function Fb(e){for(;L!==null;){var g=L;if(g.flags&8772){var t=g.alternate;try{if(g.flags&8772)switch(g.tag){case 0:case 11:case 15:sg||Ci(5,g);break;case 1:var l=g.stateNode;if(g.flags&4&&!sg)if(t===null)l.componentDidMount();else{var n=g.elementType===g.type?t.memoizedProps:st(g.type,t.memoizedProps);l.componentDidUpdate(n,t.memoizedState,l.__reactInternalSnapshotBeforeUpdate)}var I=g.updateQueue;I!==null&&Gb(g,I,l);break;case 3:var o=g.updateQueue;if(o!==null){if(t=null,g.child!==null)switch(g.child.tag){case 5:t=g.child.stateNode;break;case 1:t=g.child.stateNode}Gb(g,o,t)}break;case 5:var C=g.stateNode;if(t===null&&g.flags&4){t=C;var a=g.memoizedProps;switch(g.type){case"button":case"input":case"select":case"textarea":a.autoFocus&&t.focus();break;case"img":a.src&&(t.src=a.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(g.memoizedState===null){var r=g.alternate;if(r!==null){var i=r.memoizedState;if(i!==null){var s=i.dehydrated;s!==null&&Lo(s)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(M(163))}sg||g.flags&512&&ud(g)}catch(c){He(g,g.return,c)}}if(g===e){L=null;break}if(t=g.sibling,t!==null){t.return=g.return,L=t;break}L=g.return}}function xb(e){for(;L!==null;){var g=L;if(g===e){L=null;break}var t=g.sibling;if(t!==null){t.return=g.return,L=t;break}L=g.return}}function Eb(e){for(;L!==null;){var g=L;try{switch(g.tag){case 0:case 11:case 15:var t=g.return;try{Ci(4,g)}catch(a){He(g,t,a)}break;case 1:var l=g.stateNode;if(typeof l.componentDidMount=="function"){var n=g.return;try{l.componentDidMount()}catch(a){He(g,n,a)}}var I=g.return;try{ud(g)}catch(a){He(g,I,a)}break;case 5:var o=g.return;try{ud(g)}catch(a){He(g,o,a)}}}catch(a){He(g,g.return,a)}if(g===e){L=null;break}var C=g.sibling;if(C!==null){C.return=g.return,L=C;break}L=g.return}}var QR=Math.ceil,pr=ll.ReactCurrentDispatcher,lA=ll.ReactCurrentOwner,_g=ll.ReactCurrentBatchConfig,Ce=0,qe=null,ze=null,ng=0,Xg=0,sI=Tl(0),Pe=0,tC=null,Sn=0,ai=0,nA=0,Yo=null,Bg=null,IA=0,NI=1/0,Et=null,Gr=!1,bd=null,Yl=null,aa=!1,Sl=null,yr=0,wo=0,Zd=null,za=-1,Ta=0;function bg(){return Ce&6?Ke():za!==-1?za:za=Ke()}function wl(e){return e.mode&1?Ce&2&&ng!==0?ng&-ng:XR.transition!==null?(Ta===0&&(Ta=cp()),Ta):(e=ce,e!==0||(e=window.event,e=e===void 0?16:hp(e.type)),e):1}function bt(e,g,t,l){if(50<wo)throw wo=0,Zd=null,Error(M(185));pC(e,t,l),(!(Ce&2)||e!==qe)&&(e===qe&&(!(Ce&2)&&(ai|=t),Pe===4&&Gl(e,ng)),Wg(e,l),t===1&&Ce===0&&!(g.mode&1)&&(NI=Ke()+500,ni&&Ll()))}function Wg(e,g){var t=e.callbackNode;Xv(e,g);var l=Ir(e,e===qe?ng:0);if(l===0)t!==null&&Pm(t),e.callbackNode=null,e.callbackPriority=0;else if(g=l&-l,e.callbackPriority!==g){if(t!=null&&Pm(t),g===1)e.tag===0?RR(Db.bind(null,e)):Fp(Db.bind(null,e)),SR(function(){!(Ce&6)&&Ll()}),t=null;else{switch(dp(l)){case 1:t=ku;break;case 4:t=ip;break;case 16:t=nr;break;case 536870912:t=sp;break;default:t=nr}t=KG(t,XG.bind(null,e))}e.callbackPriority=g,e.callbackNode=t}}function XG(e,g){if(za=-1,Ta=0,Ce&6)throw Error(M(327));var t=e.callbackNode;if(vI()&&e.callbackNode!==t)return null;var l=Ir(e,e===qe?ng:0);if(l===0)return null;if(l&30||l&e.expiredLanes||g)g=Br(e,l);else{g=l;var n=Ce;Ce|=2;var I=JG();(qe!==e||ng!==g)&&(Et=null,NI=Ke()+500,mn(e,g));do try{OR();break}catch(C){kG(e,C)}while(!0);Tu(),pr.current=I,Ce=n,ze!==null?g=0:(qe=null,ng=0,g=Pe)}if(g!==0){if(g===2&&(n=Lc(e),n!==0&&(l=n,g=hd(e,n))),g===1)throw t=tC,mn(e,0),Gl(e,l),Wg(e,Ke()),t;if(g===6)Gl(e,l);else{if(n=e.current.alternate,!(l&30)&&!jR(n)&&(g=Br(e,l),g===2&&(I=Lc(e),I!==0&&(l=I,g=hd(e,I))),g===1))throw t=tC,mn(e,0),Gl(e,l),Wg(e,Ke()),t;switch(e.finishedWork=n,e.finishedLanes=l,g){case 0:case 1:throw Error(M(345));case 2:nn(e,Bg,Et);break;case 3:if(Gl(e,l),(l&130023424)===l&&(g=IA+500-Ke(),10<g)){if(Ir(e,0)!==0)break;if(n=e.suspendedLanes,(n&l)!==l){bg(),e.pingedLanes|=e.suspendedLanes&n;break}e.timeoutHandle=_c(nn.bind(null,e,Bg,Et),g);break}nn(e,Bg,Et);break;case 4:if(Gl(e,l),(l&4194240)===l)break;for(g=e.eventTimes,n=-1;0<l;){var o=31-mt(l);I=1<<o,o=g[o],o>n&&(n=o),l&=~I}if(l=n,l=Ke()-l,l=(120>l?120:480>l?480:1080>l?1080:1920>l?1920:3e3>l?3e3:4320>l?4320:1960*QR(l/1960))-l,10<l){e.timeoutHandle=_c(nn.bind(null,e,Bg,Et),l);break}nn(e,Bg,Et);break;case 5:nn(e,Bg,Et);break;default:throw Error(M(329))}}}return Wg(e,Ke()),e.callbackNode===t?XG.bind(null,e):null}function hd(e,g){var t=Yo;return e.current.memoizedState.isDehydrated&&(mn(e,g).flags|=256),e=Br(e,g),e!==2&&(g=Bg,Bg=t,g!==null&&pd(g)),e}function pd(e){Bg===null?Bg=e:Bg.push.apply(Bg,e)}function jR(e){for(var g=e;;){if(g.flags&16384){var t=g.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var l=0;l<t.length;l++){var n=t[l],I=n.getSnapshot;n=n.value;try{if(!Zt(I(),n))return!1}catch{return!1}}}if(t=g.child,g.subtreeFlags&16384&&t!==null)t.return=g,g=t;else{if(g===e)break;for(;g.sibling===null;){if(g.return===null||g.return===e)return!0;g=g.return}g.sibling.return=g.return,g=g.sibling}}return!0}function Gl(e,g){for(g&=~nA,g&=~ai,e.suspendedLanes|=g,e.pingedLanes&=~g,e=e.expirationTimes;0<g;){var t=31-mt(g),l=1<<t;e[t]=-1,g&=~l}}function Db(e){if(Ce&6)throw Error(M(327));vI();var g=Ir(e,0);if(!(g&1))return Wg(e,Ke()),null;var t=Br(e,g);if(e.tag!==0&&t===2){var l=Lc(e);l!==0&&(g=l,t=hd(e,l))}if(t===1)throw t=tC,mn(e,0),Gl(e,g),Wg(e,Ke()),t;if(t===6)throw Error(M(345));return e.finishedWork=e.current.alternate,e.finishedLanes=g,nn(e,Bg,Et),Wg(e,Ke()),null}function oA(e,g){var t=Ce;Ce|=1;try{return e(g)}finally{Ce=t,Ce===0&&(NI=Ke()+500,ni&&Ll())}}function Vn(e){Sl!==null&&Sl.tag===0&&!(Ce&6)&&vI();var g=Ce;Ce|=1;var t=_g.transition,l=ce;try{if(_g.transition=null,ce=1,e)return e()}finally{ce=l,_g.transition=t,Ce=g,!(Ce&6)&&Ll()}}function CA(){Xg=sI.current,pe(sI)}function mn(e,g){e.finishedWork=null,e.finishedLanes=0;var t=e.timeoutHandle;if(t!==-1&&(e.timeoutHandle=-1,fR(t)),ze!==null)for(t=ze.return;t!==null;){var l=t;switch(Du(l),l.tag){case 1:l=l.type.childContextTypes,l!=null&&ir();break;case 3:wI(),pe(Sg),pe(dg),Ou();break;case 5:Pu(l);break;case 4:wI();break;case 13:pe(We);break;case 19:pe(We);break;case 10:Lu(l.type._context);break;case 22:case 23:CA()}t=t.return}if(qe=e,ze=e=Hl(e.current,null),ng=Xg=g,Pe=0,tC=null,nA=ai=Sn=0,Bg=Yo=null,sn!==null){for(g=0;g<sn.length;g++)if(t=sn[g],l=t.interleaved,l!==null){t.interleaved=null;var n=l.next,I=t.pending;if(I!==null){var o=I.next;I.next=n,l.next=o}t.pending=l}sn=null}return e}function kG(e,g){do{var t=ze;try{if(Tu(),Ea.current=hr,Zr){for(var l=Re.memoizedState;l!==null;){var n=l.queue;n!==null&&(n.pending=null),l=l.next}Zr=!1}if(fn=0,$e=je=Re=null,ko=!1,_o=0,lA.current=null,t===null||t.return===null){Pe=1,tC=g,ze=null;break}e:{var I=e,o=t.return,C=t,a=g;if(g=ng,C.flags|=32768,a!==null&&typeof a=="object"&&typeof a.then=="function"){var r=a,i=C,s=i.tag;if(!(i.mode&1)&&(s===0||s===11||s===15)){var c=i.alternate;c?(i.updateQueue=c.updateQueue,i.memoizedState=c.memoizedState,i.lanes=c.lanes):(i.updateQueue=null,i.memoizedState=null)}var d=vb(o);if(d!==null){d.flags&=-257,Rb(d,o,C,I,g),d.mode&1&&Wb(I,r,g),g=d,a=r;var Z=g.updateQueue;if(Z===null){var G=new Set;G.add(a),g.updateQueue=G}else Z.add(a);break e}else{if(!(g&1)){Wb(I,r,g),aA();break e}a=Error(M(426))}}else if(ye&&C.mode&1){var y=vb(o);if(y!==null){!(y.flags&65536)&&(y.flags|=256),Rb(y,o,C,I,g),Mu(HI(a,C));break e}}I=a=HI(a,C),Pe!==4&&(Pe=2),Yo===null?Yo=[I]:Yo.push(I),I=o;do{switch(I.tag){case 3:I.flags|=65536,g&=-g,I.lanes|=g;var p=uG(I,a,g);pb(I,p);break e;case 1:C=a;var h=I.type,b=I.stateNode;if(!(I.flags&128)&&(typeof h.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(Yl===null||!Yl.has(b)))){I.flags|=65536,g&=-g,I.lanes|=g;var B=AG(I,C,g);pb(I,B);break e}}I=I.return}while(I!==null)}wG(t)}catch(S){g=S,ze===t&&t!==null&&(ze=t=t.return);continue}break}while(!0)}function JG(){var e=pr.current;return pr.current=hr,e===null?hr:e}function aA(){(Pe===0||Pe===3||Pe===2)&&(Pe=4),qe===null||!(Sn&268435455)&&!(ai&268435455)||Gl(qe,ng)}function Br(e,g){var t=Ce;Ce|=2;var l=JG();(qe!==e||ng!==g)&&(Et=null,mn(e,g));do try{PR();break}catch(n){kG(e,n)}while(!0);if(Tu(),Ce=t,pr.current=l,ze!==null)throw Error(M(261));return qe=null,ng=0,Pe}function PR(){for(;ze!==null;)YG(ze)}function OR(){for(;ze!==null&&!Gv();)YG(ze)}function YG(e){var g=NG(e.alternate,e,Xg);e.memoizedProps=e.pendingProps,g===null?wG(e):ze=g,lA.current=null}function wG(e){var g=e;do{var t=g.alternate;if(e=g.return,g.flags&32768){if(t=zR(t,g),t!==null){t.flags&=32767,ze=t;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Pe=6,ze=null;return}}else if(t=MR(t,g,Xg),t!==null){ze=t;return}if(g=g.sibling,g!==null){ze=g;return}ze=g=e}while(g!==null);Pe===0&&(Pe=5)}function nn(e,g,t){var l=ce,n=_g.transition;try{_g.transition=null,ce=1,$R(e,g,t,l)}finally{_g.transition=n,ce=l}return null}function $R(e,g,t,l){do vI();while(Sl!==null);if(Ce&6)throw Error(M(327));t=e.finishedWork;var n=e.finishedLanes;if(t===null)return null;if(e.finishedWork=null,e.finishedLanes=0,t===e.current)throw Error(M(177));e.callbackNode=null,e.callbackPriority=0;var I=t.lanes|t.childLanes;if(kv(e,I),e===qe&&(ze=qe=null,ng=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||aa||(aa=!0,KG(nr,function(){return vI(),null})),I=(t.flags&15990)!==0,t.subtreeFlags&15990||I){I=_g.transition,_g.transition=null;var o=ce;ce=1;var C=Ce;Ce|=4,lA.current=null,LR(e,t),vG(t,e),bR($c),or=!!Oc,$c=Oc=null,e.current=t,UR(t),yv(),Ce=C,ce=o,_g.transition=I}else e.current=t;if(aa&&(aa=!1,Sl=e,yr=n),I=e.pendingLanes,I===0&&(Yl=null),Sv(t.stateNode),Wg(e,Ke()),g!==null)for(l=e.onRecoverableError,t=0;t<g.length;t++)n=g[t],l(n.value,{componentStack:n.stack,digest:n.digest});if(Gr)throw Gr=!1,e=bd,bd=null,e;return yr&1&&e.tag!==0&&vI(),I=e.pendingLanes,I&1?e===Zd?wo++:(wo=0,Zd=e):wo=0,Ll(),null}function vI(){if(Sl!==null){var e=dp(yr),g=_g.transition,t=ce;try{if(_g.transition=null,ce=16>e?16:e,Sl===null)var l=!1;else{if(e=Sl,Sl=null,yr=0,Ce&6)throw Error(M(331));var n=Ce;for(Ce|=4,L=e.current;L!==null;){var I=L,o=I.child;if(L.flags&16){var C=I.deletions;if(C!==null){for(var a=0;a<C.length;a++){var r=C[a];for(L=r;L!==null;){var i=L;switch(i.tag){case 0:case 11:case 15:Jo(8,i,I)}var s=i.child;if(s!==null)s.return=i,L=s;else for(;L!==null;){i=L;var c=i.sibling,d=i.return;if(SG(i),i===r){L=null;break}if(c!==null){c.return=d,L=c;break}L=d}}}var Z=I.alternate;if(Z!==null){var G=Z.child;if(G!==null){Z.child=null;do{var y=G.sibling;G.sibling=null,G=y}while(G!==null)}}L=I}}if(I.subtreeFlags&2064&&o!==null)o.return=I,L=o;else e:for(;L!==null;){if(I=L,I.flags&2048)switch(I.tag){case 0:case 11:case 15:Jo(9,I,I.return)}var p=I.sibling;if(p!==null){p.return=I.return,L=p;break e}L=I.return}}var h=e.current;for(L=h;L!==null;){o=L;var b=o.child;if(o.subtreeFlags&2064&&b!==null)b.return=o,L=b;else e:for(o=h;L!==null;){if(C=L,C.flags&2048)try{switch(C.tag){case 0:case 11:case 15:Ci(9,C)}}catch(S){He(C,C.return,S)}if(C===o){L=null;break e}var B=C.sibling;if(B!==null){B.return=C.return,L=B;break e}L=C.return}}if(Ce=n,Ll(),vt&&typeof vt.onPostCommitFiberRoot=="function")try{vt.onPostCommitFiberRoot(_r,e)}catch{}l=!0}return l}finally{ce=t,_g.transition=g}}return!1}function Mb(e,g,t){g=HI(t,g),g=uG(e,g,1),e=Jl(e,g,1),g=bg(),e!==null&&(pC(e,1,g),Wg(e,g))}function He(e,g,t){if(e.tag===3)Mb(e,e,t);else for(;g!==null;){if(g.tag===3){Mb(g,e,t);break}else if(g.tag===1){var l=g.stateNode;if(typeof g.type.getDerivedStateFromError=="function"||typeof l.componentDidCatch=="function"&&(Yl===null||!Yl.has(l))){e=HI(t,e),e=AG(g,e,1),g=Jl(g,e,1),e=bg(),g!==null&&(pC(g,1,e),Wg(g,e));break}}g=g.return}}function qR(e,g,t){var l=e.pingCache;l!==null&&l.delete(g),g=bg(),e.pingedLanes|=e.suspendedLanes&t,qe===e&&(ng&t)===t&&(Pe===4||Pe===3&&(ng&130023424)===ng&&500>Ke()-IA?mn(e,0):nA|=t),Wg(e,g)}function HG(e,g){g===0&&(e.mode&1?(g=qC,qC<<=1,!(qC&130023424)&&(qC=4194304)):g=1);var t=bg();e=qt(e,g),e!==null&&(pC(e,g,t),Wg(e,t))}function _R(e){var g=e.memoizedState,t=0;g!==null&&(t=g.retryLane),HG(e,t)}function eX(e,g){var t=0;switch(e.tag){case 13:var l=e.stateNode,n=e.memoizedState;n!==null&&(t=n.retryLane);break;case 19:l=e.stateNode;break;default:throw Error(M(314))}l!==null&&l.delete(g),HG(e,t)}var NG;NG=function(e,g,t){if(e!==null)if(e.memoizedProps!==g.pendingProps||Sg.current)fg=!0;else{if(!(e.lanes&t)&&!(g.flags&128))return fg=!1,DR(e,g,t);fg=!!(e.flags&131072)}else fg=!1,ye&&g.flags&1048576&&xp(g,dr,g.index);switch(g.lanes=0,g.tag){case 2:var l=g.type;Ma(e,g),e=g.pendingProps;var n=kI(g,dg.current);WI(g,t),n=qu(null,g,l,e,n,t);var I=_u();return g.flags|=1,typeof n=="object"&&n!==null&&typeof n.render=="function"&&n.$$typeof===void 0?(g.tag=1,g.memoizedState=null,g.updateQueue=null,Vg(l)?(I=!0,sr(g)):I=!1,g.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,Qu(g),n.updater=Ii,g.stateNode=n,n._reactInternals=g,od(g,l,e,t),g=rd(null,g,l,!0,I,t)):(g.tag=0,ye&&I&&Eu(g),Ag(null,g,n,t),g=g.child),g;case 16:l=g.elementType;e:{switch(Ma(e,g),e=g.pendingProps,n=l._init,l=n(l._payload),g.type=l,n=g.tag=tX(l),e=st(l,e),n){case 0:g=ad(null,g,l,e,t);break e;case 1:g=Jb(null,g,l,e,t);break e;case 11:g=Xb(null,g,l,e,t);break e;case 14:g=kb(null,g,l,st(l.type,e),t);break e}throw Error(M(306,l,""))}return g;case 0:return l=g.type,n=g.pendingProps,n=g.elementType===l?n:st(l,n),ad(e,g,l,n,t);case 1:return l=g.type,n=g.pendingProps,n=g.elementType===l?n:st(l,n),Jb(e,g,l,n,t);case 3:e:{if(hG(g),e===null)throw Error(M(387));l=g.pendingProps,I=g.memoizedState,n=I.element,zp(e,g),mr(g,l,null,t);var o=g.memoizedState;if(l=o.element,I.isDehydrated)if(I={element:l,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},g.updateQueue.baseState=I,g.memoizedState=I,g.flags&256){n=HI(Error(M(423)),g),g=Yb(e,g,l,t,n);break e}else if(l!==n){n=HI(Error(M(424)),g),g=Yb(e,g,l,t,n);break e}else for(Jg=kl(g.stateNode.containerInfo.firstChild),wg=g,ye=!0,ut=null,t=Qp(g,null,l,t),g.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(JI(),l===n){g=_t(e,g,t);break e}Ag(e,g,l,t)}g=g.child}return g;case 5:return jp(g),e===null&&ld(g),l=g.type,n=g.pendingProps,I=e!==null?e.memoizedProps:null,o=n.children,qc(l,n)?o=null:I!==null&&qc(l,I)&&(g.flags|=32),ZG(e,g),Ag(e,g,o,t),g.child;case 6:return e===null&&ld(g),null;case 13:return pG(e,g,t);case 4:return ju(g,g.stateNode.containerInfo),l=g.pendingProps,e===null?g.child=YI(g,null,l,t):Ag(e,g,l,t),g.child;case 11:return l=g.type,n=g.pendingProps,n=g.elementType===l?n:st(l,n),Xb(e,g,l,n,t);case 7:return Ag(e,g,g.pendingProps,t),g.child;case 8:return Ag(e,g,g.pendingProps.children,t),g.child;case 12:return Ag(e,g,g.pendingProps.children,t),g.child;case 10:e:{if(l=g.type._context,n=g.pendingProps,I=g.memoizedProps,o=n.value,Ae(ur,l._currentValue),l._currentValue=o,I!==null)if(Zt(I.value,o)){if(I.children===n.children&&!Sg.current){g=_t(e,g,t);break e}}else for(I=g.child,I!==null&&(I.return=g);I!==null;){var C=I.dependencies;if(C!==null){o=I.child;for(var a=C.firstContext;a!==null;){if(a.context===l){if(I.tag===1){a=Qt(-1,t&-t),a.tag=2;var r=I.updateQueue;if(r!==null){r=r.shared;var i=r.pending;i===null?a.next=a:(a.next=i.next,i.next=a),r.pending=a}}I.lanes|=t,a=I.alternate,a!==null&&(a.lanes|=t),nd(I.return,t,g),C.lanes|=t;break}a=a.next}}else if(I.tag===10)o=I.type===g.type?null:I.child;else if(I.tag===18){if(o=I.return,o===null)throw Error(M(341));o.lanes|=t,C=o.alternate,C!==null&&(C.lanes|=t),nd(o,t,g),o=I.sibling}else o=I.child;if(o!==null)o.return=I;else for(o=I;o!==null;){if(o===g){o=null;break}if(I=o.sibling,I!==null){I.return=o.return,o=I;break}o=o.return}I=o}Ag(e,g,n.children,t),g=g.child}return g;case 9:return n=g.type,l=g.pendingProps.children,WI(g,t),n=gt(n),l=l(n),g.flags|=1,Ag(e,g,l,t),g.child;case 14:return l=g.type,n=st(l,g.pendingProps),n=st(l.type,n),kb(e,g,l,n,t);case 15:return mG(e,g,g.type,g.pendingProps,t);case 17:return l=g.type,n=g.pendingProps,n=g.elementType===l?n:st(l,n),Ma(e,g),g.tag=1,Vg(l)?(e=!0,sr(g)):e=!1,WI(g,t),Lp(g,l,n),od(g,l,n,t),rd(null,g,l,!0,e,t);case 19:return GG(e,g,t);case 22:return bG(e,g,t)}throw Error(M(156,g.tag))};function KG(e,g){return rp(e,g)}function gX(e,g,t,l){this.tag=e,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=g,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=l,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Og(e,g,t,l){return new gX(e,g,t,l)}function rA(e){return e=e.prototype,!(!e||!e.isReactComponent)}function tX(e){if(typeof e=="function")return rA(e)?1:0;if(e!=null){if(e=e.$$typeof,e===vu)return 11;if(e===Ru)return 14}return 2}function Hl(e,g){var t=e.alternate;return t===null?(t=Og(e.tag,g,e.key,e.mode),t.elementType=e.elementType,t.type=e.type,t.stateNode=e.stateNode,t.alternate=e,e.alternate=t):(t.pendingProps=g,t.type=e.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=e.flags&14680064,t.childLanes=e.childLanes,t.lanes=e.lanes,t.child=e.child,t.memoizedProps=e.memoizedProps,t.memoizedState=e.memoizedState,t.updateQueue=e.updateQueue,g=e.dependencies,t.dependencies=g===null?null:{lanes:g.lanes,firstContext:g.firstContext},t.sibling=e.sibling,t.index=e.index,t.ref=e.ref,t}function La(e,g,t,l,n,I){var o=2;if(l=e,typeof e=="function")rA(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case gI:return bn(t.children,n,I,g);case Wu:o=8,n|=8;break;case Xc:return e=Og(12,t,g,n|2),e.elementType=Xc,e.lanes=I,e;case kc:return e=Og(13,t,g,n),e.elementType=kc,e.lanes=I,e;case Jc:return e=Og(19,t,g,n),e.elementType=Jc,e.lanes=I,e;case Uh:return ri(t,n,I,g);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Th:o=10;break e;case Lh:o=9;break e;case vu:o=11;break e;case Ru:o=14;break e;case ul:o=16,l=null;break e}throw Error(M(130,e==null?e:typeof e,""))}return g=Og(o,t,g,n),g.elementType=e,g.type=l,g.lanes=I,g}function bn(e,g,t,l){return e=Og(7,e,l,g),e.lanes=t,e}function ri(e,g,t,l){return e=Og(22,e,l,g),e.elementType=Uh,e.lanes=t,e.stateNode={isHidden:!1},e}function Ts(e,g,t){return e=Og(6,e,null,g),e.lanes=t,e}function Ls(e,g,t){return g=Og(4,e.children!==null?e.children:[],e.key,g),g.lanes=t,g.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},g}function lX(e,g,t,l,n){this.tag=g,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ss(0),this.expirationTimes=Ss(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ss(0),this.identifierPrefix=l,this.onRecoverableError=n,this.mutableSourceEagerHydrationData=null}function iA(e,g,t,l,n,I,o,C,a){return e=new lX(e,g,t,C,a),g===1?(g=1,I===!0&&(g|=8)):g=0,I=Og(3,null,null,g),e.current=I,I.stateNode=e,I.memoizedState={element:l,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},Qu(I),e}function nX(e,g,t){var l=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:eI,key:l==null?null:""+l,children:e,containerInfo:g,implementation:t}}function FG(e){if(!e)return xl;e=e._reactInternals;e:{if(kn(e)!==e||e.tag!==1)throw Error(M(170));var g=e;do{switch(g.tag){case 3:g=g.stateNode.context;break e;case 1:if(Vg(g.type)){g=g.stateNode.__reactInternalMemoizedMergedChildContext;break e}}g=g.return}while(g!==null);throw Error(M(171))}if(e.tag===1){var t=e.type;if(Vg(t))return Kp(e,t,g)}return g}function xG(e,g,t,l,n,I,o,C,a){return e=iA(t,l,!0,e,n,I,o,C,a),e.context=FG(null),t=e.current,l=bg(),n=wl(t),I=Qt(l,n),I.callback=g??null,Jl(t,I,n),e.current.lanes=n,pC(e,n,l),Wg(e,l),e}function ii(e,g,t,l){var n=g.current,I=bg(),o=wl(n);return t=FG(t),g.context===null?g.context=t:g.pendingContext=t,g=Qt(I,o),g.payload={element:e},l=l===void 0?null:l,l!==null&&(g.callback=l),e=Jl(n,g,o),e!==null&&(bt(e,n,o,I),xa(e,n,o)),o}function fr(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function zb(e,g){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var t=e.retryLane;e.retryLane=t!==0&&t<g?t:g}}function sA(e,g){zb(e,g),(e=e.alternate)&&zb(e,g)}function IX(){return null}var EG=typeof reportError=="function"?reportError:function(e){console.error(e)};function cA(e){this._internalRoot=e}si.prototype.render=cA.prototype.render=function(e){var g=this._internalRoot;if(g===null)throw Error(M(409));ii(e,g,null,null)};si.prototype.unmount=cA.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var g=e.containerInfo;Vn(function(){ii(null,e,null,null)}),g[$t]=null}};function si(e){this._internalRoot=e}si.prototype.unstable_scheduleHydration=function(e){if(e){var g=mp();e={blockedOn:null,target:e,priority:g};for(var t=0;t<pl.length&&g!==0&&g<pl[t].priority;t++);pl.splice(t,0,e),t===0&&Zp(e)}};function dA(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function ci(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Tb(){}function oX(e,g,t,l,n){if(n){if(typeof l=="function"){var I=l;l=function(){var r=fr(o);I.call(r)}}var o=xG(g,l,e,0,null,!1,!1,"",Tb);return e._reactRootContainer=o,e[$t]=o.current,jo(e.nodeType===8?e.parentNode:e),Vn(),o}for(;n=e.lastChild;)e.removeChild(n);if(typeof l=="function"){var C=l;l=function(){var r=fr(a);C.call(r)}}var a=iA(e,0,!1,null,null,!1,!1,"",Tb);return e._reactRootContainer=a,e[$t]=a.current,jo(e.nodeType===8?e.parentNode:e),Vn(function(){ii(g,a,t,l)}),a}function di(e,g,t,l,n){var I=t._reactRootContainer;if(I){var o=I;if(typeof n=="function"){var C=n;n=function(){var a=fr(o);C.call(a)}}ii(g,o,e,n)}else o=oX(t,g,e,n,l);return fr(o)}up=function(e){switch(e.tag){case 3:var g=e.stateNode;if(g.current.memoizedState.isDehydrated){var t=Zo(g.pendingLanes);t!==0&&(Ju(g,t|1),Wg(g,Ke()),!(Ce&6)&&(NI=Ke()+500,Ll()))}break;case 13:Vn(function(){var l=qt(e,1);if(l!==null){var n=bg();bt(l,e,1,n)}}),sA(e,1)}};Yu=function(e){if(e.tag===13){var g=qt(e,134217728);if(g!==null){var t=bg();bt(g,e,134217728,t)}sA(e,134217728)}};Ap=function(e){if(e.tag===13){var g=wl(e),t=qt(e,g);if(t!==null){var l=bg();bt(t,e,g,l)}sA(e,g)}};mp=function(){return ce};bp=function(e,g){var t=ce;try{return ce=e,g()}finally{ce=t}};Mc=function(e,g,t){switch(g){case"input":if(Hc(e,t),g=t.name,t.type==="radio"&&g!=null){for(t=e;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+g)+'][type="radio"]'),g=0;g<t.length;g++){var l=t[g];if(l!==e&&l.form===e.form){var n=li(l);if(!n)throw Error(M(90));jh(l),Hc(l,n)}}}break;case"textarea":Oh(e,t);break;case"select":g=t.value,g!=null&&BI(e,!!t.multiple,g,!1)}};lp=oA;np=Vn;var CX={usingClientEntryPoint:!1,Events:[yC,II,li,gp,tp,oA]},Co={findFiberByHostInstance:rn,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},aX={bundleType:Co.bundleType,version:Co.version,rendererPackageName:Co.rendererPackageName,rendererConfig:Co.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ll.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Cp(e),e===null?null:e.stateNode},findFiberByHostInstance:Co.findFiberByHostInstance||IX,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ra=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ra.isDisabled&&ra.supportsFiber)try{_r=ra.inject(aX),vt=ra}catch{}}Fg.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=CX;Fg.createPortal=function(e,g){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!dA(g))throw Error(M(200));return nX(e,g,null,t)};Fg.createRoot=function(e,g){if(!dA(e))throw Error(M(299));var t=!1,l="",n=EG;return g!=null&&(g.unstable_strictMode===!0&&(t=!0),g.identifierPrefix!==void 0&&(l=g.identifierPrefix),g.onRecoverableError!==void 0&&(n=g.onRecoverableError)),g=iA(e,1,!1,null,null,t,!1,l,n),e[$t]=g.current,jo(e.nodeType===8?e.parentNode:e),new cA(g)};Fg.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var g=e._reactInternals;if(g===void 0)throw typeof e.render=="function"?Error(M(188)):(e=Object.keys(e).join(","),Error(M(268,e)));return e=Cp(g),e=e===null?null:e.stateNode,e};Fg.flushSync=function(e){return Vn(e)};Fg.hydrate=function(e,g,t){if(!ci(g))throw Error(M(200));return di(null,e,g,!0,t)};Fg.hydrateRoot=function(e,g,t){if(!dA(e))throw Error(M(405));var l=t!=null&&t.hydratedSources||null,n=!1,I="",o=EG;if(t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(I=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),g=xG(g,null,e,1,t??null,n,!1,I,o),e[$t]=g.current,jo(e),l)for(e=0;e<l.length;e++)t=l[e],n=t._getVersion,n=n(t._source),g.mutableSourceEagerHydrationData==null?g.mutableSourceEagerHydrationData=[t,n]:g.mutableSourceEagerHydrationData.push(t,n);return new si(g)};Fg.render=function(e,g,t){if(!ci(g))throw Error(M(200));return di(null,e,g,!1,t)};Fg.unmountComponentAtNode=function(e){if(!ci(e))throw Error(M(40));return e._reactRootContainer?(Vn(function(){di(null,null,e,!1,function(){e._reactRootContainer=null,e[$t]=null})}),!0):!1};Fg.unstable_batchedUpdates=oA;Fg.unstable_renderSubtreeIntoContainer=function(e,g,t,l){if(!ci(t))throw Error(M(200));if(e==null||e._reactInternals===void 0)throw Error(M(38));return di(e,g,t,!1,l)};Fg.version="18.2.0-next-9e3b772b8-20220608";function DG(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(DG)}catch(e){console.error(e)}}DG(),xh.exports=Fg;var uA=xh.exports;const rX=ZC(uA);/**
 * @remix-run/router v1.15.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function lC(){return lC=Object.assign?Object.assign.bind():function(e){for(var g=1;g<arguments.length;g++){var t=arguments[g];for(var l in t)Object.prototype.hasOwnProperty.call(t,l)&&(e[l]=t[l])}return e},lC.apply(this,arguments)}var Vl;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Vl||(Vl={}));const Lb="popstate";function iX(e){e===void 0&&(e={});function g(l,n){let{pathname:I,search:o,hash:C}=l.location;return Gd("",{pathname:I,search:o,hash:C},n.state&&n.state.usr||null,n.state&&n.state.key||"default")}function t(l,n){return typeof n=="string"?n:Sr(n)}return cX(g,t,null,e)}function xe(e,g){if(e===!1||e===null||typeof e>"u")throw new Error(g)}function MG(e,g){if(!e){typeof console<"u"&&console.warn(g);try{throw new Error(g)}catch{}}}function sX(){return Math.random().toString(36).substr(2,8)}function Ub(e,g){return{usr:e.state,key:e.key,idx:g}}function Gd(e,g,t,l){return t===void 0&&(t=null),lC({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof g=="string"?zI(g):g,{state:t,key:g&&g.key||l||sX()})}function Sr(e){let{pathname:g="/",search:t="",hash:l=""}=e;return t&&t!=="?"&&(g+=t.charAt(0)==="?"?t:"?"+t),l&&l!=="#"&&(g+=l.charAt(0)==="#"?l:"#"+l),g}function zI(e){let g={};if(e){let t=e.indexOf("#");t>=0&&(g.hash=e.substr(t),e=e.substr(0,t));let l=e.indexOf("?");l>=0&&(g.search=e.substr(l),e=e.substr(0,l)),e&&(g.pathname=e)}return g}function cX(e,g,t,l){l===void 0&&(l={});let{window:n=document.defaultView,v5Compat:I=!1}=l,o=n.history,C=Vl.Pop,a=null,r=i();r==null&&(r=0,o.replaceState(lC({},o.state,{idx:r}),""));function i(){return(o.state||{idx:null}).idx}function s(){C=Vl.Pop;let y=i(),p=y==null?null:y-r;r=y,a&&a({action:C,location:G.location,delta:p})}function c(y,p){C=Vl.Push;let h=Gd(G.location,y,p);t&&t(h,y),r=i()+1;let b=Ub(h,r),B=G.createHref(h);try{o.pushState(b,"",B)}catch(S){if(S instanceof DOMException&&S.name==="DataCloneError")throw S;n.location.assign(B)}I&&a&&a({action:C,location:G.location,delta:1})}function d(y,p){C=Vl.Replace;let h=Gd(G.location,y,p);t&&t(h,y),r=i();let b=Ub(h,r),B=G.createHref(h);o.replaceState(b,"",B),I&&a&&a({action:C,location:G.location,delta:0})}function Z(y){let p=n.location.origin!=="null"?n.location.origin:n.location.href,h=typeof y=="string"?y:Sr(y);return h=h.replace(/ $/,"%20"),xe(p,"No window.location.(origin|href) available to create URL for href: "+h),new URL(h,p)}let G={get action(){return C},get location(){return e(n,o)},listen(y){if(a)throw new Error("A history only accepts one active listener");return n.addEventListener(Lb,s),a=y,()=>{n.removeEventListener(Lb,s),a=null}},createHref(y){return g(n,y)},createURL:Z,encodeLocation(y){let p=Z(y);return{pathname:p.pathname,search:p.search,hash:p.hash}},push:c,replace:d,go(y){return o.go(y)}};return G}var Qb;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(Qb||(Qb={}));function dX(e,g,t){t===void 0&&(t="/");let l=typeof g=="string"?zI(g):g,n=AA(l.pathname||"/",t);if(n==null)return null;let I=zG(e);uX(I);let o=null;for(let C=0;o==null&&C<I.length;++C){let a=VX(n);o=BX(I[C],a)}return o}function zG(e,g,t,l){g===void 0&&(g=[]),t===void 0&&(t=[]),l===void 0&&(l="");let n=(I,o,C)=>{let a={relativePath:C===void 0?I.path||"":C,caseSensitive:I.caseSensitive===!0,childrenIndex:o,route:I};a.relativePath.startsWith("/")&&(xe(a.relativePath.startsWith(l),'Absolute route path "'+a.relativePath+'" nested under path '+('"'+l+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),a.relativePath=a.relativePath.slice(l.length));let r=Nl([l,a.relativePath]),i=t.concat(a);I.children&&I.children.length>0&&(xe(I.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+r+'".')),zG(I.children,g,i,r)),!(I.path==null&&!I.index)&&g.push({path:r,score:GX(r,I.index),routesMeta:i})};return e.forEach((I,o)=>{var C;if(I.path===""||!((C=I.path)!=null&&C.includes("?")))n(I,o);else for(let a of TG(I.path))n(I,o,a)}),g}function TG(e){let g=e.split("/");if(g.length===0)return[];let[t,...l]=g,n=t.endsWith("?"),I=t.replace(/\?$/,"");if(l.length===0)return n?[I,""]:[I];let o=TG(l.join("/")),C=[];return C.push(...o.map(a=>a===""?I:[I,a].join("/"))),n&&C.push(...o),C.map(a=>e.startsWith("/")&&a===""?"/":a)}function uX(e){e.sort((g,t)=>g.score!==t.score?t.score-g.score:yX(g.routesMeta.map(l=>l.childrenIndex),t.routesMeta.map(l=>l.childrenIndex)))}const AX=/^:[\w-]+$/,mX=3,bX=2,ZX=1,hX=10,pX=-2,jb=e=>e==="*";function GX(e,g){let t=e.split("/"),l=t.length;return t.some(jb)&&(l+=pX),g&&(l+=bX),t.filter(n=>!jb(n)).reduce((n,I)=>n+(AX.test(I)?mX:I===""?ZX:hX),l)}function yX(e,g){return e.length===g.length&&e.slice(0,-1).every((l,n)=>l===g[n])?e[e.length-1]-g[g.length-1]:0}function BX(e,g){let{routesMeta:t}=e,l={},n="/",I=[];for(let o=0;o<t.length;++o){let C=t[o],a=o===t.length-1,r=n==="/"?g:g.slice(n.length)||"/",i=fX({path:C.relativePath,caseSensitive:C.caseSensitive,end:a},r);if(!i)return null;Object.assign(l,i.params);let s=C.route;I.push({params:l,pathname:Nl([n,i.pathname]),pathnameBase:XX(Nl([n,i.pathnameBase])),route:s}),i.pathnameBase!=="/"&&(n=Nl([n,i.pathnameBase]))}return I}function fX(e,g){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[t,l]=SX(e.path,e.caseSensitive,e.end),n=g.match(t);if(!n)return null;let I=n[0],o=I.replace(/(.)\/+$/,"$1"),C=n.slice(1);return{params:l.reduce((r,i,s)=>{let{paramName:c,isOptional:d}=i;if(c==="*"){let G=C[s]||"";o=I.slice(0,I.length-G.length).replace(/(.)\/+$/,"$1")}const Z=C[s];return d&&!Z?r[c]=void 0:r[c]=(Z||"").replace(/%2F/g,"/"),r},{}),pathname:I,pathnameBase:o,pattern:e}}function SX(e,g,t){g===void 0&&(g=!1),t===void 0&&(t=!0),MG(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let l=[],n="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,C,a)=>(l.push({paramName:C,isOptional:a!=null}),a?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(l.push({paramName:"*"}),n+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?n+="\\/*$":e!==""&&e!=="/"&&(n+="(?:(?=\\/|$))"),[new RegExp(n,g?void 0:"i"),l]}function VX(e){try{return e.split("/").map(g=>decodeURIComponent(g).replace(/\//g,"%2F")).join("/")}catch(g){return MG(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+g+").")),e}}function AA(e,g){if(g==="/")return e;if(!e.toLowerCase().startsWith(g.toLowerCase()))return null;let t=g.endsWith("/")?g.length-1:g.length,l=e.charAt(t);return l&&l!=="/"?null:e.slice(t)||"/"}function WX(e,g){g===void 0&&(g="/");let{pathname:t,search:l="",hash:n=""}=typeof e=="string"?zI(e):e;return{pathname:t?t.startsWith("/")?t:vX(t,g):g,search:kX(l),hash:JX(n)}}function vX(e,g){let t=g.replace(/\/+$/,"").split("/");return e.split("/").forEach(n=>{n===".."?t.length>1&&t.pop():n!=="."&&t.push(n)}),t.length>1?t.join("/"):"/"}function Us(e,g,t,l){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+g+"` field ["+JSON.stringify(l)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function RX(e){return e.filter((g,t)=>t===0||g.route.path&&g.route.path.length>0)}function mA(e,g){let t=RX(e);return g?t.map((l,n)=>n===e.length-1?l.pathname:l.pathnameBase):t.map(l=>l.pathnameBase)}function bA(e,g,t,l){l===void 0&&(l=!1);let n;typeof e=="string"?n=zI(e):(n=lC({},e),xe(!n.pathname||!n.pathname.includes("?"),Us("?","pathname","search",n)),xe(!n.pathname||!n.pathname.includes("#"),Us("#","pathname","hash",n)),xe(!n.search||!n.search.includes("#"),Us("#","search","hash",n)));let I=e===""||n.pathname==="",o=I?"/":n.pathname,C;if(o==null)C=t;else{let s=g.length-1;if(!l&&o.startsWith("..")){let c=o.split("/");for(;c[0]==="..";)c.shift(),s-=1;n.pathname=c.join("/")}C=s>=0?g[s]:"/"}let a=WX(n,C),r=o&&o!=="/"&&o.endsWith("/"),i=(I||o===".")&&t.endsWith("/");return!a.pathname.endsWith("/")&&(r||i)&&(a.pathname+="/"),a}const Nl=e=>e.join("/").replace(/\/\/+/g,"/"),XX=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),kX=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,JX=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function YX(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const LG=["post","put","patch","delete"];new Set(LG);const wX=["get",...LG];new Set(wX);/**
 * React Router v6.22.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function nC(){return nC=Object.assign?Object.assign.bind():function(e){for(var g=1;g<arguments.length;g++){var t=arguments[g];for(var l in t)Object.prototype.hasOwnProperty.call(t,l)&&(e[l]=t[l])}return e},nC.apply(this,arguments)}const ZA=u.createContext(null),HX=u.createContext(null),Ul=u.createContext(null),ui=u.createContext(null),nl=u.createContext({outlet:null,matches:[],isDataRoute:!1}),UG=u.createContext(null);function NX(e,g){let{relative:t}=g===void 0?{}:g;TI()||xe(!1);let{basename:l,navigator:n}=u.useContext(Ul),{hash:I,pathname:o,search:C}=jG(e,{relative:t}),a=o;return l!=="/"&&(a=o==="/"?l:Nl([l,o])),n.createHref({pathname:a,search:C,hash:I})}function TI(){return u.useContext(ui)!=null}function fC(){return TI()||xe(!1),u.useContext(ui).location}function QG(e){u.useContext(Ul).static||u.useLayoutEffect(e)}function Il(){let{isDataRoute:e}=u.useContext(nl);return e?$X():KX()}function KX(){TI()||xe(!1);let e=u.useContext(ZA),{basename:g,future:t,navigator:l}=u.useContext(Ul),{matches:n}=u.useContext(nl),{pathname:I}=fC(),o=JSON.stringify(mA(n,t.v7_relativeSplatPath)),C=u.useRef(!1);return QG(()=>{C.current=!0}),u.useCallback(function(r,i){if(i===void 0&&(i={}),!C.current)return;if(typeof r=="number"){l.go(r);return}let s=bA(r,JSON.parse(o),I,i.relative==="path");e==null&&g!=="/"&&(s.pathname=s.pathname==="/"?g:Nl([g,s.pathname])),(i.replace?l.replace:l.push)(s,i.state,i)},[g,l,o,I,e])}const FX=u.createContext(null);function xX(e){let g=u.useContext(nl).outlet;return g&&u.createElement(FX.Provider,{value:e},g)}function jG(e,g){let{relative:t}=g===void 0?{}:g,{future:l}=u.useContext(Ul),{matches:n}=u.useContext(nl),{pathname:I}=fC(),o=JSON.stringify(mA(n,l.v7_relativeSplatPath));return u.useMemo(()=>bA(e,JSON.parse(o),I,t==="path"),[e,o,I,t])}function EX(e,g){return DX(e,g)}function DX(e,g,t,l){TI()||xe(!1);let{navigator:n}=u.useContext(Ul),{matches:I}=u.useContext(nl),o=I[I.length-1],C=o?o.params:{};o&&o.pathname;let a=o?o.pathnameBase:"/";o&&o.route;let r=fC(),i;if(g){var s;let y=typeof g=="string"?zI(g):g;a==="/"||(s=y.pathname)!=null&&s.startsWith(a)||xe(!1),i=y}else i=r;let c=i.pathname||"/",d=c;if(a!=="/"){let y=a.replace(/^\//,"").split("/");d="/"+c.replace(/^\//,"").split("/").slice(y.length).join("/")}let Z=dX(e,{pathname:d}),G=UX(Z&&Z.map(y=>Object.assign({},y,{params:Object.assign({},C,y.params),pathname:Nl([a,n.encodeLocation?n.encodeLocation(y.pathname).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?a:Nl([a,n.encodeLocation?n.encodeLocation(y.pathnameBase).pathname:y.pathnameBase])})),I,t,l);return g&&G?u.createElement(ui.Provider,{value:{location:nC({pathname:"/",search:"",hash:"",state:null,key:"default"},i),navigationType:Vl.Pop}},G):G}function MX(){let e=OX(),g=YX(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),t=e instanceof Error?e.stack:null,n={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return u.createElement(u.Fragment,null,u.createElement("h2",null,"Unexpected Application Error!"),u.createElement("h3",{style:{fontStyle:"italic"}},g),t?u.createElement("pre",{style:n},t):null,null)}const zX=u.createElement(MX,null);class TX extends u.Component{constructor(g){super(g),this.state={location:g.location,revalidation:g.revalidation,error:g.error}}static getDerivedStateFromError(g){return{error:g}}static getDerivedStateFromProps(g,t){return t.location!==g.location||t.revalidation!=="idle"&&g.revalidation==="idle"?{error:g.error,location:g.location,revalidation:g.revalidation}:{error:g.error!==void 0?g.error:t.error,location:t.location,revalidation:g.revalidation||t.revalidation}}componentDidCatch(g,t){console.error("React Router caught the following error during render",g,t)}render(){return this.state.error!==void 0?u.createElement(nl.Provider,{value:this.props.routeContext},u.createElement(UG.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function LX(e){let{routeContext:g,match:t,children:l}=e,n=u.useContext(ZA);return n&&n.static&&n.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=t.route.id),u.createElement(nl.Provider,{value:g},l)}function UX(e,g,t,l){var n;if(g===void 0&&(g=[]),t===void 0&&(t=null),l===void 0&&(l=null),e==null){var I;if((I=t)!=null&&I.errors)e=t.matches;else return null}let o=e,C=(n=t)==null?void 0:n.errors;if(C!=null){let i=o.findIndex(s=>s.route.id&&(C==null?void 0:C[s.route.id]));i>=0||xe(!1),o=o.slice(0,Math.min(o.length,i+1))}let a=!1,r=-1;if(t&&l&&l.v7_partialHydration)for(let i=0;i<o.length;i++){let s=o[i];if((s.route.HydrateFallback||s.route.hydrateFallbackElement)&&(r=i),s.route.id){let{loaderData:c,errors:d}=t,Z=s.route.loader&&c[s.route.id]===void 0&&(!d||d[s.route.id]===void 0);if(s.route.lazy||Z){a=!0,r>=0?o=o.slice(0,r+1):o=[o[0]];break}}}return o.reduceRight((i,s,c)=>{let d,Z=!1,G=null,y=null;t&&(d=C&&s.route.id?C[s.route.id]:void 0,G=s.route.errorElement||zX,a&&(r<0&&c===0?(qX("route-fallback",!1),Z=!0,y=null):r===c&&(Z=!0,y=s.route.hydrateFallbackElement||null)));let p=g.concat(o.slice(0,c+1)),h=()=>{let b;return d?b=G:Z?b=y:s.route.Component?b=u.createElement(s.route.Component,null):s.route.element?b=s.route.element:b=i,u.createElement(LX,{match:s,routeContext:{outlet:i,matches:p,isDataRoute:t!=null},children:b})};return t&&(s.route.ErrorBoundary||s.route.errorElement||c===0)?u.createElement(TX,{location:t.location,revalidation:t.revalidation,component:G,error:d,children:h(),routeContext:{outlet:null,matches:p,isDataRoute:!0}}):h()},null)}var PG=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(PG||{}),Vr=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(Vr||{});function QX(e){let g=u.useContext(ZA);return g||xe(!1),g}function jX(e){let g=u.useContext(HX);return g||xe(!1),g}function PX(e){let g=u.useContext(nl);return g||xe(!1),g}function OG(e){let g=PX(),t=g.matches[g.matches.length-1];return t.route.id||xe(!1),t.route.id}function OX(){var e;let g=u.useContext(UG),t=jX(Vr.UseRouteError),l=OG(Vr.UseRouteError);return g!==void 0?g:(e=t.errors)==null?void 0:e[l]}function $X(){let{router:e}=QX(PG.UseNavigateStable),g=OG(Vr.UseNavigateStable),t=u.useRef(!1);return QG(()=>{t.current=!0}),u.useCallback(function(n,I){I===void 0&&(I={}),t.current&&(typeof n=="number"?e.navigate(n):e.navigate(n,nC({fromRouteId:g},I)))},[e,g])}const Pb={};function qX(e,g,t){!g&&!Pb[e]&&(Pb[e]=!0)}function Wr(e){let{to:g,replace:t,state:l,relative:n}=e;TI()||xe(!1);let{future:I,static:o}=u.useContext(Ul),{matches:C}=u.useContext(nl),{pathname:a}=fC(),r=Il(),i=bA(g,mA(C,I.v7_relativeSplatPath),a,n==="path"),s=JSON.stringify(i);return u.useEffect(()=>r(JSON.parse(s),{replace:t,state:l,relative:n}),[r,s,n,t,l]),null}function hA(e){return xX(e.context)}function it(e){xe(!1)}function _X(e){let{basename:g="/",children:t=null,location:l,navigationType:n=Vl.Pop,navigator:I,static:o=!1,future:C}=e;TI()&&xe(!1);let a=g.replace(/^\/*/,"/"),r=u.useMemo(()=>({basename:a,navigator:I,static:o,future:nC({v7_relativeSplatPath:!1},C)}),[a,C,I,o]);typeof l=="string"&&(l=zI(l));let{pathname:i="/",search:s="",hash:c="",state:d=null,key:Z="default"}=l,G=u.useMemo(()=>{let y=AA(i,a);return y==null?null:{location:{pathname:y,search:s,hash:c,state:d,key:Z},navigationType:n}},[a,i,s,c,d,Z,n]);return G==null?null:u.createElement(Ul.Provider,{value:r},u.createElement(ui.Provider,{children:t,value:G}))}function e2(e){let{children:g,location:t}=e;return EX(yd(g),t)}new Promise(()=>{});function yd(e,g){g===void 0&&(g=[]);let t=[];return u.Children.forEach(e,(l,n)=>{if(!u.isValidElement(l))return;let I=[...g,n];if(l.type===u.Fragment){t.push.apply(t,yd(l.props.children,I));return}l.type!==it&&xe(!1),!l.props.index||!l.props.children||xe(!1);let o={id:l.props.id||I.join("-"),caseSensitive:l.props.caseSensitive,element:l.props.element,Component:l.props.Component,index:l.props.index,path:l.props.path,loader:l.props.loader,action:l.props.action,errorElement:l.props.errorElement,ErrorBoundary:l.props.ErrorBoundary,hasErrorBoundary:l.props.ErrorBoundary!=null||l.props.errorElement!=null,shouldRevalidate:l.props.shouldRevalidate,handle:l.props.handle,lazy:l.props.lazy};l.props.children&&(o.children=yd(l.props.children,I)),t.push(o)}),t}/**
 * React Router DOM v6.22.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Bd(){return Bd=Object.assign?Object.assign.bind():function(e){for(var g=1;g<arguments.length;g++){var t=arguments[g];for(var l in t)Object.prototype.hasOwnProperty.call(t,l)&&(e[l]=t[l])}return e},Bd.apply(this,arguments)}function g2(e,g){if(e==null)return{};var t={},l=Object.keys(e),n,I;for(I=0;I<l.length;I++)n=l[I],!(g.indexOf(n)>=0)&&(t[n]=e[n]);return t}function t2(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function l2(e,g){return e.button===0&&(!g||g==="_self")&&!t2(e)}const n2=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","unstable_viewTransition"],I2="6";try{window.__reactRouterVersion=I2}catch{}const o2="startTransition",Ob=_W[o2];function C2(e){let{basename:g,children:t,future:l,window:n}=e,I=u.useRef();I.current==null&&(I.current=iX({window:n,v5Compat:!0}));let o=I.current,[C,a]=u.useState({action:o.action,location:o.location}),{v7_startTransition:r}=l||{},i=u.useCallback(s=>{r&&Ob?Ob(()=>a(s)):a(s)},[a,r]);return u.useLayoutEffect(()=>o.listen(i),[o,i]),u.createElement(_X,{basename:g,children:t,location:C.location,navigationType:C.action,navigator:o,future:l})}const a2=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",r2=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,po=u.forwardRef(function(g,t){let{onClick:l,relative:n,reloadDocument:I,replace:o,state:C,target:a,to:r,preventScrollReset:i,unstable_viewTransition:s}=g,c=g2(g,n2),{basename:d}=u.useContext(Ul),Z,G=!1;if(typeof r=="string"&&r2.test(r)&&(Z=r,a2))try{let b=new URL(window.location.href),B=r.startsWith("//")?new URL(b.protocol+r):new URL(r),S=AA(B.pathname,d);B.origin===b.origin&&S!=null?r=S+B.search+B.hash:G=!0}catch{}let y=NX(r,{relative:n}),p=i2(r,{replace:o,state:C,target:a,preventScrollReset:i,relative:n,unstable_viewTransition:s});function h(b){l&&l(b),b.defaultPrevented||p(b)}return u.createElement("a",Bd({},c,{href:Z||y,onClick:G||I?l:h,ref:t,target:a}))});var $b;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})($b||($b={}));var qb;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(qb||(qb={}));function i2(e,g){let{target:t,replace:l,state:n,preventScrollReset:I,relative:o,unstable_viewTransition:C}=g===void 0?{}:g,a=Il(),r=fC(),i=jG(e,{relative:o});return u.useCallback(s=>{if(l2(s,t)){s.preventDefault();let c=l!==void 0?l:Sr(r)===Sr(i);a(e,{replace:c,state:n,preventScrollReset:I,relative:o,unstable_viewTransition:C})}},[r,a,i,l,n,t,e,I,o,C])}var fd={},_b=uA;fd.createRoot=_b.createRoot,fd.hydrateRoot=_b.hydrateRoot;var $G={exports:{}},s2="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",c2=s2,d2=c2;function qG(){}function _G(){}_G.resetWarningCache=qG;var u2=function(){function e(l,n,I,o,C,a){if(a!==d2){var r=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw r.name="Invariant Violation",r}}e.isRequired=e;function g(){return e}var t={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:g,element:e,elementType:e,instanceOf:g,node:e,objectOf:g,oneOf:g,oneOfType:g,shape:g,exact:g,checkPropTypes:_G,resetWarningCache:qG};return t.PropTypes=t,t};$G.exports=u2();var pA=$G.exports;const w=ZC(pA),A2=[{id:1,name:"Ruffin HOUNSOUNNON",profile:"/images/image.png",designation:"Backend & Frontend Developer",socials:{portfolio:"",github:"https://github.com/ruffinh22",linkedin:"https://www.linkedin.com/in/ruffin-hounsounnon-359559244/",twitter:"https://twitter.com/ruffinh22"}}],ey=({name:e,profile:g,designation:t,socials:l})=>A.jsxs("div",{className:"bg-white border shadow-lg p-4 rounded-lg flex items-center flex-col gap-y-4",children:[A.jsx("div",{className:"w-full overflow-hidden rounded-md border-2 border-transparent hover:border-blue-400 transition-effect",children:A.jsx("img",{src:g,alt:"profile picture",className:"w-[280px] hover:scale-105 transition-effect"})}),A.jsxs("div",{children:[A.jsx("h2",{className:"text-xl font-semibold text-center mb-1",children:e}),A.jsx("p",{className:"bg-blue-400 px-2 w-fit rounded-md text-primary-white font-medium text-sm",children:t})]}),A.jsx("div",{className:"w-full border-t border-gray-light pt-4 px-4",children:A.jsxs("div",{className:"w-full flex-center gap-6",children:[l.portfolio?A.jsx(po,{to:l.portfolio,target:"_blank",className:"team_card_icon",children:A.jsx("i",{className:"fa-solid fa-briefcase"})}):"",A.jsx(po,{to:l.github,target:"_blank",className:"team_card_icon",children:A.jsx("i",{className:"fa-brands fa-github"})}),A.jsx(po,{to:l.linkedin,target:"_blank",className:"team_card_icon",children:A.jsx("i",{className:"fa-brands fa-linkedin-in"})}),l.twitter?A.jsx(po,{to:l.twitter,target:"_blank",className:"team_card_icon",children:A.jsx("i",{className:"fa-brands fa-twitter"})}):""]})})]});ey.propTypes={name:w.string.isRequired,profile:w.string.isRequired,designation:w.string.isRequired,socials:w.shape({portfolio:w.string,github:w.string.isRequired,linkedin:w.string.isRequired,twitter:w.string}).isRequired};const m2=()=>{const e=A2;return A.jsxs("section",{className:"mt-32 flex-center flex-col",children:[A.jsx("h2",{className:"section_title",children:"Meet ByteBlasters"}),A.jsx("p",{className:"section_subtitle",children:"The one and only force behind development of ezMark from scratch. Recursively testing and upgrading the application for seamless and best user experience."}),A.jsx("div",{className:"w-full mt-10 flex-center max-sm:flex-col gap-y-6 md:gap-x-[15%]",children:e.map(g=>A.jsx(ey,{name:g.name,profile:g.profile,designation:g.designation,socials:g.socials},g.id))})]})},b2=[{id:1,iconClass:"fa-solid fa-desktop",title:"Accessibility",desc:"Easy and hassle-free access via desktop, mobile or desktop."},{id:2,iconClass:"fa-solid fa-cubes-stacked",title:"Features",desc:"Robust features like Geofencing and QR Attendance"},{id:3,iconClass:"fa-solid fa-shield-halved",title:"Security",desc:"From login to your last session, everything is highly secured"},{id:4,iconClass:"fa-solid fa-face-laugh-beam",title:"Minimal UI",desc:"For the aesthetics out there, we provide minimalistic UI/UX"}],gy=({icon:e,title:g,desc:t})=>A.jsxs("div",{className:"md:place-self-center flex-center flex-col border-2 border-transparent gap-y-2 md:w-[500px] bg-white text-primary-black shadow-md p-4 rounded-md text-6xl hover:border-blue-400 transition-effect",children:[A.jsx("i",{className:e}),A.jsx("h1",{className:"text-center text-2xl font-semibold",children:g}),A.jsx("p",{className:"text-center text-base text-gray-dark",children:t})]});gy.propTypes={icon:w.string.isRequired,title:w.string.isRequired,desc:w.string.isRequired};const Z2=()=>A.jsxs("section",{className:"mt-32 flex-center flex-col",children:[A.jsx("h2",{className:"section_title",children:"Key Benefits"}),A.jsx("p",{className:"section_subtitle",children:"Our application provides all the basic to advanced features that will surely increase the user experience. This is the revolution for the physical attendance procedure."}),A.jsx("div",{className:"w-full px-2 gap-y-4 grid-cols-1 md:gap-y-10 grid md:grid-cols-2 mt-10",children:b2.map(e=>A.jsx(gy,{icon:e.iconClass,title:e.title,desc:e.desc},e.id))})]}),h2=()=>A.jsxs("section",{className:"flex-center flex-col",children:[A.jsx("h1",{className:"section_title",children:"Application Glimpse"}),A.jsx("p",{className:"section_subtitle",children:"We designed our UI according to the likings of GenZs, Aesthetic and Minimal."}),A.jsx("img",{src:"/images/hero_image.png",alt:"",className:"mt-10 w-full md:w-[800px]"})]}),p2=()=>{const[e,g]=u.useState(null),t=Il();return u.useEffect(()=>{e==="student"?t("/student/login"):e==="admin"&&t("/admin/login")},[e,t]),A.jsxs("section",{className:"bg_img mb-20 max-sm:px-2 text-primary-black flex flex-col gap-4",children:[A.jsxs("section",{className:"h-screen flex-center flex-col gap-16",children:[A.jsxs("div",{className:"text-sm md:text-base flex-center gap-2 bg-white w-fit py-2 px-2 md:px-3 rounded-lg shadow-md",children:[A.jsx("div",{className:"bg-blue-400 px-2 md:px-4 w-fit rounded-md text-primary-white font-medium",children:"New"}),A.jsx("div",{className:"font-medium",children:"Geofenced Attendance Marking"})]}),A.jsxs("div",{className:"w-full flex-center flex-col gap-y-2",children:[A.jsxs("h1",{className:"text-3xl md:text-6xl md:leading-[1.2] text-center md:tracking-wide font-semibold",children:["Your Instant Solution for ",A.jsx("br",{className:"max-sm:hidden"}),"Attendance & Student Management"]}),A.jsx("p",{className:"w-full md:w-1/2 max-sm:text-sm text-center text-gray-dark md:leading-6",children:"Effortlessly streamlining attendance and student management, making the process hassle-free and highly efficient."})]}),A.jsxs("div",{className:"flex flex-col gap-y-4",children:[A.jsx("h3",{className:"text-center text-lg font-semibold",children:"Login or Register as"}),A.jsxs("div",{className:"flex-center gap-8",children:[A.jsxs("button",{onClick:()=>g("student"),className:"btn rounded-lg gap-1 flex items-center",children:[A.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1,stroke:"currentColor",className:"w-[25px] h-[25px]",children:A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z"})}),A.jsx("h2",{className:"text-center text-lg font-medium",children:"Student"})]}),A.jsxs("button",{onClick:()=>g("admin"),className:"btn_bordered rounded-lg gap-1 flex items-center px-4 py-2",children:[A.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1,stroke:"currentColor",className:"w-[25px] h-[25px]",children:A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 21v-8.25M15.75 21v-8.25M8.25 21v-8.25M3 9l9-6 9 6m-1.5 12V10.332A48.36 48.36 0 0 0 12 9.75c-2.551 0-5.056.2-7.5.582V21M3 21h18M12 6.75h.008v.008H12V6.75Z"})}),A.jsx("h2",{className:"text-center text-lg font-medium",children:"Admin"})]})]})]})]}),A.jsx(h2,{}),A.jsx(Z2,{}),A.jsx(m2,{})]})},GA=({type:e,setType:g,role:t,login:l,setLogin:n,handleLogin:I,register:o,setRegister:C,handleRegistration:a,forgetEmail:r,setForgetEmail:i,handleForgetPassword:s,disable:c})=>{const[d,Z]=u.useState(!1),G=Il();return A.jsxs("div",{className:"w-full max-sm:mx-[2%] md:w-[600px] mx-auto bg-white p-4 md:p-8 rounded-lg shadow-lg text-primary-black font-medium",children:[A.jsx("div",{children:A.jsx("button",{onClick:()=>G(-1),className:"px-2 py-1 rounded-full border-2 text-gray-light border-gray-light hover:border-primary-black hover:text-primary-black transition-effect",children:A.jsx("i",{className:"fa-solid fa-arrow-left-long"})})}),A.jsx("p",{className:"flex-center",children:t==="student"?A.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1,stroke:"currentColor",className:"w-12",children:A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z"})}):A.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1,stroke:"currentColor",className:"w-12",children:A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 21v-8.25M15.75 21v-8.25M8.25 21v-8.25M3 9l9-6 9 6m-1.5 12V10.332A48.36 48.36 0 0 0 12 9.75c-2.551 0-5.056.2-7.5.582V21M3 21h18M12 6.75h.008v.008H12V6.75Z"})})}),e==="login"&&!d?A.jsxs(A.Fragment,{children:[A.jsxs("h1",{className:"text-xl capitalize font-medium text-center mb-4",children:[t," Login"]}),A.jsxs("form",{onSubmit:I,className:"flex flex-col gap-4",children:[A.jsxs("label",{children:[A.jsx("span",{children:"Email"}),A.jsx("input",{id:"email",name:"email",type:"email",value:l.email,onChange:y=>n({...l,email:y.target.value}),placeholder:"Enter your email",required:!0,className:"form_input"})]}),A.jsxs("label",{children:[A.jsx("span",{children:"Password"}),A.jsx("input",{value:l.password,onChange:y=>n({...l,password:y.target.value}),type:"password",placeholder:"Enter your Password",required:!0,className:"form_input"})]}),A.jsx("button",{onClick:()=>Z(!0),className:"underline text-right text-sm text-gray-darker hover:text-primary-black transition-effect",children:"Forgot Password?"}),A.jsx("button",{disabled:c,type:"submit",className:"btn mt-2 bg-primary-black",children:c?"Logging in...":"Login"}),A.jsxs("div",{className:"flex-center gap-1",children:[A.jsx("h1",{children:"Don't have an account ?"}),A.jsx("button",{onClick:()=>g("signup"),className:"underline",children:"Create account"})]})]})]}):d?A.jsxs(A.Fragment,{children:[A.jsxs("h1",{className:"text-xl capitalize font-medium text-center mb-4",children:[t," Forget Password"]}),A.jsxs("form",{onSubmit:s,className:"flex flex-col gap-4",children:[A.jsxs("label",{children:[A.jsx("span",{children:"Registered Email"}),A.jsx("input",{id:"email",name:"email",type:"email",value:r,onChange:y=>i(y.target.value),placeholder:"Enter your email",required:!0,className:"form_input"})]}),A.jsx("button",{type:"submit",className:"btn mt-2 bg-primary-black",children:"Send Reset Link"}),A.jsxs("div",{className:"flex-center gap-1",children:[A.jsx("h1",{children:"Password Remembered ?"}),A.jsx("button",{onClick:()=>Z(!1),className:"underline",children:"Go Back"})]})]})]}):A.jsxs(A.Fragment,{children:[A.jsxs("h1",{className:"text-xl capitalize font-medium text-center mb-4",children:[t," Registration"]}),A.jsxs("form",{onSubmit:a,className:"flex flex-col gap-4",children:[A.jsxs("label",{children:[A.jsx("span",{children:"Name"}),A.jsx("input",{id:"name",name:"name",type:"text",value:o.name,onChange:y=>C({...o,name:y.target.value}),placeholder:"Enter your name",required:!0,className:"form_input"})]}),A.jsxs("label",{children:[A.jsx("span",{children:"Email"}),A.jsx("input",{id:"email",name:"email",type:"email",value:o.email,onChange:y=>C({...o,email:y.target.value}),placeholder:"Enter your email",required:!0,className:"form_input"})]}),A.jsxs("label",{children:[A.jsx("span",{children:"Mobile Number"}),A.jsx("input",{id:"mobileNum",name:"mobileNum",type:"number",value:o.mobile_number,onChange:y=>C({...o,mobile_number:y.target.value}),placeholder:"Enter your mobile number",required:!0,className:"form_input"})]}),A.jsxs("div",{className:"md:flex gap-5 justify-between items-center mb-3",children:[A.jsxs("label",{className:"md:w-1/2",children:[A.jsx("span",{children:"Password"}),A.jsx("input",{value:o.password,onChange:y=>C({...o,password:y.target.value}),type:"password",placeholder:"Enter your Password",required:!0,className:"form_input"})]}),A.jsxs("label",{className:"md:w-1/2",children:[A.jsx("span",{children:"Confirm Password"}),A.jsx("input",{value:o.password2,onChange:y=>C({...o,password2:y.target.value}),type:"password",placeholder:"Enter your Password",required:!0,className:"form_input"})]})]}),A.jsx("button",{disabled:c,type:"submit",className:"btn bg-primary-black",children:c?"Registering...":"Register"}),A.jsxs("div",{className:"flex-center gap-1",children:[A.jsx("h1",{children:"Already have an account ? "}),A.jsx("button",{onClick:()=>g("login"),className:"underline text-right text-primary-black",children:"Login"})]})]})]})]})};GA.propTypes={type:w.string.isRequired,setType:w.func.isRequired,role:w.string.isRequired,login:w.object.isRequired,setLogin:w.func.isRequired,handleLogin:w.func.isRequired,register:w.object.isRequired,setRegister:w.func.isRequired,handleRegistration:w.func.isRequired,forgetEmail:w.string.isRequired,setForgetEmail:w.func.isRequired,handleForgetPassword:w.func.isRequired,disable:w.bool.isRequired};class Go extends Error{}Go.prototype.name="InvalidTokenError";function G2(e){return decodeURIComponent(atob(e).replace(/(.)/g,(g,t)=>{let l=t.charCodeAt(0).toString(16).toUpperCase();return l.length<2&&(l="0"+l),"%"+l}))}function y2(e){let g=e.replace(/-/g,"+").replace(/_/g,"/");switch(g.length%4){case 0:break;case 2:g+="==";break;case 3:g+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return G2(g)}catch{return atob(g)}}function B2(e,g){if(typeof e!="string")throw new Go("Invalid token specified: must be a string");g||(g={});const t=g.header===!0?0:1,l=e.split(".")[t];if(typeof l!="string")throw new Go(`Invalid token specified: missing part #${t+1}`);let n;try{n=y2(l)}catch(I){throw new Go(`Invalid token specified: invalid base64 for part #${t+1} (${I.message})`)}try{return JSON.parse(n)}catch(I){throw new Go(`Invalid token specified: invalid json for part #${t+1} (${I.message})`)}}let f2={data:""},S2=e=>typeof window=="object"?((e?e.querySelector("#_goober"):window._goober)||Object.assign((e||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:e||f2,V2=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,W2=/\/\*[^]*?\*\/|  +/g,eZ=/\n+/g,yl=(e,g)=>{let t="",l="",n="";for(let I in e){let o=e[I];I[0]=="@"?I[1]=="i"?t=I+" "+o+";":l+=I[1]=="f"?yl(o,I):I+"{"+yl(o,I[1]=="k"?"":g)+"}":typeof o=="object"?l+=yl(o,g?g.replace(/([^,])+/g,C=>I.replace(/(^:.*)|([^,])+/g,a=>/&/.test(a)?a.replace(/&/g,C):C?C+" "+a:a)):I):o!=null&&(I=/^--/.test(I)?I:I.replace(/[A-Z]/g,"-$&").toLowerCase(),n+=yl.p?yl.p(I,o):I+":"+o+";")}return t+(g&&n?g+"{"+n+"}":n)+l},Ht={},ty=e=>{if(typeof e=="object"){let g="";for(let t in e)g+=t+ty(e[t]);return g}return e},v2=(e,g,t,l,n)=>{let I=ty(e),o=Ht[I]||(Ht[I]=(a=>{let r=0,i=11;for(;r<a.length;)i=101*i+a.charCodeAt(r++)>>>0;return"go"+i})(I));if(!Ht[o]){let a=I!==e?e:(r=>{let i,s,c=[{}];for(;i=V2.exec(r.replace(W2,""));)i[4]?c.shift():i[3]?(s=i[3].replace(eZ," ").trim(),c.unshift(c[0][s]=c[0][s]||{})):c[0][i[1]]=i[2].replace(eZ," ").trim();return c[0]})(e);Ht[o]=yl(n?{["@keyframes "+o]:a}:a,t?"":"."+o)}let C=t&&Ht.g?Ht.g:null;return t&&(Ht.g=Ht[o]),((a,r,i,s)=>{s?r.data=r.data.replace(s,a):r.data.indexOf(a)===-1&&(r.data=i?a+r.data:r.data+a)})(Ht[o],g,l,C),o},R2=(e,g,t)=>e.reduce((l,n,I)=>{let o=g[I];if(o&&o.call){let C=o(t),a=C&&C.props&&C.props.className||/^go/.test(C)&&C;o=a?"."+a:C&&typeof C=="object"?C.props?"":yl(C,""):C===!1?"":C}return l+n+(o??"")},"");function Ai(e){let g=this||{},t=e.call?e(g.p):e;return v2(t.unshift?t.raw?R2(t,[].slice.call(arguments,1),g.p):t.reduce((l,n)=>Object.assign(l,n&&n.call?n(g.p):n),{}):t,S2(g.target),g.g,g.o,g.k)}let ly,Sd,Vd;Ai.bind({g:1});let el=Ai.bind({k:1});function X2(e,g,t,l){yl.p=g,ly=e,Sd=t,Vd=l}function Ql(e,g){let t=this||{};return function(){let l=arguments;function n(I,o){let C=Object.assign({},I),a=C.className||n.className;t.p=Object.assign({theme:Sd&&Sd()},C),t.o=/ *go\d+/.test(a),C.className=Ai.apply(t,l)+(a?" "+a:""),g&&(C.ref=o);let r=e;return e[0]&&(r=C.as||e,delete C.as),Vd&&r[0]&&Vd(C),ly(r,C)}return g?g(n):n}}var k2=e=>typeof e=="function",vr=(e,g)=>k2(e)?e(g):e,J2=(()=>{let e=0;return()=>(++e).toString()})(),ny=(()=>{let e;return()=>{if(e===void 0&&typeof window<"u"){let g=matchMedia("(prefers-reduced-motion: reduce)");e=!g||g.matches}return e}})(),Y2=20,Ua=new Map,w2=1e3,gZ=e=>{if(Ua.has(e))return;let g=setTimeout(()=>{Ua.delete(e),Jn({type:4,toastId:e})},w2);Ua.set(e,g)},H2=e=>{let g=Ua.get(e);g&&clearTimeout(g)},Wd=(e,g)=>{switch(g.type){case 0:return{...e,toasts:[g.toast,...e.toasts].slice(0,Y2)};case 1:return g.toast.id&&H2(g.toast.id),{...e,toasts:e.toasts.map(I=>I.id===g.toast.id?{...I,...g.toast}:I)};case 2:let{toast:t}=g;return e.toasts.find(I=>I.id===t.id)?Wd(e,{type:1,toast:t}):Wd(e,{type:0,toast:t});case 3:let{toastId:l}=g;return l?gZ(l):e.toasts.forEach(I=>{gZ(I.id)}),{...e,toasts:e.toasts.map(I=>I.id===l||l===void 0?{...I,visible:!1}:I)};case 4:return g.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(I=>I.id!==g.toastId)};case 5:return{...e,pausedAt:g.time};case 6:let n=g.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map(I=>({...I,pauseDuration:I.pauseDuration+n}))}}},Qa=[],ja={toasts:[],pausedAt:void 0},Jn=e=>{ja=Wd(ja,e),Qa.forEach(g=>{g(ja)})},N2={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},K2=(e={})=>{let[g,t]=u.useState(ja);u.useEffect(()=>(Qa.push(t),()=>{let n=Qa.indexOf(t);n>-1&&Qa.splice(n,1)}),[g]);let l=g.toasts.map(n=>{var I,o;return{...e,...e[n.type],...n,duration:n.duration||((I=e[n.type])==null?void 0:I.duration)||(e==null?void 0:e.duration)||N2[n.type],style:{...e.style,...(o=e[n.type])==null?void 0:o.style,...n.style}}});return{...g,toasts:l}},F2=(e,g="blank",t)=>({createdAt:Date.now(),visible:!0,type:g,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...t,id:(t==null?void 0:t.id)||J2()}),SC=e=>(g,t)=>{let l=F2(g,e,t);return Jn({type:2,toast:l}),l.id},se=(e,g)=>SC("blank")(e,g);se.error=SC("error");se.success=SC("success");se.loading=SC("loading");se.custom=SC("custom");se.dismiss=e=>{Jn({type:3,toastId:e})};se.remove=e=>Jn({type:4,toastId:e});se.promise=(e,g,t)=>{let l=se.loading(g.loading,{...t,...t==null?void 0:t.loading});return e.then(n=>(se.success(vr(g.success,n),{id:l,...t,...t==null?void 0:t.success}),n)).catch(n=>{se.error(vr(g.error,n),{id:l,...t,...t==null?void 0:t.error})}),e};var x2=(e,g)=>{Jn({type:1,toast:{id:e,height:g}})},E2=()=>{Jn({type:5,time:Date.now()})},D2=e=>{let{toasts:g,pausedAt:t}=K2(e);u.useEffect(()=>{if(t)return;let I=Date.now(),o=g.map(C=>{if(C.duration===1/0)return;let a=(C.duration||0)+C.pauseDuration-(I-C.createdAt);if(a<0){C.visible&&se.dismiss(C.id);return}return setTimeout(()=>se.dismiss(C.id),a)});return()=>{o.forEach(C=>C&&clearTimeout(C))}},[g,t]);let l=u.useCallback(()=>{t&&Jn({type:6,time:Date.now()})},[t]),n=u.useCallback((I,o)=>{let{reverseOrder:C=!1,gutter:a=8,defaultPosition:r}=o||{},i=g.filter(d=>(d.position||r)===(I.position||r)&&d.height),s=i.findIndex(d=>d.id===I.id),c=i.filter((d,Z)=>Z<s&&d.visible).length;return i.filter(d=>d.visible).slice(...C?[c+1]:[0,c]).reduce((d,Z)=>d+(Z.height||0)+a,0)},[g]);return{toasts:g,handlers:{updateHeight:x2,startPause:E2,endPause:l,calculateOffset:n}}},M2=el`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,z2=el`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,T2=el`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,L2=Ql("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${M2} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${z2} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${e=>e.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${T2} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,U2=el`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,Q2=Ql("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${e=>e.secondary||"#e0e0e0"};
  border-right-color: ${e=>e.primary||"#616161"};
  animation: ${U2} 1s linear infinite;
`,j2=el`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,P2=el`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,O2=Ql("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${j2} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${P2} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${e=>e.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,$2=Ql("div")`
  position: absolute;
`,q2=Ql("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,_2=el`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,ek=Ql("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${_2} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,gk=({toast:e})=>{let{icon:g,type:t,iconTheme:l}=e;return g!==void 0?typeof g=="string"?u.createElement(ek,null,g):g:t==="blank"?null:u.createElement(q2,null,u.createElement(Q2,{...l}),t!=="loading"&&u.createElement($2,null,t==="error"?u.createElement(L2,{...l}):u.createElement(O2,{...l})))},tk=e=>`
0% {transform: translate3d(0,${e*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,lk=e=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${e*-150}%,-1px) scale(.6); opacity:0;}
`,nk="0%{opacity:0;} 100%{opacity:1;}",Ik="0%{opacity:1;} 100%{opacity:0;}",ok=Ql("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,Ck=Ql("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,ak=(e,g)=>{let t=e.includes("top")?1:-1,[l,n]=ny()?[nk,Ik]:[tk(t),lk(t)];return{animation:g?`${el(l)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${el(n)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},rk=u.memo(({toast:e,position:g,style:t,children:l})=>{let n=e.height?ak(e.position||g||"top-center",e.visible):{opacity:0},I=u.createElement(gk,{toast:e}),o=u.createElement(Ck,{...e.ariaProps},vr(e.message,e));return u.createElement(ok,{className:e.className,style:{...n,...t,...e.style}},typeof l=="function"?l({icon:I,message:o}):u.createElement(u.Fragment,null,I,o))});X2(u.createElement);var ik=({id:e,className:g,style:t,onHeightUpdate:l,children:n})=>{let I=u.useCallback(o=>{if(o){let C=()=>{let a=o.getBoundingClientRect().height;l(e,a)};C(),new MutationObserver(C).observe(o,{subtree:!0,childList:!0,characterData:!0})}},[e,l]);return u.createElement("div",{ref:I,className:g,style:t},n)},sk=(e,g)=>{let t=e.includes("top"),l=t?{top:0}:{bottom:0},n=e.includes("center")?{justifyContent:"center"}:e.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:ny()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${g*(t?1:-1)}px)`,...l,...n}},ck=Ai`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,ia=16,dk=({reverseOrder:e,position:g="top-center",toastOptions:t,gutter:l,children:n,containerStyle:I,containerClassName:o})=>{let{toasts:C,handlers:a}=D2(t);return u.createElement("div",{style:{position:"fixed",zIndex:9999,top:ia,left:ia,right:ia,bottom:ia,pointerEvents:"none",...I},className:o,onMouseEnter:a.startPause,onMouseLeave:a.endPause},C.map(r=>{let i=r.position||g,s=a.calculateOffset(r,{reverseOrder:e,gutter:l,defaultPosition:g}),c=sk(i,s);return u.createElement(ik,{id:r.id,key:r.id,onHeightUpdate:a.updateHeight,className:r.visible?ck:"",style:c},r.type==="custom"?vr(r.message,r):n?n(r):u.createElement(rk,{toast:r,position:i}))}))},et=se;const LI="https://attendance-manag-stud.onrender.com",Iy=({access:e,refresh:g})=>{localStorage.setItem("access_token",e),localStorage.setItem("refresh_token",g)},uk=e=>{localStorage.setItem("role",e)},ke=()=>localStorage.getItem("access_token"),Ak=()=>localStorage.getItem("refresh_token"),oy=()=>localStorage.getItem("role"),mk=()=>{localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),localStorage.removeItem("role")},lt=async e=>{if(!e.ok){const g=await e.json();console.log(g.error);const t=()=>{var o;const I=((o=g.errors)==null?void 0:o.non_field_errors)||[];if(I.length>0){const C=I[0],a={"Password and Confirm Password don't match":"Confirm Password didn't Match","You are not a Registered User":"Email not registered","Email or Password is not Valid":"Invalid Credentials"};se.error(a[C]||"")}},l=()=>{var o,C;const I=(C=(o=g.errors)==null?void 0:o.email)==null?void 0:C[0];if(I){const a={"user with this Email already exists.":"User Already Exists"};se.error(a[I]||"")}},n=()=>{const I=g.error;if(I){const o={"Invalid QR code data.":"QR Code Expired","Device is outside from geofence location":"Device is not in Range","Attendance already marked for today.":"Attendance Already Marked","Device Error":"Device Error"};se.error(o[I]||I)}};t(),l(),n()}},Cy=async(e,g)=>{console.log(e);try{const t=await fetch(`${LI}/register/${g}/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(t.ok)return se.success(g==="admin"?"Registration Done!":"Registration Pending for Approval"),(await t.json()).token;await lt(t)}catch(t){console.error(t)}},ay=async(e,g)=>{try{const t=await fetch(`${LI}/login/${g}/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(t.ok){uk(g),se.success("Login Success!");const l=await t.json();return Iy({access:l.token.access,refresh:l.token.refresh}),l.token}else await lt(t)}catch(t){console.error(t)}},ry=async(e,g)=>{const t=se.loading("Loading...");try{const l=await fetch(`${LI}/reset/password/${g}/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e})});if(l.ok){se.dismiss(t),localStorage.setItem("forgetRole",g),se.success("Link sent on Registered Email");const n=await l.json();g==="admin"?localStorage.setItem("forgetToken",n.reset_link.substring(41,n.reset_link.length)):localStorage.setItem("forgetToken",n.reset_link.substring(49,n.reset_link.length))}else se.dismiss(t),await lt(l)}catch(l){console.error(l)}},bk=async e=>{const g=se.loading("Loading...");try{const t=await fetch(`${LI}/reset-password-admin/${localStorage.getItem("forgetToken")}/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(t.ok){se.dismiss(g),se.success("Password Reset successful");const l=await t.json();return localStorage.removeItem("forgetToken"),localStorage.removeItem("forgetRole"),l}else await lt(t)}catch(t){console.error(t)}},Zk=async e=>{const g=se.loading("Loading...");try{const t=await fetch(`${LI}/reset-password-student/${localStorage.getItem("forgetToken")}/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(t.ok){se.dismiss(g),se.success("Password Reset successful");const l=await t.json();return localStorage.removeItem("forgetToken"),localStorage.removeItem("forgetRole"),l}else await lt(t)}catch(t){console.error(t)}},hk=()=>{mk(),localStorage.removeItem("forgetToken"),localStorage.removeItem("forgetRole"),se.success("Logged out!")},iy=()=>!!ke()&&oy()==="admin",sy=()=>!!ke()&&oy()==="student",ol=async()=>{if(!Jt())try{const e=Ak(),g=await fetch(`${LI}/token/refresh/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refresh:e})});if(g.ok){const{access:t}=await g.json();return Iy({access:t,refresh:e}),t}else return await lt(g),null}catch(e){return console.error("Token refresh failed:",e),null}return ke()},Jt=()=>{const e=ke();if(!e)return!1;try{const g=B2(e),t=Date.now()/1e3;return g.exp>t}catch(g){return console.error("Error decoding access token:",g),!1}},pk=()=>{const e="admin",[g,t]=u.useState({email:"",password:""}),[l,n]=u.useState("login"),[I,o]=u.useState(!1),[C,a]=u.useState(""),r=Il(),[i,s]=u.useState({name:"",email:"",mobile_number:"",password:"",password2:""}),c=async G=>{if(G.preventDefault(),o(!0),g){const y=await ay(g,e);o(!1),y&&r("/admin/dashboard")}},d=async G=>{G.preventDefault(),o(!0),i&&(await Cy(i,e),o(!1)),s({email:"",name:"",mobile_number:"",password:"",password2:""}),n("login")},Z=async G=>{G.preventDefault(),await ry(C,e)};return A.jsx("section",{className:"h-screen flex-center",children:A.jsx(GA,{type:l,setType:n,role:"admin",login:g,setLogin:t,handleLogin:c,register:i,setRegister:s,handleRegistration:d,forgetEmail:C,setForgetEmail:a,handleForgetPassword:Z,disable:I})})},Gk=()=>{const e="student",[g,t]=u.useState({email:"",password:""}),[l,n]=u.useState("login"),[I,o]=u.useState(!1),[C,a]=u.useState(""),r=Il(),[i,s]=u.useState({email:"",name:"",mobile_number:"",password:"",password2:""}),c=async G=>{if(G.preventDefault(),o(!0),g){const y=await ay(g,e);o(!1),y&&r("/student/dashboard")}},d=async G=>{G.preventDefault(),o(!0),i&&(await Cy(i,e),o(!1)),s({email:"",name:"",mobile_number:"",password:"",password2:""})},Z=async G=>{G.preventDefault(),await ry(C,e)};return A.jsx("section",{className:"h-screen flex-center",children:A.jsx(GA,{type:l,setType:n,role:"student",login:g,setLogin:t,handleLogin:c,register:i,setRegister:s,handleRegistration:d,forgetEmail:C,setForgetEmail:a,handleForgetPassword:Z,disable:I})})},Rr={prefix:String(Math.round(Math.random()*1e10)),current:0},cy=D.createContext(Rr),yk=D.createContext(!1);let Bk=!!(typeof window<"u"&&window.document&&window.document.createElement),Qs=new WeakMap;function fk(e=!1){let g=u.useContext(cy),t=u.useRef(null);if(t.current===null&&!e){var l,n;let I=(n=D.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED)===null||n===void 0||(l=n.ReactCurrentOwner)===null||l===void 0?void 0:l.current;if(I){let o=Qs.get(I);o==null?Qs.set(I,{id:g.current,state:I.memoizedState}):I.memoizedState!==o.state&&(g.current=o.id,Qs.delete(I))}t.current=++g.current}return t.current}function Sk(e){let g=u.useContext(cy);g===Rr&&!Bk&&console.warn("When server rendering, you must wrap your application in an <SSRProvider> to ensure consistent ids are generated between the client and server.");let t=fk(!!e),l=`react-aria${g.prefix}`;return e||`${l}-${t}`}function Vk(e){let g=D.useId(),[t]=u.useState(mi()),l=t?"react-aria":`react-aria${Rr.prefix}`;return e||`${l}-${g}`}const Wk=typeof D.useId=="function"?Vk:Sk;function vk(){return!1}function Rk(){return!0}function Xk(e){return()=>{}}function mi(){return typeof D.useSyncExternalStore=="function"?D.useSyncExternalStore(Xk,vk,Rk):u.useContext(yk)}const kk=Symbol.for("react-aria.i18n.locale"),Jk=Symbol.for("react-aria.i18n.strings");let Tn;class bi{getStringForLocale(g,t){let n=this.getStringsForLocale(t)[g];if(!n)throw new Error(`Could not find intl message ${g} in ${t} locale`);return n}getStringsForLocale(g){let t=this.strings[g];return t||(t=Yk(g,this.strings,this.defaultLocale),this.strings[g]=t),t}static getGlobalDictionaryForPackage(g){if(typeof window>"u")return null;let t=window[kk];if(Tn===void 0){let n=window[Jk];if(!n)return null;Tn={};for(let I in n)Tn[I]=new bi({[t]:n[I]},t)}let l=Tn==null?void 0:Tn[g];if(!l)throw new Error(`Strings for package "${g}" were not included by LocalizedStringProvider. Please add it to the list passed to createLocalizedStringDictionary.`);return l}constructor(g,t="en-US"){this.strings={...g},this.defaultLocale=t}}function Yk(e,g,t="en-US"){if(g[e])return g[e];let l=wk(e);if(g[l])return g[l];for(let n in g)if(n.startsWith(l+"-"))return g[n];return g[t]}function wk(e){return Intl.Locale?new Intl.Locale(e).language:e.split("-")[0]}const tZ=new Map,lZ=new Map;class Hk{format(g,t){let l=this.strings.getStringForLocale(g,this.locale);return typeof l=="function"?l(t,this):l}plural(g,t,l="cardinal"){let n=t["="+g];if(n)return typeof n=="function"?n():n;let I=this.locale+":"+l,o=tZ.get(I);o||(o=new Intl.PluralRules(this.locale,{type:l}),tZ.set(I,o));let C=o.select(g);return n=t[C]||t.other,typeof n=="function"?n():n}number(g){let t=lZ.get(this.locale);return t||(t=new Intl.NumberFormat(this.locale),lZ.set(this.locale,t)),t.format(g)}select(g,t){let l=g[t]||g.other;return typeof l=="function"?l():l}constructor(g,t){this.locale=g,this.strings=t}}function Nk(e,g){if(g.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Kk(e,g,t){Nk(e,g),g.set(e,t)}function VC(e,g,t){let[l,n]=u.useState(e||g),I=u.useRef(e!==void 0),o=e!==void 0;u.useEffect(()=>{let r=I.current;r!==o&&console.warn(`WARN: A component changed from ${r?"controlled":"uncontrolled"} to ${o?"controlled":"uncontrolled"}.`),I.current=o},[o]);let C=o?e:l,a=u.useCallback((r,...i)=>{let s=(c,...d)=>{t&&(Object.is(C,c)||t(c,...d)),o||(C=c)};typeof r=="function"?(console.warn("We can not support a function callback. See Github Issues for details https://github.com/adobe/react-spectrum/issues/2320"),n((d,...Z)=>{let G=r(o?C:d,...Z);return s(G,...i),o?d:G})):(o||n(r),s(r,...i))},[o,C,t]);return[C,a]}function dy(e){var g,t,l="";if(typeof e=="string"||typeof e=="number")l+=e;else if(typeof e=="object")if(Array.isArray(e)){var n=e.length;for(g=0;g<n;g++)e[g]&&(t=dy(e[g]))&&(l&&(l+=" "),l+=t)}else for(t in e)e[t]&&(l&&(l+=" "),l+=t);return l}function WC(){for(var e,g,t=0,l="",n=arguments.length;t<n;t++)(e=arguments[t])&&(g=dy(e))&&(l&&(l+=" "),l+=g);return l}const Le=typeof document<"u"?D.useLayoutEffect:()=>{};function Te(e){const g=u.useRef(null);return Le(()=>{g.current=e},[e]),u.useCallback((...t)=>{const l=g.current;return l==null?void 0:l(...t)},[])}function Fk(e){let[g,t]=u.useState(e),l=u.useRef(null),n=Te(()=>{if(!l.current)return;let o=l.current.next();if(o.done){l.current=null;return}g===o.value?n():t(o.value)});Le(()=>{l.current&&n()});let I=Te(o=>{l.current=o(g),n()});return[g,I]}let xk=!!(typeof window<"u"&&window.document&&window.document.createElement),Xr=new Map;function Wn(e){let[g,t]=u.useState(e),l=u.useRef(null),n=Wk(g),I=u.useCallback(o=>{l.current=o},[]);return xk&&Xr.set(n,I),Le(()=>{let o=n;return()=>{Xr.delete(o)}},[n]),u.useEffect(()=>{let o=l.current;o&&(l.current=null,t(o))}),n}function Ek(e,g){if(e===g)return e;let t=Xr.get(e);if(t)return t(g),g;let l=Xr.get(g);return l?(l(e),e):g}function nZ(e=[]){let g=Wn(),[t,l]=Fk(g),n=u.useCallback(()=>{l(function*(){yield g,yield document.getElementById(g)?g:void 0})},[g,l]);return Le(n,[g,n,...e]),t}function UI(...e){return(...g)=>{for(let t of e)typeof t=="function"&&t(...g)}}const Be=e=>{var g;return(g=e==null?void 0:e.ownerDocument)!==null&&g!==void 0?g:document},$g=e=>e&&"window"in e&&e.window===e?e:Be(e).defaultView||window;function _(...e){let g={...e[0]};for(let t=1;t<e.length;t++){let l=e[t];for(let n in l){let I=g[n],o=l[n];typeof I=="function"&&typeof o=="function"&&n[0]==="o"&&n[1]==="n"&&n.charCodeAt(2)>=65&&n.charCodeAt(2)<=90?g[n]=UI(I,o):(n==="className"||n==="UNSAFE_className")&&typeof I=="string"&&typeof o=="string"?g[n]=WC(I,o):n==="id"&&I&&o?g.id=Ek(I,o):g[n]=o!==void 0?o:I}}return g}function Dk(...e){return e.length===1?e[0]:g=>{for(let t of e)typeof t=="function"?t(g):t!=null&&(t.current=g)}}const Mk=new Set(["id"]),zk=new Set(["aria-label","aria-labelledby","aria-describedby","aria-details"]),Tk=new Set(["href","target","rel","download","ping","referrerPolicy"]),Lk=/^(data-.*)$/;function Zi(e,g={}){let{labelable:t,isLink:l,propNames:n}=g,I={};for(const o in e)Object.prototype.hasOwnProperty.call(e,o)&&(Mk.has(o)||t&&zk.has(o)||l&&Tk.has(o)||n!=null&&n.has(o)||Lk.test(o))&&(I[o]=e[o]);return I}function Yg(e){if(Uk())e.focus({preventScroll:!0});else{let g=Qk(e);e.focus(),jk(g)}}let sa=null;function Uk(){if(sa==null){sa=!1;try{document.createElement("div").focus({get preventScroll(){return sa=!0,!0}})}catch{}}return sa}function Qk(e){let g=e.parentNode,t=[],l=document.scrollingElement||document.documentElement;for(;g instanceof HTMLElement&&g!==l;)(g.offsetHeight<g.scrollHeight||g.offsetWidth<g.scrollWidth)&&t.push({element:g,scrollTop:g.scrollTop,scrollLeft:g.scrollLeft}),g=g.parentNode;return l instanceof HTMLElement&&t.push({element:l,scrollTop:l.scrollTop,scrollLeft:l.scrollLeft}),t}function jk(e){for(let{element:g,scrollTop:t,scrollLeft:l}of e)g.scrollTop=t,g.scrollLeft=l}function hi(e){var g;return typeof window>"u"||window.navigator==null?!1:((g=window.navigator.userAgentData)===null||g===void 0?void 0:g.brands.some(t=>e.test(t.brand)))||e.test(window.navigator.userAgent)}function yA(e){var g;return typeof window<"u"&&window.navigator!=null?e.test(((g=window.navigator.userAgentData)===null||g===void 0?void 0:g.platform)||window.navigator.platform):!1}function El(){return yA(/^Mac/i)}function Pk(){return yA(/^iPhone/i)}function uy(){return yA(/^iPad/i)||El()&&navigator.maxTouchPoints>1}function vC(){return Pk()||uy()}function Ok(){return El()||vC()}function $k(){return hi(/AppleWebKit/i)&&!qk()}function qk(){return hi(/Chrome/i)}function kr(){return hi(/Android/i)}function _k(){return hi(/Firefox/i)}const Ay=u.createContext({isNative:!0,open:gJ});function eJ(e){let{children:g,navigate:t}=e,l=u.useMemo(()=>({isNative:!1,open:(n,I)=>{by(n,o=>{my(o,I)?t(o.pathname+o.search+o.hash):kt(o,I)})}}),[t]);return D.createElement(Ay.Provider,{value:l},g)}function BA(){return u.useContext(Ay)}function my(e,g){let t=e.getAttribute("target");return(!t||t==="_self")&&e.origin===location.origin&&!e.hasAttribute("download")&&!g.metaKey&&!g.ctrlKey&&!g.altKey&&!g.shiftKey}function kt(e,g,t=!0){var l,n;let{metaKey:I,ctrlKey:o,altKey:C,shiftKey:a}=g;_k()&&(!((n=window.event)===null||n===void 0||(l=n.type)===null||l===void 0)&&l.startsWith("key"))&&e.target==="_blank"&&(El()?I=!0:o=!0);let r=$k()&&El()&&!uy()?new KeyboardEvent("keydown",{keyIdentifier:"Enter",metaKey:I,ctrlKey:o,altKey:C,shiftKey:a}):new MouseEvent("click",{metaKey:I,ctrlKey:o,altKey:C,shiftKey:a,bubbles:!0,cancelable:!0});kt.isOpening=t,Yg(e),e.dispatchEvent(r),kt.isOpening=!1}kt.isOpening=!1;function by(e,g){if(e instanceof HTMLAnchorElement)g(e);else if(e.hasAttribute("data-href")){let t=document.createElement("a");t.href=e.getAttribute("data-href"),e.hasAttribute("data-target")&&(t.target=e.getAttribute("data-target")),e.hasAttribute("data-rel")&&(t.rel=e.getAttribute("data-rel")),e.hasAttribute("data-download")&&(t.download=e.getAttribute("data-download")),e.hasAttribute("data-ping")&&(t.ping=e.getAttribute("data-ping")),e.hasAttribute("data-referrer-policy")&&(t.referrerPolicy=e.getAttribute("data-referrer-policy")),e.appendChild(t),g(t),e.removeChild(t)}}function gJ(e,g){by(e,t=>kt(t,g))}function tJ(e){return{"data-href":e.href,"data-target":e.target,"data-rel":e.rel,"data-download":e.download,"data-ping":e.ping,"data-referrer-policy":e.referrerPolicy}}let On=new Map,vd=new Set;function IZ(){if(typeof window>"u")return;function e(l){return"propertyName"in l}let g=l=>{if(!e(l)||!l.target)return;let n=On.get(l.target);n||(n=new Set,On.set(l.target,n),l.target.addEventListener("transitioncancel",t,{once:!0})),n.add(l.propertyName)},t=l=>{if(!e(l)||!l.target)return;let n=On.get(l.target);if(n&&(n.delete(l.propertyName),n.size===0&&(l.target.removeEventListener("transitioncancel",t),On.delete(l.target)),On.size===0)){for(let I of vd)I();vd.clear()}};document.body.addEventListener("transitionrun",g),document.body.addEventListener("transitionend",t)}typeof document<"u"&&(document.readyState!=="loading"?IZ():document.addEventListener("DOMContentLoaded",IZ));function fA(e){requestAnimationFrame(()=>{On.size===0?e():vd.add(e)})}function SA(){let e=u.useRef(new Map),g=u.useCallback((n,I,o,C)=>{let a=C!=null&&C.once?(...r)=>{e.current.delete(o),o(...r)}:o;e.current.set(o,{type:I,eventTarget:n,fn:a,options:C}),n.addEventListener(I,o,C)},[]),t=u.useCallback((n,I,o,C)=>{var a;let r=((a=e.current.get(o))===null||a===void 0?void 0:a.fn)||o;n.removeEventListener(I,r,C),e.current.delete(o)},[]),l=u.useCallback(()=>{e.current.forEach((n,I)=>{t(n.eventTarget,n.type,I,n.options)})},[t]);return u.useEffect(()=>l,[l]),{addGlobalListener:g,removeGlobalListener:t,removeAllGlobalListeners:l}}function lJ(e,g){let{id:t,"aria-label":l,"aria-labelledby":n}=e;return t=Wn(t),n&&l?n=[...new Set([t,...n.trim().split(/\s+/)])].join(" "):n&&(n=n.trim().split(/\s+/).join(" ")),!l&&!n&&g&&(l=g),{id:t,"aria-label":l,"aria-labelledby":n}}function Zy(e,g){const t=u.useRef(!0),l=u.useRef(null);u.useEffect(()=>(t.current=!0,()=>{t.current=!1}),[]),u.useEffect(()=>{t.current?t.current=!1:(!l.current||g.some((n,I)=>!Object.is(n,l[I])))&&e(),l.current=g},g)}function VA(e,g){Le(()=>{if(e&&e.ref&&g)return e.ref.current=g.current,()=>{e.ref&&(e.ref.current=null)}})}function ml(e,g){let t=e;for(oZ(t,g)&&(t=t.parentElement);t&&!oZ(t,g);)t=t.parentElement;return t||document.scrollingElement||document.documentElement}function oZ(e,g){let t=window.getComputedStyle(e),l=/(auto|scroll)/.test(t.overflow+t.overflowX+t.overflowY);return l&&g&&(l=e.scrollHeight!==e.clientHeight||e.scrollWidth!==e.clientWidth),l}let nJ=0;const js=new Map;function pi(e){let[g,t]=u.useState();return Le(()=>{if(!e)return;let l=js.get(e);if(l)t(l.element.id);else{let n=`react-aria-description-${nJ++}`;t(n);let I=document.createElement("div");I.id=n,I.style.display="none",I.textContent=e,document.body.appendChild(I),l={refCount:0,element:I},js.set(e,l)}return l.refCount++,()=>{l&&--l.refCount===0&&(l.element.remove(),js.delete(e))}},[e]),{"aria-describedby":e?g:void 0}}function IJ(e,g,t,l){let n=Te(t),I=t==null;u.useEffect(()=>{if(I||!e.current)return;let o=e.current;return o.addEventListener(g,n,l),()=>{o.removeEventListener(g,n,l)}},[e,g,l,I,n])}function hy(e,g){let t=CZ(e,g,"left"),l=CZ(e,g,"top"),n=g.offsetWidth,I=g.offsetHeight,o=e.scrollLeft,C=e.scrollTop,{borderTopWidth:a,borderLeftWidth:r}=getComputedStyle(e),i=e.scrollLeft+parseInt(r,10),s=e.scrollTop+parseInt(a,10),c=i+e.clientWidth,d=s+e.clientHeight;t<=o?o=t-parseInt(r,10):t+n>c&&(o+=t+n-c),l<=s?C=l-parseInt(a,10):l+I>d&&(C+=l+I-d),e.scrollLeft=o,e.scrollTop=C}function CZ(e,g,t){const l=t==="left"?"offsetLeft":"offsetTop";let n=0;for(;g.offsetParent&&(n+=g[l],g.offsetParent!==e);){if(g.offsetParent.contains(e)){n-=e[l];break}g=g.offsetParent}return n}function bl(e,g){if(document.contains(e)){let o=document.scrollingElement||document.documentElement;if(window.getComputedStyle(o).overflow==="hidden"){let a=ml(e);for(;e&&a&&e!==o&&a!==o;)hy(a,e),e=a,a=ml(e)}else{var t;let{left:a,top:r}=e.getBoundingClientRect();e==null||(t=e.scrollIntoView)===null||t===void 0||t.call(e,{block:"nearest"});let{left:i,top:s}=e.getBoundingClientRect();if(Math.abs(a-i)>1||Math.abs(r-s)>1){var l,n,I;g==null||(n=g.containingElement)===null||n===void 0||(l=n.scrollIntoView)===null||l===void 0||l.call(n,{block:"center",inline:"center"}),(I=e.scrollIntoView)===null||I===void 0||I.call(e,{block:"nearest"})}}}}function IC(e){return e.mozInputSource===0&&e.isTrusted?!0:kr()&&e.pointerType?e.type==="click"&&e.buttons===1:e.detail===0&&!e.pointerType}function py(e){return!kr()&&e.width===0&&e.height===0||e.width===1&&e.height===1&&e.pressure===0&&e.detail===0&&e.pointerType==="mouse"}function Gy(e,g,t){let l=u.useRef(g),n=Te(()=>{t&&t(l.current)});u.useEffect(()=>{var I;let o=e==null||(I=e.current)===null||I===void 0?void 0:I.form;return o==null||o.addEventListener("reset",n),()=>{o==null||o.removeEventListener("reset",n)}},[e,n])}const oJ=new Set(["Arab","Syrc","Samr","Mand","Thaa","Mend","Nkoo","Adlm","Rohg","Hebr"]),CJ=new Set(["ae","ar","arc","bcc","bqi","ckb","dv","fa","glk","he","ku","mzn","nqo","pnb","ps","sd","ug","ur","yi"]);function yy(e){if(Intl.Locale){let t=new Intl.Locale(e).maximize(),l=typeof t.getTextInfo=="function"?t.getTextInfo():t.textInfo;if(l)return l.direction==="rtl";if(t.script)return oJ.has(t.script)}let g=e.split("-")[0];return CJ.has(g)}const aJ=Symbol.for("react-aria.i18n.locale");function By(){let e=typeof window<"u"&&window[aJ]||typeof navigator<"u"&&(navigator.language||navigator.userLanguage)||"en-US";try{Intl.DateTimeFormat.supportedLocalesOf([e])}catch{e="en-US"}return{locale:e,direction:yy(e)?"rtl":"ltr"}}let Rd=By(),yo=new Set;function aZ(){Rd=By();for(let e of yo)e(Rd)}function fy(){let e=mi(),[g,t]=u.useState(Rd);return u.useEffect(()=>(yo.size===0&&window.addEventListener("languagechange",aZ),yo.add(t),()=>{yo.delete(t),yo.size===0&&window.removeEventListener("languagechange",aZ)}),[]),e?{locale:"en-US",direction:"ltr"}:g}const Sy=D.createContext(null);function rJ(e){let{locale:g,children:t}=e,l=fy(),n=g?{locale:g,direction:yy(g)?"rtl":"ltr"}:l;return D.createElement(Sy.Provider,{value:n},t)}function Yt(){let e=fy();return u.useContext(Sy)||e}const rZ=new WeakMap;function iJ(e){let g=rZ.get(e);return g||(g=new bi(e),rZ.set(e,g)),g}function sJ(e,g){return g&&bi.getGlobalDictionaryForPackage(g)||iJ(e)}function QI(e,g){let{locale:t}=Yt(),l=sJ(e,g);return u.useMemo(()=>new Hk(t,l),[t,l])}let Ps=new Map;function Vy(e){let{locale:g}=Yt(),t=g+(e?Object.entries(e).sort((n,I)=>n[0]<I[0]?-1:1).join():"");if(Ps.has(t))return Ps.get(t);let l=new Intl.Collator(g,e);return Ps.set(t,l),l}function cJ(e,g){return g.get?g.get.call(e):g.value}function Wy(e,g,t){if(!g.has(e))throw new TypeError("attempted to "+t+" private field on non-instance");return g.get(e)}function dJ(e,g){var t=Wy(e,g,"get");return cJ(e,t)}function uJ(e,g,t){if(g.set)g.set.call(e,t);else{if(!g.writable)throw new TypeError("attempted to set read only private field");g.value=t}}function iZ(e,g,t){var l=Wy(e,g,"set");return uJ(e,l,t),t}let cI="default",Xd="",Pa=new WeakMap;function sZ(e){if(vC()){if(cI==="default"){const g=Be(e);Xd=g.documentElement.style.webkitUserSelect,g.documentElement.style.webkitUserSelect="none"}cI="disabled"}else(e instanceof HTMLElement||e instanceof SVGElement)&&(Pa.set(e,e.style.userSelect),e.style.userSelect="none")}function ca(e){if(vC()){if(cI!=="disabled")return;cI="restoring",setTimeout(()=>{fA(()=>{if(cI==="restoring"){const g=Be(e);g.documentElement.style.webkitUserSelect==="none"&&(g.documentElement.style.webkitUserSelect=Xd||""),Xd="",cI="default"}})},300)}else if((e instanceof HTMLElement||e instanceof SVGElement)&&e&&Pa.has(e)){let g=Pa.get(e);e.style.userSelect==="none"&&(e.style.userSelect=g),e.getAttribute("style")===""&&e.removeAttribute("style"),Pa.delete(e)}}const WA=D.createContext({register:()=>{}});WA.displayName="PressResponderContext";function AJ(e){let g=u.useContext(WA);if(g){let{register:t,...l}=g;e=_(l,e),t()}return VA(g,e.ref),e}var da=new WeakMap;class ua{continuePropagation(){iZ(this,da,!1)}get shouldStopPropagation(){return dJ(this,da)}constructor(g,t,l){Kk(this,da,{writable:!0,value:void 0}),iZ(this,da,!0),this.type=g,this.pointerType=t,this.target=l.currentTarget,this.shiftKey=l.shiftKey,this.metaKey=l.metaKey,this.ctrlKey=l.ctrlKey,this.altKey=l.altKey}}const cZ=Symbol("linkClicked");function KI(e){let{onPress:g,onPressChange:t,onPressStart:l,onPressEnd:n,onPressUp:I,isDisabled:o,isPressed:C,preventFocusOnPress:a,shouldCancelOnPointerExit:r,allowTextSelectionOnPress:i,ref:s,...c}=AJ(e),[d,Z]=u.useState(!1),G=u.useRef({isPressed:!1,ignoreEmulatedMouseEvents:!1,ignoreClickAfterPress:!1,didFirePressStart:!1,isTriggeringEvent:!1,activePointerId:null,target:null,isOverTarget:!1,pointerType:null}),{addGlobalListener:y,removeAllGlobalListeners:p}=SA(),h=Te((m,v)=>{let R=G.current;if(o||R.didFirePressStart)return!1;let W=!0;if(R.isTriggeringEvent=!0,l){let J=new ua("pressstart",v,m);l(J),W=J.shouldStopPropagation}return t&&t(!0),R.isTriggeringEvent=!1,R.didFirePressStart=!0,Z(!0),W}),b=Te((m,v,R=!0)=>{let W=G.current;if(!W.didFirePressStart)return!1;W.ignoreClickAfterPress=!0,W.didFirePressStart=!1,W.isTriggeringEvent=!0;let J=!0;if(n){let f=new ua("pressend",v,m);n(f),J=f.shouldStopPropagation}if(t&&t(!1),Z(!1),g&&R&&!o){let f=new ua("press",v,m);g(f),J&&(J=f.shouldStopPropagation)}return W.isTriggeringEvent=!1,J}),B=Te((m,v)=>{let R=G.current;if(o)return!1;if(I){R.isTriggeringEvent=!0;let W=new ua("pressup",v,m);return I(W),R.isTriggeringEvent=!1,W.shouldStopPropagation}return!0}),S=Te(m=>{let v=G.current;v.isPressed&&v.target&&(v.isOverTarget&&v.pointerType!=null&&b(Nt(v.target,m),v.pointerType,!1),v.isPressed=!1,v.isOverTarget=!1,v.activePointerId=null,v.pointerType=null,p(),i||ca(v.target))}),X=Te(m=>{r&&S(m)}),k=u.useMemo(()=>{let m=G.current,v={onKeyDown(W){if(Os(W.nativeEvent,W.currentTarget)&&W.currentTarget.contains(W.target)){var J;uZ(W.target,W.key)&&W.preventDefault();let f=!0;if(!m.isPressed&&!W.repeat){m.target=W.currentTarget,m.isPressed=!0,f=h(W,"keyboard");let V=W.currentTarget,K=x=>{Os(x,V)&&!x.repeat&&V.contains(x.target)&&m.target&&B(Nt(m.target,x),"keyboard")};y(Be(W.currentTarget),"keyup",UI(K,R),!0)}f&&W.stopPropagation(),W.metaKey&&El()&&((J=m.metaKeyEvents)===null||J===void 0||J.set(W.key,W.nativeEvent))}else W.key==="Meta"&&(m.metaKeyEvents=new Map)},onClick(W){if(!(W&&!W.currentTarget.contains(W.target))&&W&&W.button===0&&!m.isTriggeringEvent&&!kt.isOpening){let J=!0;if(o&&W.preventDefault(),!m.ignoreClickAfterPress&&!m.ignoreEmulatedMouseEvents&&!m.isPressed&&(m.pointerType==="virtual"||IC(W.nativeEvent))){!o&&!a&&Yg(W.currentTarget);let f=h(W,"virtual"),V=B(W,"virtual"),K=b(W,"virtual");J=f&&V&&K}m.ignoreEmulatedMouseEvents=!1,m.ignoreClickAfterPress=!1,J&&W.stopPropagation()}}},R=W=>{var J;if(m.isPressed&&m.target&&Os(W,m.target)){var f;uZ(W.target,W.key)&&W.preventDefault();let K=W.target;b(Nt(m.target,W),"keyboard",m.target.contains(K)),p(),W.key!=="Enter"&&vA(m.target)&&m.target.contains(K)&&!W[cZ]&&(W[cZ]=!0,kt(m.target,W,!1)),m.isPressed=!1,(f=m.metaKeyEvents)===null||f===void 0||f.delete(W.key)}else if(W.key==="Meta"&&(!((J=m.metaKeyEvents)===null||J===void 0)&&J.size)){var V;let K=m.metaKeyEvents;m.metaKeyEvents=void 0;for(let x of K.values())(V=m.target)===null||V===void 0||V.dispatchEvent(new KeyboardEvent("keyup",x))}};if(typeof PointerEvent<"u"){v.onPointerDown=V=>{if(V.button!==0||!V.currentTarget.contains(V.target))return;if(py(V.nativeEvent)){m.pointerType="virtual";return}$s(V.currentTarget)&&V.preventDefault(),m.pointerType=V.pointerType;let K=!0;m.isPressed||(m.isPressed=!0,m.isOverTarget=!0,m.activePointerId=V.pointerId,m.target=V.currentTarget,!o&&!a&&Yg(V.currentTarget),i||sZ(m.target),K=h(V,m.pointerType),y(Be(V.currentTarget),"pointermove",W,!1),y(Be(V.currentTarget),"pointerup",J,!1),y(Be(V.currentTarget),"pointercancel",f,!1)),K&&V.stopPropagation()},v.onMouseDown=V=>{V.currentTarget.contains(V.target)&&V.button===0&&($s(V.currentTarget)&&V.preventDefault(),V.stopPropagation())},v.onPointerUp=V=>{!V.currentTarget.contains(V.target)||m.pointerType==="virtual"||V.button===0&&Ln(V,V.currentTarget)&&B(V,m.pointerType||V.pointerType)};let W=V=>{V.pointerId===m.activePointerId&&(m.target&&Ln(V,m.target)?!m.isOverTarget&&m.pointerType!=null&&(m.isOverTarget=!0,h(Nt(m.target,V),m.pointerType)):m.target&&m.isOverTarget&&m.pointerType!=null&&(m.isOverTarget=!1,b(Nt(m.target,V),m.pointerType,!1),X(V)))},J=V=>{V.pointerId===m.activePointerId&&m.isPressed&&V.button===0&&m.target&&(Ln(V,m.target)&&m.pointerType!=null?b(Nt(m.target,V),m.pointerType):m.isOverTarget&&m.pointerType!=null&&b(Nt(m.target,V),m.pointerType,!1),m.isPressed=!1,m.isOverTarget=!1,m.activePointerId=null,m.pointerType=null,p(),i||ca(m.target))},f=V=>{S(V)};v.onDragStart=V=>{V.currentTarget.contains(V.target)&&S(V)}}else{v.onMouseDown=f=>{if(f.button!==0||!f.currentTarget.contains(f.target))return;if($s(f.currentTarget)&&f.preventDefault(),m.ignoreEmulatedMouseEvents){f.stopPropagation();return}m.isPressed=!0,m.isOverTarget=!0,m.target=f.currentTarget,m.pointerType=IC(f.nativeEvent)?"virtual":"mouse",!o&&!a&&Yg(f.currentTarget),h(f,m.pointerType)&&f.stopPropagation(),y(Be(f.currentTarget),"mouseup",W,!1)},v.onMouseEnter=f=>{if(!f.currentTarget.contains(f.target))return;let V=!0;m.isPressed&&!m.ignoreEmulatedMouseEvents&&m.pointerType!=null&&(m.isOverTarget=!0,V=h(f,m.pointerType)),V&&f.stopPropagation()},v.onMouseLeave=f=>{if(!f.currentTarget.contains(f.target))return;let V=!0;m.isPressed&&!m.ignoreEmulatedMouseEvents&&m.pointerType!=null&&(m.isOverTarget=!1,V=b(f,m.pointerType,!1),X(f)),V&&f.stopPropagation()},v.onMouseUp=f=>{f.currentTarget.contains(f.target)&&!m.ignoreEmulatedMouseEvents&&f.button===0&&B(f,m.pointerType||"mouse")};let W=f=>{if(f.button===0){if(m.isPressed=!1,p(),m.ignoreEmulatedMouseEvents){m.ignoreEmulatedMouseEvents=!1;return}m.target&&Ln(f,m.target)&&m.pointerType!=null?b(Nt(m.target,f),m.pointerType):m.target&&m.isOverTarget&&m.pointerType!=null&&b(Nt(m.target,f),m.pointerType,!1),m.isOverTarget=!1}};v.onTouchStart=f=>{if(!f.currentTarget.contains(f.target))return;let V=mJ(f.nativeEvent);if(!V)return;m.activePointerId=V.identifier,m.ignoreEmulatedMouseEvents=!0,m.isOverTarget=!0,m.isPressed=!0,m.target=f.currentTarget,m.pointerType="touch",!o&&!a&&Yg(f.currentTarget),i||sZ(m.target),h(f,m.pointerType)&&f.stopPropagation(),y($g(f.currentTarget),"scroll",J,!0)},v.onTouchMove=f=>{if(!f.currentTarget.contains(f.target))return;if(!m.isPressed){f.stopPropagation();return}let V=dZ(f.nativeEvent,m.activePointerId),K=!0;V&&Ln(V,f.currentTarget)?!m.isOverTarget&&m.pointerType!=null&&(m.isOverTarget=!0,K=h(f,m.pointerType)):m.isOverTarget&&m.pointerType!=null&&(m.isOverTarget=!1,K=b(f,m.pointerType,!1),X(f)),K&&f.stopPropagation()},v.onTouchEnd=f=>{if(!f.currentTarget.contains(f.target))return;if(!m.isPressed){f.stopPropagation();return}let V=dZ(f.nativeEvent,m.activePointerId),K=!0;V&&Ln(V,f.currentTarget)&&m.pointerType!=null?(B(f,m.pointerType),K=b(f,m.pointerType)):m.isOverTarget&&m.pointerType!=null&&(K=b(f,m.pointerType,!1)),K&&f.stopPropagation(),m.isPressed=!1,m.activePointerId=null,m.isOverTarget=!1,m.ignoreEmulatedMouseEvents=!0,m.target&&!i&&ca(m.target),p()},v.onTouchCancel=f=>{f.currentTarget.contains(f.target)&&(f.stopPropagation(),m.isPressed&&S(f))};let J=f=>{m.isPressed&&f.target.contains(m.target)&&S({currentTarget:m.target,shiftKey:!1,ctrlKey:!1,metaKey:!1,altKey:!1})};v.onDragStart=f=>{f.currentTarget.contains(f.target)&&S(f)}}return v},[y,o,a,p,i,S,X,b,h,B]);return u.useEffect(()=>()=>{var m;i||ca((m=G.current.target)!==null&&m!==void 0?m:void 0)},[i]),{isPressed:C||d,pressProps:_(c,k)}}function vA(e){return e.tagName==="A"&&e.hasAttribute("href")}function Os(e,g){const{key:t,code:l}=e,n=g,I=n.getAttribute("role");return(t==="Enter"||t===" "||t==="Spacebar"||l==="Space")&&!(n instanceof $g(n).HTMLInputElement&&!vy(n,t)||n instanceof $g(n).HTMLTextAreaElement||n.isContentEditable)&&!((I==="link"||!I&&vA(n))&&t!=="Enter")}function mJ(e){const{targetTouches:g}=e;return g.length>0?g[0]:null}function dZ(e,g){const t=e.changedTouches;for(let l=0;l<t.length;l++){const n=t[l];if(n.identifier===g)return n}return null}function Nt(e,g){return{currentTarget:e,shiftKey:g.shiftKey,ctrlKey:g.ctrlKey,metaKey:g.metaKey,altKey:g.altKey}}function bJ(e){let g=0,t=0;return e.width!==void 0?g=e.width/2:e.radiusX!==void 0&&(g=e.radiusX),e.height!==void 0?t=e.height/2:e.radiusY!==void 0&&(t=e.radiusY),{top:e.clientY-t,right:e.clientX+g,bottom:e.clientY+t,left:e.clientX-g}}function ZJ(e,g){return!(e.left>g.right||g.left>e.right||e.top>g.bottom||g.top>e.bottom)}function Ln(e,g){let t=g.getBoundingClientRect(),l=bJ(e);return ZJ(t,l)}function $s(e){return!(e instanceof HTMLElement)||!e.hasAttribute("draggable")}function uZ(e,g){return e instanceof HTMLInputElement?!vy(e,g):e instanceof HTMLButtonElement?e.type!=="submit"&&e.type!=="reset":!vA(e)}const hJ=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);function vy(e,g){return e.type==="checkbox"||e.type==="radio"?g===" ":hJ.has(e.type)}function pJ({children:e}){let g=u.useMemo(()=>({register:()=>{}}),[]);return D.createElement(WA.Provider,{value:g},e)}class GJ{isDefaultPrevented(){return this.nativeEvent.defaultPrevented}preventDefault(){this.defaultPrevented=!0,this.nativeEvent.preventDefault()}stopPropagation(){this.nativeEvent.stopPropagation(),this.isPropagationStopped=()=>!0}isPropagationStopped(){return!1}persist(){}constructor(g,t){this.nativeEvent=t,this.target=t.target,this.currentTarget=t.currentTarget,this.relatedTarget=t.relatedTarget,this.bubbles=t.bubbles,this.cancelable=t.cancelable,this.defaultPrevented=t.defaultPrevented,this.eventPhase=t.eventPhase,this.isTrusted=t.isTrusted,this.timeStamp=t.timeStamp,this.type=g}}function Ry(e){let g=u.useRef({isFocused:!1,observer:null});Le(()=>{const l=g.current;return()=>{l.observer&&(l.observer.disconnect(),l.observer=null)}},[]);let t=Te(l=>{e==null||e(l)});return u.useCallback(l=>{if(l.target instanceof HTMLButtonElement||l.target instanceof HTMLInputElement||l.target instanceof HTMLTextAreaElement||l.target instanceof HTMLSelectElement){g.current.isFocused=!0;let n=l.target,I=o=>{g.current.isFocused=!1,n.disabled&&t(new GJ("blur",o)),g.current.observer&&(g.current.observer.disconnect(),g.current.observer=null)};n.addEventListener("focusout",I,{once:!0}),g.current.observer=new MutationObserver(()=>{if(g.current.isFocused&&n.disabled){var o;(o=g.current.observer)===null||o===void 0||o.disconnect();let C=n===document.activeElement?null:document.activeElement;n.dispatchEvent(new FocusEvent("blur",{relatedTarget:C})),n.dispatchEvent(new FocusEvent("focusout",{bubbles:!0,relatedTarget:C}))}}),g.current.observer.observe(n,{attributes:!0,attributeFilter:["disabled"]})}},[t])}function Xy(e){let{isDisabled:g,onFocus:t,onBlur:l,onFocusChange:n}=e;const I=u.useCallback(a=>{if(a.target===a.currentTarget)return l&&l(a),n&&n(!1),!0},[l,n]),o=Ry(I),C=u.useCallback(a=>{a.target===a.currentTarget&&document.activeElement===a.target&&(t&&t(a),n&&n(!0),o(a))},[n,t,o]);return{focusProps:{onFocus:!g&&(t||n||l)?C:void 0,onBlur:!g&&(l||n)?I:void 0}}}let gl=null,oC=new Set,Ho=new Map,vn=!1,kd=!1;const yJ={Tab:!0,Escape:!0};function Gi(e,g){for(let t of oC)t(e,g)}function BJ(e){return!(e.metaKey||!El()&&e.altKey||e.ctrlKey||e.key==="Control"||e.key==="Shift"||e.key==="Meta")}function Jr(e){vn=!0,BJ(e)&&(gl="keyboard",Gi("keyboard",e))}function Pg(e){gl="pointer",(e.type==="mousedown"||e.type==="pointerdown")&&(vn=!0,Gi("pointer",e))}function ky(e){IC(e)&&(vn=!0,gl="virtual")}function Jy(e){e.target===window||e.target===document||(!vn&&!kd&&(gl="virtual",Gi("virtual",e)),vn=!1,kd=!1)}function Yy(){vn=!1,kd=!0}function Yr(e){if(typeof window>"u"||Ho.get($g(e)))return;const g=$g(e),t=Be(e);let l=g.HTMLElement.prototype.focus;g.HTMLElement.prototype.focus=function(){vn=!0,l.apply(this,arguments)},t.addEventListener("keydown",Jr,!0),t.addEventListener("keyup",Jr,!0),t.addEventListener("click",ky,!0),g.addEventListener("focus",Jy,!0),g.addEventListener("blur",Yy,!1),typeof PointerEvent<"u"?(t.addEventListener("pointerdown",Pg,!0),t.addEventListener("pointermove",Pg,!0),t.addEventListener("pointerup",Pg,!0)):(t.addEventListener("mousedown",Pg,!0),t.addEventListener("mousemove",Pg,!0),t.addEventListener("mouseup",Pg,!0)),g.addEventListener("beforeunload",()=>{wy(e)},{once:!0}),Ho.set(g,{focus:l})}const wy=(e,g)=>{const t=$g(e),l=Be(e);g&&l.removeEventListener("DOMContentLoaded",g),Ho.has(t)&&(t.HTMLElement.prototype.focus=Ho.get(t).focus,l.removeEventListener("keydown",Jr,!0),l.removeEventListener("keyup",Jr,!0),l.removeEventListener("click",ky,!0),t.removeEventListener("focus",Jy,!0),t.removeEventListener("blur",Yy,!1),typeof PointerEvent<"u"?(l.removeEventListener("pointerdown",Pg,!0),l.removeEventListener("pointermove",Pg,!0),l.removeEventListener("pointerup",Pg,!0)):(l.removeEventListener("mousedown",Pg,!0),l.removeEventListener("mousemove",Pg,!0),l.removeEventListener("mouseup",Pg,!0)),Ho.delete(t))};function fJ(e){const g=Be(e);let t;return g.readyState!=="loading"?Yr(e):(t=()=>{Yr(e)},g.addEventListener("DOMContentLoaded",t)),()=>wy(e,t)}typeof document<"u"&&fJ();function RA(){return gl!=="pointer"}function Jd(){return gl}function SJ(e){gl=e,Gi(e,null)}function VJ(){Yr();let[e,g]=u.useState(gl);return u.useEffect(()=>{let t=()=>{g(gl)};return oC.add(t),()=>{oC.delete(t)}},[]),mi()?null:e}const WJ=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);function vJ(e,g,t){var l;const n=typeof window<"u"?$g(t==null?void 0:t.target).HTMLInputElement:HTMLInputElement,I=typeof window<"u"?$g(t==null?void 0:t.target).HTMLTextAreaElement:HTMLTextAreaElement,o=typeof window<"u"?$g(t==null?void 0:t.target).HTMLElement:HTMLElement,C=typeof window<"u"?$g(t==null?void 0:t.target).KeyboardEvent:KeyboardEvent;return e=e||(t==null?void 0:t.target)instanceof n&&!WJ.has(t==null||(l=t.target)===null||l===void 0?void 0:l.type)||(t==null?void 0:t.target)instanceof I||(t==null?void 0:t.target)instanceof o&&(t==null?void 0:t.target.isContentEditable),!(e&&g==="keyboard"&&t instanceof C&&!yJ[t.key])}function RJ(e,g,t){Yr(),u.useEffect(()=>{let l=(n,I)=>{vJ(!!(t!=null&&t.isTextInput),n,I)&&e(RA())};return oC.add(l),()=>{oC.delete(l)}},g)}function yi(e){let{isDisabled:g,onBlurWithin:t,onFocusWithin:l,onFocusWithinChange:n}=e,I=u.useRef({isFocusWithin:!1}),o=u.useCallback(r=>{I.current.isFocusWithin&&!r.currentTarget.contains(r.relatedTarget)&&(I.current.isFocusWithin=!1,t&&t(r),n&&n(!1))},[t,n,I]),C=Ry(o),a=u.useCallback(r=>{!I.current.isFocusWithin&&document.activeElement===r.target&&(l&&l(r),n&&n(!0),I.current.isFocusWithin=!0,C(r))},[l,n,C]);return g?{focusWithinProps:{onFocus:void 0,onBlur:void 0}}:{focusWithinProps:{onFocus:a,onBlur:o}}}let wr=!1,qs=0;function Yd(){wr=!0,setTimeout(()=>{wr=!1},50)}function AZ(e){e.pointerType==="touch"&&Yd()}function XJ(){if(!(typeof document>"u"))return typeof PointerEvent<"u"?document.addEventListener("pointerup",AZ):document.addEventListener("touchend",Yd),qs++,()=>{qs--,!(qs>0)&&(typeof PointerEvent<"u"?document.removeEventListener("pointerup",AZ):document.removeEventListener("touchend",Yd))}}function jI(e){let{onHoverStart:g,onHoverChange:t,onHoverEnd:l,isDisabled:n}=e,[I,o]=u.useState(!1),C=u.useRef({isHovered:!1,ignoreEmulatedMouseEvents:!1,pointerType:"",target:null}).current;u.useEffect(XJ,[]);let{hoverProps:a,triggerHoverEnd:r}=u.useMemo(()=>{let i=(d,Z)=>{if(C.pointerType=Z,n||Z==="touch"||C.isHovered||!d.currentTarget.contains(d.target))return;C.isHovered=!0;let G=d.currentTarget;C.target=G,g&&g({type:"hoverstart",target:G,pointerType:Z}),t&&t(!0),o(!0)},s=(d,Z)=>{if(C.pointerType="",C.target=null,Z==="touch"||!C.isHovered)return;C.isHovered=!1;let G=d.currentTarget;l&&l({type:"hoverend",target:G,pointerType:Z}),t&&t(!1),o(!1)},c={};return typeof PointerEvent<"u"?(c.onPointerEnter=d=>{wr&&d.pointerType==="mouse"||i(d,d.pointerType)},c.onPointerLeave=d=>{!n&&d.currentTarget.contains(d.target)&&s(d,d.pointerType)}):(c.onTouchStart=()=>{C.ignoreEmulatedMouseEvents=!0},c.onMouseEnter=d=>{!C.ignoreEmulatedMouseEvents&&!wr&&i(d,"mouse"),C.ignoreEmulatedMouseEvents=!1},c.onMouseLeave=d=>{!n&&d.currentTarget.contains(d.target)&&s(d,"mouse")}),{hoverProps:c,triggerHoverEnd:s}},[g,t,l,n,C]);return u.useEffect(()=>{n&&r({currentTarget:C.target},C.pointerType)},[n]),{hoverProps:a,isHovered:I}}function kJ(e){let{ref:g,onInteractOutside:t,isDisabled:l,onInteractOutsideStart:n}=e,I=u.useRef({isPointerDown:!1,ignoreEmulatedMouseEvents:!1}),o=Te(a=>{t&&Aa(a,g)&&(n&&n(a),I.current.isPointerDown=!0)}),C=Te(a=>{t&&t(a)});u.useEffect(()=>{let a=I.current;if(l)return;const r=g.current,i=Be(r);if(typeof PointerEvent<"u"){let s=c=>{a.isPointerDown&&Aa(c,g)&&C(c),a.isPointerDown=!1};return i.addEventListener("pointerdown",o,!0),i.addEventListener("pointerup",s,!0),()=>{i.removeEventListener("pointerdown",o,!0),i.removeEventListener("pointerup",s,!0)}}else{let s=d=>{a.ignoreEmulatedMouseEvents?a.ignoreEmulatedMouseEvents=!1:a.isPointerDown&&Aa(d,g)&&C(d),a.isPointerDown=!1},c=d=>{a.ignoreEmulatedMouseEvents=!0,a.isPointerDown&&Aa(d,g)&&C(d),a.isPointerDown=!1};return i.addEventListener("mousedown",o,!0),i.addEventListener("mouseup",s,!0),i.addEventListener("touchstart",o,!0),i.addEventListener("touchend",c,!0),()=>{i.removeEventListener("mousedown",o,!0),i.removeEventListener("mouseup",s,!0),i.removeEventListener("touchstart",o,!0),i.removeEventListener("touchend",c,!0)}}},[g,l,o,C])}function Aa(e,g){if(e.button>0)return!1;if(e.target){const t=e.target.ownerDocument;if(!t||!t.documentElement.contains(e.target)||e.target.closest("[data-react-aria-top-layer]"))return!1}return g.current&&!g.current.contains(e.target)}function mZ(e){if(!e)return;let g=!0;return t=>{let l={...t,preventDefault(){t.preventDefault()},isDefaultPrevented(){return t.isDefaultPrevented()},stopPropagation(){console.error("stopPropagation is now the default behavior for events in React Spectrum. You can use continuePropagation() to revert this behavior.")},continuePropagation(){g=!1}};e(l),g&&t.stopPropagation()}}function JJ(e){return{keyboardProps:e.isDisabled?{}:{onKeyDown:mZ(e.onKeyDown),onKeyUp:mZ(e.onKeyUp)}}}const YJ=500;function wJ(e){let{isDisabled:g,onLongPressStart:t,onLongPressEnd:l,onLongPress:n,threshold:I=YJ,accessibilityDescription:o}=e;const C=u.useRef();let{addGlobalListener:a,removeGlobalListener:r}=SA(),{pressProps:i}=KI({isDisabled:g,onPressStart(c){if(c.continuePropagation(),(c.pointerType==="mouse"||c.pointerType==="touch")&&(t&&t({...c,type:"longpressstart"}),C.current=setTimeout(()=>{c.target.dispatchEvent(new PointerEvent("pointercancel",{bubbles:!0})),n&&n({...c,type:"longpress"}),C.current=void 0},I),c.pointerType==="touch")){let d=Z=>{Z.preventDefault()};a(c.target,"contextmenu",d,{once:!0}),a(window,"pointerup",()=>{setTimeout(()=>{r(c.target,"contextmenu",d)},30)},{once:!0})}},onPressEnd(c){C.current&&clearTimeout(C.current),l&&(c.pointerType==="mouse"||c.pointerType==="touch")&&l({...c,type:"longpressend"})}}),s=pi(n&&!g?o:void 0);return{longPressProps:_(i,s)}}function kg(e){const g=Be(e);if(Jd()==="virtual"){let t=g.activeElement;fA(()=>{g.activeElement===t&&e.isConnected&&Yg(e)})}else Yg(e)}function HJ(e){const g=$g(e);if(!(e instanceof g.HTMLElement)&&!(e instanceof g.SVGElement))return!1;let{display:t,visibility:l}=e.style,n=t!=="none"&&l!=="hidden"&&l!=="collapse";if(n){const{getComputedStyle:I}=e.ownerDocument.defaultView;let{display:o,visibility:C}=I(e);n=o!=="none"&&C!=="hidden"&&C!=="collapse"}return n}function NJ(e,g){return!e.hasAttribute("hidden")&&(e.nodeName==="DETAILS"&&g&&g.nodeName!=="SUMMARY"?e.hasAttribute("open"):!0)}function Hy(e,g){return e.nodeName!=="#comment"&&HJ(e)&&NJ(e,g)&&(!e.parentElement||Hy(e.parentElement,e))}const bZ=D.createContext(null);let ue=null;function KJ(e){let{children:g,contain:t,restoreFocus:l,autoFocus:n}=e,I=u.useRef(null),o=u.useRef(null),C=u.useRef([]),{parentNode:a}=u.useContext(bZ)||{},r=u.useMemo(()=>new wd({scopeRef:C}),[C]);Le(()=>{let c=a||Me.root;if(Me.getTreeNode(c.scopeRef)&&ue&&!Nr(ue,c.scopeRef)){let d=Me.getTreeNode(ue);d&&(c=d)}c.addChild(r),Me.addNode(r)},[r,a]),Le(()=>{let c=Me.getTreeNode(C);c&&(c.contain=!!t)},[t]),Le(()=>{var c;let d=(c=I.current)===null||c===void 0?void 0:c.nextSibling,Z=[];for(;d&&d!==o.current;)Z.push(d),d=d.nextSibling;C.current=Z},[g]),TJ(C,l,t),DJ(C,t),UJ(C,l,t),zJ(C,n),u.useEffect(()=>{const c=Be(C.current?C.current[0]:void 0).activeElement;let d=null;if(cg(c,C.current)){for(let Z of Me.traverse())Z.scopeRef&&cg(c,Z.scopeRef.current)&&(d=Z);d===Me.getTreeNode(C)&&(ue=d.scopeRef)}},[C]),Le(()=>()=>{var c,d,Z;let G=(Z=(d=Me.getTreeNode(C))===null||d===void 0||(c=d.parent)===null||c===void 0?void 0:c.scopeRef)!==null&&Z!==void 0?Z:null;(C===ue||Nr(C,ue))&&(!G||Me.getTreeNode(G))&&(ue=G),Me.removeTreeNode(C)},[C]);let i=u.useMemo(()=>FJ(C),[]),s=u.useMemo(()=>({focusManager:i,parentNode:r}),[r,i]);return D.createElement(bZ.Provider,{value:s},D.createElement("span",{"data-focus-scope-start":!0,hidden:!0,ref:I}),g,D.createElement("span",{"data-focus-scope-end":!0,hidden:!0,ref:o}))}function FJ(e){return{focusNext(g={}){let t=e.current,{from:l,tabbable:n,wrap:I,accept:o}=g,C=l||Be(t[0]).activeElement,a=t[0].previousElementSibling,r=dn(t),i=qg(r,{tabbable:n,accept:o},t);i.currentNode=cg(C,t)?C:a;let s=i.nextNode();return!s&&I&&(i.currentNode=a,s=i.nextNode()),s&&Lt(s,!0),s},focusPrevious(g={}){let t=e.current,{from:l,tabbable:n,wrap:I,accept:o}=g,C=l||Be(t[0]).activeElement,a=t[t.length-1].nextElementSibling,r=dn(t),i=qg(r,{tabbable:n,accept:o},t);i.currentNode=cg(C,t)?C:a;let s=i.previousNode();return!s&&I&&(i.currentNode=a,s=i.previousNode()),s&&Lt(s,!0),s},focusFirst(g={}){let t=e.current,{tabbable:l,accept:n}=g,I=dn(t),o=qg(I,{tabbable:l,accept:n},t);o.currentNode=t[0].previousElementSibling;let C=o.nextNode();return C&&Lt(C,!0),C},focusLast(g={}){let t=e.current,{tabbable:l,accept:n}=g,I=dn(t),o=qg(I,{tabbable:l,accept:n},t);o.currentNode=t[t.length-1].nextElementSibling;let C=o.previousNode();return C&&Lt(C,!0),C}}}const XA=["input:not([disabled]):not([type=hidden])","select:not([disabled])","textarea:not([disabled])","button:not([disabled])","a[href]","area[href]","summary","iframe","object","embed","audio[controls]","video[controls]","[contenteditable]"],xJ=XA.join(":not([hidden]),")+",[tabindex]:not([disabled]):not([hidden])";XA.push('[tabindex]:not([tabindex="-1"]):not([disabled])');const EJ=XA.join(':not([hidden]):not([tabindex="-1"]),');function dn(e){return e[0].parentElement}function Bo(e){let g=Me.getTreeNode(ue);for(;g&&g.scopeRef!==e;){if(g.contain)return!1;g=g.parent}return!0}function DJ(e,g){let t=u.useRef(),l=u.useRef();Le(()=>{let n=e.current;if(!g){l.current&&(cancelAnimationFrame(l.current),l.current=void 0);return}const I=Be(n?n[0]:void 0);let o=r=>{if(r.key!=="Tab"||r.altKey||r.ctrlKey||r.metaKey||!Bo(e))return;let i=I.activeElement,s=e.current;if(!s||!cg(i,s))return;let c=dn(s),d=qg(c,{tabbable:!0},s);if(!i)return;d.currentNode=i;let Z=r.shiftKey?d.previousNode():d.nextNode();Z||(d.currentNode=r.shiftKey?s[s.length-1].nextElementSibling:s[0].previousElementSibling,Z=r.shiftKey?d.previousNode():d.nextNode()),r.preventDefault(),Z&&Lt(Z,!0)},C=r=>{(!ue||Nr(ue,e))&&cg(r.target,e.current)?(ue=e,t.current=r.target):Bo(e)&&!Hr(r.target,e)?t.current?t.current.focus():ue&&ue.current&&Kr(ue.current):Bo(e)&&(t.current=r.target)},a=r=>{l.current&&cancelAnimationFrame(l.current),l.current=requestAnimationFrame(()=>{if(I.activeElement&&Bo(e)&&!Hr(I.activeElement,e))if(ue=e,I.body.contains(r.target)){var i;t.current=r.target,(i=t.current)===null||i===void 0||i.focus()}else ue.current&&Kr(ue.current)})};return I.addEventListener("keydown",o,!1),I.addEventListener("focusin",C,!1),n==null||n.forEach(r=>r.addEventListener("focusin",C,!1)),n==null||n.forEach(r=>r.addEventListener("focusout",a,!1)),()=>{I.removeEventListener("keydown",o,!1),I.removeEventListener("focusin",C,!1),n==null||n.forEach(r=>r.removeEventListener("focusin",C,!1)),n==null||n.forEach(r=>r.removeEventListener("focusout",a,!1))}},[e,g]),Le(()=>()=>{l.current&&cancelAnimationFrame(l.current)},[l])}function Ny(e){return Hr(e)}function cg(e,g){return!e||!g?!1:g.some(t=>t.contains(e))}function Hr(e,g=null){if(e instanceof Element&&e.closest("[data-react-aria-top-layer]"))return!0;for(let{scopeRef:t}of Me.traverse(Me.getTreeNode(g)))if(t&&cg(e,t.current))return!0;return!1}function MJ(e){return Hr(e,ue)}function Nr(e,g){var t;let l=(t=Me.getTreeNode(g))===null||t===void 0?void 0:t.parent;for(;l;){if(l.scopeRef===e)return!0;l=l.parent}return!1}function Lt(e,g=!1){if(e!=null&&!g)try{kg(e)}catch{}else if(e!=null)try{e.focus()}catch{}}function Kr(e,g=!0){let t=e[0].previousElementSibling,l=dn(e),n=qg(l,{tabbable:g},e);n.currentNode=t;let I=n.nextNode();g&&!I&&(l=dn(e),n=qg(l,{tabbable:!1},e),n.currentNode=t,I=n.nextNode()),Lt(I)}function zJ(e,g){const t=D.useRef(g);u.useEffect(()=>{if(t.current){ue=e;const l=Be(e.current?e.current[0]:void 0);!cg(l.activeElement,ue.current)&&e.current&&Kr(e.current)}t.current=!1},[e])}function TJ(e,g,t){Le(()=>{if(g||t)return;let l=e.current;const n=Be(l?l[0]:void 0);let I=o=>{let C=o.target;cg(C,e.current)?ue=e:Ny(C)||(ue=null)};return n.addEventListener("focusin",I,!1),l==null||l.forEach(o=>o.addEventListener("focusin",I,!1)),()=>{n.removeEventListener("focusin",I,!1),l==null||l.forEach(o=>o.removeEventListener("focusin",I,!1))}},[e,g,t])}function LJ(e){let g=Me.getTreeNode(ue);for(;g&&g.scopeRef!==e;){if(g.nodeToRestore)return!1;g=g.parent}return(g==null?void 0:g.scopeRef)===e}function UJ(e,g,t){const l=u.useRef(typeof document<"u"?Be(e.current?e.current[0]:void 0).activeElement:null);Le(()=>{let n=e.current;const I=Be(n?n[0]:void 0);if(!g||t)return;let o=()=>{(!ue||Nr(ue,e))&&cg(I.activeElement,e.current)&&(ue=e)};return I.addEventListener("focusin",o,!1),n==null||n.forEach(C=>C.addEventListener("focusin",o,!1)),()=>{I.removeEventListener("focusin",o,!1),n==null||n.forEach(C=>C.removeEventListener("focusin",o,!1))}},[e,t]),Le(()=>{const n=Be(e.current?e.current[0]:void 0);if(!g)return;let I=o=>{if(o.key!=="Tab"||o.altKey||o.ctrlKey||o.metaKey||!Bo(e))return;let C=n.activeElement;if(!cg(C,e.current))return;let a=Me.getTreeNode(e);if(!a)return;let r=a.nodeToRestore,i=qg(n.body,{tabbable:!0});i.currentNode=C;let s=o.shiftKey?i.previousNode():i.nextNode();if((!r||!n.body.contains(r)||r===n.body)&&(r=void 0,a.nodeToRestore=void 0),(!s||!cg(s,e.current))&&r){i.currentNode=r;do s=o.shiftKey?i.previousNode():i.nextNode();while(cg(s,e.current));o.preventDefault(),o.stopPropagation(),s?Lt(s,!0):Ny(r)?Lt(r,!0):C.blur()}};return t||n.addEventListener("keydown",I,!0),()=>{t||n.removeEventListener("keydown",I,!0)}},[e,g,t]),Le(()=>{const n=Be(e.current?e.current[0]:void 0);if(!g)return;let I=Me.getTreeNode(e);if(I){var o;return I.nodeToRestore=(o=l.current)!==null&&o!==void 0?o:void 0,()=>{let C=Me.getTreeNode(e);if(!C)return;let a=C.nodeToRestore;if(g&&a&&(cg(n.activeElement,e.current)||n.activeElement===n.body&&LJ(e))){let r=Me.clone();requestAnimationFrame(()=>{if(n.activeElement===n.body){let i=r.getTreeNode(e);for(;i;){if(i.nodeToRestore&&i.nodeToRestore.isConnected){Lt(i.nodeToRestore);return}i=i.parent}for(i=r.getTreeNode(e);i;){if(i.scopeRef&&i.scopeRef.current&&Me.getTreeNode(i.scopeRef)){Kr(i.scopeRef.current,!0);return}i=i.parent}}})}}}},[e,g])}function qg(e,g,t){let l=g!=null&&g.tabbable?EJ:xJ,n=Be(e).createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode(I){var o;return!(g==null||(o=g.from)===null||o===void 0)&&o.contains(I)?NodeFilter.FILTER_REJECT:I.matches(l)&&Hy(I)&&(!t||cg(I,t))&&(!(g!=null&&g.accept)||g.accept(I))?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});return g!=null&&g.from&&(n.currentNode=g.from),n}class kA{get size(){return this.fastMap.size}getTreeNode(g){return this.fastMap.get(g)}addTreeNode(g,t,l){let n=this.fastMap.get(t??null);if(!n)return;let I=new wd({scopeRef:g});n.addChild(I),I.parent=n,this.fastMap.set(g,I),l&&(I.nodeToRestore=l)}addNode(g){this.fastMap.set(g.scopeRef,g)}removeTreeNode(g){if(g===null)return;let t=this.fastMap.get(g);if(!t)return;let l=t.parent;for(let I of this.traverse())I!==t&&t.nodeToRestore&&I.nodeToRestore&&t.scopeRef&&t.scopeRef.current&&cg(I.nodeToRestore,t.scopeRef.current)&&(I.nodeToRestore=t.nodeToRestore);let n=t.children;l&&(l.removeChild(t),n.size>0&&n.forEach(I=>l&&l.addChild(I))),this.fastMap.delete(t.scopeRef)}*traverse(g=this.root){if(g.scopeRef!=null&&(yield g),g.children.size>0)for(let t of g.children)yield*this.traverse(t)}clone(){var g;let t=new kA;var l;for(let n of this.traverse())t.addTreeNode(n.scopeRef,(l=(g=n.parent)===null||g===void 0?void 0:g.scopeRef)!==null&&l!==void 0?l:null,n.nodeToRestore);return t}constructor(){this.fastMap=new Map,this.root=new wd({scopeRef:null}),this.fastMap.set(null,this.root)}}class wd{addChild(g){this.children.add(g),g.parent=this}removeChild(g){this.children.delete(g),g.parent=void 0}constructor(g){this.children=new Set,this.contain=!1,this.scopeRef=g.scopeRef}}let Me=new kA;function ht(e={}){let{autoFocus:g=!1,isTextInput:t,within:l}=e,n=u.useRef({isFocused:!1,isFocusVisible:g||RA()}),[I,o]=u.useState(!1),[C,a]=u.useState(()=>n.current.isFocused&&n.current.isFocusVisible),r=u.useCallback(()=>a(n.current.isFocused&&n.current.isFocusVisible),[]),i=u.useCallback(d=>{n.current.isFocused=d,o(d),r()},[r]);RJ(d=>{n.current.isFocusVisible=d,r()},[],{isTextInput:t});let{focusProps:s}=Xy({isDisabled:l,onFocusChange:i}),{focusWithinProps:c}=yi({isDisabled:!l,onFocusWithinChange:i});return{isFocused:I,isFocusVisible:C,focusProps:l?c:s}}let QJ=D.createContext(null);function jJ(e){let g=u.useContext(QJ)||{};VA(g,e);let{ref:t,...l}=g;return l}function Bi(e,g){let{focusProps:t}=Xy(e),{keyboardProps:l}=JJ(e),n=_(t,l),I=jJ(g),o=e.isDisabled?{}:I,C=u.useRef(e.autoFocus);return u.useEffect(()=>{C.current&&g.current&&kg(g.current),C.current=!1},[g]),{focusableProps:_({...n,tabIndex:e.excludeFromTabOrder&&!e.isDisabled?-1:void 0},o)}}function PJ(e,g){let t=g==null?void 0:g.isDisabled,[l,n]=u.useState(!1);return Le(()=>{if(e!=null&&e.current&&!t){let I=()=>{if(e.current){let C=qg(e.current,{tabbable:!0});n(!!C.nextNode())}};I();let o=new MutationObserver(I);return o.observe(e.current,{subtree:!0,childList:!0,attributes:!0,attributeFilter:["tabIndex","disabled"]}),()=>{o.disconnect()}}}),t?!1:l}const ZZ={border:0,clip:"rect(0 0 0 0)",clipPath:"inset(50%)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap"};function OJ(e={}){let{style:g,isFocusable:t}=e,[l,n]=u.useState(!1),{focusWithinProps:I}=yi({isDisabled:!t,onFocusWithinChange:C=>n(C)}),o=u.useMemo(()=>l?g:g?{...ZZ,...g}:ZZ,[l]);return{visuallyHiddenProps:{...I,style:o}}}function fi(e){let{children:g,elementType:t="div",isFocusable:l,style:n,...I}=e,{visuallyHiddenProps:o}=OJ(e);return D.createElement(t,_(I,o),g)}const Kt=[];function $J(e,g){let{onClose:t,shouldCloseOnBlur:l,isOpen:n,isDismissable:I=!1,isKeyboardDismissDisabled:o=!1,shouldCloseOnInteractOutside:C}=e;u.useEffect(()=>(n&&Kt.push(g),()=>{let Z=Kt.indexOf(g);Z>=0&&Kt.splice(Z,1)}),[n,g]);let a=()=>{Kt[Kt.length-1]===g&&t&&t()},r=Z=>{(!C||C(Z.target))&&Kt[Kt.length-1]===g&&(Z.stopPropagation(),Z.preventDefault())},i=Z=>{(!C||C(Z.target))&&(Kt[Kt.length-1]===g&&(Z.stopPropagation(),Z.preventDefault()),a())},s=Z=>{Z.key==="Escape"&&!o&&(Z.stopPropagation(),Z.preventDefault(),a())};kJ({ref:g,onInteractOutside:I&&n?i:null,onInteractOutsideStart:r});let{focusWithinProps:c}=yi({isDisabled:!l,onBlurWithin:Z=>{!Z.relatedTarget||MJ(Z.relatedTarget)||(!C||C(Z.relatedTarget))&&t()}}),d=Z=>{Z.target===Z.currentTarget&&Z.preventDefault()};return{overlayProps:{onKeyDown:s,...c},underlayProps:{onPointerDown:d}}}const Hd=D.createContext(null);function qJ(e){let{children:g}=e,t=u.useContext(Hd),[l,n]=u.useState(0),I=u.useMemo(()=>({parent:t,modalCount:l,addModal(){n(o=>o+1),t&&t.addModal()},removeModal(){n(o=>o-1),t&&t.removeModal()}}),[t,l]);return D.createElement(Hd.Provider,{value:I},g)}function _J(){let e=u.useContext(Hd);return{modalProviderProps:{"aria-hidden":e&&e.modalCount>0?!0:null}}}function eY(e){let{modalProviderProps:g}=_J();return D.createElement("div",{"data-overlay-container":!0,...e,...g})}function gY(e){return D.createElement(qJ,null,D.createElement(eY,e))}let ao=new WeakMap,Mg=[];function tY(e,g=document.body){let t=new Set(e),l=new Set,n=a=>{for(let c of a.querySelectorAll("[data-live-announcer], [data-react-aria-top-layer]"))t.add(c);let r=c=>{if(t.has(c)||l.has(c.parentElement)&&c.parentElement.getAttribute("role")!=="row")return NodeFilter.FILTER_REJECT;for(let d of t)if(c.contains(d))return NodeFilter.FILTER_SKIP;return NodeFilter.FILTER_ACCEPT},i=document.createTreeWalker(a,NodeFilter.SHOW_ELEMENT,{acceptNode:r}),s=r(a);if(s===NodeFilter.FILTER_ACCEPT&&I(a),s!==NodeFilter.FILTER_REJECT){let c=i.nextNode();for(;c!=null;)I(c),c=i.nextNode()}},I=a=>{var r;let i=(r=ao.get(a))!==null&&r!==void 0?r:0;a.getAttribute("aria-hidden")==="true"&&i===0||(i===0&&a.setAttribute("aria-hidden","true"),l.add(a),ao.set(a,i+1))};Mg.length&&Mg[Mg.length-1].disconnect(),n(g);let o=new MutationObserver(a=>{for(let r of a)if(!(r.type!=="childList"||r.addedNodes.length===0)&&![...t,...l].some(i=>i.contains(r.target))){for(let i of r.removedNodes)i instanceof Element&&(t.delete(i),l.delete(i));for(let i of r.addedNodes)(i instanceof HTMLElement||i instanceof SVGElement)&&(i.dataset.liveAnnouncer==="true"||i.dataset.reactAriaTopLayer==="true")?t.add(i):i instanceof Element&&n(i)}});o.observe(g,{childList:!0,subtree:!0});let C={observe(){o.observe(g,{childList:!0,subtree:!0})},disconnect(){o.disconnect()}};return Mg.push(C),()=>{o.disconnect();for(let a of l){let r=ao.get(a);r===1?(a.removeAttribute("aria-hidden"),ao.delete(a)):ao.set(a,r-1)}C===Mg[Mg.length-1]?(Mg.pop(),Mg.length&&Mg[Mg.length-1].observe()):Mg.splice(Mg.indexOf(C),1)}}const Ky=D.createContext(null);function lY(e){let g=mi(),{portalContainer:t=g?null:document.body,isExiting:l}=e,[n,I]=u.useState(!1),o=u.useMemo(()=>({contain:n,setContain:I}),[n,I]);if(!t)return null;let C=e.children;return e.disableFocusManagement||(C=D.createElement(KJ,{restoreFocus:!0,contain:n&&!l},C)),C=D.createElement(Ky.Provider,{value:o},D.createElement(pJ,null,C)),rX.createPortal(C,t)}function nY(){let e=u.useContext(Ky),g=e==null?void 0:e.setContain;Le(()=>{g==null||g(!0)},[g])}var IY=({children:e,locale:g="en-US",navigate:t,...l})=>{let n=e;return t&&(n=A.jsx(eJ,{navigate:t,children:n})),A.jsx(rJ,{locale:g,children:A.jsx(gY,{...l,children:n})})};function _e(e){return u.forwardRef(e)}var PI=(e,g,t=!0)=>{if(!g)return[e,{}];const l=g.reduce((n,I)=>I in e?{...n,[I]:e[I]}:n,{});return t?[Object.keys(e).filter(I=>!g.includes(I)).reduce((I,o)=>({...I,[o]:e[o]}),{}),l]:[e,l]},oY=["0","xs","sm","md","lg","xl","2xl","3xl","4xl","5xl","6xl","7xl","8xl","9xl","1","2","3","3.5","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","20","24","28","32","36","40","44","48","52","56","60","64","72","80","96"],_s=oY.map(e=>`unit-${e}`),hZ=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,Rg=e=>!e||typeof e!="object"||Object.keys(e).length===0,CY=(e,g)=>JSON.stringify(e)===JSON.stringify(g);function Fy(e,g){e.forEach(function(t){Array.isArray(t)?Fy(t,g):g.push(t)})}function xy(e){let g=[];return Fy(e,g),g}var Ey=(...e)=>xy(e).filter(Boolean),Dy=(e,g)=>{let t={},l=Object.keys(e),n=Object.keys(g);for(let I of l)if(n.includes(I)){let o=e[I],C=g[I];typeof o=="object"&&typeof C=="object"?t[I]=Dy(o,C):Array.isArray(o)||Array.isArray(C)?t[I]=Ey(C,o):t[I]=C+" "+o}else t[I]=e[I];for(let I of n)l.includes(I)||(t[I]=g[I]);return t},pZ=e=>!e||typeof e!="string"?e:e.replace(/\s+/g," ").trim();function aY(){for(var e=0,g,t,l="";e<arguments.length;)(g=arguments[e++])&&(t=My(g))&&(l&&(l+=" "),l+=t);return l}function My(e){if(typeof e=="string")return e;for(var g,t="",l=0;l<e.length;l++)e[l]&&(g=My(e[l]))&&(t&&(t+=" "),t+=g);return t}var JA="-";function rY(e){var g=sY(e),t=e.conflictingClassGroups,l=e.conflictingClassGroupModifiers,n=l===void 0?{}:l;function I(C){var a=C.split(JA);return a[0]===""&&a.length!==1&&a.shift(),zy(a,g)||iY(C)}function o(C,a){var r=t[C]||[];return a&&n[C]?[].concat(r,n[C]):r}return{getClassGroupId:I,getConflictingClassGroupIds:o}}function zy(e,g){var o;if(e.length===0)return g.classGroupId;var t=e[0],l=g.nextPart.get(t),n=l?zy(e.slice(1),l):void 0;if(n)return n;if(g.validators.length!==0){var I=e.join(JA);return(o=g.validators.find(function(C){var a=C.validator;return a(I)}))==null?void 0:o.classGroupId}}var GZ=/^\[(.+)\]$/;function iY(e){if(GZ.test(e)){var g=GZ.exec(e)[1],t=g==null?void 0:g.substring(0,g.indexOf(":"));if(t)return"arbitrary.."+t}}function sY(e){var g=e.theme,t=e.prefix,l={nextPart:new Map,validators:[]},n=dY(Object.entries(e.classGroups),t);return n.forEach(function(I){var o=I[0],C=I[1];Nd(C,l,o,g)}),l}function Nd(e,g,t,l){e.forEach(function(n){if(typeof n=="string"){var I=n===""?g:yZ(g,n);I.classGroupId=t;return}if(typeof n=="function"){if(cY(n)){Nd(n(l),g,t,l);return}g.validators.push({validator:n,classGroupId:t});return}Object.entries(n).forEach(function(o){var C=o[0],a=o[1];Nd(a,yZ(g,C),t,l)})})}function yZ(e,g){var t=e;return g.split(JA).forEach(function(l){t.nextPart.has(l)||t.nextPart.set(l,{nextPart:new Map,validators:[]}),t=t.nextPart.get(l)}),t}function cY(e){return e.isThemeGetter}function dY(e,g){return g?e.map(function(t){var l=t[0],n=t[1],I=n.map(function(o){return typeof o=="string"?g+o:typeof o=="object"?Object.fromEntries(Object.entries(o).map(function(C){var a=C[0],r=C[1];return[g+a,r]})):o});return[l,I]}):e}function uY(e){if(e<1)return{get:function(){},set:function(){}};var g=0,t=new Map,l=new Map;function n(I,o){t.set(I,o),g++,g>e&&(g=0,l=t,t=new Map)}return{get:function(o){var C=t.get(o);if(C!==void 0)return C;if((C=l.get(o))!==void 0)return n(o,C),C},set:function(o,C){t.has(o)?t.set(o,C):n(o,C)}}}var Ty="!";function AY(e){var g=e.separator||":",t=g.length===1,l=g[0],n=g.length;return function(o){for(var C=[],a=0,r=0,i,s=0;s<o.length;s++){var c=o[s];if(a===0){if(c===l&&(t||o.slice(s,s+n)===g)){C.push(o.slice(r,s)),r=s+n;continue}if(c==="/"){i=s;continue}}c==="["?a++:c==="]"&&a--}var d=C.length===0?o:o.substring(r),Z=d.startsWith(Ty),G=Z?d.substring(1):d,y=i&&i>r?i-r:void 0;return{modifiers:C,hasImportantModifier:Z,baseClassName:G,maybePostfixModifierPosition:y}}}function mY(e){if(e.length<=1)return e;var g=[],t=[];return e.forEach(function(l){var n=l[0]==="[";n?(g.push.apply(g,t.sort().concat([l])),t=[]):t.push(l)}),g.push.apply(g,t.sort()),g}function bY(e){return{cache:uY(e.cacheSize),splitModifiers:AY(e),...rY(e)}}var ZY=/\s+/;function hY(e,g){var t=g.splitModifiers,l=g.getClassGroupId,n=g.getConflictingClassGroupIds,I=new Set;return e.trim().split(ZY).map(function(o){var C=t(o),a=C.modifiers,r=C.hasImportantModifier,i=C.baseClassName,s=C.maybePostfixModifierPosition,c=l(s?i.substring(0,s):i),d=!!s;if(!c){if(!s)return{isTailwindClass:!1,originalClassName:o};if(c=l(i),!c)return{isTailwindClass:!1,originalClassName:o};d=!1}var Z=mY(a).join(":"),G=r?Z+Ty:Z;return{isTailwindClass:!0,modifierId:G,classGroupId:c,originalClassName:o,hasPostfixModifier:d}}).reverse().filter(function(o){if(!o.isTailwindClass)return!0;var C=o.modifierId,a=o.classGroupId,r=o.hasPostfixModifier,i=C+a;return I.has(i)?!1:(I.add(i),n(a,r).forEach(function(s){return I.add(C+s)}),!0)}).reverse().map(function(o){return o.originalClassName}).join(" ")}function Kd(){for(var e=arguments.length,g=new Array(e),t=0;t<e;t++)g[t]=arguments[t];var l,n,I,o=C;function C(r){var i=g[0],s=g.slice(1),c=s.reduce(function(d,Z){return Z(d)},i());return l=bY(c),n=l.cache.get,I=l.cache.set,o=a,a(r)}function a(r){var i=n(r);if(i)return i;var s=hY(r,l);return I(r,s),s}return function(){return o(aY.apply(null,arguments))}}function be(e){var g=function(l){return l[e]||[]};return g.isThemeGetter=!0,g}var Ly=/^\[(?:([a-z-]+):)?(.+)\]$/i,pY=/^\d+\/\d+$/,GY=new Set(["px","full","screen"]),yY=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,BY=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,fY=/^-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/;function rt(e){return un(e)||GY.has(e)||pY.test(e)||Fd(e)}function Fd(e){return Yn(e,"length",XY)}function SY(e){return Yn(e,"size",Uy)}function VY(e){return Yn(e,"position",Uy)}function WY(e){return Yn(e,"url",kY)}function ma(e){return Yn(e,"number",un)}function un(e){return!Number.isNaN(Number(e))}function vY(e){return e.endsWith("%")&&un(e.slice(0,-1))}function ro(e){return BZ(e)||Yn(e,"number",BZ)}function le(e){return Ly.test(e)}function io(){return!0}function il(e){return yY.test(e)}function RY(e){return Yn(e,"",JY)}function Yn(e,g,t){var l=Ly.exec(e);return l?l[1]?l[1]===g:t(l[2]):!1}function XY(e){return BY.test(e)}function Uy(){return!1}function kY(e){return e.startsWith("url(")}function BZ(e){return Number.isInteger(Number(e))}function JY(e){return fY.test(e)}function xd(){var e=be("colors"),g=be("spacing"),t=be("blur"),l=be("brightness"),n=be("borderColor"),I=be("borderRadius"),o=be("borderSpacing"),C=be("borderWidth"),a=be("contrast"),r=be("grayscale"),i=be("hueRotate"),s=be("invert"),c=be("gap"),d=be("gradientColorStops"),Z=be("gradientColorStopPositions"),G=be("inset"),y=be("margin"),p=be("opacity"),h=be("padding"),b=be("saturate"),B=be("scale"),S=be("sepia"),X=be("skew"),k=be("space"),m=be("translate"),v=function(){return["auto","contain","none"]},R=function(){return["auto","hidden","clip","visible","scroll"]},W=function(){return["auto",le,g]},J=function(){return[le,g]},f=function(){return["",rt]},V=function(){return["auto",un,le]},K=function(){return["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"]},x=function(){return["solid","dashed","dotted","double","none"]},Y=function(){return["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity","plus-lighter"]},N=function(){return["start","end","center","between","around","evenly","stretch"]},F=function(){return["","0",le]},H=function(){return["auto","avoid","all","avoid-page","page","left","right","column"]},E=function(){return[un,ma]},z=function(){return[un,le]};return{cacheSize:500,theme:{colors:[io],spacing:[rt],blur:["none","",il,le],brightness:E(),borderColor:[e],borderRadius:["none","","full",il,le],borderSpacing:J(),borderWidth:f(),contrast:E(),grayscale:F(),hueRotate:z(),invert:F(),gap:J(),gradientColorStops:[e],gradientColorStopPositions:[vY,Fd],inset:W(),margin:W(),opacity:E(),padding:J(),saturate:E(),scale:E(),sepia:F(),skew:z(),space:J(),translate:J()},classGroups:{aspect:[{aspect:["auto","square","video",le]}],container:["container"],columns:[{columns:[il]}],"break-after":[{"break-after":H()}],"break-before":[{"break-before":H()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none"]}],clear:[{clear:["left","right","both","none"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[].concat(K(),[le])}],overflow:[{overflow:R()}],"overflow-x":[{"overflow-x":R()}],"overflow-y":[{"overflow-y":R()}],overscroll:[{overscroll:v()}],"overscroll-x":[{"overscroll-x":v()}],"overscroll-y":[{"overscroll-y":v()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[G]}],"inset-x":[{"inset-x":[G]}],"inset-y":[{"inset-y":[G]}],start:[{start:[G]}],end:[{end:[G]}],top:[{top:[G]}],right:[{right:[G]}],bottom:[{bottom:[G]}],left:[{left:[G]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",ro]}],basis:[{basis:W()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",le]}],grow:[{grow:F()}],shrink:[{shrink:F()}],order:[{order:["first","last","none",ro]}],"grid-cols":[{"grid-cols":[io]}],"col-start-end":[{col:["auto",{span:["full",ro]},le]}],"col-start":[{"col-start":V()}],"col-end":[{"col-end":V()}],"grid-rows":[{"grid-rows":[io]}],"row-start-end":[{row:["auto",{span:[ro]},le]}],"row-start":[{"row-start":V()}],"row-end":[{"row-end":V()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",le]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",le]}],gap:[{gap:[c]}],"gap-x":[{"gap-x":[c]}],"gap-y":[{"gap-y":[c]}],"justify-content":[{justify:["normal"].concat(N())}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal"].concat(N(),["baseline"])}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[].concat(N(),["baseline"])}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[h]}],px:[{px:[h]}],py:[{py:[h]}],ps:[{ps:[h]}],pe:[{pe:[h]}],pt:[{pt:[h]}],pr:[{pr:[h]}],pb:[{pb:[h]}],pl:[{pl:[h]}],m:[{m:[y]}],mx:[{mx:[y]}],my:[{my:[y]}],ms:[{ms:[y]}],me:[{me:[y]}],mt:[{mt:[y]}],mr:[{mr:[y]}],mb:[{mb:[y]}],ml:[{ml:[y]}],"space-x":[{"space-x":[k]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[k]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit",le,g]}],"min-w":[{"min-w":["min","max","fit",le,rt]}],"max-w":[{"max-w":["0","none","full","min","max","fit","prose",{screen:[il]},il,le]}],h:[{h:[le,g,"auto","min","max","fit"]}],"min-h":[{"min-h":["min","max","fit",le,rt]}],"max-h":[{"max-h":[le,g,"min","max","fit"]}],"font-size":[{text:["base",il,Fd]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",ma]}],"font-family":[{font:[io]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",le]}],"line-clamp":[{"line-clamp":["none",un,ma]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",le,rt]}],"list-image":[{"list-image":["none",le]}],"list-style-type":[{list:["none","disc","decimal",le]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[p]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[p]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[].concat(x(),["wavy"])}],"text-decoration-thickness":[{decoration:["auto","from-font",rt]}],"underline-offset":[{"underline-offset":["auto",le,rt]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],indent:[{indent:J()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",le]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",le]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[p]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[].concat(K(),[VY])}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",SY]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},WY]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[Z]}],"gradient-via-pos":[{via:[Z]}],"gradient-to-pos":[{to:[Z]}],"gradient-from":[{from:[d]}],"gradient-via":[{via:[d]}],"gradient-to":[{to:[d]}],rounded:[{rounded:[I]}],"rounded-s":[{"rounded-s":[I]}],"rounded-e":[{"rounded-e":[I]}],"rounded-t":[{"rounded-t":[I]}],"rounded-r":[{"rounded-r":[I]}],"rounded-b":[{"rounded-b":[I]}],"rounded-l":[{"rounded-l":[I]}],"rounded-ss":[{"rounded-ss":[I]}],"rounded-se":[{"rounded-se":[I]}],"rounded-ee":[{"rounded-ee":[I]}],"rounded-es":[{"rounded-es":[I]}],"rounded-tl":[{"rounded-tl":[I]}],"rounded-tr":[{"rounded-tr":[I]}],"rounded-br":[{"rounded-br":[I]}],"rounded-bl":[{"rounded-bl":[I]}],"border-w":[{border:[C]}],"border-w-x":[{"border-x":[C]}],"border-w-y":[{"border-y":[C]}],"border-w-s":[{"border-s":[C]}],"border-w-e":[{"border-e":[C]}],"border-w-t":[{"border-t":[C]}],"border-w-r":[{"border-r":[C]}],"border-w-b":[{"border-b":[C]}],"border-w-l":[{"border-l":[C]}],"border-opacity":[{"border-opacity":[p]}],"border-style":[{border:[].concat(x(),["hidden"])}],"divide-x":[{"divide-x":[C]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[C]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[p]}],"divide-style":[{divide:x()}],"border-color":[{border:[n]}],"border-color-x":[{"border-x":[n]}],"border-color-y":[{"border-y":[n]}],"border-color-t":[{"border-t":[n]}],"border-color-r":[{"border-r":[n]}],"border-color-b":[{"border-b":[n]}],"border-color-l":[{"border-l":[n]}],"divide-color":[{divide:[n]}],"outline-style":[{outline:[""].concat(x())}],"outline-offset":[{"outline-offset":[le,rt]}],"outline-w":[{outline:[rt]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:f()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[p]}],"ring-offset-w":[{"ring-offset":[rt]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",il,RY]}],"shadow-color":[{shadow:[io]}],opacity:[{opacity:[p]}],"mix-blend":[{"mix-blend":Y()}],"bg-blend":[{"bg-blend":Y()}],filter:[{filter:["","none"]}],blur:[{blur:[t]}],brightness:[{brightness:[l]}],contrast:[{contrast:[a]}],"drop-shadow":[{"drop-shadow":["","none",il,le]}],grayscale:[{grayscale:[r]}],"hue-rotate":[{"hue-rotate":[i]}],invert:[{invert:[s]}],saturate:[{saturate:[b]}],sepia:[{sepia:[S]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[t]}],"backdrop-brightness":[{"backdrop-brightness":[l]}],"backdrop-contrast":[{"backdrop-contrast":[a]}],"backdrop-grayscale":[{"backdrop-grayscale":[r]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[i]}],"backdrop-invert":[{"backdrop-invert":[s]}],"backdrop-opacity":[{"backdrop-opacity":[p]}],"backdrop-saturate":[{"backdrop-saturate":[b]}],"backdrop-sepia":[{"backdrop-sepia":[S]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",le]}],duration:[{duration:z()}],ease:[{ease:["linear","in","out","in-out",le]}],delay:[{delay:z()}],animate:[{animate:["none","spin","ping","pulse","bounce",le]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[B]}],"scale-x":[{"scale-x":[B]}],"scale-y":[{"scale-y":[B]}],rotate:[{rotate:[ro,le]}],"translate-x":[{"translate-x":[m]}],"translate-y":[{"translate-y":[m]}],"skew-x":[{"skew-x":[X]}],"skew-y":[{"skew-y":[X]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",le]}],accent:[{accent:["auto",e]}],appearance:["appearance-none"],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",le]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":J()}],"scroll-mx":[{"scroll-mx":J()}],"scroll-my":[{"scroll-my":J()}],"scroll-ms":[{"scroll-ms":J()}],"scroll-me":[{"scroll-me":J()}],"scroll-mt":[{"scroll-mt":J()}],"scroll-mr":[{"scroll-mr":J()}],"scroll-mb":[{"scroll-mb":J()}],"scroll-ml":[{"scroll-ml":J()}],"scroll-p":[{"scroll-p":J()}],"scroll-px":[{"scroll-px":J()}],"scroll-py":[{"scroll-py":J()}],"scroll-ps":[{"scroll-ps":J()}],"scroll-pe":[{"scroll-pe":J()}],"scroll-pt":[{"scroll-pt":J()}],"scroll-pr":[{"scroll-pr":J()}],"scroll-pb":[{"scroll-pb":J()}],"scroll-pl":[{"scroll-pl":J()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","pinch-zoom","manipulation",{pan:["x","left","right","y","up","down"]}]}],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",le]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[rt,ma]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}}function YY(e,g){for(var t in g)Qy(e,t,g[t]);return e}var wY=Object.prototype.hasOwnProperty,HY=new Set(["string","number","boolean"]);function Qy(e,g,t){if(!wY.call(e,g)||HY.has(typeof t)||t===null){e[g]=t;return}if(Array.isArray(t)&&Array.isArray(e[g])){e[g]=e[g].concat(t);return}if(typeof t=="object"&&typeof e[g]=="object"){if(e[g]===null){e[g]=t;return}for(var l in t)Qy(e[g],l,t[l])}}function NY(e){for(var g=arguments.length,t=new Array(g>1?g-1:0),l=1;l<g;l++)t[l-1]=arguments[l];return typeof e=="function"?Kd.apply(void 0,[xd,e].concat(t)):Kd.apply(void 0,[function(){return YY(xd(),e)}].concat(t))}var KY=Kd(xd),FY={twMerge:!0,twMergeConfig:{},responsiveVariants:!1},jy=e=>e||void 0,CC=(...e)=>jy(xy(e).filter(Boolean).join(" ")),ec=null,Fr={},Ed=!1,so=(...e)=>g=>g.twMerge?((!ec||Ed)&&(Ed=!1,ec=Rg(Fr)?KY:NY(Fr)),jy(ec(CC(e)))):CC(e),fZ=(e,g)=>{for(let t in g)e.hasOwnProperty(t)?e[t]=CC(e[t],g[t]):e[t]=g[t];return e},xY=(e,g)=>{let{extend:t=null,slots:l={},variants:n={},compoundVariants:I=[],compoundSlots:o=[],defaultVariants:C={}}=e,a={...FY,...g},r=t!=null&&t.base?CC(t.base,e==null?void 0:e.base):e==null?void 0:e.base,i=t!=null&&t.variants&&!Rg(t.variants)?Dy(n,t.variants):n,s=t!=null&&t.defaultVariants&&!Rg(t.defaultVariants)?{...t.defaultVariants,...C}:C;!Rg(a.twMergeConfig)&&!CY(a.twMergeConfig,Fr)&&(Ed=!0,Fr=a.twMergeConfig);let c=Rg(t==null?void 0:t.slots),d=Rg(l)?{}:{base:CC(e==null?void 0:e.base,c&&(t==null?void 0:t.base)),...l},Z=c?d:fZ({...t==null?void 0:t.slots},Rg(d)?{base:e==null?void 0:e.base}:d),G=p=>{if(Rg(i)&&Rg(l)&&c)return so(r,p==null?void 0:p.class,p==null?void 0:p.className)(a);if(I&&!Array.isArray(I))throw new TypeError(`The "compoundVariants" prop must be an array. Received: ${typeof I}`);if(o&&!Array.isArray(o))throw new TypeError(`The "compoundSlots" prop must be an array. Received: ${typeof o}`);let h=(J,f,V=[],K)=>{let x=V;if(typeof f=="string")x=x.concat(pZ(f).split(" ").map(Y=>`${J}:${Y}`));else if(Array.isArray(f))x=x.concat(f.reduce((Y,N)=>Y.concat(`${J}:${N}`),[]));else if(typeof f=="object"&&typeof K=="string"){for(let Y in f)if(f.hasOwnProperty(Y)&&Y===K){let N=f[Y];if(N&&typeof N=="string"){let F=pZ(N);x[K]?x[K]=x[K].concat(F.split(" ").map(H=>`${J}:${H}`)):x[K]=F.split(" ").map(H=>`${J}:${H}`)}else Array.isArray(N)&&N.length>0&&(x[K]=N.reduce((F,H)=>F.concat(`${J}:${H}`),[]))}}return x},b=(J,f=i,V=null,K=null)=>{var x;let Y=f[J];if(!Y||Rg(Y))return null;let N=(x=K==null?void 0:K[J])!=null?x:p==null?void 0:p[J];if(N===null)return null;let F=hZ(N),H=Array.isArray(a.responsiveVariants)&&a.responsiveVariants.length>0||a.responsiveVariants===!0,E=s==null?void 0:s[J],z=[];if(typeof F=="object"&&H)for(let[j,ge]of Object.entries(F)){let $=Y[ge];if(j==="initial"){E=ge;continue}Array.isArray(a.responsiveVariants)&&!a.responsiveVariants.includes(j)||(z=h(j,$,z,V))}let U=Y[F]||Y[hZ(E)];return typeof z=="object"&&typeof V=="string"&&z[V]?fZ(z,U):z.length>0?(z.push(U),z):U},B=()=>i?Object.keys(i).map(J=>b(J,i)):null,S=(J,f)=>{if(!i||typeof i!="object")return null;let V=new Array;for(let K in i){let x=b(K,i,J,f),Y=J==="base"&&typeof x=="string"?x:x&&x[J];Y&&(V[V.length]=Y)}return V},X={};for(let J in p)p[J]!==void 0&&(X[J]=p[J]);let k=(J,f)=>{var V;let K=typeof(p==null?void 0:p[J])=="object"?{[J]:(V=p[J])==null?void 0:V.initial}:{};return{...s,...X,...K,...f}},m=(J=[],f)=>{let V=[];for(let{class:K,className:x,...Y}of J){let N=!0;for(let[F,H]of Object.entries(Y)){let E=k(F,f);if(Array.isArray(H)){if(!H.includes(E[F])){N=!1;break}}else if(E[F]!==H){N=!1;break}}N&&(K&&V.push(K),x&&V.push(x))}return V},v=J=>{let f=m(I,J),V=m(t==null?void 0:t.compoundVariants,J);return Ey(V,f)},R=J=>{let f=v(J);if(!Array.isArray(f))return f;let V={};for(let K of f)if(typeof K=="string"&&(V.base=so(V.base,K)(a)),typeof K=="object")for(let[x,Y]of Object.entries(K))V[x]=so(V[x],Y)(a);return V},W=J=>{if(o.length<1)return null;let f={};for(let{slots:V=[],class:K,className:x,...Y}of o){if(!Rg(Y)){let N=!0;for(let F of Object.keys(Y)){let H=k(F,J)[F];if(H===void 0||(Array.isArray(Y[F])?!Y[F].includes(H):Y[F]!==H)){N=!1;break}}if(!N)continue}for(let N of V)f[N]=f[N]||[],f[N].push([K,x])}return f};if(!Rg(l)||!c){let J={};if(typeof Z=="object"&&!Rg(Z))for(let f of Object.keys(Z))J[f]=V=>{var K,x;return so(Z[f],S(f,V),((K=R(V))!=null?K:[])[f],((x=W(V))!=null?x:[])[f],V==null?void 0:V.class,V==null?void 0:V.className)(a)};return J}return so(r,B(),v(),p==null?void 0:p.class,p==null?void 0:p.className)(a)},y=()=>{if(!(!i||typeof i!="object"))return Object.keys(i)};return G.variantKeys=y(),G.extend=t,G.base=r,G.slots=Z,G.variants=i,G.defaultVariants=s,G.compoundSlots=o,G.compoundVariants=I,G},ba=["small","medium","large"],wt=(e,g)=>{var t,l,n;return xY(e,{...g,twMerge:(t=g==null?void 0:g.twMerge)!=null?t:!0,twMergeConfig:{...g==null?void 0:g.twMergeConfig,theme:{...(l=g==null?void 0:g.twMergeConfig)==null?void 0:l.theme,opacity:["disabled"],spacing:["divider","unit",..._s],borderWidth:ba,borderRadius:ba},classGroups:{...(n=g==null?void 0:g.twMergeConfig)==null?void 0:n.classGroups,shadow:[{shadow:ba}],"font-size":[{text:["tiny",...ba]}],"bg-image":["bg-stripe-gradient"],"min-w":[{"min-w":["unit",..._s]}],"min-h":[{"min-h":["unit",..._s]}]}}})},Zn=["outline-none","data-[focus-visible=true]:z-10","data-[focus-visible=true]:outline-2","data-[focus-visible=true]:outline-focus","data-[focus-visible=true]:outline-offset-2"],Py=["outline-none","group-data-[focus-visible=true]:z-10","group-data-[focus-visible=true]:ring-2","group-data-[focus-visible=true]:ring-focus","group-data-[focus-visible=true]:ring-offset-2","group-data-[focus-visible=true]:ring-offset-background"],Un={default:["[&+.border-medium.border-default]:ms-[calc(theme(borderWidth.medium)*-1)]"],primary:["[&+.border-medium.border-primary]:ms-[calc(theme(borderWidth.medium)*-1)]"],secondary:["[&+.border-medium.border-secondary]:ms-[calc(theme(borderWidth.medium)*-1)]"],success:["[&+.border-medium.border-success]:ms-[calc(theme(borderWidth.medium)*-1)]"],warning:["[&+.border-medium.border-warning]:ms-[calc(theme(borderWidth.medium)*-1)]"],danger:["[&+.border-medium.border-danger]:ms-[calc(theme(borderWidth.medium)*-1)]"]},EY={default:"bg-default text-default-foreground",primary:"bg-primary text-primary-foreground",secondary:"bg-secondary text-secondary-foreground",success:"bg-success text-success-foreground",warning:"bg-warning text-warning-foreground",danger:"bg-danger text-danger-foreground",foreground:"bg-foreground text-background"},DY={default:"shadow-lg shadow-default/50 bg-default text-default-foreground",primary:"shadow-lg shadow-primary/40 bg-primary text-primary-foreground",secondary:"shadow-lg shadow-secondary/40 bg-secondary text-secondary-foreground",success:"shadow-lg shadow-success/40 bg-success text-success-foreground",warning:"shadow-lg shadow-warning/40 bg-warning text-warning-foreground",danger:"shadow-lg shadow-danger/40 bg-danger text-danger-foreground",foreground:"shadow-lg shadow-foreground/40 bg-foreground text-background"},MY={default:"bg-transparent border-default text-foreground",primary:"bg-transparent border-primary text-primary",secondary:"bg-transparent border-secondary text-secondary",success:"bg-transparent border-success text-success",warning:"bg-transparent border-warning text-warning",danger:"bg-transparent border-danger text-danger",foreground:"bg-transparent border-foreground text-foreground"},zY={default:"bg-default/40 text-default-foreground",primary:"bg-primary/20 text-primary",secondary:"bg-secondary/20 text-secondary",success:"bg-success/20 text-success-600 dark:text-success",warning:"bg-warning/20 text-warning-600 dark:text-warning",danger:"bg-danger/20 text-danger dark:text-danger-500",foreground:"bg-foreground/10 text-foreground"},TY={default:"border-default bg-default-100 text-default-foreground",primary:"border-default bg-default-100 text-primary",secondary:"border-default bg-default-100 text-secondary",success:"border-default bg-default-100 text-success",warning:"border-default bg-default-100 text-warning",danger:"border-default bg-default-100 text-danger",foreground:"border-default bg-default-100 text-foreground"},LY={default:"bg-transparent text-default-foreground",primary:"bg-transparent text-primary",secondary:"bg-transparent text-secondary",success:"bg-transparent text-success",warning:"bg-transparent text-warning",danger:"bg-transparent text-danger",foreground:"bg-transparent text-foreground"},UY={default:"border-default text-default-foreground hover:!bg-default",primary:"border-primary text-primary hover:!text-primary-foreground hover:!bg-primary",secondary:"border-secondary text-secondary hover:text-secondary-foreground hover:!bg-secondary",success:"border-success text-success hover:!text-success-foreground hover:!bg-success",warning:"border-warning text-warning hover:!text-warning-foreground hover:!bg-warning",danger:"border-danger text-danger hover:!text-danger-foreground hover:!bg-danger",foreground:"border-foreground text-foreground hover:!bg-foreground"},P={solid:EY,shadow:DY,bordered:MY,flat:zY,faded:TY,light:LY,ghost:UY},SZ=wt({base:"w-px h-px inline-block",variants:{isInline:{true:"inline-block",false:"block"}},defaultVariants:{isInline:!1}}),VZ=wt({slots:{base:"relative inline-flex flex-col gap-2 items-center justify-center",wrapper:"relative flex",circle1:["absolute","w-full","h-full","rounded-full","animate-spinner-ease-spin","border-2","border-solid","border-t-transparent","border-l-transparent","border-r-transparent"],circle2:["absolute","w-full","h-full","rounded-full","opacity-75","animate-spinner-linear-spin","border-2","border-dotted","border-t-transparent","border-l-transparent","border-r-transparent"],label:"text-foreground dark:text-foreground-dark font-regular"},variants:{size:{sm:{wrapper:"w-5 h-5",circle1:"border-2",circle2:"border-2",label:"text-small"},md:{wrapper:"w-8 h-8",circle1:"border-3",circle2:"border-3",label:"text-medium"},lg:{wrapper:"w-10 h-10",circle1:"border-3",circle2:"border-3",label:"text-large"}},color:{current:{circle1:"border-b-current",circle2:"border-b-current"},white:{circle1:"border-b-white",circle2:"border-b-white"},default:{circle1:"border-b-default",circle2:"border-b-default"},primary:{circle1:"border-b-primary",circle2:"border-b-primary"},secondary:{circle1:"border-b-secondary",circle2:"border-b-secondary"},success:{circle1:"border-b-success",circle2:"border-b-success"},warning:{circle1:"border-b-warning",circle2:"border-b-warning"},danger:{circle1:"border-b-danger",circle2:"border-b-danger"}},labelColor:{foreground:{label:"text-foreground"},primary:{label:"text-primary"},secondary:{label:"text-secondary"},success:{label:"text-success"},warning:{label:"text-warning"},danger:{label:"text-danger"}}},defaultVariants:{size:"md",color:"primary",labelColor:"foreground"}}),WZ=wt({slots:{base:"flex flex-col relative gap-4",wrapper:["p-4","z-0","flex","flex-col","relative","justify-between","gap-4","shadow-small","bg-content1","overflow-auto"],table:"min-w-full h-auto",thead:"[&>tr]:first:rounded-lg",tbody:"",tr:["group","outline-none",...Zn],th:["group","px-3","h-10","text-left","align-middle","bg-default-100","whitespace-nowrap","text-foreground-500","text-tiny","font-semibold","first:rounded-l-lg","last:rounded-r-lg","outline-none","data-[sortable=true]:transition-colors","data-[sortable=true]:cursor-pointer","data-[hover=true]:text-foreground-400",...Zn],td:["py-2","px-3","relative","align-middle","whitespace-normal","text-small","font-normal","outline-none","[&>*]:z-1","[&>*]:relative",...Zn,"before:content-['']","before:absolute","before:z-0","before:inset-0","before:opacity-0","data-[selected=true]:before:opacity-100","group-data-[disabled=true]:text-foreground-300"],tfoot:"",sortIcon:["ml-2","mb-px","opacity-0","text-inherit","inline-block","transition-transform-opacity","data-[visible=true]:opacity-100","group-data-[hover=true]:opacity-100","data-[direction=ascending]:rotate-180"],emptyWrapper:"text-foreground-400 align-middle text-center h-40",loadingWrapper:"absolute inset-0 flex items-center justify-center"},variants:{color:{default:{td:"before:bg-default/40 data-[selected=true]:text-default-foreground"},primary:{td:"before:bg-primary/20 data-[selected=true]:text-primary"},secondary:{td:"before:bg-secondary/20 data-[selected=true]:text-secondary"},success:{td:"before:bg-success/20 data-[selected=true]:text-success-600 dark:data-[selected=true]:text-success"},warning:{td:"before:bg-warning/20 data-[selected=true]:text-warning-600 dark:data-[selected=true]:text-warning"},danger:{td:"before:bg-danger/20 data-[selected=true]:text-danger dark:data-[selected=true]:text-danger-500"}},layout:{auto:{table:"table-auto"},fixed:{table:"table-fixed"}},radius:{none:{wrapper:"rounded-none"},sm:{wrapper:"rounded-small"},md:{wrapper:"rounded-medium"},lg:{wrapper:"rounded-large"}},shadow:{none:{wrapper:"shadow-none"},sm:{wrapper:"shadow-small"},md:{wrapper:"shadow-medium"},lg:{wrapper:"shadow-large"}},hideHeader:{true:{thead:"hidden"}},isStriped:{true:{td:["group-data-[odd=true]:before:bg-default-100","group-data-[odd=true]:before:opacity-100"]}},isCompact:{true:{td:"py-1"},false:{}},isHeaderSticky:{true:{thead:"sticky top-0 z-20 [&>tr]:first:shadow-small"}},isSelectable:{true:{tr:"cursor-default",td:["group-aria-[selected=false]:group-data-[hover=true]:before:bg-default-100","group-aria-[selected=false]:group-data-[hover=true]:before:opacity-70"]}},isMultiSelectable:{true:{td:["group-data-[first=true]:first:before:rounded-tl-lg","group-data-[first=true]:last:before:rounded-tr-lg","group-data-[middle=true]:before:rounded-none","group-data-[last=true]:first:before:rounded-bl-lg","group-data-[last=true]:last:before:rounded-br-lg"]},false:{td:["first:before:rounded-l-lg","last:before:rounded-r-lg"]}},fullWidth:{true:{base:"w-full",wrapper:"w-full",table:"w-full"}}},defaultVariants:{layout:"auto",shadow:"sm",radius:"lg",color:"default",isCompact:!1,hideHeader:!1,isStriped:!1,fullWidth:!0,disableAnimation:!1}}),vZ=wt({slots:{base:["p-2.5","-m-2.5","overflow-x-scroll","scrollbar-hide"],wrapper:["flex","flex-nowrap","h-fit","max-w-fit","relative","gap-1","items-center","overflow-visible"],item:["tap-highlight-transparent","select-none","touch-none"],prev:"",next:"",cursor:["absolute","flex","overflow-visible","items-center","justify-center","origin-center","left-0","select-none","touch-none","pointer-events-none","z-20"],forwardIcon:"hidden group-hover:block group-data-[focus-visible=true]:block data-[before=true]:rotate-180",ellipsis:"group-hover:hidden group-data-[focus-visible=true]:hidden",chevronNext:"rotate-180"},variants:{variant:{bordered:{item:["border-medium","border-default","bg-transparent","data-[hover=true]:bg-default-100"]},light:{item:"bg-transparent"},flat:{},faded:{item:["border-medium","border-default"]}},color:{default:{cursor:P.solid.default},primary:{cursor:P.solid.primary},secondary:{cursor:P.solid.secondary},success:{cursor:P.solid.success},warning:{cursor:P.solid.warning},danger:{cursor:P.solid.danger}},size:{sm:{},md:{},lg:{}},radius:{none:{},sm:{},md:{},lg:{},full:{}},isCompact:{true:{wrapper:"gap-0 shadow-sm",item:["shadow-none","first-of-type:rounded-r-none","last-of-type:rounded-l-none","[&:not(:first-of-type):not(:last-of-type)]:rounded-none"],prev:"!rounded-r-none",next:"!rounded-l-none"}},isDisabled:{true:{base:"opacity-disabled pointer-events-none"}},showShadow:{true:{}},disableCursorAnimation:{true:{cursor:"hidden"}},disableAnimation:{true:{item:"transition-none",cursor:"transition-none"},false:{item:["data-[pressed=true]:scale-[0.97]","transition-transform-background"],cursor:["data-[moving=true]:transition-transform","!data-[moving=true]:duration-300","opacity-0","data-[moving]:opacity-100"]}}},defaultVariants:{variant:"flat",color:"primary",size:"md",radius:"md",isCompact:!1,isDisabled:!1,showShadow:!1,disableAnimation:!1,disableCursorAnimation:!1},compoundVariants:[{showShadow:!0,color:"default",class:{cursor:[P.shadow.default,"shadow-md"]}},{showShadow:!0,color:"primary",class:{cursor:[P.shadow.primary,"shadow-md"]}},{showShadow:!0,color:"secondary",class:{cursor:[P.shadow.secondary,"shadow-md"]}},{showShadow:!0,color:"success",class:{cursor:[P.shadow.success,"shadow-md"]}},{showShadow:!0,color:"warning",class:{cursor:[P.shadow.warning,"shadow-md"]}},{showShadow:!0,color:"danger",class:{cursor:[P.shadow.danger,"shadow-md"]}},{isCompact:!0,variant:"bordered",class:{item:"[&:not(:first-of-type)]:ml-[calc(theme(borderWidth.2)*-1)]"}},{disableCursorAnimation:!0,color:"default",class:{item:["data-[active=true]:bg-default-400","data-[active=true]:border-default-400","data-[active=true]:text-default-foreground"]}},{disableCursorAnimation:!0,color:"primary",class:{item:["data-[active=true]:bg-primary","data-[active=true]:border-primary","data-[active=true]:text-primary-foreground"]}},{disableCursorAnimation:!0,color:"secondary",class:{item:["data-[active=true]:bg-secondary","data-[active=true]:border-secondary","data-[active=true]:text-secondary-foreground"]}},{disableCursorAnimation:!0,color:"success",class:{item:["data-[active=true]:bg-success","data-[active=true]:border-success","data-[active=true]:text-success-foreground"]}},{disableCursorAnimation:!0,color:"warning",class:{item:["data-[active=true]:bg-warning","data-[active=true]:border-warning","data-[active=true]:text-warning-foreground"]}},{disableCursorAnimation:!0,color:"danger",class:{item:["data-[active=true]:bg-danger","data-[active=true]:border-danger","data-[active=true]:text-danger-foreground"]}},{disableCursorAnimation:!0,showShadow:!0,color:"default",class:{item:["data-[active=true]:shadow-md","data-[active=true]:shadow-default/50"]}},{disableCursorAnimation:!0,showShadow:!0,color:"primary",class:{item:["data-[active=true]:shadow-md","data-[active=true]:shadow-primary/40"]}},{disableCursorAnimation:!0,showShadow:!0,color:"secondary",class:{item:["data-[active=true]:shadow-md","data-[active=true]:shadow-secondary/40"]}},{disableCursorAnimation:!0,showShadow:!0,color:"success",class:{item:["data-[active=true]:shadow-md","data-[active=true]:shadow-success/40"]}},{disableCursorAnimation:!0,showShadow:!0,color:"warning",class:{item:["data-[active=true]:shadow-md","data-[active=true]:shadow-warning/40"]}},{disableCursorAnimation:!0,showShadow:!0,color:"danger",class:{item:["data-[active=true]:shadow-md","data-[active=true]:shadow-danger/40"]}}],compoundSlots:[{slots:["item","prev","next"],class:["flex","flex-wrap","truncate","box-border","outline-none","items-center","justify-center","text-default-foreground",...Zn,"data-[disabled=true]:text-default-300","data-[disabled=true]:pointer-events-none"]},{slots:["item","prev","next"],variant:["flat","bordered","faded"],class:["shadow-sm"]},{slots:["item","prev","next"],variant:"flat",class:["bg-default-100","[&[data-hover=true]:not([data-active=true])]:bg-default-200","active:bg-default-300"]},{slots:["item","prev","next"],variant:"faded",class:["bg-default-50","[&[data-hover=true]:not([data-active=true])]:bg-default-100","active:bg-default-200"]},{slots:["item","prev","next"],variant:"light",class:["[&[data-hover=true]:not([data-active=true])]:bg-default-100","active:bg-default-200"]},{slots:["item","cursor","prev","next"],size:"sm",class:"min-w-8 w-8 h-8 text-tiny"},{slots:["item","cursor","prev","next"],size:"md",class:"min-w-9 w-9 h-9 text-small"},{slots:["item","cursor","prev","next"],size:"lg",class:"min-w-10 w-10 h-10 text-medium"},{slots:["wrapper","item","cursor","prev","next"],radius:"none",class:"rounded-none"},{slots:["wrapper","item","cursor","prev","next"],radius:"sm",class:"rounded-small"},{slots:["wrapper","item","cursor","prev","next"],radius:"md",class:"rounded-medium"},{slots:["wrapper","item","cursor","prev","next"],radius:"lg",class:"rounded-large"},{slots:["wrapper","item","cursor","prev","next"],radius:"full",class:"rounded-full"}]}),RZ=wt({slots:{base:"group flex flex-col",label:["absolute","z-10","pointer-events-none","origin-top-left","subpixel-antialiased","block","text-small","text-foreground-500"],mainWrapper:"h-full",inputWrapper:"relative w-full inline-flex tap-highlight-transparent flex-row items-center shadow-sm px-3 gap-3",innerWrapper:"inline-flex w-full items-center h-full box-border",input:["w-full font-normal bg-transparent !outline-none placeholder:text-foreground-500 focus-visible:outline-none","data-[has-start-content=true]:ps-1.5","data-[has-end-content=true]:pe-1.5"],clearButton:["p-2","-m-2","z-10","hidden","absolute","right-3","appearance-none","outline-none","select-none","opacity-0","hover:!opacity-100","cursor-pointer","active:!opacity-70","rounded-full",...Zn],helperWrapper:"hidden group-data-[has-helper=true]:flex p-1 relative flex-col gap-1.5",description:"text-tiny text-foreground-400",errorMessage:"text-tiny text-danger"},variants:{variant:{flat:{inputWrapper:["bg-default-100","data-[hover=true]:bg-default-200","group-data-[focus=true]:bg-default-100"]},faded:{inputWrapper:["bg-default-100","border-medium","border-default-200","data-[hover=true]:border-default-400"],value:"group-data-[has-value=true]:text-default-foreground"},bordered:{inputWrapper:["border-medium","border-default-200","data-[hover=true]:border-default-400","group-data-[focus=true]:border-default-foreground"]},underlined:{inputWrapper:["!px-1","!pb-0","!gap-0","relative","box-border","border-b-medium","shadow-[0_1px_0px_0_rgba(0,0,0,0.05)]","border-default-200","!rounded-none","hover:border-default-300","after:content-['']","after:w-0","after:origin-center","after:bg-default-foreground","after:absolute","after:left-1/2","after:-translate-x-1/2","after:-bottom-[2px]","after:h-[2px]","group-data-[focus=true]:after:w-full"],innerWrapper:"pb-1",label:"group-data-[filled-within=true]:text-foreground"}},color:{default:{},primary:{},secondary:{},success:{},warning:{},danger:{}},size:{sm:{label:"text-tiny",inputWrapper:"h-unit-8 min-h-unit-8 px-2 rounded-small",input:"text-small",clearButton:"text-medium"},md:{inputWrapper:"h-unit-10 min-h-unit-10 rounded-medium",input:"text-small",clearButton:"text-large"},lg:{inputWrapper:"h-unit-12 min-h-unit-12 rounded-large",input:"text-medium",clearButton:"text-large"}},radius:{none:{inputWrapper:"rounded-none"},sm:{inputWrapper:"rounded-small"},md:{inputWrapper:"rounded-medium"},lg:{inputWrapper:"rounded-large"},full:{inputWrapper:"rounded-full"}},labelPlacement:{outside:{mainWrapper:"flex flex-col"},"outside-left":{base:"flex-row items-center flex-nowrap data-[has-helper=true]:items-start",inputWrapper:"flex-1",mainWrapper:"flex flex-col",label:"relative text-foreground pr-2"},inside:{label:"text-tiny cursor-text",inputWrapper:"flex-col items-start justify-center gap-0",innerWrapper:"group-data-[has-label=true]:items-end"}},fullWidth:{true:{base:"w-full"}},isClearable:{true:{input:"peer pr-6",clearButton:"peer-data-[filled=true]:opacity-70 peer-data-[filled=true]:block"}},isDisabled:{true:{base:"opacity-disabled pointer-events-none",inputWrapper:"pointer-events-none",label:"pointer-events-none"}},isInvalid:{true:{label:"!text-danger",input:"!placeholder:text-danger !text-danger"}},isRequired:{true:{label:"after:content-['*'] after:text-danger after:ml-0.5"}},isMultiline:{true:{label:"relative",inputWrapper:"!h-auto",innerWrapper:"items-start group-data-[has-label=true]:items-start",input:"resize-none data-[hide-scroll=true]:scrollbar-hide"}},disableAnimation:{true:{input:"transition-none",inputWrapper:"transition-none",label:"transition-none"},false:{inputWrapper:"transition-background motion-reduce:transition-none !duration-150",label:["will-change-auto","!duration-200","!ease-out","motion-reduce:transition-none","transition-[transform,color,left,opacity]"],clearButton:["transition-opacity","motion-reduce:transition-none"]}}},defaultVariants:{variant:"flat",color:"default",size:"md",fullWidth:!0,labelPlacement:"inside",isDisabled:!1,isMultiline:!1,disableAnimation:!1},compoundVariants:[{variant:"flat",color:"default",class:{input:"group-data-[has-value=true]:text-default-foreground"}},{variant:"flat",color:"primary",class:{inputWrapper:["bg-primary-50","data-[hover=true]:bg-primary-100","text-primary","group-data-[focus=true]:bg-primary-50","placeholder:text-primary"],input:"placeholder:text-primary",label:"text-primary"}},{variant:"flat",color:"secondary",class:{inputWrapper:["bg-secondary-50","text-secondary","data-[hover=true]:bg-secondary-100","group-data-[focus=true]:bg-secondary-50","placeholder:text-secondary"],input:"placeholder:text-secondary",label:"text-secondary"}},{variant:"flat",color:"success",class:{inputWrapper:["bg-success-50","text-success-600","dark:text-success","placeholder:text-success-600","dark:placeholder:text-success","data-[hover=true]:bg-success-100","group-data-[focus=true]:bg-success-50"],input:"placeholder:text-success-600 dark:placeholder:text-success",label:"text-success-600 dark:text-success"}},{variant:"flat",color:"warning",class:{inputWrapper:["bg-warning-50","text-warning-600","dark:text-warning","placeholder:text-warning-600","dark:placeholder:text-warning","data-[hover=true]:bg-warning-100","group-data-[focus=true]:bg-warning-50"],input:"placeholder:text-warning-600 dark:placeholder:text-warning",label:"text-warning-600 dark:text-warning"}},{variant:"flat",color:"danger",class:{inputWrapper:["bg-danger-50","text-danger","dark:text-danger-500","placeholder:text-danger","dark:placeholder:text-danger-500","data-[hover=true]:bg-danger-100","group-data-[focus=true]:bg-danger-50"],input:"placeholder:text-danger dark:placeholder:text-danger-500",label:"text-danger dark:text-danger-500"}},{variant:"faded",color:"primary",class:{label:"text-primary",inputWrapper:"data-[hover=true]:border-primary focus-within:border-primary"}},{variant:"faded",color:"secondary",class:{label:"text-secondary",inputWrapper:"data-[hover=true]:border-secondary focus-within:border-secondary"}},{variant:"faded",color:"success",class:{label:"text-success",inputWrapper:"data-[hover=true]:border-success focus-within:border-success"}},{variant:"faded",color:"warning",class:{label:"text-warning",inputWrapper:"data-[hover=true]:border-warning focus-within:border-warning"}},{variant:"faded",color:"danger",class:{label:"text-danger",inputWrapper:"data-[hover=true]:border-danger focus-within:border-danger"}},{variant:"underlined",color:"default",class:{input:"group-data-[has-value=true]:text-foreground"}},{variant:"underlined",color:"primary",class:{inputWrapper:"after:bg-primary",label:"text-primary"}},{variant:"underlined",color:"secondary",class:{inputWrapper:"after:bg-secondary",label:"text-secondary"}},{variant:"underlined",color:"success",class:{inputWrapper:"after:bg-success",label:"text-success"}},{variant:"underlined",color:"warning",class:{inputWrapper:"after:bg-warning",label:"text-warning"}},{variant:"underlined",color:"danger",class:{inputWrapper:"after:bg-danger",label:"text-danger"}},{variant:"bordered",color:"primary",class:{inputWrapper:"group-data-[focus=true]:border-primary",label:"text-primary"}},{variant:"bordered",color:"secondary",class:{inputWrapper:"group-data-[focus=true]:border-secondary",label:"text-secondary"}},{variant:"bordered",color:"success",class:{inputWrapper:"group-data-[focus=true]:border-success",label:"text-success"}},{variant:"bordered",color:"warning",class:{inputWrapper:"group-data-[focus=true]:border-warning",label:"text-warning"}},{variant:"bordered",color:"danger",class:{inputWrapper:"group-data-[focus=true]:border-danger",label:"text-danger"}},{labelPlacement:"inside",color:"default",class:{label:"group-data-[filled-within=true]:text-default-600"}},{labelPlacement:"outside",color:"default",class:{label:"group-data-[filled-within=true]:text-foreground"}},{radius:"full",size:["sm"],class:{inputWrapper:"px-3"}},{radius:"full",size:"md",class:{inputWrapper:"px-4"}},{radius:"full",size:"lg",class:{inputWrapper:"px-5"}},{disableAnimation:!1,variant:["faded","bordered"],class:{inputWrapper:"transition-colors motion-reduce:transition-none"}},{disableAnimation:!1,variant:"underlined",class:{inputWrapper:"after:transition-width motion-reduce:after:transition-none"}},{variant:["flat","faded"],class:{inputWrapper:[...Py]}},{isInvalid:!0,variant:"flat",class:{inputWrapper:["bg-danger-50","data-[hover=true]:bg-danger-100","group-data-[focus=true]:bg-danger-50"]}},{isInvalid:!0,variant:"bordered",class:{inputWrapper:"!border-danger group-data-[focus=true]:border-danger"}},{isInvalid:!0,variant:"underlined",class:{inputWrapper:"after:bg-danger"}},{labelPlacement:"inside",size:"sm",class:{inputWrapper:"h-12 py-1.5 px-3"}},{labelPlacement:"inside",size:"md",class:{inputWrapper:"h-14 py-2"}},{labelPlacement:"inside",size:"lg",class:{label:"text-small",inputWrapper:"h-16 py-2.5 gap-0"}},{labelPlacement:"inside",size:"sm",variant:["bordered","faded"],class:{inputWrapper:"py-1"}},{labelPlacement:["inside","outside"],class:{label:["group-data-[filled-within=true]:pointer-events-auto"]}},{labelPlacement:["outside","outside-left"],class:{input:"h-full"}},{labelPlacement:"outside",isMultiline:!1,class:{base:"group relative justify-end",label:["pb-0","z-20","top-1/2","-translate-y-1/2","group-data-[filled-within=true]:left-0"]}},{labelPlacement:["inside"],class:{label:["group-data-[filled-within=true]:scale-85"]}},{labelPlacement:["inside"],variant:"flat",class:{innerWrapper:"pb-0.5"}},{variant:"underlined",size:"sm",class:{innerWrapper:"pb-1"}},{variant:"underlined",size:["md","lg"],class:{innerWrapper:"pb-1.5"}},{labelPlacement:"inside",size:["sm","md"],class:{label:"text-small"}},{labelPlacement:"inside",isMultiline:!1,size:"sm",class:{label:["group-data-[filled-within=true]:-translate-y-[calc(50%_+_theme(fontSize.tiny)/2_-_8px)]"]}},{labelPlacement:"inside",isMultiline:!1,size:"md",class:{label:["group-data-[filled-within=true]:-translate-y-[calc(50%_+_theme(fontSize.small)/2_-_6px)]"]}},{labelPlacement:"inside",isMultiline:!1,size:"lg",class:{label:["text-medium","group-data-[filled-within=true]:-translate-y-[calc(50%_+_theme(fontSize.small)/2_-_8px)]"]}},{labelPlacement:"inside",variant:["faded","bordered"],isMultiline:!1,size:"sm",class:{label:["group-data-[filled-within=true]:-translate-y-[calc(50%_+_theme(fontSize.tiny)/2_-_8px_-_theme(borderWidth.medium))]"]}},{labelPlacement:"inside",variant:["faded","bordered"],isMultiline:!1,size:"md",class:{label:["group-data-[filled-within=true]:-translate-y-[calc(50%_+_theme(fontSize.small)/2_-_6px_-_theme(borderWidth.medium))]"]}},{labelPlacement:"inside",variant:["faded","bordered"],isMultiline:!1,size:"lg",class:{label:["text-medium","group-data-[filled-within=true]:-translate-y-[calc(50%_+_theme(fontSize.small)/2_-_8px_-_theme(borderWidth.medium))]"]}},{labelPlacement:"inside",variant:"underlined",isMultiline:!1,size:"sm",class:{label:["group-data-[filled-within=true]:-translate-y-[calc(50%_+_theme(fontSize.tiny)/2_-_5px)]"]}},{labelPlacement:"inside",variant:"underlined",isMultiline:!1,size:"md",class:{label:["group-data-[filled-within=true]:-translate-y-[calc(50%_+_theme(fontSize.small)/2_-_3.5px)]"]}},{labelPlacement:"inside",variant:"underlined",size:"lg",isMultiline:!1,class:{label:["text-medium","group-data-[filled-within=true]:-translate-y-[calc(50%_+_theme(fontSize.small)/2_-_4px)]"]}},{labelPlacement:"outside",size:"sm",isMultiline:!1,class:{label:["left-2","text-tiny","group-data-[filled-within=true]:-translate-y-[calc(100%_+_theme(fontSize.tiny)/2_+_16px)]"],base:"data-[has-label=true]:mt-[calc(theme(fontSize.small)_+_8px)]"}},{labelPlacement:"outside",size:"md",isMultiline:!1,class:{label:["left-3","text-small","group-data-[filled-within=true]:-translate-y-[calc(100%_+_theme(fontSize.small)/2_+_20px)]"],base:"data-[has-label=true]:mt-[calc(theme(fontSize.small)_+_10px)]"}},{labelPlacement:"outside",size:"lg",isMultiline:!1,class:{label:["left-3","text-medium","group-data-[filled-within=true]:-translate-y-[calc(100%_+_theme(fontSize.small)/2_+_24px)]"],base:"data-[has-label=true]:mt-[calc(theme(fontSize.small)_+_12px)]"}},{labelPlacement:"outside-left",size:"sm",class:{label:"group-data-[has-helper=true]:pt-2"}},{labelPlacement:"outside-left",size:"md",class:{label:"group-data-[has-helper=true]:pt-3"}},{labelPlacement:"outside-left",size:"lg",class:{label:"group-data-[has-helper=true]:pt-4"}},{labelPlacement:["outside","outside-left"],isMultiline:!0,class:{inputWrapper:"py-2"}},{labelPlacement:"outside",isMultiline:!0,class:{label:"pb-1.5"}},{labelPlacement:"inside",isMultiline:!0,class:{label:"pb-0.5",input:"pt-0"}},{isMultiline:!0,disableAnimation:!1,class:{input:"transition-height !duration-100 motion-reduce:transition-none"}},{labelPlacement:["inside","outside"],class:{label:["pe-2","max-w-full","text-ellipsis","overflow-hidden"]}},{isMultiline:!0,radius:"full",class:{inputWrapper:"data-[has-multiple-rows=true]:rounded-large"}}]}),XZ=wt({slots:{wrapper:["flex","w-screen","h-[100dvh]","fixed","inset-0","z-50","overflow-x-auto","justify-center","[--scale-enter:100%]","[--scale-exit:100%]","[--slide-enter:0px]","[--slide-exit:80px]","sm:[--scale-enter:100%]","sm:[--scale-exit:103%]","sm:[--slide-enter:0px]","sm:[--slide-exit:0px]"],base:["flex","flex-col","relative","bg-white","z-50","w-full","box-border","bg-content1","outline-none","mx-1","my-1","sm:mx-6","sm:my-16"],backdrop:"z-50",header:"flex py-4 px-6 flex-initial text-large font-semibold",body:"flex flex-1 flex-col gap-3 px-6 py-2",footer:"flex flex-row gap-2 px-6 py-4 justify-end",closeButton:["absolute","appearance-none","outline-none","select-none","top-1","right-1","p-2","text-foreground-500","rounded-full","hover:bg-default-100","active:bg-default-200","tap-highlight-transparent",...Zn]},variants:{size:{xs:{base:"max-w-xs"},sm:{base:"max-w-sm"},md:{base:"max-w-md"},lg:{base:"max-w-lg"},xl:{base:"max-w-xl"},"2xl":{base:"max-w-2xl"},"3xl":{base:"max-w-3xl"},"4xl":{base:"max-w-4xl"},"5xl":{base:"max-w-5xl"},full:{base:"my-0 mx-0 sm:mx-0 sm:my-0 max-w-full h-[100dvh] !rounded-none"}},radius:{none:{base:"rounded-none"},sm:{base:"rounded-small"},md:{base:"rounded-medium"},lg:{base:"rounded-large"}},placement:{auto:{wrapper:"items-end sm:items-center"},center:{wrapper:"items-center sm:items-center"},top:{wrapper:"items-start sm:items-start"},"top-center":{wrapper:"items-start sm:items-center"},bottom:{wrapper:"items-end sm:items-end"},"bottom-center":{wrapper:"items-end sm:items-center"}},shadow:{sm:{base:"shadow-small"},md:{base:"shadow-medium"},lg:{base:"shadow-large"}},backdrop:{transparent:{backdrop:"hidden"},opaque:{backdrop:"bg-overlay/50 backdrop-opacity-disabled"},blur:{backdrop:"backdrop-blur-md backdrop-saturate-150 bg-overlay/30"}},scrollBehavior:{normal:{base:"overflow-y-hidden"},inside:{base:"max-h-[calc(100%_-_7.5rem)]",body:"overflow-y-auto"},outside:{wrapper:"items-start sm:items-start overflow-y-auto",base:"my-16"}}},defaultVariants:{size:"md",radius:"lg",shadow:"sm",placement:"auto",backdrop:"opaque",scrollBehavior:"normal"},compoundVariants:[{backdrop:["opaque","blur"],class:{backdrop:"w-screen h-screen fixed inset-0"}}]}),QY=wt({slots:{base:"group relative max-w-fit inline-flex items-center justify-start cursor-pointer tap-highlight-transparent p-2 -m-2",wrapper:["relative","inline-flex","items-center","justify-center","flex-shrink-0","overflow-hidden","before:content-['']","before:absolute","before:inset-0","before:border-solid","before:border-2","before:box-border","before:border-default","after:content-['']","after:absolute","after:inset-0","after:scale-50","after:opacity-0","after:origin-center","group-data-[selected=true]:after:scale-100","group-data-[selected=true]:after:opacity-100","group-data-[hover=true]:before:bg-default-100",...Py],icon:"z-10 w-4 h-3 opacity-0 group-data-[selected=true]:opacity-100",label:"relative text-foreground select-none"},variants:{color:{default:{wrapper:"after:bg-default after:text-default-foreground text-default-foreground"},primary:{wrapper:"after:bg-primary after:text-primary-foreground text-primary-foreground"},secondary:{wrapper:"after:bg-secondary after:text-secondary-foreground text-secondary-foreground"},success:{wrapper:"after:bg-success after:text-success-foreground text-success-foreground"},warning:{wrapper:"after:bg-warning after:text-warning-foreground text-warning-foreground"},danger:{wrapper:"after:bg-danger after:text-danger-foreground text-danger-foreground"}},size:{sm:{wrapper:["w-4 h-4 mr-2","rounded-[calc(theme(borderRadius.medium)*0.5)]","before:rounded-[calc(theme(borderRadius.medium)*0.5)]","after:rounded-[calc(theme(borderRadius.medium)*0.5)]"],label:"text-small",icon:"w-3 h-2"},md:{wrapper:["w-5 h-5 mr-2","rounded-[calc(theme(borderRadius.medium)*0.6)]","before:rounded-[calc(theme(borderRadius.medium)*0.6)]","after:rounded-[calc(theme(borderRadius.medium)*0.6)]"],label:"text-medium",icon:"w-4 h-3"},lg:{wrapper:["w-6 h-6 mr-2","rounded-[calc(theme(borderRadius.medium)*0.7)]","before:rounded-[calc(theme(borderRadius.medium)*0.7)]","after:rounded-[calc(theme(borderRadius.medium)*0.7)]"],label:"text-large",icon:"w-5 h-4"}},radius:{none:{wrapper:"rounded-none before:rounded-none after:rounded-none"},sm:{wrapper:["rounded-[calc(theme(borderRadius.medium)*0.5)]","before:rounded-[calc(theme(borderRadius.medium)*0.5)]","after:rounded-[calc(theme(borderRadius.medium)*0.5)]"]},md:{wrapper:["rounded-[calc(theme(borderRadius.medium)*0.6)]","before:rounded-[calc(theme(borderRadius.medium)*0.6)]","after:rounded-[calc(theme(borderRadius.medium)*0.6)]"]},lg:{wrapper:["rounded-[calc(theme(borderRadius.medium)*0.7)]","before:rounded-[calc(theme(borderRadius.medium)*0.7)]","after:rounded-[calc(theme(borderRadius.medium)*0.7)]"]},full:{wrapper:"rounded-full before:rounded-full after:rounded-full"}},lineThrough:{true:{label:["inline-flex","items-center","justify-center","before:content-['']","before:absolute","before:bg-foreground","before:w-0","before:h-0.5","group-data-[selected=true]:opacity-60","group-data-[selected=true]:before:w-full"]}},isDisabled:{true:{base:"opacity-disabled pointer-events-none"}},isInvalid:{true:{wrapper:"before:border-danger",label:"text-danger"}},disableAnimation:{true:{wrapper:"transition-none",icon:"transition-none",label:"transition-none"},false:{wrapper:["before:transition-colors","group-data-[pressed=true]:scale-95","transition-transform","after:transition-transform-opacity","after:!ease-linear","after:!duration-200","motion-reduce:transition-none"],icon:"transition-opacity motion-reduce:transition-none",label:"transition-colors-opacity before:transition-width motion-reduce:transition-none"}}},defaultVariants:{color:"primary",size:"md",isDisabled:!1,lineThrough:!1,disableAnimation:!1}});wt({slots:{base:"relative flex flex-col gap-2",label:"relative text-medium text-foreground-500",wrapper:"flex flex-col flex-wrap gap-2 data-[orientation=horizontal]:flex-row",description:"text-small text-foreground-400",errorMessage:"text-small text-danger"},variants:{isRequired:{true:{label:"after:content-['*'] after:text-danger after:ml-0.5"}},isInvalid:{true:{description:"text-danger"}},disableAnimation:{true:{},false:{description:"transition-colors !duration-150 motion-reduce:transition-none"}}},defaultVariants:{isInvalid:!1,isRequired:!1,disableAnimation:!1}});var jY=wt({base:["z-0","group","relative","inline-flex","items-center","justify-center","box-border","appearance-none","outline-none","select-none","whitespace-nowrap","min-w-max","font-normal","subpixel-antialiased","overflow-hidden","tap-highlight-transparent",...Zn],variants:{variant:{solid:"",bordered:"border-medium bg-transparent",light:"bg-transparent",flat:"",faded:"border-medium",shadow:"",ghost:"border-medium bg-transparent"},size:{sm:"px-unit-3 min-w-unit-16 h-unit-8 text-tiny gap-unit-2 rounded-small",md:"px-unit-4 min-w-unit-20 h-unit-10 text-small gap-unit-2 rounded-medium",lg:"px-unit-6 min-w-unit-24 h-unit-12 text-medium gap-unit-3 rounded-large"},color:{default:"",primary:"",secondary:"",success:"",warning:"",danger:""},radius:{none:"rounded-none",sm:"rounded-small",md:"rounded-medium",lg:"rounded-large",full:"rounded-full"},fullWidth:{true:"w-full"},isDisabled:{true:"opacity-disabled pointer-events-none"},isInGroup:{true:"[&:not(:first-child):not(:last-child)]:rounded-none"},isIconOnly:{true:"px-unit-0 !gap-unit-0",false:"[&>svg]:max-w-[theme(spacing.unit-8)]"},disableAnimation:{true:"!transition-none",false:"data-[pressed=true]:scale-[0.97] transition-transform-colors-opacity motion-reduce:transition-none"}},defaultVariants:{size:"md",variant:"solid",color:"default",fullWidth:!1,isDisabled:!1,isInGroup:!1,disableAnimation:!1},compoundVariants:[{variant:"solid",color:"default",class:P.solid.default},{variant:"solid",color:"primary",class:P.solid.primary},{variant:"solid",color:"secondary",class:P.solid.secondary},{variant:"solid",color:"success",class:P.solid.success},{variant:"solid",color:"warning",class:P.solid.warning},{variant:"solid",color:"danger",class:P.solid.danger},{variant:"shadow",color:"default",class:P.shadow.default},{variant:"shadow",color:"primary",class:P.shadow.primary},{variant:"shadow",color:"secondary",class:P.shadow.secondary},{variant:"shadow",color:"success",class:P.shadow.success},{variant:"shadow",color:"warning",class:P.shadow.warning},{variant:"shadow",color:"danger",class:P.shadow.danger},{variant:"bordered",color:"default",class:P.bordered.default},{variant:"bordered",color:"primary",class:P.bordered.primary},{variant:"bordered",color:"secondary",class:P.bordered.secondary},{variant:"bordered",color:"success",class:P.bordered.success},{variant:"bordered",color:"warning",class:P.bordered.warning},{variant:"bordered",color:"danger",class:P.bordered.danger},{variant:"flat",color:"default",class:P.flat.default},{variant:"flat",color:"primary",class:P.flat.primary},{variant:"flat",color:"secondary",class:P.flat.secondary},{variant:"flat",color:"success",class:P.flat.success},{variant:"flat",color:"warning",class:P.flat.warning},{variant:"flat",color:"danger",class:P.flat.danger},{variant:"faded",color:"default",class:P.faded.default},{variant:"faded",color:"primary",class:P.faded.primary},{variant:"faded",color:"secondary",class:P.faded.secondary},{variant:"faded",color:"success",class:P.faded.success},{variant:"faded",color:"warning",class:P.faded.warning},{variant:"faded",color:"danger",class:P.faded.danger},{variant:"light",color:"default",class:[P.light.default,"data-[hover=true]:bg-default/40"]},{variant:"light",color:"primary",class:[P.light.primary,"data-[hover=true]:bg-primary/20"]},{variant:"light",color:"secondary",class:[P.light.secondary,"data-[hover=true]:bg-secondary/20"]},{variant:"light",color:"success",class:[P.light.success,"data-[hover=true]:bg-success/20"]},{variant:"light",color:"warning",class:[P.light.warning,"data-[hover=true]:bg-warning/20"]},{variant:"light",color:"danger",class:[P.light.danger,"data-[hover=true]:bg-danger/20"]},{variant:"ghost",color:"default",class:P.ghost.default},{variant:"ghost",color:"primary",class:P.ghost.primary},{variant:"ghost",color:"secondary",class:P.ghost.secondary},{variant:"ghost",color:"success",class:P.ghost.success},{variant:"ghost",color:"warning",class:P.ghost.warning},{variant:"ghost",color:"danger",class:P.ghost.danger},{isInGroup:!0,class:"rounded-none first:rounded-s-medium last:rounded-e-medium"},{isInGroup:!0,size:"sm",class:"rounded-none first:rounded-s-small last:rounded-e-small"},{isInGroup:!0,size:"md",class:"rounded-none first:rounded-s-medium last:rounded-e-medium"},{isInGroup:!0,size:"lg",class:"rounded-none first:rounded-s-large last:rounded-e-large"},{isInGroup:!0,isRounded:!0,class:"rounded-none first:rounded-s-full last:rounded-e-full"},{isInGroup:!0,radius:"none",class:"rounded-none first:rounded-s-none last:rounded-e-none"},{isInGroup:!0,radius:"sm",class:"rounded-none first:rounded-s-small last:rounded-e-small"},{isInGroup:!0,radius:"md",class:"rounded-none first:rounded-s-medium last:rounded-e-medium"},{isInGroup:!0,radius:"lg",class:"rounded-none first:rounded-s-large last:rounded-e-large"},{isInGroup:!0,radius:"full",class:"rounded-none first:rounded-s-full last:rounded-e-full"},{isInGroup:!0,variant:["ghost","bordered"],color:"default",className:Un.default},{isInGroup:!0,variant:["ghost","bordered"],color:"primary",className:Un.primary},{isInGroup:!0,variant:["ghost","bordered"],color:"secondary",className:Un.secondary},{isInGroup:!0,variant:["ghost","bordered"],color:"success",className:Un.success},{isInGroup:!0,variant:["ghost","bordered"],color:"warning",className:Un.warning},{isInGroup:!0,variant:["ghost","bordered"],color:"danger",className:Un.danger},{isIconOnly:!0,size:"sm",class:"min-w-unit-8 w-unit-8 h-unit-8"},{isIconOnly:!0,size:"md",class:"min-w-unit-10 w-unit-10 h-unit-10"},{isIconOnly:!0,size:"lg",class:"min-w-unit-12 w-unit-12 h-unit-12"},{variant:["solid","faded","flat","bordered","shadow"],class:"data-[hover=true]:opacity-hover"}]});wt({base:"inline-flex items-center justify-center h-auto",variants:{fullWidth:{true:"w-full"}},defaultVariants:{fullWidth:!1}});var Oy=(...e)=>{let g=" ";for(const t of e)if(typeof t=="string"&&t.length>0){g=t;break}return g};function $y(e){var g,t,l="";if(typeof e=="string"||typeof e=="number")l+=e;else if(typeof e=="object")if(Array.isArray(e))for(g=0;g<e.length;g++)e[g]&&(t=$y(e[g]))&&(l&&(l+=" "),l+=t);else for(g in e)e[g]&&(l&&(l+=" "),l+=g);return l}function ne(...e){for(var g=0,t,l,n="";g<e.length;)(t=e[g++])&&(l=$y(t))&&(n&&(n+=" "),n+=l);return n}var PY={},kZ={};function JZ(e,g,...t){var l;const I=`[Next UI]${g?` [${g}]`:" "}: ${e}`;if(!(typeof console>"u")&&!kZ[I]&&(kZ[I]=!0,((l=process==null?void 0:PY)==null?void 0:l.NODE_ENV)!=="production"))return console.warn(I,t)}function OY(e){return`${e}-${Math.floor(Math.random()*1e6)}`}function sl(e,g){const t=g-e+1;return Array.from({length:t},(l,n)=>n+e)}var $Y=!1;function YA(e){return Array.isArray(e)}function qY(e){return YA(e)&&e.length===0}function wA(e){const g=typeof e;return e!=null&&(g==="object"||g==="function")&&!YA(e)}function _Y(e){return wA(e)&&Object.keys(e).length===0}function ew(e){return YA(e)?qY(e):wA(e)?_Y(e):e==null||e===""}var T=e=>e?"true":void 0,qy=(e,g)=>wA(e)?e instanceof Array?[...e]:e[g]:e;function HA(e={}){const{strict:g=!0,errorMessage:t="useContext: `context` is undefined. Seems you forgot to wrap component within the Provider",name:l}=e,n=u.createContext(void 0);n.displayName=l;function I(){var o;const C=u.useContext(n);if(!C&&g){const a=new Error(t);throw a.name="ContextError",(o=Error.captureStackTrace)==null||o.call(Error,a,I),a}return C}return[n.Provider,I,n]}function gw(e){return{UNSAFE_getDOMNode(){return e.current}}}function tw(e,g=e){return{...gw(e),focus(){g.current&&g.current.focus()}}}function Oe(e){const g=u.useRef(null);return u.useImperativeHandle(e,()=>g.current),g}function lw(e,g){const t=u.useRef(null);return u.useImperativeHandle(e,()=>tw(t,g)),t}var nw=new Set(["id","type","style","title","role","tabIndex","htmlFor","width","height","abbr","accept","acceptCharset","accessKey","action","allowFullScreen","allowTransparency","alt","async","autoComplete","autoFocus","autoPlay","cellPadding","cellSpacing","challenge","charset","checked","cite","class","className","cols","colSpan","command","content","contentEditable","contextMenu","controls","coords","crossOrigin","data","dateTime","default","defer","dir","disabled","download","draggable","dropzone","encType","for","form","formAction","formEncType","formMethod","formNoValidate","formTarget","frameBorder","headers","hidden","high","href","hrefLang","httpEquiv","icon","inputMode","isMap","itemId","itemProp","itemRef","itemScope","itemType","kind","label","lang","list","loop","manifest","max","maxLength","media","mediaGroup","method","min","minLength","multiple","muted","name","noValidate","open","optimum","pattern","ping","placeholder","poster","preload","radioGroup","referrerPolicy","readOnly","rel","required","rows","rowSpan","sandbox","scope","scoped","scrolling","seamless","selected","shape","size","sizes","slot","sortable","span","spellCheck","src","srcDoc","srcSet","start","step","target","translate","typeMustMatch","useMap","value","wmode","wrap"]),Iw=new Set(["onCopy","onCut","onPaste","onLoad","onError","onWheel","onScroll","onCompositionEnd","onCompositionStart","onCompositionUpdate","onKeyDown","onKeyPress","onKeyUp","onFocus","onBlur","onChange","onInput","onSubmit","onClick","onContextMenu","onDoubleClick","onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onPointerDown","onPointerEnter","onPointerLeave","onPointerUp","onSelect","onTouchCancel","onTouchEnd","onTouchMove","onTouchStart","onAnimationStart","onAnimationEnd","onAnimationIteration","onTransitionEnd"]),ow=/^(data-.*)$/,Cw=/^(aria-.*)$/,gc=/^(on[A-Z].*)$/;function Ng(e,g={}){let{labelable:t=!0,enabled:l=!0,propNames:n,omitPropNames:I,omitEventNames:o}=g,C={};if(!l)return e;for(const a in e)I!=null&&I.has(a)||o!=null&&o.has(a)&&gc.test(a)||gc.test(a)&&!Iw.has(a)||(Object.prototype.hasOwnProperty.call(e,a)&&(nw.has(a)||t&&Cw.test(a)||n!=null&&n.has(a)||ow.test(a))||gc.test(a))&&(C[a]=e[a]);return C}function Dd(e){return Ok()?e.altKey:e.ctrlKey}function $n(e){return El()?e.metaKey:e.ctrlKey}const aw=1e3;function rw(e){let{keyboardDelegate:g,selectionManager:t,onTypeSelect:l}=e,n=u.useRef({search:"",timeout:null}).current,I=o=>{let C=iw(o.key);if(!C||o.ctrlKey||o.metaKey||!o.currentTarget.contains(o.target))return;C===" "&&n.search.trim().length>0&&(o.preventDefault(),"continuePropagation"in o||o.stopPropagation()),n.search+=C;let a=g.getKeyForSearch(n.search,t.focusedKey);a==null&&(a=g.getKeyForSearch(n.search)),a!=null&&(t.setFocusedKey(a),l&&l(a)),clearTimeout(n.timeout),n.timeout=setTimeout(()=>{n.search=""},aw)};return{typeSelectProps:{onKeyDownCapture:g.getKeyForSearch?I:null}}}function iw(e){return e.length===1||!/^[A-Z]/i.test(e)?e:""}function sw(e){let{selectionManager:g,keyboardDelegate:t,ref:l,autoFocus:n=!1,shouldFocusWrap:I=!1,disallowEmptySelection:o=!1,disallowSelectAll:C=!1,selectOnFocus:a=g.selectionBehavior==="replace",disallowTypeAhead:r=!1,shouldUseVirtualFocus:i,allowsTabNavigation:s=!1,isVirtualized:c,scrollRef:d=l,linkBehavior:Z="action"}=e,{direction:G}=Yt(),y=BA(),p=R=>{if(R.altKey&&R.key==="Tab"&&R.preventDefault(),!l.current.contains(R.target))return;const W=(H,E)=>{if(H!=null){if(g.isLink(H)&&Z==="selection"&&a&&!Dd(R)){uA.flushSync(()=>{g.setFocusedKey(H,E)});let z=d.current.querySelector(`[data-key="${CSS.escape(H.toString())}"]`);y.open(z,R);return}if(g.setFocusedKey(H,E),g.isLink(H)&&Z==="override")return;R.shiftKey&&g.selectionMode==="multiple"?g.extendSelection(H):a&&!Dd(R)&&g.replaceSelection(H)}};switch(R.key){case"ArrowDown":if(t.getKeyBelow){var J,f;R.preventDefault();let H=g.focusedKey!=null?t.getKeyBelow(g.focusedKey):(J=t.getFirstKey)===null||J===void 0?void 0:J.call(t);H==null&&I&&(H=(f=t.getFirstKey)===null||f===void 0?void 0:f.call(t,g.focusedKey)),W(H)}break;case"ArrowUp":if(t.getKeyAbove){var V,K;R.preventDefault();let H=g.focusedKey!=null?t.getKeyAbove(g.focusedKey):(V=t.getLastKey)===null||V===void 0?void 0:V.call(t);H==null&&I&&(H=(K=t.getLastKey)===null||K===void 0?void 0:K.call(t,g.focusedKey)),W(H)}break;case"ArrowLeft":if(t.getKeyLeftOf){var x,Y;R.preventDefault();let H=t.getKeyLeftOf(g.focusedKey);H==null&&I&&(H=G==="rtl"?(x=t.getFirstKey)===null||x===void 0?void 0:x.call(t,g.focusedKey):(Y=t.getLastKey)===null||Y===void 0?void 0:Y.call(t,g.focusedKey)),W(H,G==="rtl"?"first":"last")}break;case"ArrowRight":if(t.getKeyRightOf){var N,F;R.preventDefault();let H=t.getKeyRightOf(g.focusedKey);H==null&&I&&(H=G==="rtl"?(N=t.getLastKey)===null||N===void 0?void 0:N.call(t,g.focusedKey):(F=t.getFirstKey)===null||F===void 0?void 0:F.call(t,g.focusedKey)),W(H,G==="rtl"?"last":"first")}break;case"Home":if(t.getFirstKey){R.preventDefault();let H=t.getFirstKey(g.focusedKey,$n(R));g.setFocusedKey(H),$n(R)&&R.shiftKey&&g.selectionMode==="multiple"?g.extendSelection(H):a&&g.replaceSelection(H)}break;case"End":if(t.getLastKey){R.preventDefault();let H=t.getLastKey(g.focusedKey,$n(R));g.setFocusedKey(H),$n(R)&&R.shiftKey&&g.selectionMode==="multiple"?g.extendSelection(H):a&&g.replaceSelection(H)}break;case"PageDown":if(t.getKeyPageBelow){R.preventDefault();let H=t.getKeyPageBelow(g.focusedKey);W(H)}break;case"PageUp":if(t.getKeyPageAbove){R.preventDefault();let H=t.getKeyPageAbove(g.focusedKey);W(H)}break;case"a":$n(R)&&g.selectionMode==="multiple"&&C!==!0&&(R.preventDefault(),g.selectAll());break;case"Escape":R.preventDefault(),o||g.clearSelection();break;case"Tab":if(!s){if(R.shiftKey)l.current.focus();else{let H=qg(l.current,{tabbable:!0}),E,z;do z=H.lastChild(),z&&(E=z);while(z);E&&!E.contains(document.activeElement)&&Yg(E)}break}}},h=u.useRef({top:0,left:0});IJ(d,"scroll",c?null:()=>{h.current={top:d.current.scrollTop,left:d.current.scrollLeft}});let b=R=>{if(g.isFocused){R.currentTarget.contains(R.target)||g.setFocused(!1);return}if(R.currentTarget.contains(R.target)){if(g.setFocused(!0),g.focusedKey==null){let f=K=>{K!=null&&(g.setFocusedKey(K),a&&g.replaceSelection(K))},V=R.relatedTarget;var W,J;V&&R.currentTarget.compareDocumentPosition(V)&Node.DOCUMENT_POSITION_FOLLOWING?f((W=g.lastSelectedKey)!==null&&W!==void 0?W:t.getLastKey()):f((J=g.firstSelectedKey)!==null&&J!==void 0?J:t.getFirstKey())}else c||(d.current.scrollTop=h.current.top,d.current.scrollLeft=h.current.left);if(!c&&g.focusedKey!=null){let f=d.current.querySelector(`[data-key="${CSS.escape(g.focusedKey.toString())}"]`);f&&(f.contains(document.activeElement)||Yg(f),Jd()==="keyboard"&&bl(f,{containingElement:l.current}))}}},B=R=>{R.currentTarget.contains(R.relatedTarget)||g.setFocused(!1)};const S=u.useRef(n);u.useEffect(()=>{if(S.current){let R=null;n==="first"&&(R=t.getFirstKey()),n==="last"&&(R=t.getLastKey());let W=g.selectedKeys;if(W.size){for(let J of W)if(g.canSelectItem(J)){R=J;break}}g.setFocused(!0),g.setFocusedKey(R),R==null&&!i&&kg(l.current)}},[]);let X=u.useRef(g.focusedKey);u.useEffect(()=>{let R=Jd();if(g.isFocused&&g.focusedKey!=null&&(d!=null&&d.current)){let W=d.current.querySelector(`[data-key="${CSS.escape(g.focusedKey.toString())}"]`);W&&(R==="keyboard"||S.current)&&(c||hy(d.current,W),R!=="virtual"&&bl(W,{containingElement:l.current}))}g.isFocused&&g.focusedKey==null&&X.current!=null&&kg(l.current),X.current=g.focusedKey,S.current=!1},[c,d,g.focusedKey,g.isFocused,l]);let k={onKeyDown:p,onFocus:b,onBlur:B,onMouseDown(R){d.current===R.target&&R.preventDefault()}},{typeSelectProps:m}=rw({keyboardDelegate:t,selectionManager:g});r||(k=_(m,k));let v;return i||(v=g.focusedKey==null?0:-1),{collectionProps:{...k,tabIndex:v}}}function _y(e){let{selectionManager:g,key:t,ref:l,shouldSelectOnPressUp:n,shouldUseVirtualFocus:I,focus:o,isDisabled:C,onAction:a,allowsDifferentPressOrigin:r,linkBehavior:i="action"}=e,s=BA(),c=Y=>{if(Y.pointerType==="keyboard"&&Dd(Y))g.toggleSelection(t);else{if(g.selectionMode==="none")return;if(g.isLink(t)){if(i==="selection"){s.open(l.current,Y),g.setSelectedKeys(g.selectedKeys);return}else if(i==="override"||i==="none")return}g.selectionMode==="single"?g.isSelected(t)&&!g.disallowEmptySelection?g.toggleSelection(t):g.replaceSelection(t):Y&&Y.shiftKey?g.extendSelection(t):g.selectionBehavior==="toggle"||Y&&($n(Y)||Y.pointerType==="touch"||Y.pointerType==="virtual")?g.toggleSelection(t):g.replaceSelection(t)}};u.useEffect(()=>{t===g.focusedKey&&g.isFocused&&!I&&(o?o():document.activeElement!==l.current&&kg(l.current))},[l,t,g.focusedKey,g.childFocusStrategy,g.isFocused,I]),C=C||g.isDisabled(t);let d={};!I&&!C?d={tabIndex:t===g.focusedKey?0:-1,onFocus(Y){Y.target===l.current&&g.setFocusedKey(t)}}:C&&(d.onMouseDown=Y=>{Y.preventDefault()});let Z=g.isLink(t)&&i==="override",G=g.isLink(t)&&i!=="selection"&&i!=="none",y=!C&&g.canSelectItem(t)&&!Z,p=(a||G)&&!C,h=p&&(g.selectionBehavior==="replace"?!y:!y||g.isEmpty),b=p&&y&&g.selectionBehavior==="replace",B=h||b,S=u.useRef(null),X=B&&y,k=u.useRef(!1),m=u.useRef(!1),v=Y=>{a&&a(),G&&s.open(l.current,Y)},R={};n?(R.onPressStart=Y=>{S.current=Y.pointerType,k.current=X,Y.pointerType==="keyboard"&&(!B||wZ())&&c(Y)},r?(R.onPressUp=h?null:Y=>{Y.pointerType!=="keyboard"&&y&&c(Y)},R.onPress=h?v:null):R.onPress=Y=>{if(h||b&&Y.pointerType!=="mouse"){if(Y.pointerType==="keyboard"&&!YZ())return;v(Y)}else Y.pointerType!=="keyboard"&&y&&c(Y)}):(R.onPressStart=Y=>{S.current=Y.pointerType,k.current=X,m.current=h,y&&(Y.pointerType==="mouse"&&!h||Y.pointerType==="keyboard"&&(!p||wZ()))&&c(Y)},R.onPress=Y=>{(Y.pointerType==="touch"||Y.pointerType==="pen"||Y.pointerType==="virtual"||Y.pointerType==="keyboard"&&B&&YZ()||Y.pointerType==="mouse"&&m.current)&&(B?v(Y):y&&c(Y))}),d["data-key"]=t,R.preventFocusOnPress=I;let{pressProps:W,isPressed:J}=KI(R),f=b?Y=>{S.current==="mouse"&&(Y.stopPropagation(),Y.preventDefault(),v(Y))}:void 0,{longPressProps:V}=wJ({isDisabled:!X,onLongPress(Y){Y.pointerType==="touch"&&(c(Y),g.setSelectionBehavior("toggle"))}}),K=Y=>{S.current==="touch"&&k.current&&Y.preventDefault()},x=g.isLink(t)?Y=>{kt.isOpening||Y.preventDefault()}:void 0;return{itemProps:_(d,y||h?W:{},X?V:{},{onDoubleClick:f,onDragStartCapture:K,onClick:x}),isPressed:J,isSelected:g.isSelected(t),isFocused:g.isFocused&&g.focusedKey===t,isDisabled:C,allowsSelection:y,hasAction:B}}function YZ(){let e=window.event;return(e==null?void 0:e.key)==="Enter"}function wZ(){let e=window.event;return(e==null?void 0:e.key)===" "||(e==null?void 0:e.code)==="Space"}var eB=D.createContext(null);eB.displayName="PressResponderContext";var cw=Object.defineProperty,dw=(e,g,t)=>g in e?cw(e,g,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[g]=t,en=(e,g,t)=>(dw(e,typeof g!="symbol"?g+"":g,t),t),gB=(e,g,t)=>{if(!g.has(e))throw TypeError("Cannot "+t)},uw=(e,g,t)=>(gB(e,g,"read from private field"),t?t.call(e):g.get(e)),Aw=(e,g,t)=>{if(g.has(e))throw TypeError("Cannot add the same private member more than once");g instanceof WeakSet?g.add(e):g.set(e,t)},mw=(e,g,t,l)=>(gB(e,g,"write to private field"),l?l.call(e,t):g.set(e,t),t),Oa,Za=class{constructor(e,g,t){en(this,"type"),en(this,"pointerType"),en(this,"target"),en(this,"shiftKey"),en(this,"ctrlKey"),en(this,"metaKey"),en(this,"altKey"),Aw(this,Oa,!0),this.type=e,this.pointerType=g,this.target=t.currentTarget,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.ctrlKey=t.ctrlKey,this.altKey=t.altKey}continuePropagation(){mw(this,Oa,!1)}get shouldStopPropagation(){return uw(this,Oa)}};Oa=new WeakMap;var an=e=>{var g;return(g=e==null?void 0:e.ownerDocument)!=null?g:document},Md=e=>{var g,t;return(t=(g=e==null?void 0:e.ownerDocument)==null?void 0:g.defaultView)!=null?t:window},dI="default",zd="",$a=new WeakMap;function HZ(e){if(vC()){if(dI==="default"){const g=an(e);zd=g.documentElement.style.webkitUserSelect,g.documentElement.style.webkitUserSelect="none"}dI="disabled"}else(e instanceof HTMLElement||e instanceof SVGElement)&&($a.set(e,e.style.userSelect),e.style.userSelect="none")}function ha(e){if(vC()){if(dI!=="disabled")return;dI="restoring",setTimeout(()=>{fA(()=>{if(dI==="restoring"){const g=an(e);g.documentElement.style.webkitUserSelect==="none"&&(g.documentElement.style.webkitUserSelect=zd||""),zd="",dI="default"}})},300)}else if((e instanceof HTMLElement||e instanceof SVGElement)&&e&&$a.has(e)){let g=$a.get(e);e.style.userSelect==="none"&&g&&(e.style.userSelect=g),e.getAttribute("style")===""&&e.removeAttribute("style"),$a.delete(e)}}function bw(e){let g=u.useContext(eB);if(g){let{register:t,...l}=g;e=_(l,e),t()}return VA(g,e.ref),e}var NZ=Symbol("linkClicked");function NA(e){let{onPress:g,onPressChange:t,onPressStart:l,onPressEnd:n,onPressUp:I,isDisabled:o,isPressed:C,preventFocusOnPress:a,shouldCancelOnPointerExit:r,allowTextSelectionOnPress:i,ref:s,...c}=bw(e),[d,Z]=u.useState(!1),G=u.useRef({isPressed:!1,ignoreEmulatedMouseEvents:!1,ignoreClickAfterPress:!1,didFirePressStart:!1,isTriggeringEvent:!1,activePointerId:null,target:null,isOverTarget:!1,pointerType:null}),{addGlobalListener:y,removeAllGlobalListeners:p}=SA(),h=Te((m,v)=>{let R=G.current;if(o||R.didFirePressStart)return;let W=!0;if(R.isTriggeringEvent=!0,l){let J=new Za("pressstart",v,m);l(J),W=J.shouldStopPropagation}return t&&t(!0),R.isTriggeringEvent=!1,R.didFirePressStart=!0,Z(!0),W}),b=Te((m,v,R=!0)=>{let W=G.current;if(!W.didFirePressStart)return;W.ignoreClickAfterPress=!0,W.didFirePressStart=!1,W.isTriggeringEvent=!0;let J=!0;if(n){let f=new Za("pressend",v,m);n(f),J=f.shouldStopPropagation}if(t&&t(!1),Z(!1),g&&R&&!o){let f=new Za("press",v,m);g(f),J&&(J=f.shouldStopPropagation)}return W.isTriggeringEvent=!1,J}),B=Te((m,v)=>{let R=G.current;if(!o){if(I){R.isTriggeringEvent=!0;let W=new Za("pressup",v,m);return I(W),R.isTriggeringEvent=!1,W.shouldStopPropagation}return!0}}),S=Te(m=>{let v=G.current;v.isPressed&&(v.isOverTarget&&v.target&&b(Ft(v.target,m),v.pointerType,!1),v.isPressed=!1,v.isOverTarget=!1,v.activePointerId=null,v.pointerType=null,p(),!i&&v.target&&ha(v.target))}),X=Te(m=>{r&&S(m)}),k=u.useMemo(()=>{let m=G.current,v={onKeyDown(W){var J;if(tc(W.nativeEvent,W.currentTarget)&&W.currentTarget.contains(W.target)){FZ(W.target,W.key)&&W.preventDefault();let f=!0;!m.isPressed&&!W.repeat&&(m.target=W.currentTarget,m.isPressed=!0,f=h(W,"keyboard"),y(an(W.currentTarget),"keyup",R,!1)),f&&W.stopPropagation(),W.metaKey&&El()&&((J=m.metaKeyEvents)==null||J.set(W.key,W.nativeEvent))}else W.key==="Meta"&&(m.metaKeyEvents=new Map)},onKeyUp(W){m.target&&tc(W.nativeEvent,W.currentTarget)&&!W.repeat&&W.currentTarget.contains(W.target)&&B(Ft(m.target,W),"keyboard")},onClick(W){if(!(W&&!W.currentTarget.contains(W.target))&&W&&W.button===0&&!m.isTriggeringEvent&&!kt.isOpening){let J=!0;if(o&&W.preventDefault(),!m.ignoreClickAfterPress&&!m.ignoreEmulatedMouseEvents&&!m.isPressed&&(m.pointerType==="virtual"||IC(W.nativeEvent))){!o&&!a&&Yg(W.currentTarget);let f=h(W,"virtual"),V=B(W,"virtual"),K=b(W,"virtual");J=f&&V&&K}m.ignoreEmulatedMouseEvents=!1,m.ignoreClickAfterPress=!1,J&&W.stopPropagation()}}},R=W=>{var J,f;if(m.isPressed&&m.target&&tc(W,m.target)){FZ(W.target,W.key)&&W.preventDefault();let V=W.target,K=b(Ft(m.target,W),"keyboard",m.target.contains(V));p(),K&&W.stopPropagation(),W.key!=="Enter"&&KA(m.target)&&m.target.contains(V)&&!W[NZ]&&(W[NZ]=!0,kt(m.target,W,!1)),m.isPressed=!1,(J=m.metaKeyEvents)==null||J.delete(W.key)}else if(W.key==="Meta"&&((f=m.metaKeyEvents)!=null&&f.size)){let V=m.metaKeyEvents;m.metaKeyEvents=null;for(let K of V.values())m.target&&m.target.dispatchEvent(new KeyboardEvent("keyup",K))}};if(typeof PointerEvent<"u"){v.onPointerDown=V=>{if(V.button!==0||!V.currentTarget.contains(V.target))return;if(py(V.nativeEvent)){m.pointerType="virtual";return}lc(V.currentTarget)&&V.preventDefault(),m.pointerType=V.pointerType;let K=!0;m.isPressed||(m.isPressed=!0,m.isOverTarget=!0,m.activePointerId=V.pointerId,m.target=V.currentTarget,!o&&!a&&Yg(V.currentTarget),i||HZ(m.target),K=h(V,m.pointerType),y(an(V.currentTarget),"pointermove",W,!1),y(an(V.currentTarget),"pointerup",J,!1),y(an(V.currentTarget),"pointercancel",f,!1)),K&&V.stopPropagation()},v.onMouseDown=V=>{V.currentTarget.contains(V.target)&&V.button===0&&(lc(V.currentTarget)&&V.preventDefault(),V.stopPropagation())},v.onPointerUp=V=>{!V.currentTarget.contains(V.target)||m.pointerType==="virtual"||V.button===0&&Qn(V,V.currentTarget)&&B(V,m.pointerType||V.pointerType)};let W=V=>{V.pointerId!==m.activePointerId||!m.target||(Qn(V,m.target)?m.isOverTarget||(m.isOverTarget=!0,h(Ft(m.target,V),m.pointerType)):m.isOverTarget&&(m.isOverTarget=!1,b(Ft(m.target,V),m.pointerType,!1),X(V)))},J=V=>{V.pointerId===m.activePointerId&&m.isPressed&&V.button===0&&m.target&&((Qn(V,m.target)||m.isOverTarget)&&b(Ft(m.target,V),m.pointerType),m.isPressed=!1,m.isOverTarget=!1,m.activePointerId=null,m.pointerType=null,p(),i||ha(m.target))},f=V=>{S(V)};v.onDragStart=V=>{V.currentTarget.contains(V.target)&&S(V)}}else{v.onMouseDown=f=>{if(f.button!==0||!f.currentTarget.contains(f.target))return;if(lc(f.currentTarget)&&f.preventDefault(),m.ignoreEmulatedMouseEvents){f.stopPropagation();return}m.isPressed=!0,m.isOverTarget=!0,m.target=f.currentTarget,m.pointerType=IC(f.nativeEvent)?"virtual":"mouse",!o&&!a&&Yg(f.currentTarget),h(f,m.pointerType)&&f.stopPropagation(),y(an(f.currentTarget),"mouseup",W,!1)},v.onMouseEnter=f=>{if(!f.currentTarget.contains(f.target))return;let V=!0;m.isPressed&&!m.ignoreEmulatedMouseEvents&&(m.isOverTarget=!0,V=h(f,m.pointerType)),V&&f.stopPropagation()},v.onMouseLeave=f=>{if(!f.currentTarget.contains(f.target))return;let V=!0;m.isPressed&&!m.ignoreEmulatedMouseEvents&&(m.isOverTarget=!1,V=b(f,m.pointerType,!1),X(f)),V&&f.stopPropagation()},v.onMouseUp=f=>{f.currentTarget.contains(f.target)&&!m.ignoreEmulatedMouseEvents&&f.button===0&&B(f,m.pointerType||"mouse")};let W=f=>{if(f.button===0){if(m.isPressed=!1,p(),m.ignoreEmulatedMouseEvents){m.ignoreEmulatedMouseEvents=!1;return}m.target&&(Qn(f,m.target)?b(Ft(m.target,f),m.pointerType):m.isOverTarget&&b(Ft(m.target,f),m.pointerType,!1),m.isOverTarget=!1)}};v.onTouchStart=f=>{if(!f.currentTarget.contains(f.target))return;let V=Zw(f.nativeEvent);if(!V)return;m.activePointerId=V.identifier,m.ignoreEmulatedMouseEvents=!0,m.isOverTarget=!0,m.isPressed=!0,m.target=f.currentTarget,m.pointerType="touch",!o&&!a&&Yg(f.currentTarget),i||HZ(m.target),h(f,m.pointerType)&&f.stopPropagation(),y(Md(f.currentTarget),"scroll",J,!0)},v.onTouchMove=f=>{if(!f.currentTarget.contains(f.target))return;if(!m.isPressed){f.stopPropagation();return}let V=KZ(f.nativeEvent,m.activePointerId),K=!0;V&&Qn(V,f.currentTarget)?m.isOverTarget||(m.isOverTarget=!0,K=h(f,m.pointerType)):m.isOverTarget&&(m.isOverTarget=!1,K=b(f,m.pointerType,!1),X(f)),K&&f.stopPropagation()},v.onTouchEnd=f=>{if(!f.currentTarget.contains(f.target))return;if(!m.isPressed){f.stopPropagation();return}let V=KZ(f.nativeEvent,m.activePointerId),K=!0;V&&Qn(V,f.currentTarget)?(B(f,m.pointerType),K=b(f,m.pointerType)):m.isOverTarget&&(K=b(f,m.pointerType,!1)),K&&f.stopPropagation(),m.isPressed=!1,m.activePointerId=null,m.isOverTarget=!1,m.ignoreEmulatedMouseEvents=!0,!i&&m.target&&ha(m.target),p()},v.onTouchCancel=f=>{f.currentTarget.contains(f.target)&&(f.stopPropagation(),m.isPressed&&S(f))};let J=f=>{m.isPressed&&f.target.contains(m.target)&&S({currentTarget:m.target,shiftKey:!1,ctrlKey:!1,metaKey:!1,altKey:!1})};v.onDragStart=f=>{f.currentTarget.contains(f.target)&&S(f)}}return v},[y,o,a,p,i,S,X,b,h,B]);return u.useEffect(()=>()=>{!i&&G.current.target&&ha(G.current.target)},[i]),{isPressed:C||d,pressProps:_(c,k)}}function KA(e){return e.tagName==="A"&&e.hasAttribute("href")}function tc(e,g){const{key:t,code:l}=e,n=g,I=n.getAttribute("role");return(t==="Enter"||t===" "||t==="Spacebar"||l==="Space")&&!(n instanceof Md(n).HTMLInputElement&&!tB(n,t)||n instanceof Md(n).HTMLTextAreaElement||n.isContentEditable)&&!((I==="link"||!I&&KA(n))&&t!=="Enter")}function Zw(e){const{targetTouches:g}=e;return g.length>0?g[0]:null}function KZ(e,g){const t=e.changedTouches;for(let l=0;l<t.length;l++){const n=t[l];if(n.identifier===g)return n}return null}function Ft(e,g){return{currentTarget:e,shiftKey:g.shiftKey,ctrlKey:g.ctrlKey,metaKey:g.metaKey,altKey:g.altKey}}function hw(e){let g=e.width?e.width/2:e.radiusX||0,t=e.height?e.height/2:e.radiusY||0;return{top:e.clientY-t,right:e.clientX+g,bottom:e.clientY+t,left:e.clientX-g}}function pw(e,g){return!(e.left>g.right||g.left>e.right||e.top>g.bottom||g.top>e.bottom)}function Qn(e,g){let t=g.getBoundingClientRect(),l=hw(e);return pw(t,l)}function lc(e){return!(e instanceof HTMLElement)||!e.hasAttribute("draggable")}function FZ(e,g){return e instanceof HTMLInputElement?!tB(e,g):e instanceof HTMLButtonElement?e.type!=="submit"&&e.type!=="reset":!KA(e)}var Gw=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);function tB(e,g){return e.type==="checkbox"||e.type==="radio"?g===" ":Gw.has(e.type)}var xZ=e=>A.jsxs("svg",{"aria-hidden":"true",fill:"none",focusable:"false",height:"1em",role:"presentation",shapeRendering:"geometricPrecision",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",viewBox:"0 0 24 24",width:"1em",...e,children:[A.jsx("path",{d:"M13 17l5-5-5-5"}),A.jsx("path",{d:"M6 17l5-5-5-5"})]}),pa=e=>A.jsx("svg",{"aria-hidden":"true",fill:"none",focusable:"false",height:"1em",role:"presentation",viewBox:"0 0 24 24",width:"1em",...e,children:A.jsx("path",{d:"M15.5 19l-7-7 7-7",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5"})}),yw=e=>A.jsx("svg",{"aria-hidden":"true",focusable:"false",height:"1em",role:"presentation",viewBox:"0 0 24 24",width:"1em",...e,children:A.jsx("path",{d:"M12 2a10 10 0 1010 10A10.016 10.016 0 0012 2zm3.36 12.3a.754.754 0 010 1.06.748.748 0 01-1.06 0l-2.3-2.3-2.3 2.3a.748.748 0 01-1.06 0 .754.754 0 010-1.06l2.3-2.3-2.3-2.3A.75.75 0 019.7 8.64l2.3 2.3 2.3-2.3a.75.75 0 011.06 1.06l-2.3 2.3z",fill:"currentColor"})}),EZ=e=>A.jsxs("svg",{"aria-hidden":"true",fill:"none",height:"1em",shapeRendering:"geometricPrecision",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",viewBox:"0 0 24 24",width:"1em",...e,children:[A.jsx("circle",{cx:"12",cy:"12",fill:"currentColor",r:"1"}),A.jsx("circle",{cx:"19",cy:"12",fill:"currentColor",r:"1"}),A.jsx("circle",{cx:"5",cy:"12",fill:"currentColor",r:"1"})]}),Bw=({strokeWidth:e=1.5,...g})=>A.jsx("svg",{"aria-hidden":"true",fill:"none",focusable:"false",height:"1em",role:"presentation",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:e,viewBox:"0 0 24 24",width:"1em",...g,children:A.jsx("path",{d:"m6 9 6 6 6-6"})});const lB=u.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"}),Si=u.createContext({}),Vi=u.createContext(null),Wi=typeof document<"u",FA=Wi?u.useLayoutEffect:u.useEffect,nB=u.createContext({strict:!1}),xA=e=>e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),fw="framerAppearId",IB="data-"+xA(fw);function Sw(e,g,t,l){const{visualElement:n}=u.useContext(Si),I=u.useContext(nB),o=u.useContext(Vi),C=u.useContext(lB).reducedMotion,a=u.useRef();l=l||I.renderer,!a.current&&l&&(a.current=l(e,{visualState:g,parent:n,props:t,presenceContext:o,blockInitialAnimation:o?o.initial===!1:!1,reducedMotionConfig:C}));const r=a.current;u.useInsertionEffect(()=>{r&&r.update(t,o)});const i=u.useRef(!!(t[IB]&&!window.HandoffComplete));return FA(()=>{r&&(r.render(),i.current&&r.animationState&&r.animationState.animateChanges())}),u.useEffect(()=>{r&&(r.updateFeatures(),!i.current&&r.animationState&&r.animationState.animateChanges(),i.current&&(i.current=!1,window.HandoffComplete=!0))}),r}function uI(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function Vw(e,g,t){return u.useCallback(l=>{l&&e.mount&&e.mount(l),g&&(l?g.mount(l):g.unmount()),t&&(typeof t=="function"?t(l):uI(t)&&(t.current=l))},[g])}function aC(e){return typeof e=="string"||Array.isArray(e)}function vi(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}const EA=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],DA=["initial",...EA];function Ri(e){return vi(e.animate)||DA.some(g=>aC(e[g]))}function oB(e){return!!(Ri(e)||e.variants)}function Ww(e,g){if(Ri(e)){const{initial:t,animate:l}=e;return{initial:t===!1||aC(t)?t:void 0,animate:aC(l)?l:void 0}}return e.inherit!==!1?g:{}}function vw(e){const{initial:g,animate:t}=Ww(e,u.useContext(Si));return u.useMemo(()=>({initial:g,animate:t}),[DZ(g),DZ(t)])}function DZ(e){return Array.isArray(e)?e.join(" "):e}const MZ={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},rC={};for(const e in MZ)rC[e]={isEnabled:g=>MZ[e].some(t=>!!g[t])};function Rw(e){for(const g in e)rC[g]={...rC[g],...e[g]}}const MA=u.createContext({}),CB=u.createContext({}),Xw=Symbol.for("motionComponentSymbol");function kw({preloadedFeatures:e,createVisualElement:g,useRender:t,useVisualState:l,Component:n}){e&&Rw(e);function I(C,a){let r;const i={...u.useContext(lB),...C,layoutId:Jw(C)},{isStatic:s}=i,c=vw(C),d=l(C,s);if(!s&&Wi){c.visualElement=Sw(n,d,i,g);const Z=u.useContext(CB),G=u.useContext(nB).strict;c.visualElement&&(r=c.visualElement.loadFeatures(i,G,e,Z))}return u.createElement(Si.Provider,{value:c},r&&c.visualElement?u.createElement(r,{visualElement:c.visualElement,...i}):null,t(n,C,Vw(d,c.visualElement,a),d,s,c.visualElement))}const o=u.forwardRef(I);return o[Xw]=n,o}function Jw({layoutId:e}){const g=u.useContext(MA).id;return g&&e!==void 0?g+"-"+e:e}function Yw(e){function g(l,n={}){return kw(e(l,n))}if(typeof Proxy>"u")return g;const t=new Map;return new Proxy(g,{get:(l,n)=>(t.has(n)||t.set(n,g(n)),t.get(n))})}const ww=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function zA(e){return typeof e!="string"||e.includes("-")?!1:!!(ww.indexOf(e)>-1||/[A-Z]/.test(e))}const xr={};function Hw(e){Object.assign(xr,e)}const RC=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],wn=new Set(RC);function aB(e,{layout:g,layoutId:t}){return wn.has(e)||e.startsWith("origin")||(g||t!==void 0)&&(!!xr[e]||e==="opacity")}const vg=e=>!!(e&&e.getVelocity),Nw={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},Kw=RC.length;function Fw(e,{enableHardwareAcceleration:g=!0,allowTransformNone:t=!0},l,n){let I="";for(let o=0;o<Kw;o++){const C=RC[o];if(e[C]!==void 0){const a=Nw[C]||C;I+=`${a}(${e[C]}) `}}return g&&!e.z&&(I+="translateZ(0)"),I=I.trim(),n?I=n(e,l?"":I):t&&l&&(I="none"),I}const rB=e=>g=>typeof g=="string"&&g.startsWith(e),iB=rB("--"),Td=rB("var(--"),xw=/var\s*\(\s*--[\w-]+(\s*,\s*(?:(?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)+)?\s*\)/g,Ew=(e,g)=>g&&typeof e=="number"?g.transform(e):e,Dl=(e,g,t)=>Math.min(Math.max(t,e),g),Hn={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},No={...Hn,transform:e=>Dl(0,1,e)},Ga={...Hn,default:1},Ko=e=>Math.round(e*1e5)/1e5,Xi=/(-)?([\d]*\.?[\d])+/g,sB=/(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))/gi,Dw=/^(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))$/i;function XC(e){return typeof e=="string"}const kC=e=>({test:g=>XC(g)&&g.endsWith(e)&&g.split(" ").length===1,parse:parseFloat,transform:g=>`${g}${e}`}),dl=kC("deg"),Xt=kC("%"),O=kC("px"),Mw=kC("vh"),zw=kC("vw"),zZ={...Xt,parse:e=>Xt.parse(e)/100,transform:e=>Xt.transform(e*100)},TZ={...Hn,transform:Math.round},cB={borderWidth:O,borderTopWidth:O,borderRightWidth:O,borderBottomWidth:O,borderLeftWidth:O,borderRadius:O,radius:O,borderTopLeftRadius:O,borderTopRightRadius:O,borderBottomRightRadius:O,borderBottomLeftRadius:O,width:O,maxWidth:O,height:O,maxHeight:O,size:O,top:O,right:O,bottom:O,left:O,padding:O,paddingTop:O,paddingRight:O,paddingBottom:O,paddingLeft:O,margin:O,marginTop:O,marginRight:O,marginBottom:O,marginLeft:O,rotate:dl,rotateX:dl,rotateY:dl,rotateZ:dl,scale:Ga,scaleX:Ga,scaleY:Ga,scaleZ:Ga,skew:dl,skewX:dl,skewY:dl,distance:O,translateX:O,translateY:O,translateZ:O,x:O,y:O,z:O,perspective:O,transformPerspective:O,opacity:No,originX:zZ,originY:zZ,originZ:O,zIndex:TZ,fillOpacity:No,strokeOpacity:No,numOctaves:TZ};function TA(e,g,t,l){const{style:n,vars:I,transform:o,transformOrigin:C}=e;let a=!1,r=!1,i=!0;for(const s in g){const c=g[s];if(iB(s)){I[s]=c;continue}const d=cB[s],Z=Ew(c,d);if(wn.has(s)){if(a=!0,o[s]=Z,!i)continue;c!==(d.default||0)&&(i=!1)}else s.startsWith("origin")?(r=!0,C[s]=Z):n[s]=Z}if(g.transform||(a||l?n.transform=Fw(e.transform,t,i,l):n.transform&&(n.transform="none")),r){const{originX:s="50%",originY:c="50%",originZ:d=0}=C;n.transformOrigin=`${s} ${c} ${d}`}}const LA=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function dB(e,g,t){for(const l in g)!vg(g[l])&&!aB(l,t)&&(e[l]=g[l])}function Tw({transformTemplate:e},g,t){return u.useMemo(()=>{const l=LA();return TA(l,g,{enableHardwareAcceleration:!t},e),Object.assign({},l.vars,l.style)},[g])}function Lw(e,g,t){const l=e.style||{},n={};return dB(n,l,e),Object.assign(n,Tw(e,g,t)),e.transformValues?e.transformValues(n):n}function Uw(e,g,t){const l={},n=Lw(e,g,t);return e.drag&&e.dragListener!==!1&&(l.draggable=!1,n.userSelect=n.WebkitUserSelect=n.WebkitTouchCallout="none",n.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(l.tabIndex=0),l.style=n,l}const Qw=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","transformValues","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Er(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||Qw.has(e)}let uB=e=>!Er(e);function jw(e){e&&(uB=g=>g.startsWith("on")?!Er(g):e(g))}try{jw(require("@emotion/is-prop-valid").default)}catch{}function Pw(e,g,t){const l={};for(const n in e)n==="values"&&typeof e.values=="object"||(uB(n)||t===!0&&Er(n)||!g&&!Er(n)||e.draggable&&n.startsWith("onDrag"))&&(l[n]=e[n]);return l}function LZ(e,g,t){return typeof e=="string"?e:O.transform(g+t*e)}function Ow(e,g,t){const l=LZ(g,e.x,e.width),n=LZ(t,e.y,e.height);return`${l} ${n}`}const $w={offset:"stroke-dashoffset",array:"stroke-dasharray"},qw={offset:"strokeDashoffset",array:"strokeDasharray"};function _w(e,g,t=1,l=0,n=!0){e.pathLength=1;const I=n?$w:qw;e[I.offset]=O.transform(-l);const o=O.transform(g),C=O.transform(t);e[I.array]=`${o} ${C}`}function UA(e,{attrX:g,attrY:t,attrScale:l,originX:n,originY:I,pathLength:o,pathSpacing:C=1,pathOffset:a=0,...r},i,s,c){if(TA(e,r,i,c),s){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:d,style:Z,dimensions:G}=e;d.transform&&(G&&(Z.transform=d.transform),delete d.transform),G&&(n!==void 0||I!==void 0||Z.transform)&&(Z.transformOrigin=Ow(G,n!==void 0?n:.5,I!==void 0?I:.5)),g!==void 0&&(d.x=g),t!==void 0&&(d.y=t),l!==void 0&&(d.scale=l),o!==void 0&&_w(d,o,C,a,!1)}const AB=()=>({...LA(),attrs:{}}),QA=e=>typeof e=="string"&&e.toLowerCase()==="svg";function e1(e,g,t,l){const n=u.useMemo(()=>{const I=AB();return UA(I,g,{enableHardwareAcceleration:!1},QA(l),e.transformTemplate),{...I.attrs,style:{...I.style}}},[g]);if(e.style){const I={};dB(I,e.style,e),n.style={...I,...n.style}}return n}function g1(e=!1){return(t,l,n,{latestValues:I},o)=>{const a=(zA(t)?e1:Uw)(l,I,o,t),i={...Pw(l,typeof t=="string",e),...a,ref:n},{children:s}=l,c=u.useMemo(()=>vg(s)?s.get():s,[s]);return u.createElement(t,{...i,children:c})}}function mB(e,{style:g,vars:t},l,n){Object.assign(e.style,g,n&&n.getProjectionStyles(l));for(const I in t)e.style.setProperty(I,t[I])}const bB=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function ZB(e,g,t,l){mB(e,g,void 0,l);for(const n in g.attrs)e.setAttribute(bB.has(n)?n:xA(n),g.attrs[n])}function jA(e,g){const{style:t}=e,l={};for(const n in t)(vg(t[n])||g.style&&vg(g.style[n])||aB(n,e))&&(l[n]=t[n]);return l}function hB(e,g){const t=jA(e,g);for(const l in e)if(vg(e[l])||vg(g[l])){const n=RC.indexOf(l)!==-1?"attr"+l.charAt(0).toUpperCase()+l.substring(1):l;t[n]=e[l]}return t}function PA(e,g,t,l={},n={}){return typeof g=="function"&&(g=g(t!==void 0?t:e.custom,l,n)),typeof g=="string"&&(g=e.variants&&e.variants[g]),typeof g=="function"&&(g=g(t!==void 0?t:e.custom,l,n)),g}function pB(e){const g=u.useRef(null);return g.current===null&&(g.current=e()),g.current}const Dr=e=>Array.isArray(e),t1=e=>!!(e&&typeof e=="object"&&e.mix&&e.toValue),l1=e=>Dr(e)?e[e.length-1]||0:e;function qa(e){const g=vg(e)?e.get():e;return t1(g)?g.toValue():g}function n1({scrapeMotionValuesFromProps:e,createRenderState:g,onMount:t},l,n,I){const o={latestValues:I1(l,n,I,e),renderState:g()};return t&&(o.mount=C=>t(l,C,o)),o}const GB=e=>(g,t)=>{const l=u.useContext(Si),n=u.useContext(Vi),I=()=>n1(e,g,l,n);return t?I():pB(I)};function I1(e,g,t,l){const n={},I=l(e,{});for(const c in I)n[c]=qa(I[c]);let{initial:o,animate:C}=e;const a=Ri(e),r=oB(e);g&&r&&!a&&e.inherit!==!1&&(o===void 0&&(o=g.initial),C===void 0&&(C=g.animate));let i=t?t.initial===!1:!1;i=i||o===!1;const s=i?C:o;return s&&typeof s!="boolean"&&!vi(s)&&(Array.isArray(s)?s:[s]).forEach(d=>{const Z=PA(e,d);if(!Z)return;const{transitionEnd:G,transition:y,...p}=Z;for(const h in p){let b=p[h];if(Array.isArray(b)){const B=i?b.length-1:0;b=b[B]}b!==null&&(n[h]=b)}for(const h in G)n[h]=G[h]}),n}const Fe=e=>e;class UZ{constructor(){this.order=[],this.scheduled=new Set}add(g){if(!this.scheduled.has(g))return this.scheduled.add(g),this.order.push(g),!0}remove(g){const t=this.order.indexOf(g);t!==-1&&(this.order.splice(t,1),this.scheduled.delete(g))}clear(){this.order.length=0,this.scheduled.clear()}}function o1(e){let g=new UZ,t=new UZ,l=0,n=!1,I=!1;const o=new WeakSet,C={schedule:(a,r=!1,i=!1)=>{const s=i&&n,c=s?g:t;return r&&o.add(a),c.add(a)&&s&&n&&(l=g.order.length),a},cancel:a=>{t.remove(a),o.delete(a)},process:a=>{if(n){I=!0;return}if(n=!0,[g,t]=[t,g],t.clear(),l=g.order.length,l)for(let r=0;r<l;r++){const i=g.order[r];i(a),o.has(i)&&(C.schedule(i),e())}n=!1,I&&(I=!1,C.process(a))}};return C}const ya=["prepare","read","update","preRender","render","postRender"],C1=40;function a1(e,g){let t=!1,l=!0;const n={delta:0,timestamp:0,isProcessing:!1},I=ya.reduce((s,c)=>(s[c]=o1(()=>t=!0),s),{}),o=s=>I[s].process(n),C=()=>{const s=performance.now();t=!1,n.delta=l?1e3/60:Math.max(Math.min(s-n.timestamp,C1),1),n.timestamp=s,n.isProcessing=!0,ya.forEach(o),n.isProcessing=!1,t&&g&&(l=!1,e(C))},a=()=>{t=!0,l=!0,n.isProcessing||e(C)};return{schedule:ya.reduce((s,c)=>{const d=I[c];return s[c]=(Z,G=!1,y=!1)=>(t||a(),d.schedule(Z,G,y)),s},{}),cancel:s=>ya.forEach(c=>I[c].cancel(s)),state:n,steps:I}}const{schedule:me,cancel:tl,state:ig,steps:nc}=a1(typeof requestAnimationFrame<"u"?requestAnimationFrame:Fe,!0),r1={useVisualState:GB({scrapeMotionValuesFromProps:hB,createRenderState:AB,onMount:(e,g,{renderState:t,latestValues:l})=>{me.read(()=>{try{t.dimensions=typeof g.getBBox=="function"?g.getBBox():g.getBoundingClientRect()}catch{t.dimensions={x:0,y:0,width:0,height:0}}}),me.render(()=>{UA(t,l,{enableHardwareAcceleration:!1},QA(g.tagName),e.transformTemplate),ZB(g,t)})}})},i1={useVisualState:GB({scrapeMotionValuesFromProps:jA,createRenderState:LA})};function s1(e,{forwardMotionProps:g=!1},t,l){return{...zA(e)?r1:i1,preloadedFeatures:t,useRender:g1(g),createVisualElement:l,Component:e}}function Ut(e,g,t,l={passive:!0}){return e.addEventListener(g,t,l),()=>e.removeEventListener(g,t)}const yB=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1;function ki(e,g="page"){return{point:{x:e[g+"X"],y:e[g+"Y"]}}}const c1=e=>g=>yB(g)&&e(g,ki(g));function jt(e,g,t,l){return Ut(e,g,c1(t),l)}const d1=(e,g)=>t=>g(e(t)),Kl=(...e)=>e.reduce(d1);function BB(e){let g=null;return()=>{const t=()=>{g=null};return g===null?(g=e,t):!1}}const QZ=BB("dragHorizontal"),jZ=BB("dragVertical");function fB(e){let g=!1;if(e==="y")g=jZ();else if(e==="x")g=QZ();else{const t=QZ(),l=jZ();t&&l?g=()=>{t(),l()}:(t&&t(),l&&l())}return g}function SB(){const e=fB(!0);return e?(e(),!1):!0}class jl{constructor(g){this.isMounted=!1,this.node=g}update(){}}function PZ(e,g){const t="pointer"+(g?"enter":"leave"),l="onHover"+(g?"Start":"End"),n=(I,o)=>{if(I.pointerType==="touch"||SB())return;const C=e.getProps();e.animationState&&C.whileHover&&e.animationState.setActive("whileHover",g),C[l]&&me.update(()=>C[l](I,o))};return jt(e.current,t,n,{passive:!e.getProps()[l]})}class u1 extends jl{mount(){this.unmount=Kl(PZ(this.node,!0),PZ(this.node,!1))}unmount(){}}class A1 extends jl{constructor(){super(...arguments),this.isActive=!1}onFocus(){let g=!1;try{g=this.node.current.matches(":focus-visible")}catch{g=!0}!g||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Kl(Ut(this.node.current,"focus",()=>this.onFocus()),Ut(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const VB=(e,g)=>g?e===g?!0:VB(e,g.parentElement):!1;function Ic(e,g){if(!g)return;const t=new PointerEvent("pointer"+e);g(t,ki(t))}class m1 extends jl{constructor(){super(...arguments),this.removeStartListeners=Fe,this.removeEndListeners=Fe,this.removeAccessibleListeners=Fe,this.startPointerPress=(g,t)=>{if(this.isPressing)return;this.removeEndListeners();const l=this.node.getProps(),I=jt(window,"pointerup",(C,a)=>{if(!this.checkPressEnd())return;const{onTap:r,onTapCancel:i,globalTapTarget:s}=this.node.getProps();me.update(()=>{!s&&!VB(this.node.current,C.target)?i&&i(C,a):r&&r(C,a)})},{passive:!(l.onTap||l.onPointerUp)}),o=jt(window,"pointercancel",(C,a)=>this.cancelPress(C,a),{passive:!(l.onTapCancel||l.onPointerCancel)});this.removeEndListeners=Kl(I,o),this.startPress(g,t)},this.startAccessiblePress=()=>{const g=I=>{if(I.key!=="Enter"||this.isPressing)return;const o=C=>{C.key!=="Enter"||!this.checkPressEnd()||Ic("up",(a,r)=>{const{onTap:i}=this.node.getProps();i&&me.update(()=>i(a,r))})};this.removeEndListeners(),this.removeEndListeners=Ut(this.node.current,"keyup",o),Ic("down",(C,a)=>{this.startPress(C,a)})},t=Ut(this.node.current,"keydown",g),l=()=>{this.isPressing&&Ic("cancel",(I,o)=>this.cancelPress(I,o))},n=Ut(this.node.current,"blur",l);this.removeAccessibleListeners=Kl(t,n)}}startPress(g,t){this.isPressing=!0;const{onTapStart:l,whileTap:n}=this.node.getProps();n&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),l&&me.update(()=>l(g,t))}checkPressEnd(){return this.removeEndListeners(),this.isPressing=!1,this.node.getProps().whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!SB()}cancelPress(g,t){if(!this.checkPressEnd())return;const{onTapCancel:l}=this.node.getProps();l&&me.update(()=>l(g,t))}mount(){const g=this.node.getProps(),t=jt(g.globalTapTarget?window:this.node.current,"pointerdown",this.startPointerPress,{passive:!(g.onTapStart||g.onPointerStart)}),l=Ut(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=Kl(t,l)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}const Ld=new WeakMap,oc=new WeakMap,b1=e=>{const g=Ld.get(e.target);g&&g(e)},Z1=e=>{e.forEach(b1)};function h1({root:e,...g}){const t=e||document;oc.has(t)||oc.set(t,{});const l=oc.get(t),n=JSON.stringify(g);return l[n]||(l[n]=new IntersectionObserver(Z1,{root:e,...g})),l[n]}function p1(e,g,t){const l=h1(g);return Ld.set(e,t),l.observe(e),()=>{Ld.delete(e),l.unobserve(e)}}const G1={some:0,all:1};class y1 extends jl{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:g={}}=this.node.getProps(),{root:t,margin:l,amount:n="some",once:I}=g,o={root:t?t.current:void 0,rootMargin:l,threshold:typeof n=="number"?n:G1[n]},C=a=>{const{isIntersecting:r}=a;if(this.isInView===r||(this.isInView=r,I&&!r&&this.hasEnteredView))return;r&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",r);const{onViewportEnter:i,onViewportLeave:s}=this.node.getProps(),c=r?i:s;c&&c(a)};return p1(this.node.current,o,C)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:g,prevProps:t}=this.node;["amount","margin","root"].some(B1(g,t))&&this.startObserver()}unmount(){}}function B1({viewport:e={}},{viewport:g={}}={}){return t=>e[t]!==g[t]}const f1={inView:{Feature:y1},tap:{Feature:m1},focus:{Feature:A1},hover:{Feature:u1}};function WB(e,g){if(!Array.isArray(g))return!1;const t=g.length;if(t!==e.length)return!1;for(let l=0;l<t;l++)if(g[l]!==e[l])return!1;return!0}function S1(e){const g={};return e.values.forEach((t,l)=>g[l]=t.get()),g}function V1(e){const g={};return e.values.forEach((t,l)=>g[l]=t.getVelocity()),g}function Ji(e,g,t){const l=e.getProps();return PA(l,g,t!==void 0?t:l.custom,S1(e),V1(e))}let OA=Fe;const hn=e=>e*1e3,Pt=e=>e/1e3,W1={current:!1},vB=e=>Array.isArray(e)&&typeof e[0]=="number";function RB(e){return!!(!e||typeof e=="string"&&XB[e]||vB(e)||Array.isArray(e)&&e.every(RB))}const fo=([e,g,t,l])=>`cubic-bezier(${e}, ${g}, ${t}, ${l})`,XB={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:fo([0,.65,.55,1]),circOut:fo([.55,0,1,.45]),backIn:fo([.31,.01,.66,-.59]),backOut:fo([.33,1.53,.69,.99])};function kB(e){if(e)return vB(e)?fo(e):Array.isArray(e)?e.map(kB):XB[e]}function v1(e,g,t,{delay:l=0,duration:n,repeat:I=0,repeatType:o="loop",ease:C,times:a}={}){const r={[g]:t};a&&(r.offset=a);const i=kB(C);return Array.isArray(i)&&(r.easing=i),e.animate(r,{delay:l,duration:n,easing:Array.isArray(i)?"linear":i,fill:"both",iterations:I+1,direction:o==="reverse"?"alternate":"normal"})}function R1(e,{repeat:g,repeatType:t="loop"}){const l=g&&t!=="loop"&&g%2===1?0:e.length-1;return e[l]}const JB=(e,g,t)=>(((1-3*t+3*g)*e+(3*t-6*g))*e+3*g)*e,X1=1e-7,k1=12;function J1(e,g,t,l,n){let I,o,C=0;do o=g+(t-g)/2,I=JB(o,l,n)-e,I>0?t=o:g=o;while(Math.abs(I)>X1&&++C<k1);return o}function JC(e,g,t,l){if(e===g&&t===l)return Fe;const n=I=>J1(I,0,1,e,t);return I=>I===0||I===1?I:JB(n(I),g,l)}const Y1=JC(.42,0,1,1),w1=JC(0,0,.58,1),YB=JC(.42,0,.58,1),H1=e=>Array.isArray(e)&&typeof e[0]!="number",wB=e=>g=>g<=.5?e(2*g)/2:(2-e(2*(1-g)))/2,HB=e=>g=>1-e(1-g),$A=e=>1-Math.sin(Math.acos(e)),NB=HB($A),N1=wB($A),KB=JC(.33,1.53,.69,.99),qA=HB(KB),K1=wB(qA),F1=e=>(e*=2)<1?.5*qA(e):.5*(2-Math.pow(2,-10*(e-1))),x1={linear:Fe,easeIn:Y1,easeInOut:YB,easeOut:w1,circIn:$A,circInOut:N1,circOut:NB,backIn:qA,backInOut:K1,backOut:KB,anticipate:F1},OZ=e=>{if(Array.isArray(e)){OA(e.length===4);const[g,t,l,n]=e;return JC(g,t,l,n)}else if(typeof e=="string")return x1[e];return e},_A=(e,g)=>t=>!!(XC(t)&&Dw.test(t)&&t.startsWith(e)||g&&Object.prototype.hasOwnProperty.call(t,g)),FB=(e,g,t)=>l=>{if(!XC(l))return l;const[n,I,o,C]=l.match(Xi);return{[e]:parseFloat(n),[g]:parseFloat(I),[t]:parseFloat(o),alpha:C!==void 0?parseFloat(C):1}},E1=e=>Dl(0,255,e),Cc={...Hn,transform:e=>Math.round(E1(e))},An={test:_A("rgb","red"),parse:FB("red","green","blue"),transform:({red:e,green:g,blue:t,alpha:l=1})=>"rgba("+Cc.transform(e)+", "+Cc.transform(g)+", "+Cc.transform(t)+", "+Ko(No.transform(l))+")"};function D1(e){let g="",t="",l="",n="";return e.length>5?(g=e.substring(1,3),t=e.substring(3,5),l=e.substring(5,7),n=e.substring(7,9)):(g=e.substring(1,2),t=e.substring(2,3),l=e.substring(3,4),n=e.substring(4,5),g+=g,t+=t,l+=l,n+=n),{red:parseInt(g,16),green:parseInt(t,16),blue:parseInt(l,16),alpha:n?parseInt(n,16)/255:1}}const Ud={test:_A("#"),parse:D1,transform:An.transform},AI={test:_A("hsl","hue"),parse:FB("hue","saturation","lightness"),transform:({hue:e,saturation:g,lightness:t,alpha:l=1})=>"hsla("+Math.round(e)+", "+Xt.transform(Ko(g))+", "+Xt.transform(Ko(t))+", "+Ko(No.transform(l))+")"},ug={test:e=>An.test(e)||Ud.test(e)||AI.test(e),parse:e=>An.test(e)?An.parse(e):AI.test(e)?AI.parse(e):Ud.parse(e),transform:e=>XC(e)?e:e.hasOwnProperty("red")?An.transform(e):AI.transform(e)},ve=(e,g,t)=>-t*e+t*g+e;function ac(e,g,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?e+(g-e)*6*t:t<1/2?g:t<2/3?e+(g-e)*(2/3-t)*6:e}function M1({hue:e,saturation:g,lightness:t,alpha:l}){e/=360,g/=100,t/=100;let n=0,I=0,o=0;if(!g)n=I=o=t;else{const C=t<.5?t*(1+g):t+g-t*g,a=2*t-C;n=ac(a,C,e+1/3),I=ac(a,C,e),o=ac(a,C,e-1/3)}return{red:Math.round(n*255),green:Math.round(I*255),blue:Math.round(o*255),alpha:l}}const rc=(e,g,t)=>{const l=e*e;return Math.sqrt(Math.max(0,t*(g*g-l)+l))},z1=[Ud,An,AI],T1=e=>z1.find(g=>g.test(e));function $Z(e){const g=T1(e);let t=g.parse(e);return g===AI&&(t=M1(t)),t}const xB=(e,g)=>{const t=$Z(e),l=$Z(g),n={...t};return I=>(n.red=rc(t.red,l.red,I),n.green=rc(t.green,l.green,I),n.blue=rc(t.blue,l.blue,I),n.alpha=ve(t.alpha,l.alpha,I),An.transform(n))};function L1(e){var g,t;return isNaN(e)&&XC(e)&&(((g=e.match(Xi))===null||g===void 0?void 0:g.length)||0)+(((t=e.match(sB))===null||t===void 0?void 0:t.length)||0)>0}const EB={regex:xw,countKey:"Vars",token:"${v}",parse:Fe},DB={regex:sB,countKey:"Colors",token:"${c}",parse:ug.parse},MB={regex:Xi,countKey:"Numbers",token:"${n}",parse:Hn.parse};function ic(e,{regex:g,countKey:t,token:l,parse:n}){const I=e.tokenised.match(g);I&&(e["num"+t]=I.length,e.tokenised=e.tokenised.replace(g,l),e.values.push(...I.map(n)))}function Mr(e){const g=e.toString(),t={value:g,tokenised:g,values:[],numVars:0,numColors:0,numNumbers:0};return t.value.includes("var(--")&&ic(t,EB),ic(t,DB),ic(t,MB),t}function zB(e){return Mr(e).values}function TB(e){const{values:g,numColors:t,numVars:l,tokenised:n}=Mr(e),I=g.length;return o=>{let C=n;for(let a=0;a<I;a++)a<l?C=C.replace(EB.token,o[a]):a<l+t?C=C.replace(DB.token,ug.transform(o[a])):C=C.replace(MB.token,Ko(o[a]));return C}}const U1=e=>typeof e=="number"?0:e;function Q1(e){const g=zB(e);return TB(e)(g.map(U1))}const Ml={test:L1,parse:zB,createTransformer:TB,getAnimatableNone:Q1},LB=(e,g)=>t=>`${t>0?g:e}`;function UB(e,g){return typeof e=="number"?t=>ve(e,g,t):ug.test(e)?xB(e,g):e.startsWith("var(")?LB(e,g):jB(e,g)}const QB=(e,g)=>{const t=[...e],l=t.length,n=e.map((I,o)=>UB(I,g[o]));return I=>{for(let o=0;o<l;o++)t[o]=n[o](I);return t}},j1=(e,g)=>{const t={...e,...g},l={};for(const n in t)e[n]!==void 0&&g[n]!==void 0&&(l[n]=UB(e[n],g[n]));return n=>{for(const I in l)t[I]=l[I](n);return t}},jB=(e,g)=>{const t=Ml.createTransformer(g),l=Mr(e),n=Mr(g);return l.numVars===n.numVars&&l.numColors===n.numColors&&l.numNumbers>=n.numNumbers?Kl(QB(l.values,n.values),t):LB(e,g)},iC=(e,g,t)=>{const l=g-e;return l===0?1:(t-e)/l},qZ=(e,g)=>t=>ve(e,g,t);function P1(e){return typeof e=="number"?qZ:typeof e=="string"?ug.test(e)?xB:jB:Array.isArray(e)?QB:typeof e=="object"?j1:qZ}function O1(e,g,t){const l=[],n=t||P1(e[0]),I=e.length-1;for(let o=0;o<I;o++){let C=n(e[o],e[o+1]);if(g){const a=Array.isArray(g)?g[o]||Fe:g;C=Kl(a,C)}l.push(C)}return l}function PB(e,g,{clamp:t=!0,ease:l,mixer:n}={}){const I=e.length;if(OA(I===g.length),I===1)return()=>g[0];e[0]>e[I-1]&&(e=[...e].reverse(),g=[...g].reverse());const o=O1(g,l,n),C=o.length,a=r=>{let i=0;if(C>1)for(;i<e.length-2&&!(r<e[i+1]);i++);const s=iC(e[i],e[i+1],r);return o[i](s)};return t?r=>a(Dl(e[0],e[I-1],r)):a}function $1(e,g){const t=e[e.length-1];for(let l=1;l<=g;l++){const n=iC(0,g,l);e.push(ve(t,1,n))}}function q1(e){const g=[0];return $1(g,e.length-1),g}function _1(e,g){return e.map(t=>t*g)}function eH(e,g){return e.map(()=>g||YB).splice(0,e.length-1)}function zr({duration:e=300,keyframes:g,times:t,ease:l="easeInOut"}){const n=H1(l)?l.map(OZ):OZ(l),I={done:!1,value:g[0]},o=_1(t&&t.length===g.length?t:q1(g),e),C=PB(o,g,{ease:Array.isArray(n)?n:eH(g,n)});return{calculatedDuration:e,next:a=>(I.value=C(a),I.done=a>=e,I)}}function OB(e,g){return g?e*(1e3/g):0}const gH=5;function $B(e,g,t){const l=Math.max(g-gH,0);return OB(t-e(l),g-l)}const sc=.001,tH=.01,lH=10,nH=.05,IH=1;function oH({duration:e=800,bounce:g=.25,velocity:t=0,mass:l=1}){let n,I,o=1-g;o=Dl(nH,IH,o),e=Dl(tH,lH,Pt(e)),o<1?(n=r=>{const i=r*o,s=i*e,c=i-t,d=Qd(r,o),Z=Math.exp(-s);return sc-c/d*Z},I=r=>{const s=r*o*e,c=s*t+t,d=Math.pow(o,2)*Math.pow(r,2)*e,Z=Math.exp(-s),G=Qd(Math.pow(r,2),o);return(-n(r)+sc>0?-1:1)*((c-d)*Z)/G}):(n=r=>{const i=Math.exp(-r*e),s=(r-t)*e+1;return-sc+i*s},I=r=>{const i=Math.exp(-r*e),s=(t-r)*(e*e);return i*s});const C=5/e,a=aH(n,I,C);if(e=hn(e),isNaN(a))return{stiffness:100,damping:10,duration:e};{const r=Math.pow(a,2)*l;return{stiffness:r,damping:o*2*Math.sqrt(l*r),duration:e}}}const CH=12;function aH(e,g,t){let l=t;for(let n=1;n<CH;n++)l=l-e(l)/g(l);return l}function Qd(e,g){return e*Math.sqrt(1-g*g)}const rH=["duration","bounce"],iH=["stiffness","damping","mass"];function _Z(e,g){return g.some(t=>e[t]!==void 0)}function sH(e){let g={velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1,...e};if(!_Z(e,iH)&&_Z(e,rH)){const t=oH(e);g={...g,...t,mass:1},g.isResolvedFromDuration=!0}return g}function qB({keyframes:e,restDelta:g,restSpeed:t,...l}){const n=e[0],I=e[e.length-1],o={done:!1,value:n},{stiffness:C,damping:a,mass:r,duration:i,velocity:s,isResolvedFromDuration:c}=sH({...l,velocity:-Pt(l.velocity||0)}),d=s||0,Z=a/(2*Math.sqrt(C*r)),G=I-n,y=Pt(Math.sqrt(C/r)),p=Math.abs(G)<5;t||(t=p?.01:2),g||(g=p?.005:.5);let h;if(Z<1){const b=Qd(y,Z);h=B=>{const S=Math.exp(-Z*y*B);return I-S*((d+Z*y*G)/b*Math.sin(b*B)+G*Math.cos(b*B))}}else if(Z===1)h=b=>I-Math.exp(-y*b)*(G+(d+y*G)*b);else{const b=y*Math.sqrt(Z*Z-1);h=B=>{const S=Math.exp(-Z*y*B),X=Math.min(b*B,300);return I-S*((d+Z*y*G)*Math.sinh(X)+b*G*Math.cosh(X))/b}}return{calculatedDuration:c&&i||null,next:b=>{const B=h(b);if(c)o.done=b>=i;else{let S=d;b!==0&&(Z<1?S=$B(h,b,B):S=0);const X=Math.abs(S)<=t,k=Math.abs(I-B)<=g;o.done=X&&k}return o.value=o.done?I:B,o}}}function e0({keyframes:e,velocity:g=0,power:t=.8,timeConstant:l=325,bounceDamping:n=10,bounceStiffness:I=500,modifyTarget:o,min:C,max:a,restDelta:r=.5,restSpeed:i}){const s=e[0],c={done:!1,value:s},d=m=>C!==void 0&&m<C||a!==void 0&&m>a,Z=m=>C===void 0?a:a===void 0||Math.abs(C-m)<Math.abs(a-m)?C:a;let G=t*g;const y=s+G,p=o===void 0?y:o(y);p!==y&&(G=p-s);const h=m=>-G*Math.exp(-m/l),b=m=>p+h(m),B=m=>{const v=h(m),R=b(m);c.done=Math.abs(v)<=r,c.value=c.done?p:R};let S,X;const k=m=>{d(c.value)&&(S=m,X=qB({keyframes:[c.value,Z(c.value)],velocity:$B(b,m,c.value),damping:n,stiffness:I,restDelta:r,restSpeed:i}))};return k(0),{calculatedDuration:null,next:m=>{let v=!1;return!X&&S===void 0&&(v=!0,B(m),k(m)),S!==void 0&&m>S?X.next(m-S):(!v&&B(m),c)}}}const cH=e=>{const g=({timestamp:t})=>e(t);return{start:()=>me.update(g,!0),stop:()=>tl(g),now:()=>ig.isProcessing?ig.timestamp:performance.now()}},g0=2e4;function t0(e){let g=0;const t=50;let l=e.next(g);for(;!l.done&&g<g0;)g+=t,l=e.next(g);return g>=g0?1/0:g}const dH={decay:e0,inertia:e0,tween:zr,keyframes:zr,spring:qB};function Tr({autoplay:e=!0,delay:g=0,driver:t=cH,keyframes:l,type:n="keyframes",repeat:I=0,repeatDelay:o=0,repeatType:C="loop",onPlay:a,onStop:r,onComplete:i,onUpdate:s,...c}){let d=1,Z=!1,G,y;const p=()=>{y=new Promise(E=>{G=E})};p();let h;const b=dH[n]||zr;let B;b!==zr&&typeof l[0]!="number"&&(B=PB([0,100],l,{clamp:!1}),l=[0,100]);const S=b({...c,keyframes:l});let X;C==="mirror"&&(X=b({...c,keyframes:[...l].reverse(),velocity:-(c.velocity||0)}));let k="idle",m=null,v=null,R=null;S.calculatedDuration===null&&I&&(S.calculatedDuration=t0(S));const{calculatedDuration:W}=S;let J=1/0,f=1/0;W!==null&&(J=W+o,f=J*(I+1)-o);let V=0;const K=E=>{if(v===null)return;d>0&&(v=Math.min(v,E)),d<0&&(v=Math.min(E-f/d,v)),m!==null?V=m:V=Math.round(E-v)*d;const z=V-g*(d>=0?1:-1),U=d>=0?z<0:z>f;V=Math.max(z,0),k==="finished"&&m===null&&(V=f);let j=V,ge=S;if(I){const oe=Math.min(V,f)/J;let Q=Math.floor(oe),re=oe%1;!re&&oe>=1&&(re=1),re===1&&Q--,Q=Math.min(Q,I+1),!!(Q%2)&&(C==="reverse"?(re=1-re,o&&(re-=o/J)):C==="mirror"&&(ge=X)),j=Dl(0,1,re)*J}const $=U?{done:!1,value:l[0]}:ge.next(j);B&&($.value=B($.value));let{done:ae}=$;!U&&W!==null&&(ae=d>=0?V>=f:V<=0);const Je=m===null&&(k==="finished"||k==="running"&&ae);return s&&s($.value),Je&&N(),$},x=()=>{h&&h.stop(),h=void 0},Y=()=>{k="idle",x(),G(),p(),v=R=null},N=()=>{k="finished",i&&i(),x(),G()},F=()=>{if(Z)return;h||(h=t(K));const E=h.now();a&&a(),m!==null?v=E-m:(!v||k==="finished")&&(v=E),k==="finished"&&p(),R=v,m=null,k="running",h.start()};e&&F();const H={then(E,z){return y.then(E,z)},get time(){return Pt(V)},set time(E){E=hn(E),V=E,m!==null||!h||d===0?m=E:v=h.now()-E/d},get duration(){const E=S.calculatedDuration===null?t0(S):S.calculatedDuration;return Pt(E)},get speed(){return d},set speed(E){E===d||!h||(d=E,H.time=Pt(V))},get state(){return k},play:F,pause:()=>{k="paused",m=V},stop:()=>{Z=!0,k!=="idle"&&(k="idle",r&&r(),Y())},cancel:()=>{R!==null&&K(R),Y()},complete:()=>{k="finished"},sample:E=>(v=0,K(E))};return H}function uH(e){let g;return()=>(g===void 0&&(g=e()),g)}const AH=uH(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),mH=new Set(["opacity","clipPath","filter","transform","backgroundColor"]),Ba=10,bH=2e4,ZH=(e,g)=>g.type==="spring"||e==="backgroundColor"||!RB(g.ease);function hH(e,g,{onUpdate:t,onComplete:l,...n}){if(!(AH()&&mH.has(g)&&!n.repeatDelay&&n.repeatType!=="mirror"&&n.damping!==0&&n.type!=="inertia"))return!1;let o=!1,C,a,r=!1;const i=()=>{a=new Promise(b=>{C=b})};i();let{keyframes:s,duration:c=300,ease:d,times:Z}=n;if(ZH(g,n)){const b=Tr({...n,repeat:0,delay:0});let B={done:!1,value:s[0]};const S=[];let X=0;for(;!B.done&&X<bH;)B=b.sample(X),S.push(B.value),X+=Ba;Z=void 0,s=S,c=X-Ba,d="linear"}const G=v1(e.owner.current,g,s,{...n,duration:c,ease:d,times:Z}),y=()=>{r=!1,G.cancel()},p=()=>{r=!0,me.update(y),C(),i()};return G.onfinish=()=>{r||(e.set(R1(s,n)),l&&l(),p())},{then(b,B){return a.then(b,B)},attachTimeline(b){return G.timeline=b,G.onfinish=null,Fe},get time(){return Pt(G.currentTime||0)},set time(b){G.currentTime=hn(b)},get speed(){return G.playbackRate},set speed(b){G.playbackRate=b},get duration(){return Pt(c)},play:()=>{o||(G.play(),tl(y))},pause:()=>G.pause(),stop:()=>{if(o=!0,G.playState==="idle")return;const{currentTime:b}=G;if(b){const B=Tr({...n,autoplay:!1});e.setWithVelocity(B.sample(b-Ba).value,B.sample(b).value,Ba)}p()},complete:()=>{r||G.finish()},cancel:p}}function pH({keyframes:e,delay:g,onUpdate:t,onComplete:l}){const n=()=>(t&&t(e[e.length-1]),l&&l(),{time:0,speed:1,duration:0,play:Fe,pause:Fe,stop:Fe,then:I=>(I(),Promise.resolve()),cancel:Fe,complete:Fe});return g?Tr({keyframes:[0,1],duration:0,delay:g,onComplete:n}):n()}const GH={type:"spring",stiffness:500,damping:25,restSpeed:10},yH=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),BH={type:"keyframes",duration:.8},fH={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},SH=(e,{keyframes:g})=>g.length>2?BH:wn.has(e)?e.startsWith("scale")?yH(g[1]):GH:fH,jd=(e,g)=>e==="zIndex"?!1:!!(typeof g=="number"||Array.isArray(g)||typeof g=="string"&&(Ml.test(g)||g==="0")&&!g.startsWith("url(")),VH=new Set(["brightness","contrast","saturate","opacity"]);function WH(e){const[g,t]=e.slice(0,-1).split("(");if(g==="drop-shadow")return e;const[l]=t.match(Xi)||[];if(!l)return e;const n=t.replace(l,"");let I=VH.has(g)?1:0;return l!==t&&(I*=100),g+"("+I+n+")"}const vH=/([a-z-]*)\(.*?\)/g,Pd={...Ml,getAnimatableNone:e=>{const g=e.match(vH);return g?g.map(WH).join(" "):e}},RH={...cB,color:ug,backgroundColor:ug,outlineColor:ug,fill:ug,stroke:ug,borderColor:ug,borderTopColor:ug,borderRightColor:ug,borderBottomColor:ug,borderLeftColor:ug,filter:Pd,WebkitFilter:Pd},em=e=>RH[e];function _B(e,g){let t=em(e);return t!==Pd&&(t=Ml),t.getAnimatableNone?t.getAnimatableNone(g):void 0}const ef=e=>/^0[^.\s]+$/.test(e);function XH(e){if(typeof e=="number")return e===0;if(e!==null)return e==="none"||e==="0"||ef(e)}function kH(e,g,t,l){const n=jd(g,t);let I;Array.isArray(t)?I=[...t]:I=[null,t];const o=l.from!==void 0?l.from:e.get();let C;const a=[];for(let r=0;r<I.length;r++)I[r]===null&&(I[r]=r===0?o:I[r-1]),XH(I[r])&&a.push(r),typeof I[r]=="string"&&I[r]!=="none"&&I[r]!=="0"&&(C=I[r]);if(n&&a.length&&C)for(let r=0;r<a.length;r++){const i=a[r];I[i]=_B(g,C)}return I}function JH({when:e,delay:g,delayChildren:t,staggerChildren:l,staggerDirection:n,repeat:I,repeatType:o,repeatDelay:C,from:a,elapsed:r,...i}){return!!Object.keys(i).length}function gm(e,g){return e[g]||e.default||e}const YH={skipAnimations:!1},tm=(e,g,t,l={})=>n=>{const I=gm(l,e)||{},o=I.delay||l.delay||0;let{elapsed:C=0}=l;C=C-hn(o);const a=kH(g,e,t,I),r=a[0],i=a[a.length-1],s=jd(e,r),c=jd(e,i);let d={keyframes:a,velocity:g.getVelocity(),ease:"easeOut",...I,delay:-C,onUpdate:Z=>{g.set(Z),I.onUpdate&&I.onUpdate(Z)},onComplete:()=>{n(),I.onComplete&&I.onComplete()}};if(JH(I)||(d={...d,...SH(e,d)}),d.duration&&(d.duration=hn(d.duration)),d.repeatDelay&&(d.repeatDelay=hn(d.repeatDelay)),!s||!c||W1.current||I.type===!1||YH.skipAnimations)return pH(d);if(!l.isHandoff&&g.owner&&g.owner.current instanceof HTMLElement&&!g.owner.getProps().onUpdate){const Z=hH(g,e,d);if(Z)return Z}return Tr(d)};function Lr(e){return!!(vg(e)&&e.add)}const gf=e=>/^\-?\d*\.?\d+$/.test(e);function lm(e,g){e.indexOf(g)===-1&&e.push(g)}function nm(e,g){const t=e.indexOf(g);t>-1&&e.splice(t,1)}class Im{constructor(){this.subscriptions=[]}add(g){return lm(this.subscriptions,g),()=>nm(this.subscriptions,g)}notify(g,t,l){const n=this.subscriptions.length;if(n)if(n===1)this.subscriptions[0](g,t,l);else for(let I=0;I<n;I++){const o=this.subscriptions[I];o&&o(g,t,l)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const wH=e=>!isNaN(parseFloat(e));class HH{constructor(g,t={}){this.version="10.18.0",this.timeDelta=0,this.lastUpdated=0,this.canTrackVelocity=!1,this.events={},this.updateAndNotify=(l,n=!0)=>{this.prev=this.current,this.current=l;const{delta:I,timestamp:o}=ig;this.lastUpdated!==o&&(this.timeDelta=I,this.lastUpdated=o,me.postRender(this.scheduleVelocityCheck)),this.prev!==this.current&&this.events.change&&this.events.change.notify(this.current),this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()),n&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.scheduleVelocityCheck=()=>me.postRender(this.velocityCheck),this.velocityCheck=({timestamp:l})=>{l!==this.lastUpdated&&(this.prev=this.current,this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()))},this.hasAnimated=!1,this.prev=this.current=g,this.canTrackVelocity=wH(this.current),this.owner=t.owner}onChange(g){return this.on("change",g)}on(g,t){this.events[g]||(this.events[g]=new Im);const l=this.events[g].add(t);return g==="change"?()=>{l(),me.read(()=>{this.events.change.getSize()||this.stop()})}:l}clearListeners(){for(const g in this.events)this.events[g].clear()}attach(g,t){this.passiveEffect=g,this.stopPassiveEffect=t}set(g,t=!0){!t||!this.passiveEffect?this.updateAndNotify(g,t):this.passiveEffect(g,this.updateAndNotify)}setWithVelocity(g,t,l){this.set(t),this.prev=g,this.timeDelta=l}jump(g){this.updateAndNotify(g),this.prev=g,this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){return this.canTrackVelocity?OB(parseFloat(this.current)-parseFloat(this.prev),this.timeDelta):0}start(g){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=g(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function FI(e,g){return new HH(e,g)}const tf=e=>g=>g.test(e),NH={test:e=>e==="auto",parse:e=>e},lf=[Hn,O,Xt,dl,zw,Mw,NH],co=e=>lf.find(tf(e)),KH=[...lf,ug,Ml],FH=e=>KH.find(tf(e));function xH(e,g,t){e.hasValue(g)?e.getValue(g).set(t):e.addValue(g,FI(t))}function EH(e,g){const t=Ji(e,g);let{transitionEnd:l={},transition:n={},...I}=t?e.makeTargetAnimatable(t,!1):{};I={...I,...l};for(const o in I){const C=l1(I[o]);xH(e,o,C)}}function DH(e,g,t){var l,n;const I=Object.keys(g).filter(C=>!e.hasValue(C)),o=I.length;if(o)for(let C=0;C<o;C++){const a=I[C],r=g[a];let i=null;Array.isArray(r)&&(i=r[0]),i===null&&(i=(n=(l=t[a])!==null&&l!==void 0?l:e.readValue(a))!==null&&n!==void 0?n:g[a]),i!=null&&(typeof i=="string"&&(gf(i)||ef(i))?i=parseFloat(i):!FH(i)&&Ml.test(r)&&(i=_B(a,r)),e.addValue(a,FI(i,{owner:e})),t[a]===void 0&&(t[a]=i),i!==null&&e.setBaseTarget(a,i))}}function MH(e,g){return g?(g[e]||g.default||g).from:void 0}function zH(e,g,t){const l={};for(const n in e){const I=MH(n,g);if(I!==void 0)l[n]=I;else{const o=t.getValue(n);o&&(l[n]=o.get())}}return l}function TH({protectedKeys:e,needsAnimating:g},t){const l=e.hasOwnProperty(t)&&g[t]!==!0;return g[t]=!1,l}function LH(e,g){const t=e.get();if(Array.isArray(g)){for(let l=0;l<g.length;l++)if(g[l]!==t)return!0}else return t!==g}function nf(e,g,{delay:t=0,transitionOverride:l,type:n}={}){let{transition:I=e.getDefaultTransition(),transitionEnd:o,...C}=e.makeTargetAnimatable(g);const a=e.getValue("willChange");l&&(I=l);const r=[],i=n&&e.animationState&&e.animationState.getState()[n];for(const s in C){const c=e.getValue(s),d=C[s];if(!c||d===void 0||i&&TH(i,s))continue;const Z={delay:t,elapsed:0,...gm(I||{},s)};if(window.HandoffAppearAnimations){const p=e.getProps()[IB];if(p){const h=window.HandoffAppearAnimations(p,s,c,me);h!==null&&(Z.elapsed=h,Z.isHandoff=!0)}}let G=!Z.isHandoff&&!LH(c,d);if(Z.type==="spring"&&(c.getVelocity()||Z.velocity)&&(G=!1),c.animation&&(G=!1),G)continue;c.start(tm(s,c,d,e.shouldReduceMotion&&wn.has(s)?{type:!1}:Z));const y=c.animation;Lr(a)&&(a.add(s),y.then(()=>a.remove(s))),r.push(y)}return o&&Promise.all(r).then(()=>{o&&EH(e,o)}),r}function Od(e,g,t={}){const l=Ji(e,g,t.custom);let{transition:n=e.getDefaultTransition()||{}}=l||{};t.transitionOverride&&(n=t.transitionOverride);const I=l?()=>Promise.all(nf(e,l,t)):()=>Promise.resolve(),o=e.variantChildren&&e.variantChildren.size?(a=0)=>{const{delayChildren:r=0,staggerChildren:i,staggerDirection:s}=n;return UH(e,g,r+a,i,s,t)}:()=>Promise.resolve(),{when:C}=n;if(C){const[a,r]=C==="beforeChildren"?[I,o]:[o,I];return a().then(()=>r())}else return Promise.all([I(),o(t.delay)])}function UH(e,g,t=0,l=0,n=1,I){const o=[],C=(e.variantChildren.size-1)*l,a=n===1?(r=0)=>r*l:(r=0)=>C-r*l;return Array.from(e.variantChildren).sort(QH).forEach((r,i)=>{r.notify("AnimationStart",g),o.push(Od(r,g,{...I,delay:t+a(i)}).then(()=>r.notify("AnimationComplete",g)))}),Promise.all(o)}function QH(e,g){return e.sortNodePosition(g)}function jH(e,g,t={}){e.notify("AnimationStart",g);let l;if(Array.isArray(g)){const n=g.map(I=>Od(e,I,t));l=Promise.all(n)}else if(typeof g=="string")l=Od(e,g,t);else{const n=typeof g=="function"?Ji(e,g,t.custom):g;l=Promise.all(nf(e,n,t))}return l.then(()=>e.notify("AnimationComplete",g))}const PH=[...EA].reverse(),OH=EA.length;function $H(e){return g=>Promise.all(g.map(({animation:t,options:l})=>jH(e,t,l)))}function qH(e){let g=$H(e);const t=e5();let l=!0;const n=(a,r)=>{const i=Ji(e,r);if(i){const{transition:s,transitionEnd:c,...d}=i;a={...a,...d,...c}}return a};function I(a){g=a(e)}function o(a,r){const i=e.getProps(),s=e.getVariantContext(!0)||{},c=[],d=new Set;let Z={},G=1/0;for(let p=0;p<OH;p++){const h=PH[p],b=t[h],B=i[h]!==void 0?i[h]:s[h],S=aC(B),X=h===r?b.isActive:null;X===!1&&(G=p);let k=B===s[h]&&B!==i[h]&&S;if(k&&l&&e.manuallyAnimateOnMount&&(k=!1),b.protectedKeys={...Z},!b.isActive&&X===null||!B&&!b.prevProp||vi(B)||typeof B=="boolean")continue;let v=_H(b.prevProp,B)||h===r&&b.isActive&&!k&&S||p>G&&S,R=!1;const W=Array.isArray(B)?B:[B];let J=W.reduce(n,{});X===!1&&(J={});const{prevResolvedValues:f={}}=b,V={...f,...J},K=x=>{v=!0,d.has(x)&&(R=!0,d.delete(x)),b.needsAnimating[x]=!0};for(const x in V){const Y=J[x],N=f[x];if(Z.hasOwnProperty(x))continue;let F=!1;Dr(Y)&&Dr(N)?F=!WB(Y,N):F=Y!==N,F?Y!==void 0?K(x):d.add(x):Y!==void 0&&d.has(x)?K(x):b.protectedKeys[x]=!0}b.prevProp=B,b.prevResolvedValues=J,b.isActive&&(Z={...Z,...J}),l&&e.blockInitialAnimation&&(v=!1),v&&(!k||R)&&c.push(...W.map(x=>({animation:x,options:{type:h,...a}})))}if(d.size){const p={};d.forEach(h=>{const b=e.getBaseTarget(h);b!==void 0&&(p[h]=b)}),c.push({animation:p})}let y=!!c.length;return l&&(i.initial===!1||i.initial===i.animate)&&!e.manuallyAnimateOnMount&&(y=!1),l=!1,y?g(c):Promise.resolve()}function C(a,r,i){var s;if(t[a].isActive===r)return Promise.resolve();(s=e.variantChildren)===null||s===void 0||s.forEach(d=>{var Z;return(Z=d.animationState)===null||Z===void 0?void 0:Z.setActive(a,r)}),t[a].isActive=r;const c=o(i,a);for(const d in t)t[d].protectedKeys={};return c}return{animateChanges:o,setActive:C,setAnimateFunction:I,getState:()=>t}}function _H(e,g){return typeof g=="string"?g!==e:Array.isArray(g)?!WB(g,e):!1}function gn(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function e5(){return{animate:gn(!0),whileInView:gn(),whileHover:gn(),whileTap:gn(),whileDrag:gn(),whileFocus:gn(),exit:gn()}}class g5 extends jl{constructor(g){super(g),g.animationState||(g.animationState=qH(g))}updateAnimationControlsSubscription(){const{animate:g}=this.node.getProps();this.unmount(),vi(g)&&(this.unmount=g.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:g}=this.node.getProps(),{animate:t}=this.node.prevProps||{};g!==t&&this.updateAnimationControlsSubscription()}unmount(){}}let t5=0;class l5 extends jl{constructor(){super(...arguments),this.id=t5++}update(){if(!this.node.presenceContext)return;const{isPresent:g,onExitComplete:t,custom:l}=this.node.presenceContext,{isPresent:n}=this.node.prevPresenceContext||{};if(!this.node.animationState||g===n)return;const I=this.node.animationState.setActive("exit",!g,{custom:l??this.node.getProps().custom});t&&!g&&I.then(()=>t(this.id))}mount(){const{register:g}=this.node.presenceContext||{};g&&(this.unmount=g(this.id))}unmount(){}}const n5={animation:{Feature:g5},exit:{Feature:l5}},l0=(e,g)=>Math.abs(e-g);function I5(e,g){const t=l0(e.x,g.x),l=l0(e.y,g.y);return Math.sqrt(t**2+l**2)}class If{constructor(g,t,{transformPagePoint:l,contextWindow:n,dragSnapToOrigin:I=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const s=dc(this.lastMoveEventInfo,this.history),c=this.startEvent!==null,d=I5(s.offset,{x:0,y:0})>=3;if(!c&&!d)return;const{point:Z}=s,{timestamp:G}=ig;this.history.push({...Z,timestamp:G});const{onStart:y,onMove:p}=this.handlers;c||(y&&y(this.lastMoveEvent,s),this.startEvent=this.lastMoveEvent),p&&p(this.lastMoveEvent,s)},this.handlePointerMove=(s,c)=>{this.lastMoveEvent=s,this.lastMoveEventInfo=cc(c,this.transformPagePoint),me.update(this.updatePoint,!0)},this.handlePointerUp=(s,c)=>{this.end();const{onEnd:d,onSessionEnd:Z,resumeAnimation:G}=this.handlers;if(this.dragSnapToOrigin&&G&&G(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const y=dc(s.type==="pointercancel"?this.lastMoveEventInfo:cc(c,this.transformPagePoint),this.history);this.startEvent&&d&&d(s,y),Z&&Z(s,y)},!yB(g))return;this.dragSnapToOrigin=I,this.handlers=t,this.transformPagePoint=l,this.contextWindow=n||window;const o=ki(g),C=cc(o,this.transformPagePoint),{point:a}=C,{timestamp:r}=ig;this.history=[{...a,timestamp:r}];const{onSessionStart:i}=t;i&&i(g,dc(C,this.history)),this.removeListeners=Kl(jt(this.contextWindow,"pointermove",this.handlePointerMove),jt(this.contextWindow,"pointerup",this.handlePointerUp),jt(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(g){this.handlers=g}end(){this.removeListeners&&this.removeListeners(),tl(this.updatePoint)}}function cc(e,g){return g?{point:g(e.point)}:e}function n0(e,g){return{x:e.x-g.x,y:e.y-g.y}}function dc({point:e},g){return{point:e,delta:n0(e,of(g)),offset:n0(e,o5(g)),velocity:C5(g,.1)}}function o5(e){return e[0]}function of(e){return e[e.length-1]}function C5(e,g){if(e.length<2)return{x:0,y:0};let t=e.length-1,l=null;const n=of(e);for(;t>=0&&(l=e[t],!(n.timestamp-l.timestamp>hn(g)));)t--;if(!l)return{x:0,y:0};const I=Pt(n.timestamp-l.timestamp);if(I===0)return{x:0,y:0};const o={x:(n.x-l.x)/I,y:(n.y-l.y)/I};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function Kg(e){return e.max-e.min}function $d(e,g=0,t=.01){return Math.abs(e-g)<=t}function I0(e,g,t,l=.5){e.origin=l,e.originPoint=ve(g.min,g.max,e.origin),e.scale=Kg(t)/Kg(g),($d(e.scale,1,1e-4)||isNaN(e.scale))&&(e.scale=1),e.translate=ve(t.min,t.max,e.origin)-e.originPoint,($d(e.translate)||isNaN(e.translate))&&(e.translate=0)}function Fo(e,g,t,l){I0(e.x,g.x,t.x,l?l.originX:void 0),I0(e.y,g.y,t.y,l?l.originY:void 0)}function o0(e,g,t){e.min=t.min+g.min,e.max=e.min+Kg(g)}function a5(e,g,t){o0(e.x,g.x,t.x),o0(e.y,g.y,t.y)}function C0(e,g,t){e.min=g.min-t.min,e.max=e.min+Kg(g)}function xo(e,g,t){C0(e.x,g.x,t.x),C0(e.y,g.y,t.y)}function r5(e,{min:g,max:t},l){return g!==void 0&&e<g?e=l?ve(g,e,l.min):Math.max(e,g):t!==void 0&&e>t&&(e=l?ve(t,e,l.max):Math.min(e,t)),e}function a0(e,g,t){return{min:g!==void 0?e.min+g:void 0,max:t!==void 0?e.max+t-(e.max-e.min):void 0}}function i5(e,{top:g,left:t,bottom:l,right:n}){return{x:a0(e.x,t,n),y:a0(e.y,g,l)}}function r0(e,g){let t=g.min-e.min,l=g.max-e.max;return g.max-g.min<e.max-e.min&&([t,l]=[l,t]),{min:t,max:l}}function s5(e,g){return{x:r0(e.x,g.x),y:r0(e.y,g.y)}}function c5(e,g){let t=.5;const l=Kg(e),n=Kg(g);return n>l?t=iC(g.min,g.max-l,e.min):l>n&&(t=iC(e.min,e.max-n,g.min)),Dl(0,1,t)}function d5(e,g){const t={};return g.min!==void 0&&(t.min=g.min-e.min),g.max!==void 0&&(t.max=g.max-e.min),t}const qd=.35;function u5(e=qd){return e===!1?e=0:e===!0&&(e=qd),{x:i0(e,"left","right"),y:i0(e,"top","bottom")}}function i0(e,g,t){return{min:s0(e,g),max:s0(e,t)}}function s0(e,g){return typeof e=="number"?e:e[g]||0}const c0=()=>({translate:0,scale:1,origin:0,originPoint:0}),mI=()=>({x:c0(),y:c0()}),d0=()=>({min:0,max:0}),De=()=>({x:d0(),y:d0()});function Ug(e){return[e("x"),e("y")]}function Cf({top:e,left:g,right:t,bottom:l}){return{x:{min:g,max:t},y:{min:e,max:l}}}function A5({x:e,y:g}){return{top:g.min,right:e.max,bottom:g.max,left:e.min}}function m5(e,g){if(!g)return e;const t=g({x:e.left,y:e.top}),l=g({x:e.right,y:e.bottom});return{top:t.y,left:t.x,bottom:l.y,right:l.x}}function uc(e){return e===void 0||e===1}function _d({scale:e,scaleX:g,scaleY:t}){return!uc(e)||!uc(g)||!uc(t)}function In(e){return _d(e)||af(e)||e.z||e.rotate||e.rotateX||e.rotateY}function af(e){return u0(e.x)||u0(e.y)}function u0(e){return e&&e!=="0%"}function Ur(e,g,t){const l=e-t,n=g*l;return t+n}function A0(e,g,t,l,n){return n!==void 0&&(e=Ur(e,n,l)),Ur(e,t,l)+g}function eu(e,g=0,t=1,l,n){e.min=A0(e.min,g,t,l,n),e.max=A0(e.max,g,t,l,n)}function rf(e,{x:g,y:t}){eu(e.x,g.translate,g.scale,g.originPoint),eu(e.y,t.translate,t.scale,t.originPoint)}function b5(e,g,t,l=!1){const n=t.length;if(!n)return;g.x=g.y=1;let I,o;for(let C=0;C<n;C++){I=t[C],o=I.projectionDelta;const a=I.instance;a&&a.style&&a.style.display==="contents"||(l&&I.options.layoutScroll&&I.scroll&&I!==I.root&&bI(e,{x:-I.scroll.offset.x,y:-I.scroll.offset.y}),o&&(g.x*=o.x.scale,g.y*=o.y.scale,rf(e,o)),l&&In(I.latestValues)&&bI(e,I.latestValues))}g.x=m0(g.x),g.y=m0(g.y)}function m0(e){return Number.isInteger(e)||e>1.0000000000001||e<.999999999999?e:1}function Zl(e,g){e.min=e.min+g,e.max=e.max+g}function b0(e,g,[t,l,n]){const I=g[n]!==void 0?g[n]:.5,o=ve(e.min,e.max,I);eu(e,g[t],g[l],o,g.scale)}const Z5=["x","scaleX","originX"],h5=["y","scaleY","originY"];function bI(e,g){b0(e.x,g,Z5),b0(e.y,g,h5)}function sf(e,g){return Cf(m5(e.getBoundingClientRect(),g))}function p5(e,g,t){const l=sf(e,t),{scroll:n}=g;return n&&(Zl(l.x,n.offset.x),Zl(l.y,n.offset.y)),l}const cf=({current:e})=>e?e.ownerDocument.defaultView:null,G5=new WeakMap;class y5{constructor(g){this.openGlobalLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=De(),this.visualElement=g}start(g,{snapToCursor:t=!1}={}){const{presenceContext:l}=this.visualElement;if(l&&l.isPresent===!1)return;const n=i=>{const{dragSnapToOrigin:s}=this.getProps();s?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(ki(i,"page").point)},I=(i,s)=>{const{drag:c,dragPropagation:d,onDragStart:Z}=this.getProps();if(c&&!d&&(this.openGlobalLock&&this.openGlobalLock(),this.openGlobalLock=fB(c),!this.openGlobalLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Ug(y=>{let p=this.getAxisMotionValue(y).get()||0;if(Xt.test(p)){const{projection:h}=this.visualElement;if(h&&h.layout){const b=h.layout.layoutBox[y];b&&(p=Kg(b)*(parseFloat(p)/100))}}this.originPoint[y]=p}),Z&&me.update(()=>Z(i,s),!1,!0);const{animationState:G}=this.visualElement;G&&G.setActive("whileDrag",!0)},o=(i,s)=>{const{dragPropagation:c,dragDirectionLock:d,onDirectionLock:Z,onDrag:G}=this.getProps();if(!c&&!this.openGlobalLock)return;const{offset:y}=s;if(d&&this.currentDirection===null){this.currentDirection=B5(y),this.currentDirection!==null&&Z&&Z(this.currentDirection);return}this.updateAxis("x",s.point,y),this.updateAxis("y",s.point,y),this.visualElement.render(),G&&G(i,s)},C=(i,s)=>this.stop(i,s),a=()=>Ug(i=>{var s;return this.getAnimationState(i)==="paused"&&((s=this.getAxisMotionValue(i).animation)===null||s===void 0?void 0:s.play())}),{dragSnapToOrigin:r}=this.getProps();this.panSession=new If(g,{onSessionStart:n,onStart:I,onMove:o,onSessionEnd:C,resumeAnimation:a},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:r,contextWindow:cf(this.visualElement)})}stop(g,t){const l=this.isDragging;if(this.cancel(),!l)return;const{velocity:n}=t;this.startAnimation(n);const{onDragEnd:I}=this.getProps();I&&me.update(()=>I(g,t))}cancel(){this.isDragging=!1;const{projection:g,animationState:t}=this.visualElement;g&&(g.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:l}=this.getProps();!l&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(g,t,l){const{drag:n}=this.getProps();if(!l||!fa(g,n,this.currentDirection))return;const I=this.getAxisMotionValue(g);let o=this.originPoint[g]+l[g];this.constraints&&this.constraints[g]&&(o=r5(o,this.constraints[g],this.elastic[g])),I.set(o)}resolveConstraints(){var g;const{dragConstraints:t,dragElastic:l}=this.getProps(),n=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(g=this.visualElement.projection)===null||g===void 0?void 0:g.layout,I=this.constraints;t&&uI(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&n?this.constraints=i5(n.layoutBox,t):this.constraints=!1,this.elastic=u5(l),I!==this.constraints&&n&&this.constraints&&!this.hasMutatedConstraints&&Ug(o=>{this.getAxisMotionValue(o)&&(this.constraints[o]=d5(n.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:g,onMeasureDragConstraints:t}=this.getProps();if(!g||!uI(g))return!1;const l=g.current,{projection:n}=this.visualElement;if(!n||!n.layout)return!1;const I=p5(l,n.root,this.visualElement.getTransformPagePoint());let o=s5(n.layout.layoutBox,I);if(t){const C=t(A5(o));this.hasMutatedConstraints=!!C,C&&(o=Cf(C))}return o}startAnimation(g){const{drag:t,dragMomentum:l,dragElastic:n,dragTransition:I,dragSnapToOrigin:o,onDragTransitionEnd:C}=this.getProps(),a=this.constraints||{},r=Ug(i=>{if(!fa(i,t,this.currentDirection))return;let s=a&&a[i]||{};o&&(s={min:0,max:0});const c=n?200:1e6,d=n?40:1e7,Z={type:"inertia",velocity:l?g[i]:0,bounceStiffness:c,bounceDamping:d,timeConstant:750,restDelta:1,restSpeed:10,...I,...s};return this.startAxisValueAnimation(i,Z)});return Promise.all(r).then(C)}startAxisValueAnimation(g,t){const l=this.getAxisMotionValue(g);return l.start(tm(g,l,0,t))}stopAnimation(){Ug(g=>this.getAxisMotionValue(g).stop())}pauseAnimation(){Ug(g=>{var t;return(t=this.getAxisMotionValue(g).animation)===null||t===void 0?void 0:t.pause()})}getAnimationState(g){var t;return(t=this.getAxisMotionValue(g).animation)===null||t===void 0?void 0:t.state}getAxisMotionValue(g){const t="_drag"+g.toUpperCase(),l=this.visualElement.getProps(),n=l[t];return n||this.visualElement.getValue(g,(l.initial?l.initial[g]:void 0)||0)}snapToCursor(g){Ug(t=>{const{drag:l}=this.getProps();if(!fa(t,l,this.currentDirection))return;const{projection:n}=this.visualElement,I=this.getAxisMotionValue(t);if(n&&n.layout){const{min:o,max:C}=n.layout.layoutBox[t];I.set(g[t]-ve(o,C,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:g,dragConstraints:t}=this.getProps(),{projection:l}=this.visualElement;if(!uI(t)||!l||!this.constraints)return;this.stopAnimation();const n={x:0,y:0};Ug(o=>{const C=this.getAxisMotionValue(o);if(C){const a=C.get();n[o]=c5({min:a,max:a},this.constraints[o])}});const{transformTemplate:I}=this.visualElement.getProps();this.visualElement.current.style.transform=I?I({},""):"none",l.root&&l.root.updateScroll(),l.updateLayout(),this.resolveConstraints(),Ug(o=>{if(!fa(o,g,null))return;const C=this.getAxisMotionValue(o),{min:a,max:r}=this.constraints[o];C.set(ve(a,r,n[o]))})}addListeners(){if(!this.visualElement.current)return;G5.set(this.visualElement,this);const g=this.visualElement.current,t=jt(g,"pointerdown",a=>{const{drag:r,dragListener:i=!0}=this.getProps();r&&i&&this.start(a)}),l=()=>{const{dragConstraints:a}=this.getProps();uI(a)&&(this.constraints=this.resolveRefConstraints())},{projection:n}=this.visualElement,I=n.addEventListener("measure",l);n&&!n.layout&&(n.root&&n.root.updateScroll(),n.updateLayout()),l();const o=Ut(window,"resize",()=>this.scalePositionWithinConstraints()),C=n.addEventListener("didUpdate",({delta:a,hasLayoutChanged:r})=>{this.isDragging&&r&&(Ug(i=>{const s=this.getAxisMotionValue(i);s&&(this.originPoint[i]+=a[i].translate,s.set(s.get()+a[i].translate))}),this.visualElement.render())});return()=>{o(),t(),I(),C&&C()}}getProps(){const g=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:l=!1,dragPropagation:n=!1,dragConstraints:I=!1,dragElastic:o=qd,dragMomentum:C=!0}=g;return{...g,drag:t,dragDirectionLock:l,dragPropagation:n,dragConstraints:I,dragElastic:o,dragMomentum:C}}}function fa(e,g,t){return(g===!0||g===e)&&(t===null||t===e)}function B5(e,g=10){let t=null;return Math.abs(e.y)>g?t="y":Math.abs(e.x)>g&&(t="x"),t}class f5 extends jl{constructor(g){super(g),this.removeGroupControls=Fe,this.removeListeners=Fe,this.controls=new y5(g)}mount(){const{dragControls:g}=this.node.getProps();g&&(this.removeGroupControls=g.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Fe}unmount(){this.removeGroupControls(),this.removeListeners()}}const Z0=e=>(g,t)=>{e&&me.update(()=>e(g,t))};class S5 extends jl{constructor(){super(...arguments),this.removePointerDownListener=Fe}onPointerDown(g){this.session=new If(g,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:cf(this.node)})}createPanHandlers(){const{onPanSessionStart:g,onPanStart:t,onPan:l,onPanEnd:n}=this.node.getProps();return{onSessionStart:Z0(g),onStart:Z0(t),onMove:l,onEnd:(I,o)=>{delete this.session,n&&me.update(()=>n(I,o))}}}mount(){this.removePointerDownListener=jt(this.node.current,"pointerdown",g=>this.onPointerDown(g))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}function V5(){const e=u.useContext(Vi);if(e===null)return[!0,null];const{isPresent:g,onExitComplete:t,register:l}=e,n=u.useId();return u.useEffect(()=>l(n),[]),!g&&t?[!1,()=>t&&t(n)]:[!0]}const _a={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function h0(e,g){return g.max===g.min?0:e/(g.max-g.min)*100}const uo={correct:(e,g)=>{if(!g.target)return e;if(typeof e=="string")if(O.test(e))e=parseFloat(e);else return e;const t=h0(e,g.target.x),l=h0(e,g.target.y);return`${t}% ${l}%`}},W5={correct:(e,{treeScale:g,projectionDelta:t})=>{const l=e,n=Ml.parse(e);if(n.length>5)return l;const I=Ml.createTransformer(e),o=typeof n[0]!="number"?1:0,C=t.x.scale*g.x,a=t.y.scale*g.y;n[0+o]/=C,n[1+o]/=a;const r=ve(C,a,.5);return typeof n[2+o]=="number"&&(n[2+o]/=r),typeof n[3+o]=="number"&&(n[3+o]/=r),I(n)}};class v5 extends D.Component{componentDidMount(){const{visualElement:g,layoutGroup:t,switchLayoutGroup:l,layoutId:n}=this.props,{projection:I}=g;Hw(R5),I&&(t.group&&t.group.add(I),l&&l.register&&n&&l.register(I),I.root.didUpdate(),I.addEventListener("animationComplete",()=>{this.safeToRemove()}),I.setOptions({...I.options,onExitComplete:()=>this.safeToRemove()})),_a.hasEverUpdated=!0}getSnapshotBeforeUpdate(g){const{layoutDependency:t,visualElement:l,drag:n,isPresent:I}=this.props,o=l.projection;return o&&(o.isPresent=I,n||g.layoutDependency!==t||t===void 0?o.willUpdate():this.safeToRemove(),g.isPresent!==I&&(I?o.promote():o.relegate()||me.postRender(()=>{const C=o.getStack();(!C||!C.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:g}=this.props.visualElement;g&&(g.root.didUpdate(),queueMicrotask(()=>{!g.currentAnimation&&g.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:g,layoutGroup:t,switchLayoutGroup:l}=this.props,{projection:n}=g;n&&(n.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(n),l&&l.deregister&&l.deregister(n))}safeToRemove(){const{safeToRemove:g}=this.props;g&&g()}render(){return null}}function df(e){const[g,t]=V5(),l=u.useContext(MA);return D.createElement(v5,{...e,layoutGroup:l,switchLayoutGroup:u.useContext(CB),isPresent:g,safeToRemove:t})}const R5={borderRadius:{...uo,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:uo,borderTopRightRadius:uo,borderBottomLeftRadius:uo,borderBottomRightRadius:uo,boxShadow:W5},uf=["TopLeft","TopRight","BottomLeft","BottomRight"],X5=uf.length,p0=e=>typeof e=="string"?parseFloat(e):e,G0=e=>typeof e=="number"||O.test(e);function k5(e,g,t,l,n,I){n?(e.opacity=ve(0,t.opacity!==void 0?t.opacity:1,J5(l)),e.opacityExit=ve(g.opacity!==void 0?g.opacity:1,0,Y5(l))):I&&(e.opacity=ve(g.opacity!==void 0?g.opacity:1,t.opacity!==void 0?t.opacity:1,l));for(let o=0;o<X5;o++){const C=`border${uf[o]}Radius`;let a=y0(g,C),r=y0(t,C);if(a===void 0&&r===void 0)continue;a||(a=0),r||(r=0),a===0||r===0||G0(a)===G0(r)?(e[C]=Math.max(ve(p0(a),p0(r),l),0),(Xt.test(r)||Xt.test(a))&&(e[C]+="%")):e[C]=r}(g.rotate||t.rotate)&&(e.rotate=ve(g.rotate||0,t.rotate||0,l))}function y0(e,g){return e[g]!==void 0?e[g]:e.borderRadius}const J5=Af(0,.5,NB),Y5=Af(.5,.95,Fe);function Af(e,g,t){return l=>l<e?0:l>g?1:t(iC(e,g,l))}function B0(e,g){e.min=g.min,e.max=g.max}function zg(e,g){B0(e.x,g.x),B0(e.y,g.y)}function f0(e,g,t,l,n){return e-=g,e=Ur(e,1/t,l),n!==void 0&&(e=Ur(e,1/n,l)),e}function w5(e,g=0,t=1,l=.5,n,I=e,o=e){if(Xt.test(g)&&(g=parseFloat(g),g=ve(o.min,o.max,g/100)-o.min),typeof g!="number")return;let C=ve(I.min,I.max,l);e===I&&(C-=g),e.min=f0(e.min,g,t,C,n),e.max=f0(e.max,g,t,C,n)}function S0(e,g,[t,l,n],I,o){w5(e,g[t],g[l],g[n],g.scale,I,o)}const H5=["x","scaleX","originX"],N5=["y","scaleY","originY"];function V0(e,g,t,l){S0(e.x,g,H5,t?t.x:void 0,l?l.x:void 0),S0(e.y,g,N5,t?t.y:void 0,l?l.y:void 0)}function W0(e){return e.translate===0&&e.scale===1}function mf(e){return W0(e.x)&&W0(e.y)}function K5(e,g){return e.x.min===g.x.min&&e.x.max===g.x.max&&e.y.min===g.y.min&&e.y.max===g.y.max}function bf(e,g){return Math.round(e.x.min)===Math.round(g.x.min)&&Math.round(e.x.max)===Math.round(g.x.max)&&Math.round(e.y.min)===Math.round(g.y.min)&&Math.round(e.y.max)===Math.round(g.y.max)}function v0(e){return Kg(e.x)/Kg(e.y)}class F5{constructor(){this.members=[]}add(g){lm(this.members,g),g.scheduleRender()}remove(g){if(nm(this.members,g),g===this.prevLead&&(this.prevLead=void 0),g===this.lead){const t=this.members[this.members.length-1];t&&this.promote(t)}}relegate(g){const t=this.members.findIndex(n=>g===n);if(t===0)return!1;let l;for(let n=t;n>=0;n--){const I=this.members[n];if(I.isPresent!==!1){l=I;break}}return l?(this.promote(l),!0):!1}promote(g,t){const l=this.lead;if(g!==l&&(this.prevLead=l,this.lead=g,g.show(),l)){l.instance&&l.scheduleRender(),g.scheduleRender(),g.resumeFrom=l,t&&(g.resumeFrom.preserveOpacity=!0),l.snapshot&&(g.snapshot=l.snapshot,g.snapshot.latestValues=l.animationValues||l.latestValues),g.root&&g.root.isUpdating&&(g.isLayoutDirty=!0);const{crossfade:n}=g.options;n===!1&&l.hide()}}exitAnimationComplete(){this.members.forEach(g=>{const{options:t,resumingFrom:l}=g;t.onExitComplete&&t.onExitComplete(),l&&l.options.onExitComplete&&l.options.onExitComplete()})}scheduleRender(){this.members.forEach(g=>{g.instance&&g.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function R0(e,g,t){let l="";const n=e.x.translate/g.x,I=e.y.translate/g.y;if((n||I)&&(l=`translate3d(${n}px, ${I}px, 0) `),(g.x!==1||g.y!==1)&&(l+=`scale(${1/g.x}, ${1/g.y}) `),t){const{rotate:a,rotateX:r,rotateY:i}=t;a&&(l+=`rotate(${a}deg) `),r&&(l+=`rotateX(${r}deg) `),i&&(l+=`rotateY(${i}deg) `)}const o=e.x.scale*g.x,C=e.y.scale*g.y;return(o!==1||C!==1)&&(l+=`scale(${o}, ${C})`),l||"none"}const x5=(e,g)=>e.depth-g.depth;class E5{constructor(){this.children=[],this.isDirty=!1}add(g){lm(this.children,g),this.isDirty=!0}remove(g){nm(this.children,g),this.isDirty=!0}forEach(g){this.isDirty&&this.children.sort(x5),this.isDirty=!1,this.children.forEach(g)}}function D5(e,g){const t=performance.now(),l=({timestamp:n})=>{const I=n-t;I>=g&&(tl(l),e(I-g))};return me.read(l,!0),()=>tl(l)}function M5(e){window.MotionDebug&&window.MotionDebug.record(e)}function z5(e){return e instanceof SVGElement&&e.tagName!=="svg"}function T5(e,g,t){const l=vg(e)?e:FI(e);return l.start(tm("",l,g,t)),l.animation}const X0=["","X","Y","Z"],L5={visibility:"hidden"},k0=1e3;let U5=0;const on={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0};function Zf({attachResizeListener:e,defaultParent:g,measureScroll:t,checkIsScrollRoot:l,resetTransform:n}){return class{constructor(o={},C=g==null?void 0:g()){this.id=U5++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,on.totalNodes=on.resolvedTargetDeltas=on.recalculatedProjection=0,this.nodes.forEach(P5),this.nodes.forEach(e9),this.nodes.forEach(g9),this.nodes.forEach(O5),M5(on)},this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=C?C.root||C:this,this.path=C?[...C.path,C]:[],this.parent=C,this.depth=C?C.depth+1:0;for(let a=0;a<this.path.length;a++)this.path[a].shouldResetTransform=!0;this.root===this&&(this.nodes=new E5)}addEventListener(o,C){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new Im),this.eventHandlers.get(o).add(C)}notifyListeners(o,...C){const a=this.eventHandlers.get(o);a&&a.notify(...C)}hasListeners(o){return this.eventHandlers.has(o)}mount(o,C=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=z5(o),this.instance=o;const{layoutId:a,layout:r,visualElement:i}=this.options;if(i&&!i.current&&i.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),C&&(r||a)&&(this.isLayoutDirty=!0),e){let s;const c=()=>this.root.updateBlockedByResize=!1;e(o,()=>{this.root.updateBlockedByResize=!0,s&&s(),s=D5(c,250),_a.hasAnimatedSinceResize&&(_a.hasAnimatedSinceResize=!1,this.nodes.forEach(Y0))})}a&&this.root.registerSharedNode(a,this),this.options.animate!==!1&&i&&(a||r)&&this.addEventListener("didUpdate",({delta:s,hasLayoutChanged:c,hasRelativeTargetChanged:d,layout:Z})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const G=this.options.transition||i.getDefaultTransition()||o9,{onLayoutAnimationStart:y,onLayoutAnimationComplete:p}=i.getProps(),h=!this.targetLayout||!bf(this.targetLayout,Z)||d,b=!c&&d;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||b||c&&(h||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(s,b);const B={...gm(G,"layout"),onPlay:y,onComplete:p};(i.shouldReduceMotion||this.options.layoutRoot)&&(B.delay=0,B.type=!1),this.startAnimation(B)}else c||Y0(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=Z})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,tl(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(t9),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let i=0;i<this.path.length;i++){const s=this.path[i];s.shouldResetTransform=!0,s.updateScroll("snapshot"),s.options.layoutRoot&&s.willUpdate(!1)}const{layoutId:C,layout:a}=this.options;if(C===void 0&&!a)return;const r=this.getTransformTemplate();this.prevTransformTemplateValue=r?r(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(J0);return}this.isUpdating||this.nodes.forEach(q5),this.isUpdating=!1,this.nodes.forEach(_5),this.nodes.forEach(Q5),this.nodes.forEach(j5),this.clearAllSnapshots();const C=performance.now();ig.delta=Dl(0,1e3/60,C-ig.timestamp),ig.timestamp=C,ig.isProcessing=!0,nc.update.process(ig),nc.preRender.process(ig),nc.render.process(ig),ig.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,queueMicrotask(()=>this.update()))}clearAllSnapshots(){this.nodes.forEach($5),this.sharedNodes.forEach(l9)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,me.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){me.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let a=0;a<this.path.length;a++)this.path[a].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=De(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:C}=this.options;C&&C.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let C=!!(this.options.layoutScroll&&this.instance);this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(C=!1),C&&(this.scroll={animationId:this.root.animationId,phase:o,isRoot:l(this.instance),offset:t(this.instance)})}resetTransform(){if(!n)return;const o=this.isLayoutDirty||this.shouldResetTransform,C=this.projectionDelta&&!mf(this.projectionDelta),a=this.getTransformTemplate(),r=a?a(this.latestValues,""):void 0,i=r!==this.prevTransformTemplateValue;o&&(C||In(this.latestValues)||i)&&(n(this.instance,r),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const C=this.measurePageBox();let a=this.removeElementScroll(C);return o&&(a=this.removeTransform(a)),C9(a),{animationId:this.root.animationId,measuredBox:C,layoutBox:a,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:o}=this.options;if(!o)return De();const C=o.measureViewportBox(),{scroll:a}=this.root;return a&&(Zl(C.x,a.offset.x),Zl(C.y,a.offset.y)),C}removeElementScroll(o){const C=De();zg(C,o);for(let a=0;a<this.path.length;a++){const r=this.path[a],{scroll:i,options:s}=r;if(r!==this.root&&i&&s.layoutScroll){if(i.isRoot){zg(C,o);const{scroll:c}=this.root;c&&(Zl(C.x,-c.offset.x),Zl(C.y,-c.offset.y))}Zl(C.x,i.offset.x),Zl(C.y,i.offset.y)}}return C}applyTransform(o,C=!1){const a=De();zg(a,o);for(let r=0;r<this.path.length;r++){const i=this.path[r];!C&&i.options.layoutScroll&&i.scroll&&i!==i.root&&bI(a,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),In(i.latestValues)&&bI(a,i.latestValues)}return In(this.latestValues)&&bI(a,this.latestValues),a}removeTransform(o){const C=De();zg(C,o);for(let a=0;a<this.path.length;a++){const r=this.path[a];if(!r.instance||!In(r.latestValues))continue;_d(r.latestValues)&&r.updateSnapshot();const i=De(),s=r.measurePageBox();zg(i,s),V0(C,r.latestValues,r.snapshot?r.snapshot.layoutBox:void 0,i)}return In(this.latestValues)&&V0(C,this.latestValues),C}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==ig.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var C;const a=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=a.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=a.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=a.isSharedProjectionDirty);const r=!!this.resumingFrom||this!==a;if(!(o||r&&this.isSharedProjectionDirty||this.isProjectionDirty||!((C=this.parent)===null||C===void 0)&&C.isProjectionDirty||this.attemptToResolveRelativeTarget))return;const{layout:s,layoutId:c}=this.options;if(!(!this.layout||!(s||c))){if(this.resolvedRelativeTargetAt=ig.timestamp,!this.targetDelta&&!this.relativeTarget){const d=this.getClosestProjectingParent();d&&d.layout&&this.animationProgress!==1?(this.relativeParent=d,this.forceRelativeParentToResolveTarget(),this.relativeTarget=De(),this.relativeTargetOrigin=De(),xo(this.relativeTargetOrigin,this.layout.layoutBox,d.layout.layoutBox),zg(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=De(),this.targetWithTransforms=De()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),a5(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):zg(this.target,this.layout.layoutBox),rf(this.target,this.targetDelta)):zg(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const d=this.getClosestProjectingParent();d&&!!d.resumingFrom==!!this.resumingFrom&&!d.options.layoutScroll&&d.target&&this.animationProgress!==1?(this.relativeParent=d,this.forceRelativeParentToResolveTarget(),this.relativeTarget=De(),this.relativeTargetOrigin=De(),xo(this.relativeTargetOrigin,this.target,d.target),zg(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}on.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||_d(this.parent.latestValues)||af(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var o;const C=this.getLead(),a=!!this.resumingFrom||this!==C;let r=!0;if((this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty)&&(r=!1),a&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(r=!1),this.resolvedRelativeTargetAt===ig.timestamp&&(r=!1),r)return;const{layout:i,layoutId:s}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(i||s))return;zg(this.layoutCorrected,this.layout.layoutBox);const c=this.treeScale.x,d=this.treeScale.y;b5(this.layoutCorrected,this.treeScale,this.path,a),C.layout&&!C.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(C.target=C.layout.layoutBox);const{target:Z}=C;if(!Z){this.projectionTransform&&(this.projectionDelta=mI(),this.projectionTransform="none",this.scheduleRender());return}this.projectionDelta||(this.projectionDelta=mI(),this.projectionDeltaWithTransform=mI());const G=this.projectionTransform;Fo(this.projectionDelta,this.layoutCorrected,Z,this.latestValues),this.projectionTransform=R0(this.projectionDelta,this.treeScale),(this.projectionTransform!==G||this.treeScale.x!==c||this.treeScale.y!==d)&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",Z)),on.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){if(this.options.scheduleRender&&this.options.scheduleRender(),o){const C=this.getStack();C&&C.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}setAnimationOrigin(o,C=!1){const a=this.snapshot,r=a?a.latestValues:{},i={...this.latestValues},s=mI();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!C;const c=De(),d=a?a.source:void 0,Z=this.layout?this.layout.source:void 0,G=d!==Z,y=this.getStack(),p=!y||y.members.length<=1,h=!!(G&&!p&&this.options.crossfade===!0&&!this.path.some(I9));this.animationProgress=0;let b;this.mixTargetDelta=B=>{const S=B/1e3;w0(s.x,o.x,S),w0(s.y,o.y,S),this.setTargetDelta(s),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(xo(c,this.layout.layoutBox,this.relativeParent.layout.layoutBox),n9(this.relativeTarget,this.relativeTargetOrigin,c,S),b&&K5(this.relativeTarget,b)&&(this.isProjectionDirty=!1),b||(b=De()),zg(b,this.relativeTarget)),G&&(this.animationValues=i,k5(i,r,this.latestValues,S,h,p)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=S},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(tl(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=me.update(()=>{_a.hasAnimatedSinceResize=!0,this.currentAnimation=T5(0,k0,{...o,onUpdate:C=>{this.mixTargetDelta(C),o.onUpdate&&o.onUpdate(C)},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(k0),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:C,target:a,layout:r,latestValues:i}=o;if(!(!C||!a||!r)){if(this!==o&&this.layout&&r&&hf(this.options.animationType,this.layout.layoutBox,r.layoutBox)){a=this.target||De();const s=Kg(this.layout.layoutBox.x);a.x.min=o.target.x.min,a.x.max=a.x.min+s;const c=Kg(this.layout.layoutBox.y);a.y.min=o.target.y.min,a.y.max=a.y.min+c}zg(C,a),bI(C,i),Fo(this.projectionDeltaWithTransform,this.layoutCorrected,C,i)}}registerSharedNode(o,C){this.sharedNodes.has(o)||this.sharedNodes.set(o,new F5),this.sharedNodes.get(o).add(C);const r=C.options.initialPromotionConfig;C.promote({transition:r?r.transition:void 0,preserveFollowOpacity:r&&r.shouldPreserveFollowOpacity?r.shouldPreserveFollowOpacity(C):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var o;const{layoutId:C}=this.options;return C?((o=this.getStack())===null||o===void 0?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:C}=this.options;return C?(o=this.getStack())===null||o===void 0?void 0:o.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:C,preserveFollowOpacity:a}={}){const r=this.getStack();r&&r.promote(this,a),o&&(this.projectionDelta=void 0,this.needsReset=!0),C&&this.setOptions({transition:C})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetRotation(){const{visualElement:o}=this.options;if(!o)return;let C=!1;const{latestValues:a}=o;if((a.rotate||a.rotateX||a.rotateY||a.rotateZ)&&(C=!0),!C)return;const r={};for(let i=0;i<X0.length;i++){const s="rotate"+X0[i];a[s]&&(r[s]=a[s],o.setStaticValue(s,0))}o.render();for(const i in r)o.setStaticValue(i,r[i]);o.scheduleRender()}getProjectionStyles(o){var C,a;if(!this.instance||this.isSVG)return;if(!this.isVisible)return L5;const r={visibility:""},i=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,r.opacity="",r.pointerEvents=qa(o==null?void 0:o.pointerEvents)||"",r.transform=i?i(this.latestValues,""):"none",r;const s=this.getLead();if(!this.projectionDelta||!this.layout||!s.target){const G={};return this.options.layoutId&&(G.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,G.pointerEvents=qa(o==null?void 0:o.pointerEvents)||""),this.hasProjected&&!In(this.latestValues)&&(G.transform=i?i({},""):"none",this.hasProjected=!1),G}const c=s.animationValues||s.latestValues;this.applyTransformsToTarget(),r.transform=R0(this.projectionDeltaWithTransform,this.treeScale,c),i&&(r.transform=i(c,r.transform));const{x:d,y:Z}=this.projectionDelta;r.transformOrigin=`${d.origin*100}% ${Z.origin*100}% 0`,s.animationValues?r.opacity=s===this?(a=(C=c.opacity)!==null&&C!==void 0?C:this.latestValues.opacity)!==null&&a!==void 0?a:1:this.preserveOpacity?this.latestValues.opacity:c.opacityExit:r.opacity=s===this?c.opacity!==void 0?c.opacity:"":c.opacityExit!==void 0?c.opacityExit:0;for(const G in xr){if(c[G]===void 0)continue;const{correct:y,applyTo:p}=xr[G],h=r.transform==="none"?c[G]:y(c[G],s);if(p){const b=p.length;for(let B=0;B<b;B++)r[p[B]]=h}else r[G]=h}return this.options.layoutId&&(r.pointerEvents=s===this?qa(o==null?void 0:o.pointerEvents)||"":"none"),r}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var C;return(C=o.currentAnimation)===null||C===void 0?void 0:C.stop()}),this.root.nodes.forEach(J0),this.root.sharedNodes.clear()}}}function Q5(e){e.updateLayout()}function j5(e){var g;const t=((g=e.resumeFrom)===null||g===void 0?void 0:g.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&t&&e.hasListeners("didUpdate")){const{layoutBox:l,measuredBox:n}=e.layout,{animationType:I}=e.options,o=t.source!==e.layout.source;I==="size"?Ug(s=>{const c=o?t.measuredBox[s]:t.layoutBox[s],d=Kg(c);c.min=l[s].min,c.max=c.min+d}):hf(I,t.layoutBox,l)&&Ug(s=>{const c=o?t.measuredBox[s]:t.layoutBox[s],d=Kg(l[s]);c.max=c.min+d,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[s].max=e.relativeTarget[s].min+d)});const C=mI();Fo(C,l,t.layoutBox);const a=mI();o?Fo(a,e.applyTransform(n,!0),t.measuredBox):Fo(a,l,t.layoutBox);const r=!mf(C);let i=!1;if(!e.resumeFrom){const s=e.getClosestProjectingParent();if(s&&!s.resumeFrom){const{snapshot:c,layout:d}=s;if(c&&d){const Z=De();xo(Z,t.layoutBox,c.layoutBox);const G=De();xo(G,l,d.layoutBox),bf(Z,G)||(i=!0),s.options.layoutRoot&&(e.relativeTarget=G,e.relativeTargetOrigin=Z,e.relativeParent=s)}}}e.notifyListeners("didUpdate",{layout:l,snapshot:t,delta:a,layoutDelta:C,hasLayoutChanged:r,hasRelativeTargetChanged:i})}else if(e.isLead()){const{onExitComplete:l}=e.options;l&&l()}e.options.transition=void 0}function P5(e){on.totalNodes++,e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function O5(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function $5(e){e.clearSnapshot()}function J0(e){e.clearMeasurements()}function q5(e){e.isLayoutDirty=!1}function _5(e){const{visualElement:g}=e.options;g&&g.getProps().onBeforeLayoutMeasure&&g.notify("BeforeLayoutMeasure"),e.resetTransform()}function Y0(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function e9(e){e.resolveTargetDelta()}function g9(e){e.calcProjection()}function t9(e){e.resetRotation()}function l9(e){e.removeLeadSnapshot()}function w0(e,g,t){e.translate=ve(g.translate,0,t),e.scale=ve(g.scale,1,t),e.origin=g.origin,e.originPoint=g.originPoint}function H0(e,g,t,l){e.min=ve(g.min,t.min,l),e.max=ve(g.max,t.max,l)}function n9(e,g,t,l){H0(e.x,g.x,t.x,l),H0(e.y,g.y,t.y,l)}function I9(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const o9={duration:.45,ease:[.4,0,.1,1]},N0=e=>typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes(e),K0=N0("applewebkit/")&&!N0("chrome/")?Math.round:Fe;function F0(e){e.min=K0(e.min),e.max=K0(e.max)}function C9(e){F0(e.x),F0(e.y)}function hf(e,g,t){return e==="position"||e==="preserve-aspect"&&!$d(v0(g),v0(t),.2)}const a9=Zf({attachResizeListener:(e,g)=>Ut(e,"resize",g),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),Ac={current:void 0},pf=Zf({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!Ac.current){const e=new a9({});e.mount(window),e.setOptions({layoutScroll:!0}),Ac.current=e}return Ac.current},resetTransform:(e,g)=>{e.style.transform=g!==void 0?g:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),r9={pan:{Feature:S5},drag:{Feature:f5,ProjectionNode:pf,MeasureLayout:df}},i9=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/;function s9(e){const g=i9.exec(e);if(!g)return[,];const[,t,l]=g;return[t,l]}function gu(e,g,t=1){const[l,n]=s9(e);if(!l)return;const I=window.getComputedStyle(g).getPropertyValue(l);if(I){const o=I.trim();return gf(o)?parseFloat(o):o}else return Td(n)?gu(n,g,t+1):n}function c9(e,{...g},t){const l=e.current;if(!(l instanceof Element))return{target:g,transitionEnd:t};t&&(t={...t}),e.values.forEach(n=>{const I=n.get();if(!Td(I))return;const o=gu(I,l);o&&n.set(o)});for(const n in g){const I=g[n];if(!Td(I))continue;const o=gu(I,l);o&&(g[n]=o,t||(t={}),t[n]===void 0&&(t[n]=I))}return{target:g,transitionEnd:t}}const d9=new Set(["width","height","top","left","right","bottom","x","y","translateX","translateY"]),Gf=e=>d9.has(e),u9=e=>Object.keys(e).some(Gf),x0=e=>e===Hn||e===O,E0=(e,g)=>parseFloat(e.split(", ")[g]),D0=(e,g)=>(t,{transform:l})=>{if(l==="none"||!l)return 0;const n=l.match(/^matrix3d\((.+)\)$/);if(n)return E0(n[1],g);{const I=l.match(/^matrix\((.+)\)$/);return I?E0(I[1],e):0}},A9=new Set(["x","y","z"]),m9=RC.filter(e=>!A9.has(e));function b9(e){const g=[];return m9.forEach(t=>{const l=e.getValue(t);l!==void 0&&(g.push([t,l.get()]),l.set(t.startsWith("scale")?1:0))}),g.length&&e.render(),g}const xI={width:({x:e},{paddingLeft:g="0",paddingRight:t="0"})=>e.max-e.min-parseFloat(g)-parseFloat(t),height:({y:e},{paddingTop:g="0",paddingBottom:t="0"})=>e.max-e.min-parseFloat(g)-parseFloat(t),top:(e,{top:g})=>parseFloat(g),left:(e,{left:g})=>parseFloat(g),bottom:({y:e},{top:g})=>parseFloat(g)+(e.max-e.min),right:({x:e},{left:g})=>parseFloat(g)+(e.max-e.min),x:D0(4,13),y:D0(5,14)};xI.translateX=xI.x;xI.translateY=xI.y;const Z9=(e,g,t)=>{const l=g.measureViewportBox(),n=g.current,I=getComputedStyle(n),{display:o}=I,C={};o==="none"&&g.setStaticValue("display",e.display||"block"),t.forEach(r=>{C[r]=xI[r](l,I)}),g.render();const a=g.measureViewportBox();return t.forEach(r=>{const i=g.getValue(r);i&&i.jump(C[r]),e[r]=xI[r](a,I)}),e},h9=(e,g,t={},l={})=>{g={...g},l={...l};const n=Object.keys(g).filter(Gf);let I=[],o=!1;const C=[];if(n.forEach(a=>{const r=e.getValue(a);if(!e.hasValue(a))return;let i=t[a],s=co(i);const c=g[a];let d;if(Dr(c)){const Z=c.length,G=c[0]===null?1:0;i=c[G],s=co(i);for(let y=G;y<Z&&c[y]!==null;y++)d?OA(co(c[y])===d):d=co(c[y])}else d=co(c);if(s!==d)if(x0(s)&&x0(d)){const Z=r.get();typeof Z=="string"&&r.set(parseFloat(Z)),typeof c=="string"?g[a]=parseFloat(c):Array.isArray(c)&&d===O&&(g[a]=c.map(parseFloat))}else s!=null&&s.transform&&(d!=null&&d.transform)&&(i===0||c===0)?i===0?r.set(d.transform(i)):g[a]=s.transform(c):(o||(I=b9(e),o=!0),C.push(a),l[a]=l[a]!==void 0?l[a]:g[a],r.jump(c))}),C.length){const a=C.indexOf("height")>=0?window.pageYOffset:null,r=Z9(g,e,C);return I.length&&I.forEach(([i,s])=>{e.getValue(i).set(s)}),e.render(),Wi&&a!==null&&window.scrollTo({top:a}),{target:r,transitionEnd:l}}else return{target:g,transitionEnd:l}};function p9(e,g,t,l){return u9(g)?h9(e,g,t,l):{target:g,transitionEnd:l}}const G9=(e,g,t,l)=>{const n=c9(e,g,l);return g=n.target,l=n.transitionEnd,p9(e,g,t,l)},tu={current:null},yf={current:!1};function y9(){if(yf.current=!0,!!Wi)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),g=()=>tu.current=e.matches;e.addListener(g),g()}else tu.current=!1}function B9(e,g,t){const{willChange:l}=g;for(const n in g){const I=g[n],o=t[n];if(vg(I))e.addValue(n,I),Lr(l)&&l.add(n);else if(vg(o))e.addValue(n,FI(I,{owner:e})),Lr(l)&&l.remove(n);else if(o!==I)if(e.hasValue(n)){const C=e.getValue(n);!C.hasAnimated&&C.set(I)}else{const C=e.getStaticValue(n);e.addValue(n,FI(C!==void 0?C:I,{owner:e}))}}for(const n in t)g[n]===void 0&&e.removeValue(n);return g}const M0=new WeakMap,Bf=Object.keys(rC),f9=Bf.length,z0=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"],S9=DA.length;class V9{constructor({parent:g,props:t,presenceContext:l,reducedMotionConfig:n,visualState:I},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.scheduleRender=()=>me.render(this.render,!1,!0);const{latestValues:C,renderState:a}=I;this.latestValues=C,this.baseTarget={...C},this.initialValues=t.initial?{...C}:{},this.renderState=a,this.parent=g,this.props=t,this.presenceContext=l,this.depth=g?g.depth+1:0,this.reducedMotionConfig=n,this.options=o,this.isControllingVariants=Ri(t),this.isVariantNode=oB(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(g&&g.current);const{willChange:r,...i}=this.scrapeMotionValuesFromProps(t,{});for(const s in i){const c=i[s];C[s]!==void 0&&vg(c)&&(c.set(C[s],!1),Lr(r)&&r.add(s))}}scrapeMotionValuesFromProps(g,t){return{}}mount(g){this.current=g,M0.set(g,this),this.projection&&!this.projection.instance&&this.projection.mount(g),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((t,l)=>this.bindToMotionValue(l,t)),yf.current||y9(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:tu.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){M0.delete(this.current),this.projection&&this.projection.unmount(),tl(this.notifyUpdate),tl(this.render),this.valueSubscriptions.forEach(g=>g()),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const g in this.events)this.events[g].clear();for(const g in this.features)this.features[g].unmount();this.current=null}bindToMotionValue(g,t){const l=wn.has(g),n=t.on("change",o=>{this.latestValues[g]=o,this.props.onUpdate&&me.update(this.notifyUpdate,!1,!0),l&&this.projection&&(this.projection.isTransformDirty=!0)}),I=t.on("renderRequest",this.scheduleRender);this.valueSubscriptions.set(g,()=>{n(),I()})}sortNodePosition(g){return!this.current||!this.sortInstanceNodePosition||this.type!==g.type?0:this.sortInstanceNodePosition(this.current,g.current)}loadFeatures({children:g,...t},l,n,I){let o,C;for(let a=0;a<f9;a++){const r=Bf[a],{isEnabled:i,Feature:s,ProjectionNode:c,MeasureLayout:d}=rC[r];c&&(o=c),i(t)&&(!this.features[r]&&s&&(this.features[r]=new s(this)),d&&(C=d))}if((this.type==="html"||this.type==="svg")&&!this.projection&&o){this.projection=new o(this.latestValues,this.parent&&this.parent.projection);const{layoutId:a,layout:r,drag:i,dragConstraints:s,layoutScroll:c,layoutRoot:d}=t;this.projection.setOptions({layoutId:a,layout:r,alwaysMeasureLayout:!!i||s&&uI(s),visualElement:this,scheduleRender:()=>this.scheduleRender(),animationType:typeof r=="string"?r:"both",initialPromotionConfig:I,layoutScroll:c,layoutRoot:d})}return C}updateFeatures(){for(const g in this.features){const t=this.features[g];t.isMounted?t.update():(t.mount(),t.isMounted=!0)}}triggerBuild(){this.build(this.renderState,this.latestValues,this.options,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):De()}getStaticValue(g){return this.latestValues[g]}setStaticValue(g,t){this.latestValues[g]=t}makeTargetAnimatable(g,t=!0){return this.makeTargetAnimatableFromInstance(g,this.props,t)}update(g,t){(g.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=g,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let l=0;l<z0.length;l++){const n=z0[l];this.propEventSubscriptions[n]&&(this.propEventSubscriptions[n](),delete this.propEventSubscriptions[n]);const I=g["on"+n];I&&(this.propEventSubscriptions[n]=this.on(n,I))}this.prevMotionValues=B9(this,this.scrapeMotionValuesFromProps(g,this.prevProps),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(g){return this.props.variants?this.props.variants[g]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}getVariantContext(g=!1){if(g)return this.parent?this.parent.getVariantContext():void 0;if(!this.isControllingVariants){const l=this.parent?this.parent.getVariantContext()||{}:{};return this.props.initial!==void 0&&(l.initial=this.props.initial),l}const t={};for(let l=0;l<S9;l++){const n=DA[l],I=this.props[n];(aC(I)||I===!1)&&(t[n]=I)}return t}addVariantChild(g){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(g),()=>t.variantChildren.delete(g)}addValue(g,t){t!==this.values.get(g)&&(this.removeValue(g),this.bindToMotionValue(g,t)),this.values.set(g,t),this.latestValues[g]=t.get()}removeValue(g){this.values.delete(g);const t=this.valueSubscriptions.get(g);t&&(t(),this.valueSubscriptions.delete(g)),delete this.latestValues[g],this.removeValueFromRenderState(g,this.renderState)}hasValue(g){return this.values.has(g)}getValue(g,t){if(this.props.values&&this.props.values[g])return this.props.values[g];let l=this.values.get(g);return l===void 0&&t!==void 0&&(l=FI(t,{owner:this}),this.addValue(g,l)),l}readValue(g){var t;return this.latestValues[g]!==void 0||!this.current?this.latestValues[g]:(t=this.getBaseTargetFromProps(this.props,g))!==null&&t!==void 0?t:this.readValueFromInstance(this.current,g,this.options)}setBaseTarget(g,t){this.baseTarget[g]=t}getBaseTarget(g){var t;const{initial:l}=this.props,n=typeof l=="string"||typeof l=="object"?(t=PA(this.props,l))===null||t===void 0?void 0:t[g]:void 0;if(l&&n!==void 0)return n;const I=this.getBaseTargetFromProps(this.props,g);return I!==void 0&&!vg(I)?I:this.initialValues[g]!==void 0&&n===void 0?void 0:this.baseTarget[g]}on(g,t){return this.events[g]||(this.events[g]=new Im),this.events[g].add(t)}notify(g,...t){this.events[g]&&this.events[g].notify(...t)}}class ff extends V9{sortInstanceNodePosition(g,t){return g.compareDocumentPosition(t)&2?1:-1}getBaseTargetFromProps(g,t){return g.style?g.style[t]:void 0}removeValueFromRenderState(g,{vars:t,style:l}){delete t[g],delete l[g]}makeTargetAnimatableFromInstance({transition:g,transitionEnd:t,...l},{transformValues:n},I){let o=zH(l,g||{},this);if(n&&(t&&(t=n(t)),l&&(l=n(l)),o&&(o=n(o))),I){DH(this,l,o);const C=G9(this,l,o,t);t=C.transitionEnd,l=C.target}return{transition:g,transitionEnd:t,...l}}}function W9(e){return window.getComputedStyle(e)}class v9 extends ff{constructor(){super(...arguments),this.type="html"}readValueFromInstance(g,t){if(wn.has(t)){const l=em(t);return l&&l.default||0}else{const l=W9(g),n=(iB(t)?l.getPropertyValue(t):l[t])||0;return typeof n=="string"?n.trim():n}}measureInstanceViewportBox(g,{transformPagePoint:t}){return sf(g,t)}build(g,t,l,n){TA(g,t,l,n.transformTemplate)}scrapeMotionValuesFromProps(g,t){return jA(g,t)}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:g}=this.props;vg(g)&&(this.childSubscription=g.on("change",t=>{this.current&&(this.current.textContent=`${t}`)}))}renderInstance(g,t,l,n){mB(g,t,l,n)}}class R9 extends ff{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1}getBaseTargetFromProps(g,t){return g[t]}readValueFromInstance(g,t){if(wn.has(t)){const l=em(t);return l&&l.default||0}return t=bB.has(t)?t:xA(t),g.getAttribute(t)}measureInstanceViewportBox(){return De()}scrapeMotionValuesFromProps(g,t){return hB(g,t)}build(g,t,l,n){UA(g,t,l,this.isSVGTag,n.transformTemplate)}renderInstance(g,t,l,n){ZB(g,t,l,n)}mount(g){this.isSVGTag=QA(g.tagName),super.mount(g)}}const X9=(e,g)=>zA(e)?new R9(g,{enableHardwareAcceleration:!1}):new v9(g,{enableHardwareAcceleration:!0}),k9={layout:{ProjectionNode:pf,MeasureLayout:df}},J9={...n5,...f1,...r9,...k9},Y9=Yw((e,g)=>s1(e,g,J9,X9));function Sf(){const e=u.useRef(!1);return FA(()=>(e.current=!0,()=>{e.current=!1}),[]),e}function w9(){const e=Sf(),[g,t]=u.useState(0),l=u.useCallback(()=>{e.current&&t(g+1)},[g]);return[u.useCallback(()=>me.postRender(l),[l]),g]}class H9 extends u.Component{getSnapshotBeforeUpdate(g){const t=this.props.childRef.current;if(t&&g.isPresent&&!this.props.isPresent){const l=this.props.sizeRef.current;l.height=t.offsetHeight||0,l.width=t.offsetWidth||0,l.top=t.offsetTop,l.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function N9({children:e,isPresent:g}){const t=u.useId(),l=u.useRef(null),n=u.useRef({width:0,height:0,top:0,left:0});return u.useInsertionEffect(()=>{const{width:I,height:o,top:C,left:a}=n.current;if(g||!l.current||!I||!o)return;l.current.dataset.motionPopId=t;const r=document.createElement("style");return document.head.appendChild(r),r.sheet&&r.sheet.insertRule(`
          [data-motion-pop-id="${t}"] {
            position: absolute !important;
            width: ${I}px !important;
            height: ${o}px !important;
            top: ${C}px !important;
            left: ${a}px !important;
          }
        `),()=>{document.head.removeChild(r)}},[g]),u.createElement(H9,{isPresent:g,childRef:l,sizeRef:n},u.cloneElement(e,{ref:l}))}const mc=({children:e,initial:g,isPresent:t,onExitComplete:l,custom:n,presenceAffectsLayout:I,mode:o})=>{const C=pB(K9),a=u.useId(),r=u.useMemo(()=>({id:a,initial:g,isPresent:t,custom:n,onExitComplete:i=>{C.set(i,!0);for(const s of C.values())if(!s)return;l&&l()},register:i=>(C.set(i,!1),()=>C.delete(i))}),I?void 0:[t]);return u.useMemo(()=>{C.forEach((i,s)=>C.set(s,!1))},[t]),u.useEffect(()=>{!t&&!C.size&&l&&l()},[t]),o==="popLayout"&&(e=u.createElement(N9,{isPresent:t},e)),u.createElement(Vi.Provider,{value:r},e)};function K9(){return new Map}function F9(e){return u.useEffect(()=>()=>e(),[])}const Cn=e=>e.key||"";function x9(e,g){e.forEach(t=>{const l=Cn(t);g.set(l,t)})}function E9(e){const g=[];return u.Children.forEach(e,t=>{u.isValidElement(t)&&g.push(t)}),g}const Vf=({children:e,custom:g,initial:t=!0,onExitComplete:l,exitBeforeEnter:n,presenceAffectsLayout:I=!0,mode:o="sync"})=>{const C=u.useContext(MA).forceRender||w9()[0],a=Sf(),r=E9(e);let i=r;const s=u.useRef(new Map).current,c=u.useRef(i),d=u.useRef(new Map).current,Z=u.useRef(!0);if(FA(()=>{Z.current=!1,x9(r,d),c.current=i}),F9(()=>{Z.current=!0,d.clear(),s.clear()}),Z.current)return u.createElement(u.Fragment,null,i.map(h=>u.createElement(mc,{key:Cn(h),isPresent:!0,initial:t?void 0:!1,presenceAffectsLayout:I,mode:o},h)));i=[...i];const G=c.current.map(Cn),y=r.map(Cn),p=G.length;for(let h=0;h<p;h++){const b=G[h];y.indexOf(b)===-1&&!s.has(b)&&s.set(b,void 0)}return o==="wait"&&s.size&&(i=[]),s.forEach((h,b)=>{if(y.indexOf(b)!==-1)return;const B=d.get(b);if(!B)return;const S=G.indexOf(b);let X=h;if(!X){const k=()=>{s.delete(b);const m=Array.from(d.keys()).filter(v=>!y.includes(v));if(m.forEach(v=>d.delete(v)),c.current=r.filter(v=>{const R=Cn(v);return R===b||m.includes(R)}),!s.size){if(a.current===!1)return;C(),l&&l()}};X=u.createElement(mc,{key:Cn(B),isPresent:!1,onExitComplete:k,custom:g,presenceAffectsLayout:I,mode:o},B),s.set(b,X)}i.splice(S,0,X)}),i=i.map(h=>{const b=h.key;return s.has(b)?h:u.createElement(mc,{key:Cn(h),isPresent:!0,presenceAffectsLayout:I,mode:o},h)}),u.createElement(u.Fragment,null,s.size?i:i.map(h=>u.cloneElement(h)))};class D9{build(g,t){return this.context=t,T0(()=>this.iterateCollection(g))}*iterateCollection(g){let{children:t,items:l}=g;if(typeof t=="function"){if(!l)throw new Error("props.children was a function but props.items is missing");for(let n of g.items)yield*this.getFullNode({value:n},{renderer:t})}else{let n=[];D.Children.forEach(t,o=>{n.push(o)});let I=0;for(let o of n){let C=this.getFullNode({element:o,index:I},{});for(let a of C)I++,yield a}}}getKey(g,t,l,n){if(g.key!=null)return g.key;if(t.type==="cell"&&t.key!=null)return`${n}${t.key}`;let I=t.value;if(I!=null){var o;let C=(o=I.key)!==null&&o!==void 0?o:I.id;if(C==null)throw new Error("No key found for item");return C}return n?`${n}.${t.index}`:`$.${t.index}`}getChildState(g,t){return{renderer:t.renderer||g.renderer}}*getFullNode(g,t,l,n){let I=g.element;if(!I&&g.value&&t&&t.renderer){let a=this.cache.get(g.value);if(a&&(!a.shouldInvalidate||!a.shouldInvalidate(this.context))){a.index=g.index,a.parentKey=n?n.key:null,yield a;return}I=t.renderer(g.value)}if(D.isValidElement(I)){let a=I.type;if(typeof a!="function"&&typeof a.getCollectionNode!="function"){let c=typeof I.type=="function"?I.type.name:I.type;throw new Error(`Unknown element <${c}> in collection.`)}let r=a.getCollectionNode(I.props,this.context),i=g.index,s=r.next();for(;!s.done&&s.value;){let c=s.value;g.index=i;let d=c.key;d||(d=c.element?null:this.getKey(I,g,t,l));let G=[...this.getFullNode({...c,key:d,index:i,wrapper:M9(g.wrapper,c.wrapper)},this.getChildState(t,c),l?`${l}${I.key}`:I.key,n)];for(let y of G){if(y.value=c.value||g.value,y.value&&this.cache.set(y.value,y),g.type&&y.type!==g.type)throw new Error(`Unsupported type <${bc(y.type)}> in <${bc(n.type)}>. Only <${bc(g.type)}> is supported.`);i++,yield y}s=r.next(G)}return}if(g.key==null)return;let o=this,C={type:g.type,props:g.props,key:g.key,parentKey:n?n.key:null,value:g.value,level:n?n.level+1:0,index:g.index,rendered:g.rendered,textValue:g.textValue,"aria-label":g["aria-label"],wrapper:g.wrapper,shouldInvalidate:g.shouldInvalidate,hasChildNodes:g.hasChildNodes,childNodes:T0(function*(){if(!g.hasChildNodes)return;let a=0;for(let r of g.childNodes()){r.key!=null&&(r.key=`${C.key}${r.key}`),r.index=a;let i=o.getFullNode(r,o.getChildState(t,r),C.key,C);for(let s of i)a++,yield s}})};yield C}constructor(){this.cache=new WeakMap}}function T0(e){let g=[],t=null;return{*[Symbol.iterator](){for(let l of g)yield l;t||(t=e());for(let l of t)g.push(l),yield l}}}function M9(e,g){if(e&&g)return t=>e(g(t));if(e)return e;if(g)return g}function bc(e){return e[0].toUpperCase()+e.slice(1)}function z9(e,g,t){let l=u.useMemo(()=>new D9,[]),{children:n,items:I,collection:o}=e;return u.useMemo(()=>{if(o)return o;let a=l.build({children:n,items:I},t);return g(a)},[l,n,I,o,t,g])}function Qe(e,g){return typeof g.getChildren=="function"?g.getChildren(e.key):e.childNodes}function Mt(e){return hl(e,0)}function hl(e,g){if(g<0)return;let t=0;for(let l of e){if(t===g)return l;t++}}function Wl(e){let g;for(let t of e)g=t;return g}function Zc(e,g,t){if(g.parentKey===t.parentKey)return g.index-t.index;let l=[...L0(e,g),g],n=[...L0(e,t),t],I=l.slice(0,n.length).findIndex((o,C)=>o!==n[C]);return I!==-1?(g=l[I],t=n[I],g.index-t.index):l.findIndex(o=>o===t)>=0?1:(n.findIndex(o=>o===g)>=0,-1)}function L0(e,g){let t=[];for(;(g==null?void 0:g.parentKey)!=null;)g=e.getItem(g.parentKey),t.unshift(g);return t}class dt extends Set{constructor(g,t,l){super(g),g instanceof dt?(this.anchorKey=t||g.anchorKey,this.currentKey=l||g.currentKey):(this.anchorKey=t,this.currentKey=l)}}function T9(e,g){if(e.size!==g.size)return!1;for(let t of e)if(!g.has(t))return!1;return!0}function L9(e){let{selectionMode:g="none",disallowEmptySelection:t,allowDuplicateSelectionEvents:l,selectionBehavior:n="toggle",disabledBehavior:I="all"}=e,o=u.useRef(!1),[,C]=u.useState(!1),a=u.useRef(null),r=u.useRef(null),[,i]=u.useState(null),s=u.useMemo(()=>U0(e.selectedKeys),[e.selectedKeys]),c=u.useMemo(()=>U0(e.defaultSelectedKeys,new dt),[e.defaultSelectedKeys]),[d,Z]=VC(s,c,e.onSelectionChange),G=u.useMemo(()=>e.disabledKeys?new Set(e.disabledKeys):new Set,[e.disabledKeys]),[y,p]=u.useState(n);n==="replace"&&y==="toggle"&&typeof d=="object"&&d.size===0&&p("replace");let h=u.useRef(n);return u.useEffect(()=>{n!==h.current&&(p(n),h.current=n)},[n]),{selectionMode:g,disallowEmptySelection:t,selectionBehavior:y,setSelectionBehavior:p,get isFocused(){return o.current},setFocused(b){o.current=b,C(b)},get focusedKey(){return a.current},get childFocusStrategy(){return r.current},setFocusedKey(b,B="first"){a.current=b,r.current=B,i(b)},selectedKeys:d,setSelectedKeys(b){(l||!T9(b,d))&&Z(b)},disabledKeys:G,disabledBehavior:I}}function U0(e,g){return e?e==="all"?"all":new dt(e):g}class U9{get selectionMode(){return this.state.selectionMode}get disallowEmptySelection(){return this.state.disallowEmptySelection}get selectionBehavior(){return this.state.selectionBehavior}setSelectionBehavior(g){this.state.setSelectionBehavior(g)}get isFocused(){return this.state.isFocused}setFocused(g){this.state.setFocused(g)}get focusedKey(){return this.state.focusedKey}get childFocusStrategy(){return this.state.childFocusStrategy}setFocusedKey(g,t){(g==null||this.collection.getItem(g))&&this.state.setFocusedKey(g,t)}get selectedKeys(){return this.state.selectedKeys==="all"?new Set(this.getSelectAllKeys()):this.state.selectedKeys}get rawSelection(){return this.state.selectedKeys}isSelected(g){return this.state.selectionMode==="none"?!1:(g=this.getKey(g),this.state.selectedKeys==="all"?this.canSelectItem(g):this.state.selectedKeys.has(g))}get isEmpty(){return this.state.selectedKeys!=="all"&&this.state.selectedKeys.size===0}get isSelectAll(){if(this.isEmpty)return!1;if(this.state.selectedKeys==="all")return!0;if(this._isSelectAll!=null)return this._isSelectAll;let g=this.getSelectAllKeys(),t=this.state.selectedKeys;return this._isSelectAll=g.every(l=>t.has(l)),this._isSelectAll}get firstSelectedKey(){let g=null;for(let t of this.state.selectedKeys){let l=this.collection.getItem(t);(!g||l&&Zc(this.collection,l,g)<0)&&(g=l)}return g==null?void 0:g.key}get lastSelectedKey(){let g=null;for(let t of this.state.selectedKeys){let l=this.collection.getItem(t);(!g||l&&Zc(this.collection,l,g)>0)&&(g=l)}return g==null?void 0:g.key}get disabledKeys(){return this.state.disabledKeys}get disabledBehavior(){return this.state.disabledBehavior}extendSelection(g){if(this.selectionMode==="none")return;if(this.selectionMode==="single"){this.replaceSelection(g);return}g=this.getKey(g);let t;if(this.state.selectedKeys==="all")t=new dt([g],g,g);else{let l=this.state.selectedKeys,n=l.anchorKey||g;t=new dt(l,n,g);for(let I of this.getKeyRange(n,l.currentKey||g))t.delete(I);for(let I of this.getKeyRange(g,n))this.canSelectItem(I)&&t.add(I)}this.state.setSelectedKeys(t)}getKeyRange(g,t){let l=this.collection.getItem(g),n=this.collection.getItem(t);return l&&n?Zc(this.collection,l,n)<=0?this.getKeyRangeInternal(g,t):this.getKeyRangeInternal(t,g):[]}getKeyRangeInternal(g,t){let l=[],n=g;for(;n;){let I=this.collection.getItem(n);if((I&&I.type==="item"||I.type==="cell"&&this.allowsCellSelection)&&l.push(n),n===t)return l;n=this.collection.getKeyAfter(n)}return[]}getKey(g){let t=this.collection.getItem(g);if(!t||t.type==="cell"&&this.allowsCellSelection)return g;for(;t.type!=="item"&&t.parentKey!=null;)t=this.collection.getItem(t.parentKey);return!t||t.type!=="item"?null:t.key}toggleSelection(g){if(this.selectionMode==="none")return;if(this.selectionMode==="single"&&!this.isSelected(g)){this.replaceSelection(g);return}if(g=this.getKey(g),g==null)return;let t=new dt(this.state.selectedKeys==="all"?this.getSelectAllKeys():this.state.selectedKeys);t.has(g)?t.delete(g):this.canSelectItem(g)&&(t.add(g),t.anchorKey=g,t.currentKey=g),!(this.disallowEmptySelection&&t.size===0)&&this.state.setSelectedKeys(t)}replaceSelection(g){if(this.selectionMode==="none"||(g=this.getKey(g),g==null))return;let t=this.canSelectItem(g)?new dt([g],g,g):new dt;this.state.setSelectedKeys(t)}setSelectedKeys(g){if(this.selectionMode==="none")return;let t=new dt;for(let l of g)if(l=this.getKey(l),l!=null&&(t.add(l),this.selectionMode==="single"))break;this.state.setSelectedKeys(t)}getSelectAllKeys(){let g=[],t=l=>{for(;l;){if(this.canSelectItem(l)){let n=this.collection.getItem(l);n.type==="item"&&g.push(l),n.hasChildNodes&&(this.allowsCellSelection||n.type!=="item")&&t(Mt(Qe(n,this.collection)).key)}l=this.collection.getKeyAfter(l)}};return t(this.collection.getFirstKey()),g}selectAll(){!this.isSelectAll&&this.selectionMode==="multiple"&&this.state.setSelectedKeys("all")}clearSelection(){!this.disallowEmptySelection&&(this.state.selectedKeys==="all"||this.state.selectedKeys.size>0)&&this.state.setSelectedKeys(new dt)}toggleSelectAll(){this.isSelectAll?this.clearSelection():this.selectAll()}select(g,t){this.selectionMode!=="none"&&(this.selectionMode==="single"?this.isSelected(g)&&!this.disallowEmptySelection?this.toggleSelection(g):this.replaceSelection(g):this.selectionBehavior==="toggle"||t&&(t.pointerType==="touch"||t.pointerType==="virtual")?this.toggleSelection(g):this.replaceSelection(g))}isSelectionEqual(g){if(g===this.state.selectedKeys)return!0;let t=this.selectedKeys;if(g.size!==t.size)return!1;for(let l of g)if(!t.has(l))return!1;for(let l of t)if(!g.has(l))return!1;return!0}canSelectItem(g){if(this.state.selectionMode==="none"||this.state.disabledKeys.has(g))return!1;let t=this.collection.getItem(g);return!(!t||t.type==="cell"&&!this.allowsCellSelection)}isDisabled(g){return this.state.disabledKeys.has(g)&&this.state.disabledBehavior==="all"}isLink(g){var t,l;return!!(!((l=this.collection.getItem(g))===null||l===void 0||(t=l.props)===null||t===void 0)&&t.href)}constructor(g,t,l){this.collection=g,this.state=t;var n;this.allowsCellSelection=(n=l==null?void 0:l.allowsCellSelection)!==null&&n!==void 0?n:!1,this._isSelectAll=null}}var[oE,Q9]=HA({name:"ButtonGroupContext",strict:!1});function Wf(e,g){let{elementType:t="button",isDisabled:l,onPress:n,onPressStart:I,onPressEnd:o,onPressChange:C,preventFocusOnPress:a,allowFocusWhenDisabled:r,onClick:i,href:s,target:c,rel:d,type:Z="button",allowTextSelectionOnPress:G}=e,y;t==="button"?y={type:Z,disabled:l}:y={role:"button",tabIndex:l?void 0:0,href:t==="a"&&l?void 0:s,target:t==="a"?c:void 0,type:t==="input"?Z:void 0,disabled:t==="input"?l:void 0,"aria-disabled":!l||t==="input"?void 0:l,rel:t==="a"?d:void 0};let{pressProps:p,isPressed:h}=NA({onPressStart:I,onPressEnd:o,onPressChange:C,onPress:n,isDisabled:l,preventFocusOnPress:a,allowTextSelectionOnPress:G,ref:g}),{focusableProps:b}=Bi(e,g);r&&(b.tabIndex=l?-1:b.tabIndex);let B=_(b,p,Zi(e,{labelable:!0}));return{isPressed:h,buttonProps:_(y,B,{"aria-haspopup":e["aria-haspopup"],"aria-expanded":e["aria-expanded"],"aria-controls":e["aria-controls"],"aria-pressed":e["aria-pressed"],onClick:S=>{i==null||i(S)}})}}var j9=(e,g,t)=>Math.min(Math.max(e,g),t),vf=e=>{const{ripples:g=[],motionProps:t,color:l="currentColor",style:n,onClear:I}=e;return A.jsx(A.Fragment,{children:g.map(o=>{const C=j9(.01*o.size,.2,o.size>100?.75:.5);return A.jsx(Vf,{mode:"popLayout",children:A.jsx(Y9.span,{animate:{transform:"scale(2)",opacity:0},className:"nextui-ripple",exit:{opacity:0},initial:{transform:"scale(0)",opacity:.35},style:{position:"absolute",backgroundColor:l,borderRadius:"100%",transformOrigin:"center",pointerEvents:"none",zIndex:10,top:o.y,left:o.x,width:`${o.size}px`,height:`${o.size}px`,...n},transition:{duration:C},onAnimationComplete:()=>{I(o.key)},...t})},o.key)})})};vf.displayName="NextUI.Ripple";var P9=vf;function O9(e={}){const[g,t]=u.useState([]),l=u.useCallback(I=>{const o=I.currentTarget,C=Math.max(o.clientWidth,o.clientHeight),a=o.getBoundingClientRect();t(r=>[...r,{key:OY(r.length.toString()),size:C,x:I.clientX-a.x-C/2,y:I.clientY-a.y-C/2}])},[]),n=u.useCallback(I=>{t(o=>o.filter(C=>C.key!==I))},[]);return{ripples:g,onClick:l,onClear:n,...e}}function $9(e){var g,t,l,n,I,o,C,a;const r=Q9(),i=!!r,{ref:s,as:c,children:d,startContent:Z,endContent:G,autoFocus:y,className:p,spinner:h,fullWidth:b=(g=r==null?void 0:r.fullWidth)!=null?g:!1,size:B=(t=r==null?void 0:r.size)!=null?t:"md",color:S=(l=r==null?void 0:r.color)!=null?l:"default",variant:X=(n=r==null?void 0:r.variant)!=null?n:"solid",disableAnimation:k=(I=r==null?void 0:r.disableAnimation)!=null?I:!1,radius:m=r==null?void 0:r.radius,disableRipple:v=(o=r==null?void 0:r.disableRipple)!=null?o:!1,isDisabled:R=(C=r==null?void 0:r.isDisabled)!=null?C:!1,isIconOnly:W=(a=r==null?void 0:r.isIconOnly)!=null?a:!1,isLoading:J=!1,spinnerPlacement:f="start",onPress:V,onClick:K,...x}=e,Y=c||"button",N=typeof Y=="string",F=Oe(s),{isFocusVisible:H,isFocused:E,focusProps:z}=ht({autoFocus:y}),U=R||J,j=u.useMemo(()=>jY({size:B,color:S,variant:X,radius:m,fullWidth:b,isDisabled:U,isInGroup:i,disableAnimation:k,isIconOnly:W,className:p}),[B,S,X,m,b,U,i,W,k,p]),{onClick:ge,onClear:$,ripples:ae}=O9(),Je=u.useCallback(Ne=>{v||U||k||F.current&&ge(Ne)},[v,U,k,F,ge]),{buttonProps:oe,isPressed:Q}=Wf({elementType:c,isDisabled:U,onPress:V,onClick:UI(K,Je),...x},F),{isHovered:re,hoverProps:Se}=jI({isDisabled:U}),Ue=u.useCallback((Ne={})=>({"data-disabled":T(U),"data-focus":T(E),"data-pressed":T(Q),"data-focus-visible":T(H),"data-hover":T(re),"data-loading":T(J),..._(oe,z,Se,Ng(x,{enabled:N}),Ng(Ne))}),[J,U,E,Q,N,H,re,oe,z,Se,x]),ee=Ne=>u.isValidElement(Ne)?u.cloneElement(Ne,{"aria-hidden":!0,focusable:!1,tabIndex:-1}):null,Ye=ee(Z),ie=ee(G),pg=u.useMemo(()=>({sm:"sm",md:"sm",lg:"md"})[B],[B]),og=u.useCallback(()=>({ripples:ae,onClear:$}),[ae,$]);return{Component:Y,children:d,domRef:F,spinner:h,styles:j,startContent:Ye,endContent:ie,isLoading:J,spinnerPlacement:f,spinnerSize:pg,disableRipple:v,getButtonProps:Ue,getRippleProps:og,isIconOnly:W}}function q9(e){const[g,t]=PI(e,VZ.variantKeys),{children:l,className:n,classNames:I,label:o,...C}=g,a=u.useMemo(()=>VZ({...t}),[...Object.values(t)]),r=ne(I==null?void 0:I.base,n),i=o||l,s=u.useMemo(()=>i&&typeof i=="string"?i:C["aria-label"]?"":"Loading",[l,i,C["aria-label"]]),c=u.useCallback(()=>({"aria-label":s,className:a.base({class:r}),...C}),[s,a,r,C]);return{label:i,slots:a,classNames:I,getSpinnerProps:c}}var Rf=_e((e,g)=>{const{slots:t,classNames:l,label:n,getSpinnerProps:I}=q9({...e});return A.jsxs("div",{ref:g,...I(),children:[A.jsxs("div",{className:t.wrapper({class:l==null?void 0:l.wrapper}),children:[A.jsx("i",{className:t.circle1({class:l==null?void 0:l.circle1})}),A.jsx("i",{className:t.circle2({class:l==null?void 0:l.circle2})})]}),n&&A.jsx("span",{className:t.label({class:l==null?void 0:l.label}),children:n})]})});Rf.displayName="NextUI.Spinner";var Xf=Rf,kf=_e((e,g)=>{const{Component:t,domRef:l,children:n,styles:I,spinnerSize:o,spinner:C=A.jsx(Xf,{color:"current",size:o}),spinnerPlacement:a,startContent:r,endContent:i,isLoading:s,disableRipple:c,getButtonProps:d,getRippleProps:Z,isIconOnly:G}=$9({...e,ref:g});return A.jsxs(t,{ref:l,className:I,...d(),children:[r,s&&a==="start"&&C,s&&G?null:n,s&&a==="end"&&C,i,!c&&A.jsx(P9,{...Z()})]})});kf.displayName="NextUI.Button";var Q0=kf;function Jf(e,g,t){let{validationBehavior:l,focus:n}=e;Le(()=>{if(l==="native"&&(t!=null&&t.current)){let a=g.realtimeValidation.isInvalid?g.realtimeValidation.validationErrors.join(" ")||"Invalid value.":"";t.current.setCustomValidity(a),t.current.hasAttribute("title")||(t.current.title=""),g.realtimeValidation.isInvalid||g.updateValidation(eN(t.current))}});let I=Te(()=>{g.resetValidation()}),o=Te(a=>{var r;g.displayValidation.isInvalid||g.commitValidation();let i=t==null||(r=t.current)===null||r===void 0?void 0:r.form;if(!a.defaultPrevented&&t&&i&&gN(i)===t.current){var s;n?n():(s=t.current)===null||s===void 0||s.focus(),SJ("keyboard")}a.preventDefault()}),C=Te(()=>{g.commitValidation()});u.useEffect(()=>{let a=t==null?void 0:t.current;if(!a)return;let r=a.form;return a.addEventListener("invalid",o),a.addEventListener("change",C),r==null||r.addEventListener("reset",I),()=>{a.removeEventListener("invalid",o),a.removeEventListener("change",C),r==null||r.removeEventListener("reset",I)}},[t,o,C,I,l])}function _9(e){let g=e.validity;return{badInput:g.badInput,customError:g.customError,patternMismatch:g.patternMismatch,rangeOverflow:g.rangeOverflow,rangeUnderflow:g.rangeUnderflow,stepMismatch:g.stepMismatch,tooLong:g.tooLong,tooShort:g.tooShort,typeMismatch:g.typeMismatch,valueMissing:g.valueMissing,valid:g.valid}}function eN(e){return{isInvalid:!e.validity.valid,validationDetails:_9(e),validationErrors:e.validationMessage?[e.validationMessage]:[]}}function gN(e){for(let g=0;g<e.elements.length;g++){let t=e.elements[g];if(!t.validity.valid)return t}return null}const Yf={badInput:!1,customError:!1,patternMismatch:!1,rangeOverflow:!1,rangeUnderflow:!1,stepMismatch:!1,tooLong:!1,tooShort:!1,typeMismatch:!1,valueMissing:!1,valid:!0},wf={...Yf,customError:!0,valid:!1},qn={isInvalid:!1,validationDetails:Yf,validationErrors:[]},tN=u.createContext({}),lu="__formValidationState"+Date.now();function om(e){if(e[lu]){let{realtimeValidation:g,displayValidation:t,updateValidation:l,resetValidation:n,commitValidation:I}=e[lu];return{realtimeValidation:g,displayValidation:t,updateValidation:l,resetValidation:n,commitValidation:I}}return lN(e)}function lN(e){let{isInvalid:g,validationState:t,name:l,value:n,builtinValidation:I,validate:o,validationBehavior:C="aria"}=e;t&&(g||(g=t==="invalid"));let a=g?{isInvalid:!0,validationErrors:[],validationDetails:wf}:null,r=u.useMemo(()=>j0(nN(o,n)),[o,n]);I!=null&&I.validationDetails.valid&&(I=null);let i=u.useContext(tN),s=u.useMemo(()=>l?Array.isArray(l)?l.flatMap(R=>nu(i[R])):nu(i[l]):[],[i,l]),[c,d]=u.useState(i),[Z,G]=u.useState(!1);i!==c&&(d(i),G(!1));let y=u.useMemo(()=>j0(Z?[]:s),[Z,s]),p=u.useRef(qn),[h,b]=u.useState(qn),B=u.useRef(qn),S=()=>{if(!X)return;k(!1);let R=r||I||p.current;hc(R,B.current)||(B.current=R,b(R))},[X,k]=u.useState(!1);return u.useEffect(S),{realtimeValidation:a||y||r||I||qn,displayValidation:C==="native"?a||y||h:a||y||r||I||h,updateValidation(R){C==="aria"&&!hc(h,R)?b(R):p.current=R},resetValidation(){let R=qn;hc(R,B.current)||(B.current=R,b(R)),C==="native"&&k(!1),G(!0)},commitValidation(){C==="native"&&k(!0),G(!0)}}}function nu(e){return e?Array.isArray(e)?e:[e]:[]}function nN(e,g){if(typeof e=="function"){let t=e(g);if(t&&typeof t!="boolean")return nu(t)}return[]}function j0(e){return e.length?{isInvalid:!0,validationErrors:e,validationDetails:wf}:null}function hc(e,g){return e===g?!0:e&&g&&e.isInvalid===g.isInvalid&&e.validationErrors.length===g.validationErrors.length&&e.validationErrors.every((t,l)=>t===g.validationErrors[l])&&Object.entries(e.validationDetails).every(([t,l])=>g.validationDetails[t]===l)}function IN(e,g,t){let{isDisabled:l=!1,isReadOnly:n=!1,value:I,name:o,children:C,"aria-label":a,"aria-labelledby":r,validationState:i="valid",isInvalid:s}=e,c=X=>{X.stopPropagation(),g.setSelected(X.target.checked)},d=C!=null,Z=a!=null||r!=null;!d&&!Z&&console.warn("If you do not provide children, you must specify an aria-label for accessibility");let{pressProps:G,isPressed:y}=KI({isDisabled:l}),{pressProps:p,isPressed:h}=KI({isDisabled:l||n,onPress(){g.toggle()}}),{focusableProps:b}=Bi(e,t),B=_(G,b),S=Zi(e,{labelable:!0});return Gy(t,g.isSelected,g.setSelected),{labelProps:_(p,{onClick:X=>X.preventDefault()}),inputProps:_(S,{"aria-invalid":s||i==="invalid"||void 0,"aria-errormessage":e["aria-errormessage"],"aria-controls":e["aria-controls"],"aria-readonly":n||void 0,onChange:c,disabled:l,...I==null?{}:{value:I},name:o,type:"checkbox",...B}),isSelected:g.isSelected,isPressed:y||h,isDisabled:l,isReadOnly:n,isInvalid:s||i==="invalid"}}function oN(e){let{id:g,label:t,"aria-labelledby":l,"aria-label":n,labelElementType:I="label"}=e;g=Wn(g);let o=Wn(),C={};t?(l=l?`${o} ${l}`:o,C={id:o,htmlFor:I==="label"?g:void 0}):!l&&!n&&console.warn("If you do not provide a visible label, you must specify an aria-label or aria-labelledby attribute for accessibility");let a=lJ({id:g,"aria-label":n,"aria-labelledby":l});return{labelProps:C,fieldProps:a}}function CN(e){let{description:g,errorMessage:t,isInvalid:l,validationState:n}=e,{labelProps:I,fieldProps:o}=oN(e),C=nZ([!!g,!!t,l,n]),a=nZ([!!g,!!t,l,n]);return o=_(o,{"aria-describedby":[C,a,e["aria-describedby"]].filter(Boolean).join(" ")||void 0}),{labelProps:I,fieldProps:o,descriptionProps:{id:C},errorMessageProps:{id:a}}}function Hf(e={}){let{isReadOnly:g}=e,[t,l]=VC(e.isSelected,e.defaultSelected||!1,e.onChange);function n(o){g||l(o)}function I(){g||l(!t)}return{isSelected:t,setSelected:n,toggle:I}}function Nf(e,g,t){let l=om({...e,value:g.isSelected}),{isInvalid:n,validationErrors:I,validationDetails:o}=l.displayValidation,{labelProps:C,inputProps:a,isSelected:r,isPressed:i,isDisabled:s,isReadOnly:c}=IN({...e,isInvalid:n},g,t);Jf(e,l,t);let{isIndeterminate:d,isRequired:Z,validationBehavior:G="aria"}=e;return u.useEffect(()=>{t.current&&(t.current.indeterminate=!!d)}),{labelProps:C,inputProps:{...a,checked:r,"aria-required":Z&&G==="aria"||void 0,required:Z&&G==="native"},isSelected:r,isPressed:i,isDisabled:s,isReadOnly:c,isInvalid:n,validationErrors:I,validationDetails:o}}const aN=new WeakMap;function rN(e,g,t){const l=Hf({isReadOnly:e.isReadOnly||g.isReadOnly,isSelected:g.isSelected(e.value),onChange(y){y?g.addValue(e.value):g.removeValue(e.value),e.onChange&&e.onChange(y)}});let{name:n,descriptionId:I,errorMessageId:o,validationBehavior:C}=aN.get(g);var a;C=(a=e.validationBehavior)!==null&&a!==void 0?a:C;let{realtimeValidation:r}=om({...e,value:l.isSelected,name:void 0,validationBehavior:"aria"}),i=u.useRef(qn),s=()=>{g.setInvalid(e.value,r.isInvalid?r:i.current)};u.useEffect(s);let c=g.realtimeValidation.isInvalid?g.realtimeValidation:r,d=C==="native"?g.displayValidation:c;var Z;let G=Nf({...e,isReadOnly:e.isReadOnly||g.isReadOnly,isDisabled:e.isDisabled||g.isDisabled,name:e.name||n,isRequired:(Z=e.isRequired)!==null&&Z!==void 0?Z:g.isRequired,validationBehavior:C,[lu]:{realtimeValidation:c,displayValidation:d,resetValidation:g.resetValidation,commitValidation:g.commitValidation,updateValidation(y){i.current=y,s()}}},l,t);return{...G,inputProps:{...G.inputProps,"aria-describedby":[e["aria-describedby"],g.isInvalid?o:null,I].filter(Boolean).join(" ")||void 0}}}var[CE,iN]=HA({name:"CheckboxGroupContext",strict:!1});function sN(e){const{isSelected:g,disableAnimation:t,...l}=e;return A.jsx("svg",{"aria-hidden":"true",role:"presentation",viewBox:"0 0 17 18",...l,children:A.jsx("polyline",{fill:"none",points:"1 9 7 14 15 4",stroke:"currentColor",strokeDasharray:22,strokeDashoffset:g?44:66,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,style:!t&&g?{transition:"stroke-dashoffset 250ms linear 0.2s"}:{}})})}function cN(e){const{isSelected:g,disableAnimation:t,...l}=e;return A.jsx("svg",{stroke:"currentColor",strokeWidth:3,viewBox:"0 0 24 24",...l,children:A.jsx("line",{x1:"21",x2:"3",y1:"12",y2:"12"})})}function dN(e){const{isIndeterminate:g,...t}=e,l=g?cN:sN;return A.jsx(l,{...t})}function uN(e={}){var g,t,l,n,I,o;const C=iN(),a=!!C,{as:r,ref:i,value:s="",children:c,icon:d,name:Z,isRequired:G=!1,isReadOnly:y=!1,autoFocus:p=!1,isSelected:h,validationState:b,size:B=(g=C==null?void 0:C.size)!=null?g:"md",color:S=(t=C==null?void 0:C.color)!=null?t:"primary",radius:X=C==null?void 0:C.radius,lineThrough:k=(l=C==null?void 0:C.lineThrough)!=null?l:!1,isDisabled:m=(n=C==null?void 0:C.isDisabled)!=null?n:!1,disableAnimation:v=(I=C==null?void 0:C.disableAnimation)!=null?I:!1,isInvalid:R=b?b==="invalid":(o=C==null?void 0:C.isInvalid)!=null?o:!1,isIndeterminate:W=!1,defaultSelected:J,classNames:f,onChange:V,className:K,onValueChange:x,...Y}=e;C&&$Y&&(h&&JZ("The Checkbox.Group is being used, `isSelected` will be ignored. Use the `value` of the Checkbox.Group instead.","Checkbox"),J&&JZ("The Checkbox.Group is being used, `defaultSelected` will be ignored. Use the `defaultValue` of the Checkbox.Group instead.","Checkbox"));const N=r||"label",F=u.useRef(null),H=lw(i,F),E=u.useId(),z=u.useMemo(()=>({name:Z,value:s,children:c,autoFocus:p,defaultSelected:J,isIndeterminate:W,isRequired:G,isInvalid:R,isSelected:h,isDisabled:m,isReadOnly:y,"aria-label":Oy(Y["aria-label"],c),"aria-labelledby":Y["aria-labelledby"]||E,onChange:x}),[s,Z,E,c,p,R,W,m,y,h,J,Y["aria-label"],Y["aria-labelledby"],x]),{inputProps:U,isSelected:j,isDisabled:ge,isReadOnly:$,isPressed:ae}=a?rN({...z,isInvalid:R},C.groupState,F):Nf(z,Hf(z),F),Je=ge||$,[oe,Q]=u.useState(!1),{pressProps:re}=NA({isDisabled:Je,onPressStart(nt){nt.pointerType!=="keyboard"&&Q(!0)},onPressEnd(nt){nt.pointerType!=="keyboard"&&Q(!1)}}),Se=Je?!1:oe||ae;G&&(U.required=!0);const{hoverProps:Ue,isHovered:ee}=jI({isDisabled:U.disabled}),{focusProps:Ye,isFocused:ie,isFocusVisible:pg}=ht({autoFocus:U.autoFocus}),og=u.useMemo(()=>QY({color:S,size:B,radius:X,isInvalid:R,lineThrough:k,isDisabled:ge,disableAnimation:v}),[S,B,X,R,k,ge,v]),Ne=ne(f==null?void 0:f.base,K),xn=u.useCallback(()=>({ref:H,className:og.base({class:Ne}),"data-disabled":T(ge),"data-selected":T(j||W),"data-invalid":T(R),"data-hover":T(ee),"data-focus":T(ie),"data-pressed":T(Se),"data-readonly":T(U.readOnly),"data-focus-visible":T(pg),"data-indeterminate":T(W),..._(Ue,re,Y)}),[og,Ne,ge,j,W,R,ee,ie,Se,U.readOnly,pg,Ue,re,Y]),ql=u.useCallback((nt={})=>({...nt,"aria-hidden":!0,className:ne(og.wrapper({class:ne(f==null?void 0:f.wrapper,nt==null?void 0:nt.className)}))}),[og,f==null?void 0:f.wrapper]),En=u.useCallback(()=>({ref:F,..._(U,Ye),onChange:UI(U.onChange,V)}),[U,Ye,V]),Dn=u.useCallback(()=>({id:E,className:og.label({class:f==null?void 0:f.label})}),[og,f==null?void 0:f.label,ge,j,R]),al=u.useCallback(()=>({isSelected:j,isIndeterminate:!!W,disableAnimation:!!v,className:og.icon({class:f==null?void 0:f.icon})}),[og,f==null?void 0:f.icon,j,W,v]);return{Component:N,icon:d,children:c,isSelected:j,isDisabled:ge,isInvalid:R,isFocused:ie,isHovered:ee,isFocusVisible:pg,getBaseProps:xn,getWrapperProps:ql,getInputProps:En,getLabelProps:Dn,getIconProps:al}}var Kf=_e((e,g)=>{const{Component:t,children:l,icon:n=A.jsx(dN,{}),getBaseProps:I,getWrapperProps:o,getInputProps:C,getIconProps:a,getLabelProps:r}=uN({...e,ref:g}),i=typeof n=="function"?n(a()):u.cloneElement(n,a());return A.jsxs(t,{...I(),children:[A.jsx(fi,{children:A.jsx("input",{...C()})}),A.jsx("span",{...o(),children:i}),l&&A.jsx("span",{...r(),children:l})]})});Kf.displayName="NextUI.Checkbox";var Ff=Kf,xf=_e((e,g)=>{const{as:t,activePage:l,...n}=e,I=t||"span",o=Oe(g);return A.jsx(I,{ref:o,"aria-hidden":!0,...n,children:l})});xf.displayName="NextUI.PaginationCursor";var AN=xf;function mN(e){const{as:g,ref:t,value:l,children:n,isActive:I,isDisabled:o,onPress:C,onClick:a,getAriaLabel:r,className:i,...s}=e,c=!!(e!=null&&e.href),d=g||c?"a":"li",Z=typeof d=="string",G=Oe(t),y=BA(),p=u.useMemo(()=>I?`${r==null?void 0:r(l)} active`:r==null?void 0:r(l),[l,I]),{isPressed:h,pressProps:b}=NA({isDisabled:o,onPress:C}),{focusProps:B,isFocused:S,isFocusVisible:X}=ht({}),{isHovered:k,hoverProps:m}=jI({isDisabled:o});return{Component:d,children:n,ariaLabel:p,isFocused:S,isFocusVisible:X,getItemProps:(R={})=>({ref:G,role:"button",tabIndex:o?-1:0,"aria-label":p,"aria-current":T(I),"aria-disabled":T(o),"data-disabled":T(o),"data-active":T(I),"data-focus":T(S),"data-hover":T(k),"data-pressed":T(h),"data-focus-visible":T(X),..._(R,b,B,m,Ng(s,{enabled:Z})),className:ne(i,R.className),onClick:W=>{UI(b==null?void 0:b.onClick,a)(W),!y.isNative&&W.currentTarget instanceof HTMLAnchorElement&&W.currentTarget.href&&!W.isDefaultPrevented()&&my(W.currentTarget,W)&&(W.preventDefault(),y.open(W.currentTarget,W))}})}}var Ef=_e((e,g)=>{const{Component:t,children:l,getItemProps:n}=mN({...e,ref:g});return A.jsx(t,{...n(),children:l})});Ef.displayName="NextUI.PaginationItem";var Sa=Ef,rg=(e=>(e.DOTS="dots",e.PREV="prev",e.NEXT="next",e))(rg||{});function bN(e){const{page:g,total:t,siblings:l=1,boundaries:n=1,initialPage:I=1,showControls:o=!1,onChange:C}=e,[a,r]=u.useState(g||I),{direction:i}=Yt(),s=i==="rtl",c=B=>{r(B),C&&C(B)};u.useEffect(()=>{g&&g!==a&&r(g)},[g]);const d=u.useCallback(B=>{B<=0?c(1):B>t?c(t):c(B)},[t,a]),Z=()=>d(s?a-1:a+1),G=()=>d(s?a+1:a-1),y=()=>d(s?t:1),p=()=>d(s?1:t),h=u.useCallback(B=>o?s?["next",...B,"prev"]:["prev",...B,"next"]:B,[s,o]);return{range:u.useMemo(()=>{if(l*2+3+n*2>=t)return h(sl(1,t));const S=Math.max(a-l,n),X=Math.min(a+l,t-n),k=S>n+2,m=X<t-(n+1);if(!k&&m){const v=l*2+n+2;return h([...sl(1,v),"dots",...sl(t-(n-1),t)])}if(k&&!m){const v=n+1+2*l;return h([...sl(1,n),"dots",...sl(t-v,t)])}return h([...sl(1,n),"dots",...sl(S,X),"dots",...sl(t-n+1,t)])},[t,a,l,n,h]),activePage:a,setPage:d,next:Z,previous:G,first:y,last:p}}const P0=e=>typeof e=="object"&&e!=null&&e.nodeType===1,O0=(e,g)=>(!g||e!=="hidden")&&e!=="visible"&&e!=="clip",pc=(e,g)=>{if(e.clientHeight<e.scrollHeight||e.clientWidth<e.scrollWidth){const t=getComputedStyle(e,null);return O0(t.overflowY,g)||O0(t.overflowX,g)||(l=>{const n=(I=>{if(!I.ownerDocument||!I.ownerDocument.defaultView)return null;try{return I.ownerDocument.defaultView.frameElement}catch{return null}})(l);return!!n&&(n.clientHeight<l.scrollHeight||n.clientWidth<l.scrollWidth)})(e)}return!1},Va=(e,g,t,l,n,I,o,C)=>I<e&&o>g||I>e&&o<g?0:I<=e&&C<=t||o>=g&&C>=t?I-e-l:o>g&&C<t||I<e&&C>t?o-g+n:0,ZN=e=>{const g=e.parentElement;return g??(e.getRootNode().host||null)},$0=(e,g)=>{var t,l,n,I;if(typeof document>"u")return[];const{scrollMode:o,block:C,inline:a,boundary:r,skipOverflowHiddenElements:i}=g,s=typeof r=="function"?r:x=>x!==r;if(!P0(e))throw new TypeError("Invalid target");const c=document.scrollingElement||document.documentElement,d=[];let Z=e;for(;P0(Z)&&s(Z);){if(Z=ZN(Z),Z===c){d.push(Z);break}Z!=null&&Z===document.body&&pc(Z)&&!pc(document.documentElement)||Z!=null&&pc(Z,i)&&d.push(Z)}const G=(l=(t=window.visualViewport)==null?void 0:t.width)!=null?l:innerWidth,y=(I=(n=window.visualViewport)==null?void 0:n.height)!=null?I:innerHeight,{scrollX:p,scrollY:h}=window,{height:b,width:B,top:S,right:X,bottom:k,left:m}=e.getBoundingClientRect(),{top:v,right:R,bottom:W,left:J}=(x=>{const Y=window.getComputedStyle(x);return{top:parseFloat(Y.scrollMarginTop)||0,right:parseFloat(Y.scrollMarginRight)||0,bottom:parseFloat(Y.scrollMarginBottom)||0,left:parseFloat(Y.scrollMarginLeft)||0}})(e);let f=C==="start"||C==="nearest"?S-v:C==="end"?k+W:S+b/2-v+W,V=a==="center"?m+B/2-J+R:a==="end"?X+R:m-J;const K=[];for(let x=0;x<d.length;x++){const Y=d[x],{height:N,width:F,top:H,right:E,bottom:z,left:U}=Y.getBoundingClientRect();if(o==="if-needed"&&S>=0&&m>=0&&k<=y&&X<=G&&S>=H&&k<=z&&m>=U&&X<=E)return K;const j=getComputedStyle(Y),ge=parseInt(j.borderLeftWidth,10),$=parseInt(j.borderTopWidth,10),ae=parseInt(j.borderRightWidth,10),Je=parseInt(j.borderBottomWidth,10);let oe=0,Q=0;const re="offsetWidth"in Y?Y.offsetWidth-Y.clientWidth-ge-ae:0,Se="offsetHeight"in Y?Y.offsetHeight-Y.clientHeight-$-Je:0,Ue="offsetWidth"in Y?Y.offsetWidth===0?0:F/Y.offsetWidth:0,ee="offsetHeight"in Y?Y.offsetHeight===0?0:N/Y.offsetHeight:0;if(c===Y)oe=C==="start"?f:C==="end"?f-y:C==="nearest"?Va(h,h+y,y,$,Je,h+f,h+f+b,b):f-y/2,Q=a==="start"?V:a==="center"?V-G/2:a==="end"?V-G:Va(p,p+G,G,ge,ae,p+V,p+V+B,B),oe=Math.max(0,oe+h),Q=Math.max(0,Q+p);else{oe=C==="start"?f-H-$:C==="end"?f-z+Je+Se:C==="nearest"?Va(H,z,N,$,Je+Se,f,f+b,b):f-(H+N/2)+Se/2,Q=a==="start"?V-U-ge:a==="center"?V-(U+F/2)+re/2:a==="end"?V-E+ae+re:Va(U,E,F,ge,ae+re,V,V+B,B);const{scrollLeft:Ye,scrollTop:ie}=Y;oe=ee===0?0:Math.max(0,Math.min(ie+oe/ee,Y.scrollHeight-N/ee+Se)),Q=Ue===0?0:Math.max(0,Math.min(Ye+Q/Ue,Y.scrollWidth-F/Ue+re)),f+=ie-oe,V+=Ye-Q}K.push({el:Y,top:oe,left:Q})}return K},hN=e=>e===!1?{block:"end",inline:"nearest"}:(g=>g===Object(g)&&Object.keys(g).length!==0)(e)?e:{block:"start",inline:"nearest"};function pN(e,g){if(!e.isConnected||!(l=>{let n=l;for(;n&&n.parentNode;){if(n.parentNode===document)return!0;n=n.parentNode instanceof ShadowRoot?n.parentNode.host:n.parentNode}return!1})(e))return;if((l=>typeof l=="object"&&typeof l.behavior=="function")(g))return g.behavior($0(e,g));const t=typeof g=="boolean"||g==null?void 0:g.behavior;for(const{el:l,top:n,left:I}of $0(e,hN(g)))l.scroll({top:n,left:I,behavior:t})}var q0=300;function GN(e){const[g,t]=PI(e,vZ.variantKeys),{as:l,ref:n,classNames:I,dotsJump:o=5,loop:C=!1,showControls:a=!1,total:r=1,initialPage:i=1,page:s,siblings:c,boundaries:d,onChange:Z,className:G,renderItem:y,getItemAriaLabel:p,...h}=g,b=l||"nav",B=Oe(n),S=u.useRef(null),X=u.useRef(),k=u.useRef(),{direction:m}=Yt(),v=m==="rtl";function R(){return X.current||(X.current=new Map),X.current}function W(Q,re){const Se=R();Q?Se.set(re,Q):Se.delete(re)}function J(Q,re){const Ue=R().get(Q);if(!Ue||!S.current)return;k.current&&clearTimeout(k.current),pN(Ue,{scrollMode:"always",behavior:"smooth",block:"start",inline:"start",boundary:B.current});const{offsetLeft:ee}=Ue;if(re){S.current.setAttribute("data-moving","false"),S.current.style.transform=`translateX(${ee}px) scale(1)`;return}S.current.setAttribute("data-moving","true"),S.current.style.transform=`translateX(${ee}px) scale(1.1)`,k.current=setTimeout(()=>{S.current&&(S.current.style.transform=`translateX(${ee}px) scale(1)`),k.current=setTimeout(()=>{var Ye;(Ye=S.current)==null||Ye.setAttribute("data-moving","false"),k.current&&clearTimeout(k.current)},q0)},q0)}const{range:f,activePage:V,setPage:K,previous:x,next:Y,first:N,last:F}=bN({page:s,total:r,initialPage:i,siblings:c,boundaries:d,showControls:a,onChange:Z}),H=u.useRef(V);u.useEffect(()=>{V&&!e.disableAnimation&&J(V,V===H.current),H.current=V},[V,e.disableAnimation,e.disableCursorAnimation,e.dotsJump,e.isCompact,e.showControls]);const E=u.useMemo(()=>vZ({...t,disableCursorAnimation:e.disableCursorAnimation||e.disableAnimation}),[...Object.values(t)]),z=ne(I==null?void 0:I.base,G),U=()=>C&&V===(v?1:r)?N():Y(),j=()=>C&&V===(v?r:1)?F():x(),ge=(Q={})=>({...Q,ref:B,role:"navigation","aria-label":Q["aria-label"]||"pagination navigation","data-slot":"base","data-controls":T(a),"data-loop":T(C),"data-dots-jump":o,"data-total":r,"data-active-page":V,className:E.base({class:ne(z,Q==null?void 0:Q.className)}),...h}),$=(Q={})=>({...Q,"data-slot":"wrapper",className:E.wrapper({class:ne(I==null?void 0:I.wrapper,Q==null?void 0:Q.className)})}),ae=Q=>{if(Q){if(p)return p(Q);switch(Q){case rg.DOTS:return"dots element";case rg.PREV:return"previous page button";case rg.NEXT:return"next page button";case"first":return"first page button";case"last":return"last page button";default:return`pagination item ${Q}`}}},Je=(Q={})=>({...Q,ref:re=>W(re,Q.value),"data-slot":"item",isActive:Q.value===V,className:E.item({class:ne(I==null?void 0:I.item,Q==null?void 0:Q.className)}),onPress:()=>{Q.value!==V&&K(Q.value)}}),oe=(Q={})=>({...Q,ref:S,activePage:V,"data-slot":"cursor",className:E.cursor({class:ne(I==null?void 0:I.cursor,Q==null?void 0:Q.className)})});return{Component:b,showControls:a,dotsJump:o,slots:E,classNames:I,loop:C,total:r,range:f,activePage:V,getItemRef:W,disableCursorAnimation:e.disableCursorAnimation,disableAnimation:e.disableAnimation,setPage:K,onPrevious:j,onNext:U,renderItem:y,getBaseProps:ge,getWrapperProps:$,getItemProps:Je,getCursorProps:oe,getItemAriaLabel:ae}}var Df=_e((e,g)=>{const{Component:t,dotsJump:l,slots:n,classNames:I,total:o,range:C,loop:a,activePage:r,disableCursorAnimation:i,disableAnimation:s,renderItem:c,onNext:d,onPrevious:Z,setPage:G,getItemAriaLabel:y,getItemRef:p,getBaseProps:h,getWrapperProps:b,getItemProps:B,getCursorProps:S}=GN({...e,ref:g}),{direction:X}=Yt(),k=X==="rtl",m=u.useCallback((v,R)=>{const W=R<C.indexOf(r);if(c&&typeof c=="function"){let J=typeof v=="number"?v:R;v===rg.NEXT&&(J=r+1),v===rg.PREV&&(J=r-1),v===rg.DOTS&&(J=W?r-l>=1?r-l:1:r+l<=o?r+l:o);const f={[rg.PREV]:A.jsx(pa,{}),[rg.NEXT]:A.jsx(pa,{className:n.chevronNext({class:I==null?void 0:I.chevronNext})}),[rg.DOTS]:A.jsxs(A.Fragment,{children:[A.jsx(EZ,{className:n==null?void 0:n.ellipsis({class:I==null?void 0:I.ellipsis})}),A.jsx(xZ,{className:n==null?void 0:n.forwardIcon({class:I==null?void 0:I.forwardIcon}),"data-before":T(W)})]})};return c({value:v,index:R,key:`${v}-${R}`,page:J,total:o,children:typeof v=="number"?v:f[v],activePage:r,dotsJump:l,isBefore:W,isActive:v===r,isPrevious:v===r-1,isNext:v===r+1,isFirst:v===1,isLast:v===o,onNext:d,onPrevious:Z,setPage:G,onPress:()=>G(J),ref:typeof v=="number"?V=>p(V,v):void 0,className:n.item({class:I==null?void 0:I.item}),getAriaLabel:y})}return v===rg.PREV?A.jsx(Sa,{className:n.prev({class:I==null?void 0:I.prev}),"data-slot":"prev",getAriaLabel:y,isDisabled:!a&&r===(k?o:1),value:v,onPress:Z,children:A.jsx(pa,{})},rg.PREV):v===rg.NEXT?A.jsx(Sa,{className:n.next({class:ne(I==null?void 0:I.next)}),"data-slot":"next",getAriaLabel:y,isDisabled:!a&&r===(k?1:o),value:v,onPress:d,children:A.jsx(pa,{className:n.chevronNext({class:I==null?void 0:I.chevronNext})})},rg.NEXT):v===rg.DOTS?A.jsxs(Sa,{className:n.item({class:ne(I==null?void 0:I.item,"group")}),"data-slot":"item",getAriaLabel:y,value:v,onPress:()=>G(W?r-l>=1?r-l:1:r+l<=o?r+l:o),children:[A.jsx(EZ,{className:n==null?void 0:n.ellipsis({class:I==null?void 0:I.ellipsis})}),A.jsx(xZ,{className:n==null?void 0:n.forwardIcon({class:I==null?void 0:I.forwardIcon}),"data-before":T(k?!W:W)})]},rg.DOTS+W):u.createElement(Sa,{...B({value:v}),key:v,getAriaLabel:y},v)},[k,r,l,B,a,C,c,n,I,o]);return A.jsx(t,{...h(),children:A.jsxs("ul",{...b(),children:[!i&&!s&&A.jsx(AN,{...S()}),C.map(m)]})})});Df.displayName="NextUI.Pagination";var Yi=Df;function yN(e){let[g,t]=VC(e.isOpen,e.defaultOpen||!1,e.onOpenChange);const l=u.useCallback(()=>{t(!0)},[t]),n=u.useCallback(()=>{t(!1)},[t]),I=u.useCallback(()=>{t(!g)},[t,g]);return{isOpen:g,setOpen:t,open:l,close:n,toggle:I}}function BN(e,g){let{inputElementType:t="input",isDisabled:l=!1,isRequired:n=!1,isReadOnly:I=!1,type:o="text",validationBehavior:C="aria"}=e,[a,r]=VC(e.value,e.defaultValue||"",e.onChange),{focusableProps:i}=Bi(e,g),s=om({...e,value:a}),{isInvalid:c,validationErrors:d,validationDetails:Z}=s.displayValidation,{labelProps:G,fieldProps:y,descriptionProps:p,errorMessageProps:h}=CN({...e,isInvalid:c,errorMessage:e.errorMessage||d}),b=Zi(e,{labelable:!0});const B={type:o,pattern:e.pattern};return Gy(g,a,r),Jf(e,s,g),u.useEffect(()=>{if(g.current instanceof $g(g.current).HTMLTextAreaElement){let S=g.current;Object.defineProperty(S,"defaultValue",{get:()=>S.value,set:()=>{},configurable:!0})}},[g]),{labelProps:G,inputProps:_(b,t==="input"&&B,{disabled:l,readOnly:I,required:n&&C==="native","aria-required":n&&C==="aria"||void 0,"aria-invalid":c||void 0,"aria-errormessage":e["aria-errormessage"],"aria-activedescendant":e["aria-activedescendant"],"aria-autocomplete":e["aria-autocomplete"],"aria-haspopup":e["aria-haspopup"],value:a,onChange:S=>r(S.target.value),autoComplete:e.autoComplete,autoCapitalize:e.autoCapitalize,maxLength:e.maxLength,minLength:e.minLength,name:e.name,placeholder:e.placeholder,inputMode:e.inputMode,onCopy:e.onCopy,onCut:e.onCut,onPaste:e.onPaste,onCompositionEnd:e.onCompositionEnd,onCompositionStart:e.onCompositionStart,onCompositionUpdate:e.onCompositionUpdate,onSelect:e.onSelect,onBeforeInput:e.onBeforeInput,onInput:e.onInput,...i,...y}),descriptionProps:p,errorMessageProps:h,isInvalid:c,validationErrors:d,validationDetails:Z}}function fN(e){const[g,t]=PI(e,RZ.variantKeys),{ref:l,as:n,type:I,label:o,baseRef:C,wrapperRef:a,description:r,errorMessage:i,className:s,classNames:c,autoFocus:d,startContent:Z,endContent:G,onClear:y,onChange:p,validationState:h,innerWrapperRef:b,onValueChange:B=()=>{},...S}=g,X=u.useCallback(q=>{B(q??"")},[B]),[k,m]=VC(g.value,g.defaultValue,X),[v,R]=u.useState(!1),W=n||"div",J=["date","time","month","week","range"].includes(I),f=!ew(k)||J,V=f||v,K=ne(c==null?void 0:c.base,s,f?"is-filled":""),x=e.isMultiline,Y=Oe(l),N=Oe(C),F=Oe(a),H=Oe(b),E=u.useCallback(()=>{var q;m(""),y==null||y(),(q=Y.current)==null||q.focus()},[m,y]),{labelProps:z,inputProps:U,descriptionProps:j,errorMessageProps:ge}=BN({...e,value:k,"aria-label":Oy(e==null?void 0:e["aria-label"],e==null?void 0:e.label,e==null?void 0:e.placeholder),inputElementType:x?"textarea":"input",onChange:m},Y),{isFocusVisible:$,isFocused:ae,focusProps:Je}=ht({autoFocus:d,isTextInput:!0}),{isHovered:oe,hoverProps:Q}=jI({isDisabled:!!(e!=null&&e.isDisabled)}),{focusProps:re,isFocusVisible:Se}=ht(),{focusWithinProps:Ue}=yi({onFocusWithinChange:R}),{pressProps:ee}=KI({isDisabled:!!(e!=null&&e.isDisabled),onPress:E}),Ye=h==="invalid"||e.isInvalid,ie=u.useMemo(()=>{var q;return(!e.labelPlacement||e.labelPlacement==="inside")&&!o?"outside":(q=e.labelPlacement)!=null?q:"inside"},[e.labelPlacement,o]),pg=!!y||e.isClearable,og=!!o||!!r||!!i,Ne=!!g.placeholder,xn=!!o,ql=!!r||!!i,En=ie==="outside"||ie==="outside-left",Dn=ie==="inside",al=Y.current?(!Y.current.value||Y.current.value===""||!k||k==="")&&Ne:!1,nt=ie==="outside-left",It=!!Z,as=En?ie==="outside-left"||Ne||ie==="outside"&&It:!1,rs=ie==="outside"&&!Ne&&!It,Ge=u.useMemo(()=>RZ({...t,isInvalid:Ye,labelPlacement:ie,isClearable:pg}),[...Object.values(t),Ye,ie,pg,It]),xC=u.useCallback((q={})=>({ref:N,className:Ge.base({class:K}),"data-slot":"base","data-filled":T(f||Ne||It||al),"data-filled-within":T(V||Ne||It||al),"data-focus-within":T(v),"data-focus-visible":T($),"data-readonly":T(e.isReadOnly),"data-focus":T(ae),"data-hover":T(oe),"data-required":T(e.isRequired),"data-invalid":T(Ye),"data-disabled":T(e.isDisabled),"data-has-elements":T(og),"data-has-helper":T(ql),"data-has-label":T(xn),"data-has-value":T(!al),...Ue,...q}),[Ge,K,f,ae,oe,Ye,ql,xn,og,al,It,v,$,V,Ne,Ue,e.isReadOnly,e.isRequired,e.isDisabled]),EC=u.useCallback((q={})=>({"data-slot":"label",className:Ge.label({class:c==null?void 0:c.label}),...z,...q}),[Ge,z,c==null?void 0:c.label]),is=u.useCallback((q={})=>({ref:Y,"data-slot":"input","data-filled":T(f),"data-filled-within":T(V),"data-has-start-content":T(It),"data-has-end-content":T(!!G),className:Ge.input({class:ne(c==null?void 0:c.input,f?"is-filled":"")}),..._(Je,U,Ng(S,{enabled:!0,labelable:!0,omitEventNames:new Set(Object.keys(U))}),q),required:e.isRequired,"aria-readonly":T(e.isReadOnly),"aria-required":T(e.isRequired),onChange:UI(U.onChange,p)}),[Ge,k,Je,U,S,f,V,It,G,c==null?void 0:c.input,e.isReadOnly,e.isRequired,p]),Mn=u.useCallback((q={})=>({ref:F,"data-slot":"input-wrapper","data-hover":T(oe),"data-focus-visible":T($),"data-focus":T(ae),className:Ge.inputWrapper({class:ne(c==null?void 0:c.inputWrapper,f?"is-filled":"")}),..._(q,Q),onClick:_l=>{Y.current&&_l.currentTarget===_l.target&&Y.current.focus()},style:{cursor:"text",...q.style}}),[Ge,oe,$,ae,k,c==null?void 0:c.inputWrapper]),DC=u.useCallback((q={})=>({...q,ref:H,"data-slot":"inner-wrapper",onClick:_l=>{Y.current&&_l.currentTarget===_l.target&&Y.current.focus()},className:Ge.innerWrapper({class:ne(c==null?void 0:c.innerWrapper,q==null?void 0:q.className)})}),[Ge,c==null?void 0:c.innerWrapper]),ss=u.useCallback((q={})=>({...q,"data-slot":"main-wrapper",className:Ge.mainWrapper({class:ne(c==null?void 0:c.mainWrapper,q==null?void 0:q.className)})}),[Ge,c==null?void 0:c.mainWrapper]),MC=u.useCallback((q={})=>({...q,"data-slot":"helper-wrapper",className:Ge.helperWrapper({class:ne(c==null?void 0:c.helperWrapper,q==null?void 0:q.className)})}),[Ge,c==null?void 0:c.helperWrapper]),zC=u.useCallback((q={})=>({...q,...j,"data-slot":"description",className:Ge.description({class:ne(c==null?void 0:c.description,q==null?void 0:q.className)})}),[Ge,c==null?void 0:c.description]),_I=u.useCallback((q={})=>({...q,...ge,"data-slot":"error-message",className:Ge.errorMessage({class:ne(c==null?void 0:c.errorMessage,q==null?void 0:q.className)})}),[Ge,ge,c==null?void 0:c.errorMessage]),cs=u.useCallback((q={})=>({...q,role:"button",tabIndex:0,"data-slot":"clear-button","data-focus-visible":T(Se),className:Ge.clearButton({class:ne(c==null?void 0:c.clearButton,q==null?void 0:q.className)}),..._(ee,re)}),[Ge,Se,ee,re,c==null?void 0:c.clearButton]);return{Component:W,classNames:c,domRef:Y,label:o,description:r,startContent:Z,endContent:G,labelPlacement:ie,isClearable:pg,isInvalid:Ye,hasHelper:ql,hasStartContent:It,isLabelOutside:as,isOutsideLeft:nt,isLabelOutsideAsPlaceholder:rs,shouldLabelBeOutside:En,shouldLabelBeInside:Dn,hasPlaceholder:Ne,errorMessage:i,getBaseProps:xC,getLabelProps:EC,getInputProps:is,getMainWrapperProps:ss,getInputWrapperProps:Mn,getInnerWrapperProps:DC,getHelperWrapperProps:MC,getDescriptionProps:zC,getErrorMessageProps:_I,getClearButtonProps:cs}}var Mf=_e((e,g)=>{const{Component:t,label:l,description:n,isClearable:I,startContent:o,endContent:C,labelPlacement:a,hasHelper:r,isOutsideLeft:i,shouldLabelBeOutside:s,errorMessage:c,getBaseProps:d,getLabelProps:Z,getInputProps:G,getInnerWrapperProps:y,getInputWrapperProps:p,getMainWrapperProps:h,getHelperWrapperProps:b,getDescriptionProps:B,getErrorMessageProps:S,getClearButtonProps:X}=fN({...e,ref:g}),k=l?A.jsx("label",{...Z(),children:l}):null,m=u.useMemo(()=>I?A.jsx("span",{...X(),children:C||A.jsx(yw,{})}):C,[I,X]),v=u.useMemo(()=>r?A.jsx("div",{...b(),children:c?A.jsx("div",{...S(),children:c}):n?A.jsx("div",{...B(),children:n}):null}):null,[r,c,n,b,S,B]),R=u.useMemo(()=>o||m?A.jsxs("div",{...y(),children:[o,A.jsx("input",{...G()}),m]}):A.jsx("div",{...y(),children:A.jsx("input",{...G()})}),[o,m,G,y]),W=u.useMemo(()=>s?A.jsxs("div",{...h(),children:[A.jsxs("div",{...p(),children:[i?null:k,R]}),v]}):A.jsxs(A.Fragment,{children:[A.jsxs("div",{...p(),children:[k,R]}),v]}),[a,v,s,k,R,c,n,h,p,S,B]);return A.jsxs(t,{...d(),children:[i?k:null,W]})});Mf.displayName="NextUI.Input";var Wa=Mf;function Iu(){return Iu=Object.assign?Object.assign.bind():function(e){for(var g=1;g<arguments.length;g++){var t=arguments[g];for(var l in t)Object.prototype.hasOwnProperty.call(t,l)&&(e[l]=t[l])}return e},Iu.apply(this,arguments)}function SN(e,g){if(e==null)return{};var t={},l=Object.keys(e),n,I;for(I=0;I<l.length;I++)n=l[I],!(g.indexOf(n)>=0)&&(t[n]=e[n]);return t}var[VN,aE]=HA({name:"ModalContext",errorMessage:"useModalContext: `context` is undefined. Seems you forgot to wrap all popover components within `<Modal />`"});function WN(e={},g,t){let{overlayProps:l,underlayProps:n}=$J({...e,isOpen:g.isOpen,onClose:g.close},t);return nY(),u.useEffect(()=>{if(g.isOpen&&t.current)return tY([t.current])},[g.isOpen,t]),{modalProps:_(l),underlayProps:n}}function vN(e){var g;const[t,l]=PI(e,XZ.variantKeys),{ref:n,as:I,className:o,classNames:C,disableAnimation:a=!1,isOpen:r,defaultOpen:i,onOpenChange:s,motionProps:c,closeButton:d,isDismissable:Z=!0,hideCloseButton:G=!1,shouldBlockScroll:y=!0,portalContainer:p,isKeyboardDismissDisabled:h=!1,onClose:b,...B}=t,S=I||"section",X=Oe(n),k=u.useRef(null),[m,v]=u.useState(!1),[R,W]=u.useState(!1),J=u.useId(),f=u.useId(),V=u.useId(),K=yN({isOpen:r,defaultOpen:i,onOpenChange:$=>{s==null||s($),$||b==null||b()}}),{modalProps:x,underlayProps:Y}=WN({isDismissable:Z,isKeyboardDismissDisabled:h},K,X),{buttonProps:N}=Wf({onPress:K.close},k),{isFocusVisible:F,focusProps:H}=ht(),E=ne(C==null?void 0:C.base,o),z=u.useMemo(()=>XZ({...l}),[...Object.values(l)]),U=($={},ae=null)=>({ref:Dk(ae,X),..._(x,B,$),className:z.base({class:ne(E,$.className)}),id:J,"data-open":T(K.isOpen),"data-dismissable":T(Z),"aria-modal":T(!0),"aria-labelledby":m?f:void 0,"aria-describedby":R?V:void 0}),j=u.useCallback(($={})=>({className:z.backdrop({class:C==null?void 0:C.backdrop}),onClick:()=>K.close(),...Y,...$}),[z,C,Y]),ge=()=>({role:"button",tabIndex:0,"aria-label":"Close","data-focus-visible":T(F),className:z.closeButton({class:C==null?void 0:C.closeButton}),..._(N,H)});return{Component:S,slots:z,domRef:X,headerId:f,bodyId:V,motionProps:c,classNames:C,isDismissable:Z,closeButton:d,hideCloseButton:G,portalContainer:p,shouldBlockScroll:y,backdrop:(g=e.backdrop)!=null?g:"opaque",isOpen:K.isOpen,onClose:K.close,disableAnimation:a,setBodyMounted:W,setHeaderMounted:v,getDialogProps:U,getBackdropProps:j,getCloseButtonProps:ge}}var zf=_e((e,g)=>{const{children:t,...l}=e,n=vN({...l,ref:g}),I=A.jsx(lY,{portalContainer:n.portalContainer,children:t});return A.jsx(VN,{value:n,children:n.disableAnimation&&n.isOpen?I:A.jsx(Vf,{children:n.isOpen?I:null})})});zf.displayName="NextUI.Modal";var va=zf,Tf={};Tf={ascending:"تصاعدي",ascendingSort:e=>`ترتيب حسب العمود ${e.columnName} بترتيب تصاعدي`,columnSize:e=>`${e.value} بالبكسل`,descending:"تنازلي",descendingSort:e=>`ترتيب حسب العمود ${e.columnName} بترتيب تنازلي`,resizerDescription:"اضغط على مفتاح Enter لبدء تغيير الحجم",select:"تحديد",selectAll:"تحديد الكل",sortable:"عمود قابل للترتيب"};var Lf={};Lf={ascending:"възходящ",ascendingSort:e=>`сортирано по колона ${e.columnName} във възходящ ред`,columnSize:e=>`${e.value} пиксела`,descending:"низходящ",descendingSort:e=>`сортирано по колона ${e.columnName} в низходящ ред`,resizerDescription:"Натиснете „Enter“, за да започнете да преоразмерявате",select:"Изберете",selectAll:"Изберете всичко",sortable:"сортираща колона"};var Uf={};Uf={ascending:"vzestupně",ascendingSort:e=>`řazeno vzestupně podle sloupce ${e.columnName}`,columnSize:e=>`${e.value} pixelů`,descending:"sestupně",descendingSort:e=>`řazeno sestupně podle sloupce ${e.columnName}`,resizerDescription:"Stisknutím klávesy Enter začnete měnit velikost",select:"Vybrat",selectAll:"Vybrat vše",sortable:"sloupec s možností řazení"};var Qf={};Qf={ascending:"stigende",ascendingSort:e=>`sorteret efter kolonne ${e.columnName} i stigende rækkefølge`,columnSize:e=>`${e.value} pixels`,descending:"faldende",descendingSort:e=>`sorteret efter kolonne ${e.columnName} i faldende rækkefølge`,resizerDescription:"Tryk på Enter for at ændre størrelse",select:"Vælg",selectAll:"Vælg alle",sortable:"sorterbar kolonne"};var jf={};jf={ascending:"aufsteigend",ascendingSort:e=>`sortiert nach Spalte ${e.columnName} in aufsteigender Reihenfolge`,columnSize:e=>`${e.value} Pixel`,descending:"absteigend",descendingSort:e=>`sortiert nach Spalte ${e.columnName} in absteigender Reihenfolge`,resizerDescription:"Eingabetaste zum Starten der Größenänderung drücken",select:"Auswählen",selectAll:"Alles auswählen",sortable:"sortierbare Spalte"};var Pf={};Pf={ascending:"αύξουσα",ascendingSort:e=>`διαλογή ανά στήλη ${e.columnName} σε αύξουσα σειρά`,columnSize:e=>`${e.value} pixel`,descending:"φθίνουσα",descendingSort:e=>`διαλογή ανά στήλη ${e.columnName} σε φθίνουσα σειρά`,resizerDescription:"Πατήστε Enter για έναρξη της αλλαγής μεγέθους",select:"Επιλογή",selectAll:"Επιλογή όλων",sortable:"Στήλη διαλογής"};var Of={};Of={select:"Select",selectAll:"Select All",sortable:"sortable column",ascending:"ascending",descending:"descending",ascendingSort:e=>`sorted by column ${e.columnName} in ascending order`,descendingSort:e=>`sorted by column ${e.columnName} in descending order`,columnSize:e=>`${e.value} pixels`,resizerDescription:"Press Enter to start resizing"};var $f={};$f={ascending:"de subida",ascendingSort:e=>`ordenado por columna ${e.columnName} en orden de subida`,columnSize:e=>`${e.value} píxeles`,descending:"de bajada",descendingSort:e=>`ordenado por columna ${e.columnName} en orden de bajada`,resizerDescription:"Pulse Intro para empezar a redimensionar",select:"Seleccionar",selectAll:"Seleccionar todos",sortable:"columna ordenable"};var qf={};qf={ascending:"tõusev järjestus",ascendingSort:e=>`sorditud veeru järgi ${e.columnName} tõusvas järjestuses`,columnSize:e=>`${e.value} pikslit`,descending:"laskuv järjestus",descendingSort:e=>`sorditud veeru järgi ${e.columnName} laskuvas järjestuses`,resizerDescription:"Suuruse muutmise alustamiseks vajutage klahvi Enter",select:"Vali",selectAll:"Vali kõik",sortable:"sorditav veerg"};var _f={};_f={ascending:"nouseva",ascendingSort:e=>`lajiteltu sarakkeen ${e.columnName} mukaan nousevassa järjestyksessä`,columnSize:e=>`${e.value} pikseliä`,descending:"laskeva",descendingSort:e=>`lajiteltu sarakkeen ${e.columnName} mukaan laskevassa järjestyksessä`,resizerDescription:"Aloita koon muutos painamalla Enter-näppäintä",select:"Valitse",selectAll:"Valitse kaikki",sortable:"lajiteltava sarake"};var eS={};eS={ascending:"croissant",ascendingSort:e=>`trié en fonction de la colonne ${e.columnName} par ordre croissant`,columnSize:e=>`${e.value} pixels`,descending:"décroissant",descendingSort:e=>`trié en fonction de la colonne ${e.columnName} par ordre décroissant`,resizerDescription:"Appuyez sur Entrée pour commencer le redimensionnement.",select:"Sélectionner",selectAll:"Sélectionner tout",sortable:"colonne triable"};var gS={};gS={ascending:"עולה",ascendingSort:e=>`מוין לפי עמודה ${e.columnName} בסדר עולה`,columnSize:e=>`${e.value} פיקסלים`,descending:"יורד",descendingSort:e=>`מוין לפי עמודה ${e.columnName} בסדר יורד`,resizerDescription:"הקש Enter כדי לשנות את הגודל",select:"בחר",selectAll:"בחר הכול",sortable:"עמודה שניתן למיין"};var tS={};tS={ascending:"rastući",ascendingSort:e=>`razvrstano po stupcima ${e.columnName} rastućem redoslijedom`,columnSize:e=>`${e.value} piksela`,descending:"padajući",descendingSort:e=>`razvrstano po stupcima ${e.columnName} padajućim redoslijedom`,resizerDescription:"Pritisnite Enter da biste započeli promenu veličine",select:"Odaberite",selectAll:"Odaberite sve",sortable:"stupac koji se može razvrstati"};var lS={};lS={ascending:"növekvő",ascendingSort:e=>`rendezve a(z) ${e.columnName} oszlop szerint, növekvő sorrendben`,columnSize:e=>`${e.value} képpont`,descending:"csökkenő",descendingSort:e=>`rendezve a(z) ${e.columnName} oszlop szerint, csökkenő sorrendben`,resizerDescription:"Nyomja le az Enter billentyűt az átméretezés megkezdéséhez",select:"Kijelölés",selectAll:"Összes kijelölése",sortable:"rendezendő oszlop"};var nS={};nS={ascending:"crescente",ascendingSort:e=>`in ordine crescente in base alla colonna ${e.columnName}`,columnSize:e=>`${e.value} pixel`,descending:"decrescente",descendingSort:e=>`in ordine decrescente in base alla colonna ${e.columnName}`,resizerDescription:"Premi Invio per iniziare a ridimensionare",select:"Seleziona",selectAll:"Seleziona tutto",sortable:"colonna ordinabile"};var IS={};IS={ascending:"昇順",ascendingSort:e=>`列 ${e.columnName} を昇順で並べ替え`,columnSize:e=>`${e.value} ピクセル`,descending:"降順",descendingSort:e=>`列 ${e.columnName} を降順で並べ替え`,resizerDescription:"Enter キーを押してサイズ変更を開始",select:"選択",selectAll:"すべて選択",sortable:"並べ替え可能な列"};var oS={};oS={ascending:"오름차순",ascendingSort:e=>`${e.columnName} 열을 기준으로 오름차순으로 정렬됨`,columnSize:e=>`${e.value} 픽셀`,descending:"내림차순",descendingSort:e=>`${e.columnName} 열을 기준으로 내림차순으로 정렬됨`,resizerDescription:"크기 조정을 시작하려면 Enter를 누르세요.",select:"선택",selectAll:"모두 선택",sortable:"정렬 가능한 열"};var CS={};CS={ascending:"didėjančia tvarka",ascendingSort:e=>`surikiuota pagal stulpelį ${e.columnName} didėjančia tvarka`,columnSize:e=>`${e.value} piks.`,descending:"mažėjančia tvarka",descendingSort:e=>`surikiuota pagal stulpelį ${e.columnName} mažėjančia tvarka`,resizerDescription:"Paspauskite „Enter“, kad pradėtumėte keisti dydį",select:"Pasirinkti",selectAll:"Pasirinkti viską",sortable:"rikiuojamas stulpelis"};var aS={};aS={ascending:"augošā secībā",ascendingSort:e=>`kārtots pēc kolonnas ${e.columnName} augošā secībā`,columnSize:e=>`${e.value} pikseļi`,descending:"dilstošā secībā",descendingSort:e=>`kārtots pēc kolonnas ${e.columnName} dilstošā secībā`,resizerDescription:"Nospiediet Enter, lai sāktu izmēru mainīšanu",select:"Atlasīt",selectAll:"Atlasīt visu",sortable:"kārtojamā kolonna"};var rS={};rS={ascending:"stigende",ascendingSort:e=>`sortert etter kolonne ${e.columnName} i stigende rekkefølge`,columnSize:e=>`${e.value} piksler`,descending:"synkende",descendingSort:e=>`sortert etter kolonne ${e.columnName} i synkende rekkefølge`,resizerDescription:"Trykk på Enter for å starte størrelsesendring",select:"Velg",selectAll:"Velg alle",sortable:"kolonne som kan sorteres"};var iS={};iS={ascending:"oplopend",ascendingSort:e=>`gesorteerd in oplopende volgorde in kolom ${e.columnName}`,columnSize:e=>`${e.value} pixels`,descending:"aflopend",descendingSort:e=>`gesorteerd in aflopende volgorde in kolom ${e.columnName}`,resizerDescription:"Druk op Enter om het formaat te wijzigen",select:"Selecteren",selectAll:"Alles selecteren",sortable:"sorteerbare kolom"};var sS={};sS={ascending:"rosnąco",ascendingSort:e=>`posortowano według kolumny ${e.columnName} w porządku rosnącym`,columnSize:e=>`Liczba pikseli: ${e.value}`,descending:"malejąco",descendingSort:e=>`posortowano według kolumny ${e.columnName} w porządku malejącym`,resizerDescription:"Naciśnij Enter, aby rozpocząć zmienianie rozmiaru",select:"Zaznacz",selectAll:"Zaznacz wszystko",sortable:"kolumna z możliwością sortowania"};var cS={};cS={ascending:"crescente",ascendingSort:e=>`classificado pela coluna ${e.columnName} em ordem crescente`,columnSize:e=>`${e.value} pixels`,descending:"decrescente",descendingSort:e=>`classificado pela coluna ${e.columnName} em ordem decrescente`,resizerDescription:"Pressione Enter para começar a redimensionar",select:"Selecionar",selectAll:"Selecionar tudo",sortable:"coluna classificável"};var dS={};dS={ascending:"ascendente",ascendingSort:e=>`Ordenar por coluna ${e.columnName} em ordem ascendente`,columnSize:e=>`${e.value} pixels`,descending:"descendente",descendingSort:e=>`Ordenar por coluna ${e.columnName} em ordem descendente`,resizerDescription:"Prima Enter para iniciar o redimensionamento",select:"Selecionar",selectAll:"Selecionar tudo",sortable:"Coluna ordenável"};var uS={};uS={ascending:"crescătoare",ascendingSort:e=>`sortate după coloana ${e.columnName} în ordine crescătoare`,columnSize:e=>`${e.value} pixeli`,descending:"descrescătoare",descendingSort:e=>`sortate după coloana ${e.columnName} în ordine descrescătoare`,resizerDescription:"Apăsați pe Enter pentru a începe redimensionarea",select:"Selectare",selectAll:"Selectare totală",sortable:"coloană sortabilă"};var AS={};AS={ascending:"возрастание",ascendingSort:e=>`сортировать столбец ${e.columnName} в порядке возрастания`,columnSize:e=>`${e.value} пикс.`,descending:"убывание",descendingSort:e=>`сортировать столбец ${e.columnName} в порядке убывания`,resizerDescription:"Нажмите клавишу Enter для начала изменения размеров",select:"Выбрать",selectAll:"Выбрать все",sortable:"сортируемый столбец"};var mS={};mS={ascending:"vzostupne",ascendingSort:e=>`zoradené zostupne podľa stĺpca ${e.columnName}`,columnSize:e=>`Počet pixelov: ${e.value}`,descending:"zostupne",descendingSort:e=>`zoradené zostupne podľa stĺpca ${e.columnName}`,resizerDescription:"Stlačením klávesu Enter začnete zmenu veľkosti",select:"Vybrať",selectAll:"Vybrať všetko",sortable:"zoraditeľný stĺpec"};var bS={};bS={ascending:"naraščajoče",ascendingSort:e=>`razvrščeno po stolpcu ${e.columnName} v naraščajočem vrstnem redu`,columnSize:e=>`${e.value} slikovnih pik`,descending:"padajoče",descendingSort:e=>`razvrščeno po stolpcu ${e.columnName} v padajočem vrstnem redu`,resizerDescription:"Pritisnite tipko Enter da začnete spreminjati velikost",select:"Izberite",selectAll:"Izberite vse",sortable:"razvrstljivi stolpec"};var ZS={};ZS={ascending:"rastući",ascendingSort:e=>`sortirano po kolonama ${e.columnName} rastućim redosledom`,columnSize:e=>`${e.value} piksela`,descending:"padajući",descendingSort:e=>`sortirano po kolonama ${e.columnName} padajućim redosledom`,resizerDescription:"Pritisnite Enter da biste započeli promenu veličine",select:"Izaberite",selectAll:"Izaberite sve",sortable:"kolona koja se može sortirati"};var hS={};hS={ascending:"stigande",ascendingSort:e=>`sorterat på kolumn ${e.columnName} i stigande ordning`,columnSize:e=>`${e.value} pixlar`,descending:"fallande",descendingSort:e=>`sorterat på kolumn ${e.columnName} i fallande ordning`,resizerDescription:"Tryck på Retur för att börja ändra storlek",select:"Markera",selectAll:"Markera allt",sortable:"sorterbar kolumn"};var pS={};pS={ascending:"artan sırada",ascendingSort:e=>`${e.columnName} sütuna göre artan düzende sırala`,columnSize:e=>`${e.value} piksel`,descending:"azalan sırada",descendingSort:e=>`${e.columnName} sütuna göre azalan düzende sırala`,resizerDescription:"Yeniden boyutlandırmak için Enter'a basın",select:"Seç",selectAll:"Tümünü Seç",sortable:"Sıralanabilir sütun"};var GS={};GS={ascending:"висхідний",ascendingSort:e=>`відсортовано за стовпцем ${e.columnName} у висхідному порядку`,columnSize:e=>`${e.value} пікс.`,descending:"низхідний",descendingSort:e=>`відсортовано за стовпцем ${e.columnName} у низхідному порядку`,resizerDescription:"Натисніть Enter, щоб почати зміну розміру",select:"Вибрати",selectAll:"Вибрати все",sortable:"сортувальний стовпець"};var yS={};yS={ascending:"升序",ascendingSort:e=>`按列 ${e.columnName} 升序排序`,columnSize:e=>`${e.value} 像素`,descending:"降序",descendingSort:e=>`按列 ${e.columnName} 降序排序`,resizerDescription:"按“输入”键开始调整大小。",select:"选择",selectAll:"全选",sortable:"可排序的列"};var BS={};BS={ascending:"遞增",ascendingSort:e=>`已依據「${e.columnName}」欄遞增排序`,columnSize:e=>`${e.value} 像素`,descending:"遞減",descendingSort:e=>`已依據「${e.columnName}」欄遞減排序`,resizerDescription:"按 Enter 鍵以開始調整大小",select:"選取",selectAll:"全選",sortable:"可排序的欄"};var fS={};fS={deselectedItem:e=>`${e.item} غير المحدد`,longPressToSelect:"اضغط مطولًا للدخول إلى وضع التحديد.",select:"تحديد",selectedAll:"جميع العناصر المحددة.",selectedCount:(e,g)=>`${g.plural(e.count,{"=0":"لم يتم تحديد عناصر",one:()=>`${g.number(e.count)} عنصر محدد`,other:()=>`${g.number(e.count)} عنصر محدد`})}.`,selectedItem:e=>`${e.item} المحدد`};var SS={};SS={deselectedItem:e=>`${e.item} не е избран.`,longPressToSelect:"Натиснете и задръжте за да влезете в избирателен режим.",select:"Изберете",selectedAll:"Всички елементи са избрани.",selectedCount:(e,g)=>`${g.plural(e.count,{"=0":"Няма избрани елементи",one:()=>`${g.number(e.count)} избран елемент`,other:()=>`${g.number(e.count)} избрани елементи`})}.`,selectedItem:e=>`${e.item} избран.`};var VS={};VS={deselectedItem:e=>`Položka ${e.item} není vybrána.`,longPressToSelect:"Dlouhým stisknutím přejdete do režimu výběru.",select:"Vybrat",selectedAll:"Vybrány všechny položky.",selectedCount:(e,g)=>`${g.plural(e.count,{"=0":"Nevybrány žádné položky",one:()=>`Vybrána ${g.number(e.count)} položka`,other:()=>`Vybráno ${g.number(e.count)} položek`})}.`,selectedItem:e=>`Vybrána položka ${e.item}.`};var WS={};WS={deselectedItem:e=>`${e.item} ikke valgt.`,longPressToSelect:"Lav et langt tryk for at aktivere valgtilstand.",select:"Vælg",selectedAll:"Alle elementer valgt.",selectedCount:(e,g)=>`${g.plural(e.count,{"=0":"Ingen elementer valgt",one:()=>`${g.number(e.count)} element valgt`,other:()=>`${g.number(e.count)} elementer valgt`})}.`,selectedItem:e=>`${e.item} valgt.`};var vS={};vS={deselectedItem:e=>`${e.item} nicht ausgewählt.`,longPressToSelect:"Gedrückt halten, um Auswahlmodus zu öffnen.",select:"Auswählen",selectedAll:"Alle Elemente ausgewählt.",selectedCount:(e,g)=>`${g.plural(e.count,{"=0":"Keine Elemente ausgewählt",one:()=>`${g.number(e.count)} Element ausgewählt`,other:()=>`${g.number(e.count)} Elemente ausgewählt`})}.`,selectedItem:e=>`${e.item} ausgewählt.`};var RS={};RS={deselectedItem:e=>`Δεν επιλέχθηκε το στοιχείο ${e.item}.`,longPressToSelect:"Πατήστε παρατεταμένα για να μπείτε σε λειτουργία επιλογής.",select:"Επιλογή",selectedAll:"Επιλέχθηκαν όλα τα στοιχεία.",selectedCount:(e,g)=>`${g.plural(e.count,{"=0":"Δεν επιλέχθηκαν στοιχεία",one:()=>`Επιλέχθηκε ${g.number(e.count)} στοιχείο`,other:()=>`Επιλέχθηκαν ${g.number(e.count)} στοιχεία`})}.`,selectedItem:e=>`Επιλέχθηκε το στοιχείο ${e.item}.`};var XS={};XS={deselectedItem:e=>`${e.item} not selected.`,select:"Select",selectedCount:(e,g)=>`${g.plural(e.count,{"=0":"No items selected",one:()=>`${g.number(e.count)} item selected`,other:()=>`${g.number(e.count)} items selected`})}.`,selectedAll:"All items selected.",selectedItem:e=>`${e.item} selected.`,longPressToSelect:"Long press to enter selection mode."};var kS={};kS={deselectedItem:e=>`${e.item} no seleccionado.`,longPressToSelect:"Mantenga pulsado para abrir el modo de selección.",select:"Seleccionar",selectedAll:"Todos los elementos seleccionados.",selectedCount:(e,g)=>`${g.plural(e.count,{"=0":"Ningún elemento seleccionado",one:()=>`${g.number(e.count)} elemento seleccionado`,other:()=>`${g.number(e.count)} elementos seleccionados`})}.`,selectedItem:e=>`${e.item} seleccionado.`};var JS={};JS={deselectedItem:e=>`${e.item} pole valitud.`,longPressToSelect:"Valikurežiimi sisenemiseks vajutage pikalt.",select:"Vali",selectedAll:"Kõik üksused valitud.",selectedCount:(e,g)=>`${g.plural(e.count,{"=0":"Üksusi pole valitud",one:()=>`${g.number(e.count)} üksus valitud`,other:()=>`${g.number(e.count)} üksust valitud`})}.`,selectedItem:e=>`${e.item} valitud.`};var YS={};YS={deselectedItem:e=>`Kohdetta ${e.item} ei valittu.`,longPressToSelect:"Siirry valintatilaan painamalla pitkään.",select:"Valitse",selectedAll:"Kaikki kohteet valittu.",selectedCount:(e,g)=>`${g.plural(e.count,{"=0":"Ei yhtään kohdetta valittu",one:()=>`${g.number(e.count)} kohde valittu`,other:()=>`${g.number(e.count)} kohdetta valittu`})}.`,selectedItem:e=>`${e.item} valittu.`};var wS={};wS={deselectedItem:e=>`${e.item} non sélectionné.`,longPressToSelect:"Appuyez de manière prolongée pour passer en mode de sélection.",select:"Sélectionner",selectedAll:"Tous les éléments sélectionnés.",selectedCount:(e,g)=>`${g.plural(e.count,{"=0":"Aucun élément sélectionné",one:()=>`${g.number(e.count)} élément sélectionné`,other:()=>`${g.number(e.count)} éléments sélectionnés`})}.`,selectedItem:e=>`${e.item} sélectionné.`};var HS={};HS={deselectedItem:e=>`${e.item} לא נבחר.`,longPressToSelect:"הקשה ארוכה לכניסה למצב בחירה.",select:"בחר",selectedAll:"כל הפריטים נבחרו.",selectedCount:(e,g)=>`${g.plural(e.count,{"=0":"לא נבחרו פריטים",one:()=>`פריט ${g.number(e.count)} נבחר`,other:()=>`${g.number(e.count)} פריטים נבחרו`})}.`,selectedItem:e=>`${e.item} נבחר.`};var NS={};NS={deselectedItem:e=>`Stavka ${e.item} nije odabrana.`,longPressToSelect:"Dugo pritisnite za ulazak u način odabira.",select:"Odaberite",selectedAll:"Odabrane su sve stavke.",selectedCount:(e,g)=>`${g.plural(e.count,{"=0":"Nije odabrana nijedna stavka",one:()=>`Odabrana je ${g.number(e.count)} stavka`,other:()=>`Odabrano je ${g.number(e.count)} stavki`})}.`,selectedItem:e=>`Stavka ${e.item} je odabrana.`};var KS={};KS={deselectedItem:e=>`${e.item} nincs kijelölve.`,longPressToSelect:"Nyomja hosszan a kijelöléshez.",select:"Kijelölés",selectedAll:"Az összes elem kijelölve.",selectedCount:(e,g)=>`${g.plural(e.count,{"=0":"Egy elem sincs kijelölve",one:()=>`${g.number(e.count)} elem kijelölve`,other:()=>`${g.number(e.count)} elem kijelölve`})}.`,selectedItem:e=>`${e.item} kijelölve.`};var FS={};FS={deselectedItem:e=>`${e.item} non selezionato.`,longPressToSelect:"Premi a lungo per passare alla modalità di selezione.",select:"Seleziona",selectedAll:"Tutti gli elementi selezionati.",selectedCount:(e,g)=>`${g.plural(e.count,{"=0":"Nessun elemento selezionato",one:()=>`${g.number(e.count)} elemento selezionato`,other:()=>`${g.number(e.count)} elementi selezionati`})}.`,selectedItem:e=>`${e.item} selezionato.`};var xS={};xS={deselectedItem:e=>`${e.item} が選択されていません。`,longPressToSelect:"長押しして選択モードを開きます。",select:"選択",selectedAll:"すべての項目を選択しました。",selectedCount:(e,g)=>`${g.plural(e.count,{"=0":"項目が選択されていません",one:()=>`${g.number(e.count)} 項目を選択しました`,other:()=>`${g.number(e.count)} 項目を選択しました`})}。`,selectedItem:e=>`${e.item} を選択しました。`};var ES={};ES={deselectedItem:e=>`${e.item}이(가) 선택되지 않았습니다.`,longPressToSelect:"선택 모드로 들어가려면 길게 누르십시오.",select:"선택",selectedAll:"모든 항목이 선택되었습니다.",selectedCount:(e,g)=>`${g.plural(e.count,{"=0":"선택된 항목이 없습니다",one:()=>`${g.number(e.count)}개 항목이 선택되었습니다`,other:()=>`${g.number(e.count)}개 항목이 선택되었습니다`})}.`,selectedItem:e=>`${e.item}이(가) 선택되었습니다.`};var DS={};DS={deselectedItem:e=>`${e.item} nepasirinkta.`,longPressToSelect:"Norėdami įjungti pasirinkimo režimą, paspauskite ir palaikykite.",select:"Pasirinkti",selectedAll:"Pasirinkti visi elementai.",selectedCount:(e,g)=>`${g.plural(e.count,{"=0":"Nepasirinktas nė vienas elementas",one:()=>`Pasirinktas ${g.number(e.count)} elementas`,other:()=>`Pasirinkta elementų: ${g.number(e.count)}`})}.`,selectedItem:e=>`Pasirinkta: ${e.item}.`};var MS={};MS={deselectedItem:e=>`Vienums ${e.item} nav atlasīts.`,longPressToSelect:"Ilgi turiet nospiestu. lai ieslēgtu atlases režīmu.",select:"Atlasīt",selectedAll:"Atlasīti visi vienumi.",selectedCount:(e,g)=>`${g.plural(e.count,{"=0":"Nav atlasīts neviens vienums",one:()=>`Atlasīto vienumu skaits: ${g.number(e.count)}`,other:()=>`Atlasīto vienumu skaits: ${g.number(e.count)}`})}.`,selectedItem:e=>`Atlasīts vienums ${e.item}.`};var zS={};zS={deselectedItem:e=>`${e.item} er ikke valgt.`,longPressToSelect:"Bruk et langt trykk for å gå inn i valgmodus.",select:"Velg",selectedAll:"Alle elementer er valgt.",selectedCount:(e,g)=>`${g.plural(e.count,{"=0":"Ingen elementer er valgt",one:()=>`${g.number(e.count)} element er valgt`,other:()=>`${g.number(e.count)} elementer er valgt`})}.`,selectedItem:e=>`${e.item} er valgt.`};var TS={};TS={deselectedItem:e=>`${e.item} niet geselecteerd.`,longPressToSelect:"Druk lang om de selectiemodus te openen.",select:"Selecteren",selectedAll:"Alle items geselecteerd.",selectedCount:(e,g)=>`${g.plural(e.count,{"=0":"Geen items geselecteerd",one:()=>`${g.number(e.count)} item geselecteerd`,other:()=>`${g.number(e.count)} items geselecteerd`})}.`,selectedItem:e=>`${e.item} geselecteerd.`};var LS={};LS={deselectedItem:e=>`Nie zaznaczono ${e.item}.`,longPressToSelect:"Naciśnij i przytrzymaj, aby wejść do trybu wyboru.",select:"Zaznacz",selectedAll:"Wszystkie zaznaczone elementy.",selectedCount:(e,g)=>`${g.plural(e.count,{"=0":"Nie zaznaczono żadnych elementów",one:()=>`${g.number(e.count)} zaznaczony element`,other:()=>`${g.number(e.count)} zaznaczonych elementów`})}.`,selectedItem:e=>`Zaznaczono ${e.item}.`};var US={};US={deselectedItem:e=>`${e.item} não selecionado.`,longPressToSelect:"Mantenha pressionado para entrar no modo de seleção.",select:"Selecionar",selectedAll:"Todos os itens selecionados.",selectedCount:(e,g)=>`${g.plural(e.count,{"=0":"Nenhum item selecionado",one:()=>`${g.number(e.count)} item selecionado`,other:()=>`${g.number(e.count)} itens selecionados`})}.`,selectedItem:e=>`${e.item} selecionado.`};var QS={};QS={deselectedItem:e=>`${e.item} não selecionado.`,longPressToSelect:"Prima continuamente para entrar no modo de seleção.",select:"Selecionar",selectedAll:"Todos os itens selecionados.",selectedCount:(e,g)=>`${g.plural(e.count,{"=0":"Nenhum item selecionado",one:()=>`${g.number(e.count)} item selecionado`,other:()=>`${g.number(e.count)} itens selecionados`})}.`,selectedItem:e=>`${e.item} selecionado.`};var jS={};jS={deselectedItem:e=>`${e.item} neselectat.`,longPressToSelect:"Apăsați lung pentru a intra în modul de selectare.",select:"Selectare",selectedAll:"Toate elementele selectate.",selectedCount:(e,g)=>`${g.plural(e.count,{"=0":"Niciun element selectat",one:()=>`${g.number(e.count)} element selectat`,other:()=>`${g.number(e.count)} elemente selectate`})}.`,selectedItem:e=>`${e.item} selectat.`};var PS={};PS={deselectedItem:e=>`${e.item} не выбрано.`,longPressToSelect:"Нажмите и удерживайте для входа в режим выбора.",select:"Выбрать",selectedAll:"Выбраны все элементы.",selectedCount:(e,g)=>`${g.plural(e.count,{"=0":"Нет выбранных элементов",one:()=>`${g.number(e.count)} элемент выбран`,other:()=>`${g.number(e.count)} элементов выбрано`})}.`,selectedItem:e=>`${e.item} выбрано.`};var OS={};OS={deselectedItem:e=>`Nevybraté položky: ${e.item}.`,longPressToSelect:"Dlhším stlačením prejdite do režimu výberu.",select:"Vybrať",selectedAll:"Všetky vybraté položky.",selectedCount:(e,g)=>`${g.plural(e.count,{"=0":"Žiadne vybraté položky",one:()=>`${g.number(e.count)} vybratá položka`,other:()=>`Počet vybratých položiek:${g.number(e.count)}`})}.`,selectedItem:e=>`Vybraté položky: ${e.item}.`};var $S={};$S={deselectedItem:e=>`Element ${e.item} ni izbran.`,longPressToSelect:"Za izbirni način pritisnite in dlje časa držite.",select:"Izberite",selectedAll:"Vsi elementi so izbrani.",selectedCount:(e,g)=>`${g.plural(e.count,{"=0":"Noben element ni izbran",one:()=>`${g.number(e.count)} element je izbran`,other:()=>`${g.number(e.count)} elementov je izbranih`})}.`,selectedItem:e=>`Element ${e.item} je izbran.`};var qS={};qS={deselectedItem:e=>`${e.item} nije izabrano.`,longPressToSelect:"Dugo pritisnite za ulazak u režim biranja.",select:"Izaberite",selectedAll:"Izabrane su sve stavke.",selectedCount:(e,g)=>`${g.plural(e.count,{"=0":"Nije izabrana nijedna stavka",one:()=>`Izabrana je ${g.number(e.count)} stavka`,other:()=>`Izabrano je ${g.number(e.count)} stavki`})}.`,selectedItem:e=>`${e.item} je izabrano.`};var _S={};_S={deselectedItem:e=>`${e.item} ej markerat.`,longPressToSelect:"Tryck länge när du vill öppna väljarläge.",select:"Markera",selectedAll:"Alla markerade objekt.",selectedCount:(e,g)=>`${g.plural(e.count,{"=0":"Inga markerade objekt",one:()=>`${g.number(e.count)} markerat objekt`,other:()=>`${g.number(e.count)} markerade objekt`})}.`,selectedItem:e=>`${e.item} markerat.`};var eV={};eV={deselectedItem:e=>`${e.item} seçilmedi.`,longPressToSelect:"Seçim moduna girmek için uzun basın.",select:"Seç",selectedAll:"Tüm ögeler seçildi.",selectedCount:(e,g)=>`${g.plural(e.count,{"=0":"Hiçbir öge seçilmedi",one:()=>`${g.number(e.count)} öge seçildi`,other:()=>`${g.number(e.count)} öge seçildi`})}.`,selectedItem:e=>`${e.item} seçildi.`};var gV={};gV={deselectedItem:e=>`${e.item} не вибрано.`,longPressToSelect:"Виконайте довге натиснення, щоб перейти в режим вибору.",select:"Вибрати",selectedAll:"Усі елементи вибрано.",selectedCount:(e,g)=>`${g.plural(e.count,{"=0":"Жодних елементів не вибрано",one:()=>`${g.number(e.count)} елемент вибрано`,other:()=>`Вибрано елементів: ${g.number(e.count)}`})}.`,selectedItem:e=>`${e.item} вибрано.`};var tV={};tV={deselectedItem:e=>`未选择 ${e.item}。`,longPressToSelect:"长按以进入选择模式。",select:"选择",selectedAll:"已选择所有项目。",selectedCount:(e,g)=>`${g.plural(e.count,{"=0":"未选择项目",one:()=>`已选择 ${g.number(e.count)} 个项目`,other:()=>`已选择 ${g.number(e.count)} 个项目`})}。`,selectedItem:e=>`已选择 ${e.item}。`};var lV={};lV={deselectedItem:e=>`未選取「${e.item}」。`,longPressToSelect:"長按以進入選擇模式。",select:"選取",selectedAll:"已選取所有項目。",selectedCount:(e,g)=>`${g.plural(e.count,{"=0":"未選取任何項目",one:()=>`已選取 ${g.number(e.count)} 個項目`,other:()=>`已選取 ${g.number(e.count)} 個項目`})}。`,selectedItem:e=>`已選取「${e.item}」。`};class ZI{copy(){return new ZI(this.x,this.y)}equals(g){return this.x===g.x&&this.y===g.y}isOrigin(){return this.x===0&&this.y===0}constructor(g=0,t=0){this.x=g,this.y=t}}class hI{get maxX(){return this.x+this.width}get maxY(){return this.y+this.height}get area(){return this.width*this.height}get topLeft(){return new ZI(this.x,this.y)}get topRight(){return new ZI(this.maxX,this.y)}get bottomLeft(){return new ZI(this.x,this.maxY)}get bottomRight(){return new ZI(this.maxX,this.maxY)}intersects(g){return this.x<=g.x+g.width&&g.x<=this.x+this.width&&this.y<=g.y+g.height&&g.y<=this.y+this.height}containsRect(g){return this.x<=g.x&&this.y<=g.y&&this.maxX>=g.maxX&&this.maxY>=g.maxY}containsPoint(g){return this.x<=g.x&&this.y<=g.y&&this.maxX>=g.x&&this.maxY>=g.y}getCornerInRect(g){for(let t of["topLeft","topRight","bottomLeft","bottomRight"])if(g.containsPoint(this[t]))return t;return null}equals(g){return g.x===this.x&&g.y===this.y&&g.width===this.width&&g.height===this.height}pointEquals(g){return this.x===g.x&&this.y===g.y}sizeEquals(g){return this.width===g.width&&this.height===g.height}union(g){let t=Math.min(this.x,g.x),l=Math.min(this.y,g.y),n=Math.max(this.maxX,g.maxX)-t,I=Math.max(this.maxY,g.maxY)-l;return new hI(t,l,n,I)}intersection(g){if(!this.intersects(g))return new hI(0,0,0,0);let t=Math.max(this.x,g.x),l=Math.max(this.y,g.y);return new hI(t,l,Math.min(this.maxX,g.maxX)-t,Math.min(this.maxY,g.maxY)-l)}copy(){return new hI(this.x,this.y,this.width,this.height)}constructor(g=0,t=0,l=0,n=0){this.x=g,this.y=t,this.width=l,this.height=n}}let _n=typeof window<"u"?window.performance:null,_0=_n&&(_n.now||_n.webkitNow||_n.msNow||_n.mozNow);_0&&_0.bind(_n);const nV=7e3;let Gc=null;function IV(e,g="assertive",t=nV){Gc||(Gc=new RN),Gc.announce(e,g,t)}class RN{createLog(g){let t=document.createElement("div");return t.setAttribute("role","log"),t.setAttribute("aria-live",g),t.setAttribute("aria-relevant","additions"),t}destroy(){this.node&&(document.body.removeChild(this.node),this.node=null)}announce(g,t="assertive",l=nV){if(!this.node)return;let n=document.createElement("div");n.textContent=g,t==="assertive"?this.assertiveLog.appendChild(n):this.politeLog.appendChild(n),g!==""&&setTimeout(()=>{n.remove()},l)}clear(g){this.node&&((!g||g==="assertive")&&(this.assertiveLog.innerHTML=""),(!g||g==="polite")&&(this.politeLog.innerHTML=""))}constructor(){this.node=document.createElement("div"),this.node.dataset.liveAnnouncer="true",Object.assign(this.node.style,{border:0,clip:"rect(0 0 0 0)",clipPath:"inset(50%)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap"}),this.assertiveLog=this.createLog("assertive"),this.node.appendChild(this.assertiveLog),this.politeLog=this.createLog("polite"),this.node.appendChild(this.politeLog),document.body.prepend(this.node)}}function Cm(e){return e&&e.__esModule?e.default:e}class oV{isCell(g){return g.type==="cell"}isRow(g){return g.type==="row"||g.type==="item"}findPreviousKey(g,t){let l=g!=null?this.collection.getKeyBefore(g):this.collection.getLastKey();for(;l!=null;){let n=this.collection.getItem(l);if(!this.disabledKeys.has(l)&&(!t||t(n)))return l;l=this.collection.getKeyBefore(l)}}findNextKey(g,t){let l=g!=null?this.collection.getKeyAfter(g):this.collection.getFirstKey();for(;l!=null;){let n=this.collection.getItem(l);if(!this.disabledKeys.has(l)&&(!t||t(n)))return l;l=this.collection.getKeyAfter(l)}}getKeyBelow(g){let t=this.collection.getItem(g);if(t&&(this.isCell(t)&&(g=t.parentKey),g=this.findNextKey(g),g!=null)){if(this.isCell(t)){let l=this.collection.getItem(g);return hl(Qe(l,this.collection),t.index).key}if(this.focusMode==="row")return g}}getKeyAbove(g){let t=this.collection.getItem(g);if(t&&(this.isCell(t)&&(g=t.parentKey),g=this.findPreviousKey(g),g!=null)){if(this.isCell(t)){let l=this.collection.getItem(g);return hl(Qe(l,this.collection),t.index).key}if(this.focusMode==="row")return g}}getKeyRightOf(g){let t=this.collection.getItem(g);if(t){if(this.isRow(t)){let l=Qe(t,this.collection);return this.direction==="rtl"?Wl(l).key:Mt(l).key}if(this.isCell(t)){let l=this.collection.getItem(t.parentKey),n=Qe(l,this.collection),I=this.direction==="rtl"?hl(n,t.index-1):hl(n,t.index+1);return I?I.key:this.focusMode==="row"?t.parentKey:this.direction==="rtl"?this.getFirstKey(g):this.getLastKey(g)}}}getKeyLeftOf(g){let t=this.collection.getItem(g);if(t){if(this.isRow(t)){let l=Qe(t,this.collection);return this.direction==="rtl"?Mt(l).key:Wl(l).key}if(this.isCell(t)){let l=this.collection.getItem(t.parentKey),n=Qe(l,this.collection),I=this.direction==="rtl"?hl(n,t.index+1):hl(n,t.index-1);return I?I.key:this.focusMode==="row"?t.parentKey:this.direction==="rtl"?this.getLastKey(g):this.getFirstKey(g)}}}getFirstKey(g,t){let l;if(g!=null){if(l=this.collection.getItem(g),!l)return;if(this.isCell(l)&&!t){let n=this.collection.getItem(l.parentKey);return Mt(Qe(n,this.collection)).key}}if(g=this.findNextKey(),g!=null&&l&&this.isCell(l)&&t||this.focusMode==="cell"){let n=this.collection.getItem(g);g=Mt(Qe(n,this.collection)).key}return g}getLastKey(g,t){let l;if(g!=null){if(l=this.collection.getItem(g),!l)return;if(this.isCell(l)&&!t){let n=this.collection.getItem(l.parentKey),I=Qe(n,this.collection);return Wl(I).key}}if(g=this.findPreviousKey(),g!=null&&l&&this.isCell(l)&&t||this.focusMode==="cell"){let n=this.collection.getItem(g),I=Qe(n,this.collection);g=Wl(I).key}return g}getItem(g){return this.ref.current.querySelector(`[data-key="${CSS.escape(g.toString())}"]`)}getItemRect(g){var t;if(this.layout)return(t=this.layout.getLayoutInfo(g))===null||t===void 0?void 0:t.rect;let l=this.getItem(g);if(l)return new hI(l.offsetLeft,l.offsetTop,l.offsetWidth,l.offsetHeight)}getPageHeight(){var g,t,l;return this.layout?(g=this.layout.virtualizer)===null||g===void 0?void 0:g.visibleRect.height:(l=this.ref)===null||l===void 0||(t=l.current)===null||t===void 0?void 0:t.offsetHeight}getContentHeight(){var g,t;return this.layout?this.layout.getContentSize().height:(t=this.ref)===null||t===void 0||(g=t.current)===null||g===void 0?void 0:g.scrollHeight}getKeyPageAbove(g){let t=this.getItemRect(g);if(!t)return null;let l=Math.max(0,t.maxY-this.getPageHeight());for(;t&&t.y>l;)g=this.getKeyAbove(g),t=this.getItemRect(g);return g}getKeyPageBelow(g){let t=this.getItemRect(g);if(!t)return null;let l=this.getPageHeight(),n=Math.min(this.getContentHeight(),t.y+l);for(;t&&t.maxY<n;){let I=this.getKeyBelow(g);t=this.getItemRect(I),I!=null&&(g=I)}return g}getKeyForSearch(g,t){if(!this.collator)return null;let l=this.collection,n=t??this.getFirstKey(),I=l.getItem(n);I.type==="cell"&&(n=I.parentKey);let o=!1;for(;n!=null;){let C=l.getItem(n);if(C.textValue){let a=C.textValue.slice(0,g.length);if(this.collator.compare(a,g)===0)return this.isRow(C)&&this.focusMode==="cell"?Mt(Qe(C,this.collection)).key:C.key}n=this.findNextKey(n),n==null&&!o&&(n=this.getFirstKey(),o=!0)}return null}constructor(g){this.collection=g.collection,this.disabledKeys=g.disabledKeys,this.ref=g.ref,this.direction=g.direction,this.collator=g.collator,this.layout=g.layout,this.focusMode=g.focusMode||"row"}}const am=new WeakMap;var wi={};wi={"ar-AE":fS,"bg-BG":SS,"cs-CZ":VS,"da-DK":WS,"de-DE":vS,"el-GR":RS,"en-US":XS,"es-ES":kS,"et-EE":JS,"fi-FI":YS,"fr-FR":wS,"he-IL":HS,"hr-HR":NS,"hu-HU":KS,"it-IT":FS,"ja-JP":xS,"ko-KR":ES,"lt-LT":DS,"lv-LV":MS,"nb-NO":zS,"nl-NL":TS,"pl-PL":LS,"pt-BR":US,"pt-PT":QS,"ro-RO":jS,"ru-RU":PS,"sk-SK":OS,"sl-SI":$S,"sr-SP":qS,"sv-SE":_S,"tr-TR":eV,"uk-UA":gV,"zh-CN":tV,"zh-TW":lV};function XN(e,g){let{getRowText:t=o=>{var C,a,r,i;return(i=(C=(a=g.collection).getTextValue)===null||C===void 0?void 0:C.call(a,o))!==null&&i!==void 0?i:(r=g.collection.getItem(o))===null||r===void 0?void 0:r.textValue}}=e,l=QI(Cm(wi),"@react-aria/grid"),n=g.selectionManager.rawSelection,I=u.useRef(n);Zy(()=>{var o;if(!g.selectionManager.isFocused){I.current=n;return}let C=eh(n,I.current),a=eh(I.current,n),r=g.selectionManager.selectionBehavior==="replace",i=[];if(g.selectionManager.selectedKeys.size===1&&r){if(g.collection.getItem(g.selectionManager.selectedKeys.keys().next().value)){let s=t(g.selectionManager.selectedKeys.keys().next().value);s&&i.push(l.format("selectedItem",{item:s}))}}else if(C.size===1&&a.size===0){let s=t(C.keys().next().value);s&&i.push(l.format("selectedItem",{item:s}))}else if(a.size===1&&C.size===0&&g.collection.getItem(a.keys().next().value)){let s=t(a.keys().next().value);s&&i.push(l.format("deselectedItem",{item:s}))}g.selectionManager.selectionMode==="multiple"&&(i.length===0||n==="all"||n.size>1||I.current==="all"||((o=I.current)===null||o===void 0?void 0:o.size)>1)&&i.push(n==="all"?l.format("selectedAll"):l.format("selectedCount",{count:n.size})),i.length>0&&IV(i.join(" ")),I.current=n},[n])}function eh(e,g){let t=new Set;if(e==="all"||g==="all")return t;for(let l of e.keys())g.has(l)||t.add(l);return t}function kN(e){let g=QI(Cm(wi),"@react-aria/grid"),t=VJ(),l=(t==="pointer"||t==="virtual"||t==null)&&typeof window<"u"&&"ontouchstart"in window,n=u.useMemo(()=>{let o=e.selectionManager.selectionMode,C=e.selectionManager.selectionBehavior,a;return l&&(a=g.format("longPressToSelect")),C==="replace"&&o!=="none"&&e.hasItemActions?a:void 0},[e.selectionManager.selectionMode,e.selectionManager.selectionBehavior,e.hasItemActions,g,l]);return pi(n)}function JN(e,g,t){let{isVirtualized:l,keyboardDelegate:n,focusMode:I,scrollRef:o,getRowText:C,onRowAction:a,onCellAction:r}=e,{selectionManager:i}=g;!e["aria-label"]&&!e["aria-labelledby"]&&console.warn("An aria-label or aria-labelledby prop is required for accessibility.");let s=Vy({usage:"search",sensitivity:"base"}),{direction:c}=Yt(),d=g.selectionManager.disabledBehavior,Z=u.useMemo(()=>n||new oV({collection:g.collection,disabledKeys:d==="selection"?new Set:g.disabledKeys,ref:t,direction:c,collator:s,focusMode:I}),[n,g.collection,g.disabledKeys,d,t,c,s,I]),{collectionProps:G}=sw({ref:t,selectionManager:i,keyboardDelegate:Z,isVirtualized:l,scrollRef:o}),y=Wn(e.id);am.set(g,{keyboardDelegate:Z,actions:{onRowAction:a,onCellAction:r}});let p=kN({selectionManager:i,hasItemActions:!!(a||r)}),h=Zi(e,{labelable:!0}),b=u.useCallback(k=>{if(i.isFocused){k.currentTarget.contains(k.target)||i.setFocused(!1);return}k.currentTarget.contains(k.target)&&i.setFocused(!0)},[i]),B=u.useMemo(()=>({onBlur:G.onBlur,onFocus:b}),[b,G.onBlur]),S=PJ(t,{isDisabled:g.collection.size!==0}),X=_(h,{role:"grid",id:y,"aria-multiselectable":i.selectionMode==="multiple"?"true":void 0},g.isKeyboardNavigationDisabled?B:G,g.collection.size===0&&{tabIndex:S?-1:0},p);return l&&(X["aria-rowcount"]=g.collection.size,X["aria-colcount"]=g.collection.columnCount),XN({getRowText:C},g),{gridProps:X}}function YN(){return{rowGroupProps:{role:"rowgroup"}}}function wN(e,g,t){let{node:l,isVirtualized:n,shouldSelectOnPressUp:I,onAction:o}=e,{actions:{onRowAction:C}}=am.get(g),{itemProps:a,...r}=_y({selectionManager:g.selectionManager,key:l.key,ref:t,isVirtualized:n,shouldSelectOnPressUp:I,onAction:C?()=>C(l.key):o,isDisabled:g.collection.size===0}),i=g.selectionManager.isSelected(l.key),s={role:"row","aria-selected":g.selectionManager.selectionMode!=="none"?i:void 0,"aria-disabled":r.isDisabled||void 0,...a};return n&&(s["aria-rowindex"]=l.index+1),{rowProps:s,...r}}function CV(e,g,t){let{node:l,isVirtualized:n,focusMode:I="child",shouldSelectOnPressUp:o,onAction:C}=e,{direction:a}=Yt(),{keyboardDelegate:r,actions:{onCellAction:i}}=am.get(g),s=u.useRef(null),c=()=>{let b=qg(t.current);if(I==="child"){if(t.current.contains(document.activeElement)&&t.current!==document.activeElement)return;let B=g.selectionManager.childFocusStrategy==="last"?yc(b):b.firstChild();if(B){kg(B);return}}(s.current!=null&&l.key!==s.current||!t.current.contains(document.activeElement))&&kg(t.current)},{itemProps:d,isPressed:Z}=_y({selectionManager:g.selectionManager,key:l.key,ref:t,isVirtualized:n,focus:c,shouldSelectOnPressUp:o,onAction:i?()=>i(l.key):C,isDisabled:g.collection.size===0}),p=_(d,{role:"gridcell",onKeyDownCapture:b=>{if(!b.currentTarget.contains(b.target)||g.isKeyboardNavigationDisabled)return;let B=qg(t.current);switch(B.currentNode=document.activeElement,b.key){case"ArrowLeft":{let S=a==="rtl"?B.nextNode():B.previousNode();if(I==="child"&&S===t.current&&(S=null),S)b.preventDefault(),b.stopPropagation(),kg(S),bl(S,{containingElement:ml(t.current)});else{if(r.getKeyLeftOf(l.key)!==l.key)break;b.preventDefault(),b.stopPropagation(),I==="cell"&&a==="rtl"?(kg(t.current),bl(t.current,{containingElement:ml(t.current)})):(B.currentNode=t.current,S=a==="rtl"?B.firstChild():yc(B),S&&(kg(S),bl(S,{containingElement:ml(t.current)})))}break}case"ArrowRight":{let S=a==="rtl"?B.previousNode():B.nextNode();if(I==="child"&&S===t.current&&(S=null),S)b.preventDefault(),b.stopPropagation(),kg(S),bl(S,{containingElement:ml(t.current)});else{if(r.getKeyRightOf(l.key)!==l.key)break;b.preventDefault(),b.stopPropagation(),I==="cell"&&a==="ltr"?(kg(t.current),bl(t.current,{containingElement:ml(t.current)})):(B.currentNode=t.current,S=a==="rtl"?yc(B):B.firstChild(),S&&(kg(S),bl(S,{containingElement:ml(t.current)})))}break}case"ArrowUp":case"ArrowDown":!b.altKey&&t.current.contains(b.target)&&(b.stopPropagation(),b.preventDefault(),t.current.parentElement.dispatchEvent(new KeyboardEvent(b.nativeEvent.type,b.nativeEvent)));break}},onFocus:b=>{if(s.current=l.key,b.target!==t.current){RA()||g.selectionManager.setFocusedKey(l.key);return}requestAnimationFrame(()=>{I==="child"&&document.activeElement===t.current&&c()})}});var h;return n&&(p["aria-colindex"]=((h=l.colIndex)!==null&&h!==void 0?h:l.index)+1),o&&p.tabIndex!=null&&p.onPointerDown==null&&(p.onPointerDown=b=>{let B=b.currentTarget,S=B.getAttribute("tabindex");B.removeAttribute("tabindex"),requestAnimationFrame(()=>{B.setAttribute("tabindex",S)})}),{gridCellProps:p,isPressed:Z}}function yc(e){let g,t;do t=e.lastChild(),t&&(g=t);while(t);return g}function HN(e,g){let{key:t}=e,l=g.selectionManager,n=Wn(),I=!g.selectionManager.canSelectItem(t),o=g.selectionManager.isSelected(t),C=()=>l.select(t);const a=QI(Cm(wi),"@react-aria/grid");return{checkboxProps:{id:n,"aria-label":a.format("select"),isSelected:o,isDisabled:I,onChange:C}}}let NN=!1;function Qr(){return NN}function rm(e){return e&&e.__esModule?e.default:e}const im=new WeakMap;function ou(e){return typeof e=="string"?e.replace(/\s*/g,""):""+e}function KN(e,g){let t=im.get(e);if(!t)throw new Error("Unknown grid");return`${t}-${ou(g)}`}function aV(e,g,t){let l=im.get(e);if(!l)throw new Error("Unknown grid");return`${l}-${ou(g)}-${ou(t)}`}function rV(e,g){return[...e.collection.rowHeaderColumnKeys].map(t=>aV(e,g,t)).join(" ")}var Hi={};Hi={"ar-AE":Tf,"bg-BG":Lf,"cs-CZ":Uf,"da-DK":Qf,"de-DE":jf,"el-GR":Pf,"en-US":Of,"es-ES":$f,"et-EE":qf,"fi-FI":_f,"fr-FR":eS,"he-IL":gS,"hr-HR":tS,"hu-HU":lS,"it-IT":nS,"ja-JP":IS,"ko-KR":oS,"lt-LT":CS,"lv-LV":aS,"nb-NO":rS,"nl-NL":iS,"pl-PL":sS,"pt-BR":cS,"pt-PT":dS,"ro-RO":uS,"ru-RU":AS,"sk-SK":mS,"sl-SI":bS,"sr-SP":ZS,"sv-SE":hS,"tr-TR":pS,"uk-UA":GS,"zh-CN":yS,"zh-TW":BS};class FN extends oV{isCell(g){return g.type==="cell"||g.type==="rowheader"||g.type==="column"}getKeyBelow(g){let t=this.collection.getItem(g);if(t){if(t.type==="column"){let l=Mt(Qe(t,this.collection));if(l)return l.key;let n=this.getFirstKey();if(n==null)return;let I=this.collection.getItem(n);return hl(Qe(I,this.collection),t.index).key}return super.getKeyBelow(g)}}getKeyAbove(g){let t=this.collection.getItem(g);if(!t)return;if(t.type==="column"){let n=this.collection.getItem(t.parentKey);return n&&n.type==="column"?n.key:void 0}let l=super.getKeyAbove(g);return l!=null&&this.collection.getItem(l).type!=="headerrow"?l:this.isCell(t)?this.collection.columns[t.index].key:this.collection.columns[0].key}findNextColumnKey(g){let t=this.findNextKey(g.key,n=>n.type==="column");if(t!=null)return t;let l=this.collection.headerRows[g.level];for(let n of Qe(l,this.collection))if(n.type==="column")return n.key}findPreviousColumnKey(g){let t=this.findPreviousKey(g.key,I=>I.type==="column");if(t!=null)return t;let l=this.collection.headerRows[g.level],n=[...Qe(l,this.collection)];for(let I=n.length-1;I>=0;I--){let o=n[I];if(o.type==="column")return o.key}}getKeyRightOf(g){let t=this.collection.getItem(g);if(t)return t.type==="column"?this.direction==="rtl"?this.findPreviousColumnKey(t):this.findNextColumnKey(t):super.getKeyRightOf(g)}getKeyLeftOf(g){let t=this.collection.getItem(g);if(t)return t.type==="column"?this.direction==="rtl"?this.findNextColumnKey(t):this.findPreviousColumnKey(t):super.getKeyLeftOf(g)}getKeyForSearch(g,t){if(!this.collator)return null;let l=this.collection,n=t??this.getFirstKey();if(n==null)return null;let I=l.getItem(n);I.type==="cell"&&(n=I.parentKey);let o=!1;for(;n!=null;){let C=l.getItem(n);for(let a of Qe(C,this.collection)){let r=l.columns[a.index];if(l.rowHeaderColumnKeys.has(r.key)&&a.textValue){let i=a.textValue.slice(0,g.length);if(this.collator.compare(i,g)===0)return(t!=null?l.getItem(t):I).type==="cell"?a.key:C.key}}n=this.getKeyBelow(n),n==null&&!o&&(n=this.getFirstKey(),o=!0)}return null}}function xN(e,g,t){let{keyboardDelegate:l,isVirtualized:n,layout:I}=e,o=Vy({usage:"search",sensitivity:"base"}),{direction:C}=Yt(),a=g.selectionManager.disabledBehavior,r=u.useMemo(()=>l||new FN({collection:g.collection,disabledKeys:a==="selection"?new Set:g.disabledKeys,ref:t,direction:C,collator:o,layout:I}),[l,g.collection,g.disabledKeys,a,t,C,o,I]),i=Wn(e.id);im.set(g,i);let{gridProps:s}=JN({...e,id:i,keyboardDelegate:r},g,t);n&&(s["aria-rowcount"]=g.collection.size+g.collection.headerRows.length),Qr()&&"expandedKeys"in g&&(s.role="treegrid");let{column:c,direction:d}=g.sortDescriptor||{},Z=QI(rm(Hi),"@react-aria/table"),G=u.useMemo(()=>{var p;let h=(p=g.collection.columns.find(b=>b.key===c))===null||p===void 0?void 0:p.textValue;return d&&c?Z.format(`${d}Sort`,{columnName:h}):void 0},[d,c,g.collection.columns]),y=pi(G);return Zy(()=>{IV(G,"assertive",500)},[G]),{gridProps:_(s,y,{"aria-describedby":[y["aria-describedby"],s["aria-describedby"]].filter(Boolean).join(" ")})}}function iV(e,g,t){var l,n;let{node:I}=e,o=I.props.allowsSorting,{gridCellProps:C}=CV({...e,focusMode:"child"},g,t),a=I.props.isSelectionCell&&g.selectionManager.selectionMode==="single",{pressProps:r}=KI({isDisabled:!o||a,onPress(){g.sort(I.key)},ref:t}),{focusableProps:i}=Bi({},t),s=null,c=((l=g.sortDescriptor)===null||l===void 0?void 0:l.column)===I.key,d=(n=g.sortDescriptor)===null||n===void 0?void 0:n.direction;I.props.allowsSorting&&!kr()&&(s=c?d:"none");let Z=QI(rm(Hi),"@react-aria/table"),G;o&&(G=`${Z.format("sortable")}`,c&&d&&kr()&&(G=`${G}, ${Z.format(d)}`));let y=pi(G),p=g.collection.size===0;return u.useEffect(()=>{p&&g.selectionManager.focusedKey===I.key&&g.selectionManager.setFocusedKey(null)},[p,g.selectionManager,I.key]),{columnHeaderProps:{..._(C,r,i,y,p&&{tabIndex:-1}),role:"columnheader",id:KN(g,I.key),"aria-colspan":I.colspan&&I.colspan>1?I.colspan:null,"aria-sort":s}}}const gh={expand:{ltr:"ArrowRight",rtl:"ArrowLeft"},collapse:{ltr:"ArrowLeft",rtl:"ArrowRight"}};function EN(e,g,t){let{node:l,isVirtualized:n}=e,{rowProps:I,...o}=wN(e,g,t),{direction:C}=Yt();n&&!(Qr()&&"expandedKeys"in g)?I["aria-rowindex"]=l.index+1+g.collection.headerRows.length:delete I["aria-rowindex"];let a={};if(Qr()&&"expandedKeys"in g){let d=g.keyMap.get(l.key);if(d!=null){var r,i,s;let Z=((r=d.props)===null||r===void 0?void 0:r.UNSTABLE_childItems)||((s=d.props)===null||s===void 0||(i=s.children)===null||i===void 0?void 0:i.length)>g.userColumnCount;a={onKeyDown:G=>{(G.key===gh.expand[C]&&g.selectionManager.focusedKey===d.key&&Z&&g.expandedKeys!=="all"&&!g.expandedKeys.has(d.key)||G.key===gh.collapse[C]&&g.selectionManager.focusedKey===d.key&&Z&&(g.expandedKeys==="all"||g.expandedKeys.has(d.key)))&&(g.toggleKey(d.key),G.stopPropagation())},"aria-expanded":Z?g.expandedKeys==="all"||g.expandedKeys.has(l.key):void 0,"aria-level":d.level,"aria-posinset":d.indexOfType+1,"aria-setsize":d.level>1?Wl(g.keyMap.get(d==null?void 0:d.parentKey).childNodes).indexOfType+1:Wl(g.keyMap.get(g.collection.body.key).childNodes).indexOfType+1}}}let c=o.hasAction?tJ(l.props):{};return{rowProps:{..._(I,a,c),"aria-labelledby":rV(g,l.key)},...o}}function DN(e,g,t){let{node:l,isVirtualized:n}=e,I={role:"row"};return n&&!(Qr()&&"expandedKeys"in g)&&(I["aria-rowindex"]=l.index+1),{rowProps:I}}function sV(e,g,t){let{gridCellProps:l,isPressed:n}=CV(e,g,t),I=e.node.column.key;return g.collection.rowHeaderColumnKeys.has(I)&&(l.role="rowheader",l.id=aV(g,e.node.parentKey,I)),{gridCellProps:l,isPressed:n}}function MN(e,g){let{key:t}=e;const{checkboxProps:l}=HN(e,g);return{checkboxProps:{...l,"aria-labelledby":`${l.id} ${rV(g,t)}`}}}function zN(e){let{isEmpty:g,isSelectAll:t,selectionMode:l}=e.selectionManager;return{checkboxProps:{"aria-label":QI(rm(Hi),"@react-aria/table").format(l==="single"?"select":"selectAll"),isSelected:t,isDisabled:l!=="multiple"||e.collection.size===0,isIndeterminate:!g&&!t,onChange:()=>e.selectionManager.toggleSelectAll()}}}function cV(){return YN()}var dV=_e((e,g)=>{var t,l;const{as:n,className:I,node:o,slots:C,state:a,selectionMode:r,color:i,checkboxesProps:s,disableAnimation:c,classNames:d,...Z}=e,G=n||"th",y=typeof G=="string",p=Oe(g),{columnHeaderProps:h}=iV({node:o},a,p),{isFocusVisible:b,focusProps:B}=ht(),{checkboxProps:S}=zN(a),X=ne(d==null?void 0:d.th,I,(t=o.props)==null?void 0:t.className),k=r==="single",{onChange:m,...v}=S;return A.jsx(G,{ref:p,"data-focus-visible":T(b),..._(h,B,Ng(o.props,{enabled:y}),Ng(Z,{enabled:y})),className:(l=C.th)==null?void 0:l.call(C,{class:X}),children:k?A.jsx(fi,{children:S["aria-label"]}):A.jsx(Ff,{color:i,disableAnimation:c,onValueChange:m,..._(s,v)})})});dV.displayName="NextUI.TableSelectAllCheckbox";var TN=dV;function LN(e){let{collection:g,focusMode:t}=e,l=L9(e),n=u.useMemo(()=>e.disabledKeys?new Set(e.disabledKeys):new Set,[e.disabledKeys]),I=l.setFocusedKey;l.setFocusedKey=(a,r)=>{if(t==="cell"&&a!=null){let c=g.getItem(a);if((c==null?void 0:c.type)==="item"){var i,s;let d=Qe(c,g);r==="last"?a=(i=Wl(d))===null||i===void 0?void 0:i.key:a=(s=Mt(d))===null||s===void 0?void 0:s.key}}I(a,r)};let o=u.useMemo(()=>new U9(g,l),[g,l]);const C=u.useRef(null);return u.useEffect(()=>{if(l.focusedKey!=null&&!g.getItem(l.focusedKey)){const a=C.current.getItem(l.focusedKey),r=a.parentKey!=null&&(a.type==="cell"||a.type==="rowheader"||a.type==="column")?C.current.getItem(a.parentKey):a,i=C.current.rows,s=g.rows,c=i.length-s.length;let d=Math.min(c>1?Math.max(r.index-c+1,0):r.index,s.length-1),Z;for(;d>=0;){if(!o.isDisabled(s[d].key)&&s[d].type!=="headerrow"){Z=s[d];break}d<s.length-1?d++:(d>r.index&&(d=r.index),d--)}if(Z){const G=Z.hasChildNodes?[...Qe(Z,g)]:[],y=Z.hasChildNodes&&r!==a&&a.index<G.length?G[a.index].key:Z.key;l.setFocusedKey(y)}else l.setFocusedKey(null)}C.current=g},[g,o,l,l.focusedKey]),{collection:g,disabledKeys:n,isKeyboardNavigationDisabled:!1,selectionManager:o}}class UN{*[Symbol.iterator](){yield*[...this.rows]}get size(){return[...this.rows].length}getKeys(){return this.keyMap.keys()}getKeyBefore(g){let t=this.keyMap.get(g);return t?t.prevKey:null}getKeyAfter(g){let t=this.keyMap.get(g);return t?t.nextKey:null}getFirstKey(){var g;return(g=[...this.rows][0])===null||g===void 0?void 0:g.key}getLastKey(){var g;let t=[...this.rows];return(g=t[t.length-1])===null||g===void 0?void 0:g.key}getItem(g){return this.keyMap.get(g)}at(g){const t=[...this.getKeys()];return this.getItem(t[g])}getChildren(g){let t=this.keyMap.get(g);return(t==null?void 0:t.childNodes)||[]}constructor(g){this.keyMap=new Map,this.keyMap=new Map,this.columnCount=g==null?void 0:g.columnCount,this.rows=[];let t=I=>{let o=this.keyMap.get(I.key);g.visitNode&&(I=g.visitNode(I)),this.keyMap.set(I.key,I);let C=new Set,a;for(let r of I.childNodes)r.type==="cell"&&r.parentKey==null&&(r.parentKey=I.key),C.add(r.key),a?(a.nextKey=r.key,r.prevKey=a.key):r.prevKey=null,t(r),a=r;if(a&&(a.nextKey=null),o)for(let r of o.childNodes)C.has(r.key)||l(r)},l=I=>{this.keyMap.delete(I.key);for(let o of I.childNodes)this.keyMap.get(o.key)===o&&l(o)},n;g.items.forEach((I,o)=>{let C={level:0,key:"row-"+o,type:"row",value:void 0,hasChildNodes:!0,childNodes:[...I.childNodes],rendered:void 0,textValue:void 0,...I};n?(n.nextKey=C.key,C.prevKey=n.key):C.prevKey=null,this.rows.push(C),t(C),n=C}),n&&(n.nextKey=null)}}const uV="row-header-column-"+Math.random().toString(36).slice(2);let Cu="row-header-column-"+Math.random().toString(36).slice(2);for(;uV===Cu;)Cu="row-header-column-"+Math.random().toString(36).slice(2);function QN(e,g){if(g.length===0)return[];let t=[],l=new Map;for(let a of g){let r=a.parentKey,i=[a];for(;r;){let s=e.get(r);if(!s)break;if(l.has(s)){s.colspan++;let{column:c,index:d}=l.get(s);if(d>i.length)break;for(let Z=d;Z<i.length;Z++)c.splice(Z,0,null);for(let Z=i.length;Z<c.length;Z++)c[Z]&&l.has(c[Z])&&(l.get(c[Z]).index=Z)}else s.colspan=1,i.push(s),l.set(s,{column:i,index:i.length-1});r=s.parentKey}t.push(i),a.index=t.length-1}let n=Math.max(...t.map(a=>a.length)),I=Array(n).fill(0).map(()=>[]),o=0;for(let a of t){let r=n-1;for(let i of a){if(i){let s=I[r],c=s.reduce((d,Z)=>d+Z.colspan,0);if(c<o){let d={type:"placeholder",key:"placeholder-"+i.key,colspan:o-c,index:c,value:null,rendered:null,level:r,hasChildNodes:!1,childNodes:[],textValue:null};s.length>0&&(s[s.length-1].nextKey=d.key,d.prevKey=s[s.length-1].key),s.push(d)}s.length>0&&(s[s.length-1].nextKey=i.key,i.prevKey=s[s.length-1].key),i.level=r,i.colIndex=o,s.push(i)}r--}o++}let C=0;for(let a of I){let r=a.reduce((i,s)=>i+s.colspan,0);if(r<g.length){let i={type:"placeholder",key:"placeholder-"+a[a.length-1].key,colspan:g.length-r,index:r,value:null,rendered:null,level:C,hasChildNodes:!1,childNodes:[],textValue:null,prevKey:a[a.length-1].key};a.push(i)}C++}return I.map((a,r)=>({type:"headerrow",key:"headerrow-"+r,index:r,value:null,rendered:null,level:0,hasChildNodes:!0,childNodes:a,textValue:null}))}class jN extends UN{*[Symbol.iterator](){yield*this.body.childNodes}get size(){return this._size}getKeys(){return this.keyMap.keys()}getKeyBefore(g){let t=this.keyMap.get(g);return t?t.prevKey:null}getKeyAfter(g){let t=this.keyMap.get(g);return t?t.nextKey:null}getFirstKey(){var g;return(g=Mt(this.body.childNodes))===null||g===void 0?void 0:g.key}getLastKey(){var g;return(g=Wl(this.body.childNodes))===null||g===void 0?void 0:g.key}getItem(g){return this.keyMap.get(g)}at(g){const t=[...this.getKeys()];return this.getItem(t[g])}getTextValue(g){let t=this.getItem(g);if(!t)return"";if(t.textValue)return t.textValue;let l=this.rowHeaderColumnKeys;if(l){let n=[];for(let I of t.childNodes){let o=this.columns[I.index];if(l.has(o.key)&&I.textValue&&n.push(I.textValue),n.length===l.size)break}return n.join(" ")}return""}constructor(g,t,l){let n=new Set,I,o=[];if(l!=null&&l.showSelectionCheckboxes){let s={type:"column",key:uV,value:null,textValue:"",level:0,index:l!=null&&l.showDragButtons?1:0,hasChildNodes:!1,rendered:null,childNodes:[],props:{isSelectionCell:!0}};o.unshift(s)}if(l!=null&&l.showDragButtons){let s={type:"column",key:Cu,value:null,textValue:"",level:0,index:0,hasChildNodes:!1,rendered:null,childNodes:[],props:{isDragButtonCell:!0}};o.unshift(s)}let C=[],a=new Map,r=s=>{switch(s.type){case"body":I=s;break;case"column":a.set(s.key,s),s.hasChildNodes||(o.push(s),s.props.isRowHeader&&n.add(s.key));break;case"item":C.push(s);return}for(let c of s.childNodes)r(c)};for(let s of g)r(s);let i=QN(a,o);i.forEach((s,c)=>C.splice(c,0,s)),super({columnCount:o.length,items:C,visitNode:s=>(s.column=o[s.index],s)}),this._size=0,this.columns=o,this.rowHeaderColumnKeys=n,this.body=I,this.headerRows=i,this._size=[...I.childNodes].length,this.rowHeaderColumnKeys.size===0&&this.rowHeaderColumnKeys.add(this.columns.find(s=>{var c,d;return!(!((c=s.props)===null||c===void 0)&&c.isDragButtonCell)&&!(!((d=s.props)===null||d===void 0)&&d.isSelectionCell)}).key)}}const PN={ascending:"descending",descending:"ascending"};function ON(e){let[g,t]=u.useState(!1),{selectionMode:l="none",showSelectionCheckboxes:n,showDragButtons:I}=e,o=u.useMemo(()=>({showSelectionCheckboxes:n&&l!=="none",showDragButtons:I,selectionMode:l,columns:[]}),[e.children,n,l,I]),C=z9(e,u.useCallback(i=>new jN(i,null,o),[o]),o),{disabledKeys:a,selectionManager:r}=LN({...e,collection:C,disabledBehavior:e.disabledBehavior||"selection"});return{collection:C,disabledKeys:a,selectionManager:r,showSelectionCheckboxes:e.showSelectionCheckboxes||!1,sortDescriptor:e.sortDescriptor,isKeyboardNavigationDisabled:C.size===0||g,setKeyboardNavigationDisabled:t,sort(i,s){var c;e.onSortChange({column:i,direction:s??(((c=e.sortDescriptor)===null||c===void 0?void 0:c.column)===i?PN[e.sortDescriptor.direction]:"ascending")})}}}function AV(e){return null}AV.getCollectionNode=function*(g,t){let{children:l,columns:n}=g;if(t.columns=[],typeof l=="function"){if(!n)throw new Error("props.children was a function but props.columns is missing");for(let I of n)yield{type:"column",value:I,renderer:l}}else{let I=[];D.Children.forEach(l,o=>{I.push({type:"column",element:o})}),yield*I}};let $N=AV;function mV(e){return null}mV.getCollectionNode=function*(g){let{children:t,items:l}=g;yield{type:"body",hasChildNodes:!0,props:g,*childNodes(){if(typeof t=="function"){if(!l)throw new Error("props.children was a function but props.items is missing");for(let n of l)yield{type:"item",value:n,renderer:t}}else{let n=[];D.Children.forEach(t,I=>{n.push({type:"item",element:I})}),yield*n}}}};let qN=mV;function bV(e){return null}bV.getCollectionNode=function*(g,t){let{title:l,children:n,childColumns:I}=g,o=l||n,C=g.textValue||(typeof o=="string"?o:"")||g["aria-label"],a=yield{type:"column",hasChildNodes:!!I||l&&D.Children.count(n)>0,rendered:o,textValue:C,props:g,*childNodes(){if(I)for(let i of I)yield{type:"column",value:i};else if(l){let i=[];D.Children.forEach(n,s=>{i.push({type:"column",element:s})}),yield*i}},shouldInvalidate(i){return r(i),!1}},r=i=>{for(let s of a)s.hasChildNodes||i.columns.push(s)};r(t)};let _N=bV;function au(e){return null}au.getCollectionNode=function*(g,t){let{children:l,textValue:n,UNSTABLE_childItems:I}=g;yield{type:"item",props:g,textValue:n,"aria-label":g["aria-label"],hasChildNodes:!0,*childNodes(){if(t.showDragButtons&&(yield{type:"cell",key:"header-drag",props:{isDragButtonCell:!0}}),t.showSelectionCheckboxes&&t.selectionMode!=="none"&&(yield{type:"cell",key:"header",props:{isSelectionCell:!0}}),typeof l=="function"){for(let o of t.columns)yield{type:"cell",element:l(o.key),key:o.key};if(I)for(let o of I)yield{type:"item",value:o}}else{let o=[],C=[];if(D.Children.forEach(l,a=>{if(a.type===au){if(o.length<t.columns.length)throw new Error("All of a Row's child Cells must be positioned before any child Rows.");C.push({type:"item",element:a})}else o.push({type:"cell",element:a})}),o.length!==t.columns.length)throw new Error(`Cell count must match column count. Found ${o.length} cells and ${t.columns.length} columns.`);yield*o,yield*C}},shouldInvalidate(o){return o.columns.length!==t.columns.length||o.columns.some((C,a)=>C.key!==t.columns[a].key)||o.showSelectionCheckboxes!==t.showSelectionCheckboxes||o.showDragButtons!==t.showDragButtons||o.selectionMode!==t.selectionMode}}};let eK=au;function ZV(e){return null}ZV.getCollectionNode=function*(g){let{children:t}=g,l=g.textValue||(typeof t=="string"?t:"")||g["aria-label"]||"";yield{type:"cell",props:g,rendered:t,textValue:l,"aria-label":g["aria-label"],hasChildNodes:!1}};let gK=ZV;function tK(e){const[g,t]=PI(e,WZ.variantKeys),{ref:l,as:n,baseRef:I,children:o,className:C,classNames:a,layoutNode:r,removeWrapper:i=!1,disableAnimation:s=!1,selectionMode:c="none",topContentPlacement:d="inside",bottomContentPlacement:Z="inside",selectionBehavior:G=c==="none"?null:"toggle",disabledBehavior:y="selection",showSelectionCheckboxes:p=c==="multiple"&&G!=="replace",BaseComponent:h="div",checkboxesProps:b,topContent:B,bottomContent:S,onRowAction:X,onCellAction:k,...m}=g,v=n||"table",R=typeof v=="string",W=Oe(l),J=Oe(I),f=ON({...e,children:o,showSelectionCheckboxes:p}),{collection:V}=f,{gridProps:K}=xN({...e,layout:r},f,W),x=c!=="none",Y=c==="multiple",N=u.useMemo(()=>WZ({...t,isSelectable:x,isMultiSelectable:Y}),[...Object.values(t),x,Y]),F=ne(a==null?void 0:a.base,C),H=u.useMemo(()=>{var j;return{state:f,slots:N,isSelectable:x,collection:V,classNames:a,color:e==null?void 0:e.color,disableAnimation:s,checkboxesProps:b,isHeaderSticky:(j=e==null?void 0:e.isHeaderSticky)!=null?j:!1,selectionMode:c,selectionBehavior:G,disabledBehavior:y,showSelectionCheckboxes:p,onRowAction:X,onCellAction:k}},[N,f,V,x,a,c,G,b,y,s,p,e==null?void 0:e.color,e==null?void 0:e.isHeaderSticky,X,k]),E=u.useCallback(j=>({...j,ref:J,className:N.base({class:ne(F,j==null?void 0:j.className)})}),[F,N]),z=u.useCallback(j=>({...j,ref:J,className:N.wrapper({class:ne(a==null?void 0:a.wrapper,j==null?void 0:j.className)})}),[a==null?void 0:a.wrapper,N]),U=u.useCallback(j=>({..._(K,Ng(m,{enabled:R}),j),ref:W,className:N.table({class:ne(a==null?void 0:a.table,j==null?void 0:j.className)})}),[a==null?void 0:a.table,R,N,K,m]);return{BaseComponent:h,Component:v,children:o,state:f,collection:V,values:H,topContent:B,bottomContent:S,removeWrapper:i,topContentPlacement:d,bottomContentPlacement:Z,getBaseProps:E,getWrapperProps:z,getTableProps:U}}var hV=_e((e,g)=>{var t,l;const{as:n,className:I,node:o,rowKey:C,slots:a,state:r,classNames:i,...s}=e,c=n||"td",d=typeof c=="string",Z=Oe(g),{gridCellProps:G}=sV({node:o},r,Z),y=ne(i==null?void 0:i.td,I,(t=o.props)==null?void 0:t.className),{isFocusVisible:p,focusProps:h}=ht(),b=r.selectionManager.isSelected(C),B=u.useMemo(()=>{const S=typeof o.rendered;return S!=="object"&&S!=="function"?A.jsx("span",{children:o.rendered}):o.rendered},[o.rendered]);return A.jsx(c,{ref:Z,"data-focus-visible":T(p),"data-selected":T(b),..._(G,h,Ng(o.props,{enabled:d}),s),className:(l=a.td)==null?void 0:l.call(a,{class:y}),children:B})});hV.displayName="NextUI.TableCell";var lK=hV,pV=_e((e,g)=>{var t,l;const{as:n,className:I,node:o,rowKey:C,slots:a,state:r,color:i,disableAnimation:s,checkboxesProps:c,selectionMode:d,classNames:Z,...G}=e,y=n||"td",p=typeof y=="string",h=Oe(g),{gridCellProps:b}=sV({node:o},r,h),{isFocusVisible:B,focusProps:S}=ht(),{checkboxProps:X}=MN({key:(o==null?void 0:o.parentKey)||o.key},r),k=ne(Z==null?void 0:Z.td,I,(t=o.props)==null?void 0:t.className),m=d==="single",{onChange:v,...R}=X,W=r.selectionManager.isSelected(C);return A.jsx(y,{ref:h,"data-focus-visible":T(B),"data-selected":T(W),..._(b,S,Ng(o.props,{enabled:p}),G),className:(l=a.td)==null?void 0:l.call(a,{class:k}),children:m?A.jsx(fi,{children:X["aria-label"]}):A.jsx(Ff,{color:i,disableAnimation:s,onValueChange:v,..._(c,R)})})});pV.displayName="NextUI.TableCheckboxCell";var nK=pV,GV=_e((e,g)=>{var t,l;const{as:n,className:I,children:o,node:C,slots:a,state:r,isSelectable:i,classNames:s,...c}=e,d=n||(e!=null&&e.href?"a":"tr"),Z=typeof d=="string",G=Oe(g),{rowProps:y}=EN({node:C},r,G),p=ne(s==null?void 0:s.tr,I,(t=C.props)==null?void 0:t.className),{isFocusVisible:h,focusProps:b}=ht(),B=r.disabledKeys.has(C.key),S=r.selectionManager.isSelected(C.key),{isHovered:X,hoverProps:k}=jI({isDisabled:B}),{isFirst:m,isLast:v,isMiddle:R,isOdd:W}=u.useMemo(()=>{const J=C.key===r.collection.getFirstKey(),f=C.key===r.collection.getLastKey(),V=!J&&!f,K=C!=null&&C.index?(C.index+1)%2===0:!1;return{isFirst:J,isLast:f,isMiddle:V,isOdd:K}},[C,r.collection]);return A.jsx(d,{ref:G,"data-disabled":T(B),"data-first":T(m),"data-focus-visible":T(h),"data-hover":T(X),"data-last":T(v),"data-middle":T(R),"data-odd":T(W),"data-selected":T(S),..._(y,b,i?k:{},Ng(C.props,{enabled:Z}),c),className:(l=a.tr)==null?void 0:l.call(a,{class:p}),children:o})});GV.displayName="NextUI.TableRow";var IK=GV,yV=_e((e,g)=>{var t;const{as:l,className:n,slots:I,state:o,collection:C,isSelectable:a,color:r,disableAnimation:i,checkboxesProps:s,selectionMode:c,classNames:d,...Z}=e,G=l||"tbody",y=typeof G=="string",p=Oe(g),{rowGroupProps:h}=cV(),b=ne(d==null?void 0:d.tbody,n),B=C==null?void 0:C.body.props,S=(B==null?void 0:B.isLoading)||(B==null?void 0:B.loadingState)==="loading"||(B==null?void 0:B.loadingState)==="loadingMore",X=u.useMemo(()=>[...C.body.childNodes].map(v=>A.jsx(IK,{classNames:d,isSelectable:a,node:v,slots:I,state:o,children:[...v.childNodes].map(R=>R.props.isSelectionCell?A.jsx(nK,{checkboxesProps:s,classNames:d,color:r,disableAnimation:i,node:R,rowKey:v.key,selectionMode:c,slots:I,state:o},R.key):A.jsx(lK,{classNames:d,node:R,rowKey:v.key,slots:I,state:o},R.key))},v.key)),[C.body.childNodes,d,a,I,o]);let k,m;return C.size===0&&B.emptyContent&&(k=A.jsx("tr",{role:"row",children:A.jsx("td",{className:I==null?void 0:I.emptyWrapper({class:d==null?void 0:d.emptyWrapper}),colSpan:C.columnCount,role:"gridcell",children:B.emptyContent})})),S&&B.loadingContent&&(m=A.jsx("tr",{role:"row",children:A.jsx("td",{className:I==null?void 0:I.loadingWrapper({class:d==null?void 0:d.loadingWrapper}),colSpan:C.columnCount,role:"gridcell",children:B.loadingContent})})),A.jsxs(G,{ref:p,..._(h,Ng(B,{enabled:y}),Z),className:(t=I.tbody)==null?void 0:t.call(I,{class:b}),"data-empty":T(C.size===0),"data-loading":T(S),children:[X,m,k]})});yV.displayName="NextUI.TableBody";var oK=yV,BV=_e((e,g)=>{var t,l,n,I,o;const{as:C,className:a,state:r,node:i,slots:s,classNames:c,...d}=e,Z=C||"th",G=typeof Z=="string",y=Oe(g),{columnHeaderProps:p}=iV({node:i},r,y),h=ne(c==null?void 0:c.th,a,(t=i.props)==null?void 0:t.className),{isFocusVisible:b,focusProps:B}=ht(),{isHovered:S,hoverProps:X}=jI({}),{hideHeader:k,...m}=i.props,v=m.allowsSorting;return A.jsxs(Z,{ref:y,colSpan:i.colspan,"data-focus-visible":T(b),"data-hover":T(S),"data-sortable":T(v),..._(p,B,Ng(m,{enabled:G}),v?X:{},d),className:(l=s.th)==null?void 0:l.call(s,{class:h}),children:[k?A.jsx(fi,{children:i.rendered}):i.rendered,v&&A.jsx(Bw,{"aria-hidden":"true",className:(n=s.sortIcon)==null?void 0:n.call(s,{class:c==null?void 0:c.sortIcon}),"data-direction":(I=r.sortDescriptor)==null?void 0:I.direction,"data-visible":T(((o=r.sortDescriptor)==null?void 0:o.column)===i.key),strokeWidth:3})]})});BV.displayName="NextUI.TableColumnHeader";var CK=BV,fV=_e((e,g)=>{var t,l;const{as:n,className:I,children:o,node:C,slots:a,classNames:r,state:i,...s}=e,c=n||"tr",d=typeof c=="string",Z=Oe(g),{rowProps:G}=DN({node:C},i),y=ne(r==null?void 0:r.tr,I,(t=C.props)==null?void 0:t.className);return A.jsx(c,{ref:Z,..._(G,Ng(C.props,{enabled:d}),s),className:(l=a.tr)==null?void 0:l.call(a,{class:y}),children:o})});fV.displayName="NextUI.TableHeaderRow";var aK=fV,SV=_e((e,g)=>{var t;const{as:l,className:n,children:I,slots:o,classNames:C,...a}=e,r=l||"thead",i=Oe(g),{rowGroupProps:s}=cV(),c=ne(C==null?void 0:C.thead,n);return A.jsx(r,{ref:i,className:(t=o.thead)==null?void 0:t.call(o,{class:c}),..._(s,a),children:I})});SV.displayName="NextUI.TableRowGroup";var rK=SV,iK={px:"1px",0:"0px",.5:"0.125rem",1:"0.25rem",1.5:"0.375rem",2:"0.5rem",2.5:"0.625rem",3:"0.75rem",3.5:"0.875rem",4:"1rem",5:"1.25rem",6:"1.5rem",7:"1.75rem",8:"2rem",9:"2.25rem",10:"2.5rem",11:"2.75rem",12:"3rem",14:"3.5rem",16:"4rem",20:"5rem",24:"6rem",28:"7rem",32:"8rem",36:"9rem",40:"10rem",44:"11rem",48:"12rem",52:"13rem",56:"14rem",60:"15rem",64:"16rem",72:"18rem",80:"20rem",96:"24rem"},th=e=>{var g;return(g=iK[e])!=null?g:e};function sK(e){const[g,t]=PI(e,SZ.variantKeys),{as:l,className:n,x:I=1,y:o=1,...C}=g,a=l||"span",r=u.useMemo(()=>SZ({...t,className:n}),[...Object.values(t),n]),i=th(I),s=th(o);return{Component:a,getSpacerProps:(d={})=>({...d,...C,"aria-hidden":T(!0),className:ne(r,d.className),style:{...d.style,...C.style,marginLeft:i,marginTop:s}})}}var VV=_e((e,g)=>{const{Component:t,getSpacerProps:l}=sK({...e});return A.jsx(t,{ref:g,...l()})});VV.displayName="NextUI.Spacer";var cK=VV,WV=_e((e,g)=>{const{BaseComponent:t,Component:l,collection:n,values:I,topContent:o,topContentPlacement:C,bottomContentPlacement:a,bottomContent:r,removeWrapper:i,getBaseProps:s,getWrapperProps:c,getTableProps:d}=tK({...e,ref:g}),Z=u.useCallback(({children:G})=>i?G:A.jsx(t,{...c(),children:G}),[i,c]);return A.jsxs("div",{...s(),children:[C==="outside"&&o,A.jsx(Z,{children:A.jsxs(A.Fragment,{children:[C==="inside"&&o,A.jsxs(l,{...d(),children:[A.jsxs(rK,{classNames:I.classNames,slots:I.slots,children:[n.headerRows.map(G=>A.jsx(aK,{classNames:I.classNames,node:G,slots:I.slots,state:I.state,children:[...G.childNodes].map(y=>{var p;return(p=y==null?void 0:y.props)!=null&&p.isSelectionCell?A.jsx(TN,{checkboxesProps:I.checkboxesProps,classNames:I.classNames,color:I.color,disableAnimation:I.disableAnimation,node:y,selectionMode:I.selectionMode,slots:I.slots,state:I.state},y==null?void 0:y.key):A.jsx(CK,{classNames:I.classNames,node:y,slots:I.slots,state:I.state},y==null?void 0:y.key)})},G==null?void 0:G.key)),A.jsx(cK,{as:"tr",tabIndex:-1,y:1})]}),A.jsx(oK,{checkboxesProps:I.checkboxesProps,classNames:I.classNames,collection:I.collection,color:I.color,disableAnimation:I.disableAnimation,isSelectable:I.isSelectable,selectionMode:I.selectionMode,slots:I.slots,state:I.state})]}),a==="inside"&&r]})}),a==="outside"&&r]})});WV.displayName="NextUI.Table";var Ni=WV,dK=eK,Ki=dK,uK=qN,Fi=uK,AK=gK,Bl=AK,mK=_N,mg=mK,bK=$N,xi=bK;const sm=({color:e})=>A.jsx(Xf,{classNames:{base:"w-[20px] h-[20px] md:w-[30px] md:h-[30px]",wrapper:"w-[20px] h-[20px] md:w-[30px] md:h-[30px]",circle1:`${e==="white"?"border-b-2 border-b-primary-white":"border-b-2 border-b-primary-black"}`,circle2:`${e==="white"?"border-b-2 border-b-primary-white":"border-b-2 border-b-primary-black"}`}});sm.propTypes={color:w.oneOf(["white","black"]).isRequired};const cm=({role:e,name:g,email:t})=>{const l=Il(),n=()=>{hk(),l("/")};return A.jsxs("nav",{className:"fixed z-10 w-[96%] lg:w-[94%] rounded-md mx-auto h-[65px] top-0 left-0 right-0 mt-3 md:mt-5 px-3 md:px-6 flex-between items-center shadow-md navbar_glass",children:[A.jsxs("div",{className:"flex-center gap-1",children:[A.jsx("img",{src:"/images/logo.png",alt:"",className:"w-12"}),A.jsx("h1",{className:"md:text-2xl tracking-wide font-bold capitalize",children:e})]}),A.jsxs("div",{className:"flex-center gap-2",children:[A.jsxs("div",{className:"flex items-center gap-2 max-sm:border-l-2 pl-2 md:border-r-2 pr-2",children:[g?A.jsx("button",{className:"btn text-lg px-3 py-1 font-semibold uppercase",children:g.substring(0,1)}):A.jsx(sm,{color:"black"}),A.jsx("button",{onClick:n,className:"md:hidden btn_bordered p-1.5",children:A.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6",children:A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 9V5.25A2.25 2.25 0 0 0 13.5 3h-6a2.25 2.25 0 0 0-2.25 2.25v13.5A2.25 2.25 0 0 0 7.5 21h6a2.25 2.25 0 0 0 2.25-2.25V15m3 0 3-3m0 0-3-3m3 3H9"})})}),A.jsxs("div",{className:"hidden md:block",children:[A.jsx("p",{className:"font-medium text-xs",children:g}),A.jsx("p",{className:"text-xs",children:t})]})]}),A.jsx("button",{onClick:n,className:"hidden md:block btn_bordered p-1.5",children:A.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6",children:A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 9V5.25A2.25 2.25 0 0 0 13.5 3h-6a2.25 2.25 0 0 0-2.25 2.25v13.5A2.25 2.25 0 0 0 7.5 21h6a2.25 2.25 0 0 0 2.25-2.25V15m3 0 3-3m0 0-3-3m3 3H9"})})})]})]})};cm.propTypes={role:w.string.isRequired,name:w.string,email:w.string};const vV=()=>{const[e,g]=u.useState({day:new Date().getDate(),month:new Date().toLocaleString("default",{month:"long"}),year:new Date().getFullYear(),minutes:new Date().getMinutes(),hours:new Date().getHours(),seconds:new Date().getSeconds()});u.useEffect(()=>{const n=setInterval(()=>{const I=new Date;g({day:I.getDate(),month:I.toLocaleString("default",{month:"long"}),year:I.getFullYear(),minutes:I.getMinutes(),hours:I.getHours(),seconds:I.getSeconds()})},1e3);return()=>clearInterval(n)},[]);const t=n=>n.toLocaleString("en-US",{minimumIntegerDigits:2});let l="";switch(e.day){case 1:l="st";break;case 2:l="nd";break;case 3:l="rd";break;default:l="th"}return A.jsxs("div",{className:"h-full flex flex-col justify-between p-6 gap-2 bg-white border-2 border-transparent hover:border-blue-400 transition-effect rounded-md shadow-lg",children:[A.jsxs("div",{className:"w-full flex items-center gap-4",children:[e.hours>=18?A.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1,stroke:"currentColor",className:"w-12 h-12 md:w-16 md:h-16",children:A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21.752 15.002A9.72 9.72 0 0 1 18 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 0 0 3 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 0 0 9.002-5.998Z"})}):A.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1,stroke:"currentColor",className:"w-12 h-12 md:w-16 md:h-16",children:A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z"})}),A.jsxs("h1",{className:"font-bold text-2xl text-gray-dark",children:[A.jsxs("span",{children:[t(e.hours),":"]}),A.jsxs("span",{children:[t(e.minutes),":"]}),A.jsx("span",{children:t(e.seconds)}),A.jsx("span",{children:e.hours>=12?" PM":" AM"})]})]}),A.jsxs("div",{className:"hidden md:block text-3xl font-bold",children:[A.jsx("h1",{className:"text-xl font-semibold text-gray-dark",children:"Today"}),A.jsxs("h1",{children:[e.day,l,A.jsxs("span",{children:[" ",e.month]})]}),A.jsx("h1",{children:e.year})]})]})},pn=({title:e,value:g,loading:t})=>A.jsxs("div",{className:"metric_card w-[30%] shadow-lg rounded-md flex flex-col gap-3 p-3 md:p-4",children:[t?A.jsx(sm,{color:"white"}):A.jsx("h1",{className:"text-2xl md:text-4xl font-bold",children:g}),A.jsx("h1",{className:"text-sm md:text-2xl font-semibold",children:e})]});pn.propTypes={title:w.string.isRequired,value:w.oneOfType([w.string,w.number]).isRequired,loading:w.bool.isRequired};const pt="https://attendance-manag-stud.onrender.com",ZK=async()=>{if(!ke())return Promise.reject(new Error("No access token available"));if(!Jt()&&!await ol())return Promise.reject(new Error("Token refresh failed"));try{const g=await fetch(`${pt}/dashboard/admin/metrics/`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${ke()}`}});if(g.ok)return await g.json();await lt(g)}catch(g){console.error(g)}},lh=async e=>{if(!ke())return Promise.reject(new Error("No access token available"));if(!Jt()&&!await ol())return Promise.reject(new Error("Token refresh failed"));try{const t=await fetch(`${pt}/dashboard/admin/student-section/${e?`?search=${e}`:""}`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${ke()}`}});if(t.ok){const l=await t.json();return l.length>0||et("No Data Found!",{icon:"👎"}),l}}catch(t){console.error(t)}},hK=async e=>{if(!ke())return Promise.reject(new Error("No access token available"));if(!Jt()&&!await ol())return Promise.reject(new Error("Token refresh failed"));try{const t=await fetch(`${pt}/dashboard/admin/attendance-management/?date=${e}`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${ke()}`}});if(t.ok){const l=await t.json();return l.length>0||et(`No Attendance Found (${e})`,{icon:"👎"}),l}}catch(t){console.error(t)}},pK=async()=>{if(!ke())return Promise.reject(new Error("No access token available"));if(!Jt()&&!await ol())return Promise.reject(new Error("Token refresh failed"));try{const g=await fetch(`${pt}/student/request-management-section/`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${ke()}`}});if(g.ok){const t=await g.json();return t.length>0||et("No Pending requests",{icon:"👎"}),t}}catch(g){console.error(g)}},nh=async(e,g)=>{if(!ke())return Promise.reject(new Error("No access token available"));if(!Jt()&&!await ol())return Promise.reject(new Error("Token refresh failed"));try{const l=await fetch(`${pt}/student/pending-requests/`,{method:g,headers:{"Content-Type":"application/json",Authorization:`Bearer ${ke()}`},body:JSON.stringify({email:e})});if(l.ok)return g==="POST"&&et.success(`${e} Approved`),g==="DELETE"&&et(`${e} Deleted`,{icon:"🗑️"}),l;await lt(l)}catch(l){console.error(l)}},GK=async()=>{if(!ke())return Promise.reject(new Error("No access token available"));if(!Jt()&&!await ol())return Promise.reject(new Error("Token refresh failed"));try{const g=await fetch(`${pt}/student/dashboard/`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${ke()}`}});if(g.ok)return await g.json();await lt(g)}catch(g){console.error(g)}},yK=async()=>{if(!ke())return Promise.reject(new Error("No access token available"));if(!Jt()&&!await ol())return Promise.reject(new Error("Token refresh failed"));try{const g=await fetch(`${pt}/student/generate-qr-code/`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${ke()}`}});if(g.ok){const t=await g.json();return console.log(t),t}else await lt(g)}catch(g){console.error(g)}},BK=async e=>{const g=ke();if(console.log(JSON.stringify(e)),!g)return Promise.reject(new Error("No access token available"));if(!Jt()&&!await ol())return Promise.reject(new Error("Token refresh failed"));try{const t=await fetch(`${pt}/student/MarkAttendanceDynamicQRView/`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${ke()}`},body:JSON.stringify(e)});if(t.ok){const l=await t.json();return et.success("Attendance Marked Successfully"),console.log("Response Data:",l),l}else await lt(t)}catch(t){console.error(t)}},fK=async e=>{if(!ke())return Promise.reject(new Error("No access token available"));if(!Jt()&&!await ol())return Promise.reject(new Error("Token refresh failed"));try{const t=await fetch(`${pt}/student/get-attendence-by-date/?date=${e}`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${ke()}`}});if(t.ok)return await t.json()}catch(t){console.error(t)}},SK=async e=>{try{const g=await fetch(`${pt}/mark-attendance/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(g.ok){const t=await g.json();return et.success("Attendance marked successfully"),t}else await lt(g)}catch(g){console.error(g)}},VK=async e=>{try{const g=ke();if(!g)return Promise.reject(new Error("No access token available"));const t=await fetch(`${pt}/mark-attendance/`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${g}`},body:JSON.stringify(e)}),l=await t.json();return t.ok?(et.success("Attendance added successfully"),l):(console.error("Server error:",l),et.error("An error occurred while adding attendance. Please try again later."),Promise.reject(l))}catch(g){return console.error(g),et.error("An error occurred while adding attendance. Please try again later."),Promise.reject(g)}},WK=()=>{const[e,g]=u.useState(!0),[t,l]=u.useState([]),[n,I]=u.useState(""),[o,C]=u.useState(1),a=10,r=Math.ceil(t.length/a),i=u.useMemo(()=>{const d=(o-1)*a,Z=d+a;return t.slice(d,Z)},[o,t]),s=async()=>{const d=await lh();l(d),g(!1)},c=async d=>{d.preventDefault(),g(!0),l([]);const Z=await lh(n);l(Z)};return u.useEffect(()=>{s()},[]),A.jsxs("div",{className:"w-full flex-center flex-col gap-10",children:[A.jsxs("form",{onSubmit:c,className:"w-full flex items-stretch justify-center",children:[A.jsx("input",{type:"text",placeholder:"Search by name, roll number or mobile number",value:n,onChange:d=>I(d.target.value),className:"w-3/4 p-3 px-4 shadow-sm bg-white rounded-l-md outline-none border-2 focus:border-r-0 border-transparent focus:border-2 focus:border-primary-black text-sm font-medium"}),A.jsx("button",{type:"submit",className:"btn bg-primary-black rounded-l-none",children:A.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1,stroke:"currentColor",className:"w-7 h-7",children:A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"})})})]}),A.jsxs(Ni,{"aria-label":"Example table with client side pagination",isStriped:!0,bottomContent:A.jsx("div",{className:"flex w-full justify-center",children:A.jsx(Yi,{isCompact:!0,showControls:!0,showShadow:!0,page:o,total:r,onChange:d=>C(d),classNames:{cursor:"bg-primary-black shadow-none"}})}),classNames:{base:"",wrapper:"min-h-[222px] bg-white shadow-lg rounded-md",th:"bg-primary-black text-primary-white rounded-none text-base"},children:[A.jsxs(xi,{children:[A.jsx(mg,{children:"Role No."},"roll_number"),A.jsx(mg,{children:"Name"},"name"),A.jsx(mg,{children:"Email"},"email"),A.jsx(mg,{children:"Mobile Number"},"mobile_number")]}),A.jsx(Fi,{emptyContent:e?"Searching...":"No Student Data Found!",items:i,children:d=>A.jsx(Ki,{children:Z=>A.jsx(Bl,{children:qy(d,Z)})},d.roll_number)})]})]})};var vK="Expected a function",RV="__lodash_hash_undefined__",RK="[object Function]",XK="[object GeneratorFunction]",kK=/[\\^$.*+?()[\]{}|]/g,JK=/^\[object .+?Constructor\]$/,YK=typeof UC=="object"&&UC&&UC.Object===Object&&UC,wK=typeof self=="object"&&self&&self.Object===Object&&self,XV=YK||wK||Function("return this")();function HK(e,g){return e==null?void 0:e[g]}function NK(e){var g=!1;if(e!=null&&typeof e.toString!="function")try{g=!!(e+"")}catch{}return g}var KK=Array.prototype,FK=Function.prototype,kV=Object.prototype,Bc=XV["__core-js_shared__"],Ih=function(){var e=/[^.]+$/.exec(Bc&&Bc.keys&&Bc.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),JV=FK.toString,dm=kV.hasOwnProperty,xK=kV.toString,EK=RegExp("^"+JV.call(dm).replace(kK,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),DK=KK.splice,MK=YV(XV,"Map"),sC=YV(Object,"create");function Rn(e){var g=-1,t=e?e.length:0;for(this.clear();++g<t;){var l=e[g];this.set(l[0],l[1])}}function zK(){this.__data__=sC?sC(null):{}}function TK(e){return this.has(e)&&delete this.__data__[e]}function LK(e){var g=this.__data__;if(sC){var t=g[e];return t===RV?void 0:t}return dm.call(g,e)?g[e]:void 0}function UK(e){var g=this.__data__;return sC?g[e]!==void 0:dm.call(g,e)}function QK(e,g){var t=this.__data__;return t[e]=sC&&g===void 0?RV:g,this}Rn.prototype.clear=zK;Rn.prototype.delete=TK;Rn.prototype.get=LK;Rn.prototype.has=UK;Rn.prototype.set=QK;function OI(e){var g=-1,t=e?e.length:0;for(this.clear();++g<t;){var l=e[g];this.set(l[0],l[1])}}function jK(){this.__data__=[]}function PK(e){var g=this.__data__,t=Ei(g,e);if(t<0)return!1;var l=g.length-1;return t==l?g.pop():DK.call(g,t,1),!0}function OK(e){var g=this.__data__,t=Ei(g,e);return t<0?void 0:g[t][1]}function $K(e){return Ei(this.__data__,e)>-1}function qK(e,g){var t=this.__data__,l=Ei(t,e);return l<0?t.push([e,g]):t[l][1]=g,this}OI.prototype.clear=jK;OI.prototype.delete=PK;OI.prototype.get=OK;OI.prototype.has=$K;OI.prototype.set=qK;function Nn(e){var g=-1,t=e?e.length:0;for(this.clear();++g<t;){var l=e[g];this.set(l[0],l[1])}}function _K(){this.__data__={hash:new Rn,map:new(MK||OI),string:new Rn}}function e3(e){return Di(this,e).delete(e)}function g3(e){return Di(this,e).get(e)}function t3(e){return Di(this,e).has(e)}function l3(e,g){return Di(this,e).set(e,g),this}Nn.prototype.clear=_K;Nn.prototype.delete=e3;Nn.prototype.get=g3;Nn.prototype.has=t3;Nn.prototype.set=l3;function Ei(e,g){for(var t=e.length;t--;)if(a3(e[t][0],g))return t;return-1}function n3(e){if(!wV(e)||o3(e))return!1;var g=r3(e)||NK(e)?EK:JK;return g.test(C3(e))}function Di(e,g){var t=e.__data__;return I3(g)?t[typeof g=="string"?"string":"hash"]:t.map}function YV(e,g){var t=HK(e,g);return n3(t)?t:void 0}function I3(e){var g=typeof e;return g=="string"||g=="number"||g=="symbol"||g=="boolean"?e!=="__proto__":e===null}function o3(e){return!!Ih&&Ih in e}function C3(e){if(e!=null){try{return JV.call(e)}catch{}try{return e+""}catch{}}return""}function um(e,g){if(typeof e!="function"||g&&typeof g!="function")throw new TypeError(vK);var t=function(){var l=arguments,n=g?g.apply(this,l):l[0],I=t.cache;if(I.has(n))return I.get(n);var o=e.apply(this,l);return t.cache=I.set(n,o),o};return t.cache=new(um.Cache||Nn),t}um.Cache=Nn;function a3(e,g){return e===g||e!==e&&g!==g}function r3(e){var g=wV(e)?xK.call(e):"";return g==RK||g==XK}function wV(e){var g=typeof e;return!!e&&(g=="object"||g=="function")}var i3=um;const HV=ZC(i3);function NV(e){return JSON.stringify(e)}function s3(e){return typeof e=="string"}function c3(e,g,t){return t.indexOf(e)===g}function d3(e){return e.toLowerCase()===e}function oh(e){return e.indexOf(",")===-1?e:e.split(",")}function ru(e){if(!e)return e;if(e==="C"||e==="posix"||e==="POSIX")return"en-US";if(e.indexOf(".")!==-1){var g=e.split(".")[0],t=g===void 0?"":g;return ru(t)}if(e.indexOf("@")!==-1){var l=e.split("@")[0],t=l===void 0?"":l;return ru(t)}if(e.indexOf("-")===-1||!d3(e))return e;var n=e.split("-"),I=n[0],o=n[1],C=o===void 0?"":o;return"".concat(I,"-").concat(C.toUpperCase())}function u3(e){var g=e===void 0?{}:e,t=g.useFallbackLocale,l=t===void 0?!0:t,n=g.fallbackLocale,I=n===void 0?"en-US":n,o=[];if(typeof navigator<"u"){for(var C=navigator.languages||[],a=[],r=0,i=C;r<i.length;r++){var s=i[r];a=a.concat(oh(s))}var c=navigator.language,d=c&&oh(c);o=o.concat(a,d)}return l&&o.push(I),o.filter(s3).map(ru).filter(c3)}var A3=HV(u3,NV);function m3(e){return A3(e)[0]||null}var KV=HV(m3,NV);function Cl(e,g,t){return function(n,I){I===void 0&&(I=t);var o=e(n)+I;return g(o)}}function YC(e){return function(t){return new Date(e(t).getTime()-1)}}function wC(e,g){return function(l){return[e(l),g(l)]}}function fe(e){if(e instanceof Date)return e.getFullYear();if(typeof e=="number")return e;var g=parseInt(e,10);if(typeof e=="string"&&!isNaN(g))return g;throw new Error("Failed to get year from date: ".concat(e,"."))}function Pl(e){if(e instanceof Date)return e.getMonth();throw new Error("Failed to get month from date: ".concat(e,"."))}function Mi(e){if(e instanceof Date)return e.getDate();throw new Error("Failed to get year from date: ".concat(e,"."))}function $I(e){var g=fe(e),t=g+(-g+1)%100,l=new Date;return l.setFullYear(t,0,1),l.setHours(0,0,0,0),l}var b3=Cl(fe,$I,-100),FV=Cl(fe,$I,100),Am=YC(FV),Z3=Cl(fe,Am,-100),xV=wC($I,Am);function Ol(e){var g=fe(e),t=g+(-g+1)%10,l=new Date;return l.setFullYear(t,0,1),l.setHours(0,0,0,0),l}var EV=Cl(fe,Ol,-10),mm=Cl(fe,Ol,10),zi=YC(mm),DV=Cl(fe,zi,-10),MV=wC(Ol,zi);function qI(e){var g=fe(e),t=new Date;return t.setFullYear(g,0,1),t.setHours(0,0,0,0),t}var zV=Cl(fe,qI,-1),bm=Cl(fe,qI,1),Ti=YC(bm),TV=Cl(fe,Ti,-1),h3=wC(qI,Ti);function Zm(e,g){return function(l,n){n===void 0&&(n=g);var I=fe(l),o=Pl(l)+n,C=new Date;return C.setFullYear(I,o,1),C.setHours(0,0,0,0),e(C)}}function Kn(e){var g=fe(e),t=Pl(e),l=new Date;return l.setFullYear(g,t,1),l.setHours(0,0,0,0),l}var LV=Zm(Kn,-1),hm=Zm(Kn,1),HC=YC(hm),UV=Zm(HC,-1),p3=wC(Kn,HC);function G3(e,g){return function(l,n){n===void 0&&(n=g);var I=fe(l),o=Pl(l),C=Mi(l)+n,a=new Date;return a.setFullYear(I,o,C),a.setHours(0,0,0,0),e(a)}}function NC(e){var g=fe(e),t=Pl(e),l=Mi(e),n=new Date;return n.setFullYear(g,t,l),n.setHours(0,0,0,0),n}var y3=G3(NC,1),pm=YC(y3),B3=wC(NC,pm);function QV(e){return Mi(HC(e))}var Ao,he={GREGORY:"gregory",HEBREW:"hebrew",ISLAMIC:"islamic",ISO_8601:"iso8601"},pI={ARABIC:"Arabic",HEBREW:"Hebrew",ISO_8601:"ISO 8601",US:"US"},f3=(Ao={},Ao[he.GREGORY]=["en-CA","en-US","es-AR","es-BO","es-CL","es-CO","es-CR","es-DO","es-EC","es-GT","es-HN","es-MX","es-NI","es-PA","es-PE","es-PR","es-SV","es-VE","pt-BR"],Ao[he.HEBREW]=["he","he-IL"],Ao[he.ISLAMIC]=["ar","ar-AE","ar-BH","ar-DZ","ar-EG","ar-IQ","ar-JO","ar-KW","ar-LY","ar-OM","ar-QA","ar-SA","ar-SD","ar-SY","ar-YE","dv","dv-MV","ps","ps-AR"],Ao),Gm=[0,1,2,3,4,5,6],fc=new Map;function S3(e){return function(t,l){var n=t||KV();fc.has(n)||fc.set(n,new Map);var I=fc.get(n);return I.has(e)||I.set(e,new Intl.DateTimeFormat(n||void 0,e).format),I.get(e)(l)}}function V3(e){var g=new Date(e);return new Date(g.setHours(12))}function Fn(e){return function(g,t){return S3(e)(g,V3(t))}}var W3={day:"numeric"},v3={day:"numeric",month:"long",year:"numeric"},R3={month:"long"},X3={month:"long",year:"numeric"},k3={weekday:"short"},J3={weekday:"long"},Y3={year:"numeric"},w3=Fn(W3),H3=Fn(v3),N3=Fn(R3),jV=Fn(X3),K3=Fn(k3),F3=Fn(J3),Li=Fn(Y3),x3=Gm[0],E3=Gm[5],Ch=Gm[6];function cC(e,g){g===void 0&&(g=he.ISO_8601);var t=e.getDay();switch(g){case he.ISO_8601:return(t+6)%7;case he.ISLAMIC:return(t+1)%7;case he.HEBREW:case he.GREGORY:return t;default:throw new Error("Unsupported calendar type.")}}function D3(e){var g=$I(e);return fe(g)}function M3(e){var g=Ol(e);return fe(g)}function iu(e,g){g===void 0&&(g=he.ISO_8601);var t=fe(e),l=Pl(e),n=e.getDate()-cC(e,g);return new Date(t,l,n)}function z3(e,g){g===void 0&&(g=he.ISO_8601);var t=g===he.GREGORY?he.GREGORY:he.ISO_8601,l=iu(e,g),n=fe(e)+1,I,o;do I=new Date(n,0,t===he.ISO_8601?4:1),o=iu(I,g),n-=1;while(e<o);return Math.round((l.getTime()-o.getTime())/(864e5*7))+1}function Gn(e,g){switch(e){case"century":return $I(g);case"decade":return Ol(g);case"year":return qI(g);case"month":return Kn(g);case"day":return NC(g);default:throw new Error("Invalid rangeType: ".concat(e))}}function T3(e,g){switch(e){case"century":return b3(g);case"decade":return EV(g);case"year":return zV(g);case"month":return LV(g);default:throw new Error("Invalid rangeType: ".concat(e))}}function PV(e,g){switch(e){case"century":return FV(g);case"decade":return mm(g);case"year":return bm(g);case"month":return hm(g);default:throw new Error("Invalid rangeType: ".concat(e))}}function L3(e,g){switch(e){case"decade":return EV(g,-100);case"year":return zV(g,-10);case"month":return LV(g,-12);default:throw new Error("Invalid rangeType: ".concat(e))}}function U3(e,g){switch(e){case"decade":return mm(g,100);case"year":return bm(g,10);case"month":return hm(g,12);default:throw new Error("Invalid rangeType: ".concat(e))}}function OV(e,g){switch(e){case"century":return Am(g);case"decade":return zi(g);case"year":return Ti(g);case"month":return HC(g);case"day":return pm(g);default:throw new Error("Invalid rangeType: ".concat(e))}}function Q3(e,g){switch(e){case"century":return Z3(g);case"decade":return DV(g);case"year":return TV(g);case"month":return UV(g);default:throw new Error("Invalid rangeType: ".concat(e))}}function j3(e,g){switch(e){case"decade":return DV(g,-100);case"year":return TV(g,-10);case"month":return UV(g,-12);default:throw new Error("Invalid rangeType: ".concat(e))}}function ah(e,g){switch(e){case"century":return xV(g);case"decade":return MV(g);case"year":return h3(g);case"month":return p3(g);case"day":return B3(g);default:throw new Error("Invalid rangeType: ".concat(e))}}function P3(e,g,t){var l=[g,t].sort(function(n,I){return n.getTime()-I.getTime()});return[Gn(e,l[0]),OV(e,l[1])]}function $V(e,g,t){return g===void 0&&(g=Li),t.map(function(l){return g(e,l)}).join(" – ")}function O3(e,g,t){return $V(e,g,xV(t))}function qV(e,g,t){return $V(e,g,MV(t))}function $3(e){return e.getDay()===new Date().getDay()}function _V(e,g){g===void 0&&(g=he.ISO_8601);var t=e.getDay();switch(g){case he.ISLAMIC:case he.HEBREW:return t===E3||t===Ch;case he.ISO_8601:case he.GREGORY:return t===Ch||t===x3;default:throw new Error("Unsupported calendar type.")}}var Bt="react-calendar__navigation";function q3(e){var g=e.activeStartDate,t=e.drillUp,l=e.formatMonthYear,n=l===void 0?jV:l,I=e.formatYear,o=I===void 0?Li:I,C=e.locale,a=e.maxDate,r=e.minDate,i=e.navigationAriaLabel,s=i===void 0?"":i,c=e.navigationAriaLive,d=e.navigationLabel,Z=e.next2AriaLabel,G=Z===void 0?"":Z,y=e.next2Label,p=y===void 0?"»":y,h=e.nextAriaLabel,b=h===void 0?"":h,B=e.nextLabel,S=B===void 0?"›":B,X=e.prev2AriaLabel,k=X===void 0?"":X,m=e.prev2Label,v=m===void 0?"«":m,R=e.prevAriaLabel,W=R===void 0?"":R,J=e.prevLabel,f=J===void 0?"‹":J,V=e.setActiveStartDate,K=e.showDoubleView,x=e.view,Y=e.views,N=Y.indexOf(x)>0,F=x!=="century",H=T3(x,g),E=F?L3(x,g):void 0,z=PV(x,g),U=F?U3(x,g):void 0,j=function(){if(H.getFullYear()<0)return!0;var ee=Q3(x,g);return r&&r>=ee}(),ge=F&&function(){if(E.getFullYear()<0)return!0;var ee=j3(x,g);return r&&r>=ee}(),$=a&&a<z,ae=F&&a&&a<U;function Je(){V(H,"prev")}function oe(){V(E,"prev2")}function Q(){V(z,"next")}function re(){V(U,"next2")}function Se(ee){var Ye=function(){switch(x){case"century":return O3(C,o,ee);case"decade":return qV(C,o,ee);case"year":return o(C,ee);case"month":return n(C,ee);default:throw new Error("Invalid view: ".concat(x,"."))}}();return d?d({date:ee,label:Ye,locale:C||KV()||void 0,view:x}):Ye}function Ue(){var ee="".concat(Bt,"__label");return D.createElement("button",{"aria-label":s,"aria-live":c,className:ee,disabled:!N,onClick:t,style:{flexGrow:1},type:"button"},D.createElement("span",{className:"".concat(ee,"__labelText ").concat(ee,"__labelText--from")},Se(g)),K?D.createElement(D.Fragment,null,D.createElement("span",{className:"".concat(ee,"__divider")}," – "),D.createElement("span",{className:"".concat(ee,"__labelText ").concat(ee,"__labelText--to")},Se(z))):null)}return D.createElement("div",{className:Bt},v!==null&&F?D.createElement("button",{"aria-label":k,className:"".concat(Bt,"__arrow ").concat(Bt,"__prev2-button"),disabled:ge,onClick:oe,type:"button"},v):null,f!==null&&D.createElement("button",{"aria-label":W,className:"".concat(Bt,"__arrow ").concat(Bt,"__prev-button"),disabled:j,onClick:Je,type:"button"},f),Ue(),S!==null&&D.createElement("button",{"aria-label":b,className:"".concat(Bt,"__arrow ").concat(Bt,"__next-button"),disabled:$,onClick:Q,type:"button"},S),p!==null&&F?D.createElement("button",{"aria-label":G,className:"".concat(Bt,"__arrow ").concat(Bt,"__next2-button"),disabled:ae,onClick:re,type:"button"},p):null)}var GI=function(){return GI=Object.assign||function(e){for(var g,t=1,l=arguments.length;t<l;t++){g=arguments[t];for(var n in g)Object.prototype.hasOwnProperty.call(g,n)&&(e[n]=g[n])}return e},GI.apply(this,arguments)},_3=function(e,g){var t={};for(var l in e)Object.prototype.hasOwnProperty.call(e,l)&&g.indexOf(l)<0&&(t[l]=e[l]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,l=Object.getOwnPropertySymbols(e);n<l.length;n++)g.indexOf(l[n])<0&&Object.prototype.propertyIsEnumerable.call(e,l[n])&&(t[l[n]]=e[l[n]]);return t};function rh(e){return"".concat(e,"%")}function ym(e){var g=e.children,t=e.className,l=e.count,n=e.direction,I=e.offset,o=e.style,C=e.wrap,a=_3(e,["children","className","count","direction","offset","style","wrap"]);return D.createElement("div",GI({className:t,style:GI({display:"flex",flexDirection:n,flexWrap:C?"wrap":"nowrap"},o)},a),D.Children.map(g,function(r,i){var s=I&&i===0?rh(100*I/l):null;return D.cloneElement(r,GI(GI({},r.props),{style:{flexBasis:rh(100/l),flexShrink:0,flexGrow:0,overflow:"hidden",marginLeft:s,marginInlineStart:s,marginInlineEnd:0}}))}))}var eF=function(){},gF=eF;const tF=ZC(gF);var jn;function lF(e,g,t){return g&&g>e?g:t&&t<e?t:e}function dC(e,g){return g[0]<=e&&g[1]>=e}function nF(e,g){return e[0]<=g[0]&&e[1]>=g[1]}function eW(e,g){return dC(e[0],g)||dC(e[1],g)}function ih(e,g,t){var l=eW(g,e),n=[];if(l){n.push(t);var I=dC(e[0],g),o=dC(e[1],g);I&&n.push("".concat(t,"Start")),o&&n.push("".concat(t,"End")),I&&o&&n.push("".concat(t,"BothEnds"))}return n}function IF(e){return Array.isArray(e)?e[0]!==null&&e[1]!==null:e!==null}function oF(e){if(!e)throw new Error("args is required");var g=e.value,t=e.date,l=e.hover,n="react-calendar__tile",I=[n];if(!t)return I;var o=new Date,C=function(){if(Array.isArray(t))return t;var d=e.dateType;if(!d)throw new Error("dateType is required when date is not an array of two dates");return ah(d,t)}();if(dC(o,C)&&I.push("".concat(n,"--now")),!g||!IF(g))return I;var a=function(){if(Array.isArray(g))return g;var d=e.valueType;if(!d)throw new Error("valueType is required when value is not an array of two dates");return ah(d,g)}();nF(a,C)?I.push("".concat(n,"--active")):eW(a,C)&&I.push("".concat(n,"--hasActive"));var r=ih(a,C,"".concat(n,"--range"));I.push.apply(I,r);var i=Array.isArray(g)?g:[g];if(l&&i.length===1){var s=l>a[0]?[a[0],l]:[l,a[0]],c=ih(s,C,"".concat(n,"--hover"));I.push.apply(I,c)}return I}var CF=(jn={},jn[pI.ARABIC]=he.ISLAMIC,jn[pI.HEBREW]=he.HEBREW,jn[pI.ISO_8601]=he.ISO_8601,jn[pI.US]=he.GREGORY,jn);function aF(e){return e!==void 0&&e in pI}var sh=!1;function Ui(e){if(aF(e)){var g=CF[e];return tF(sh,'Specifying calendarType="'.concat(e,'" is deprecated. Use calendarType="').concat(g,'" instead.')),sh=!0,g}return e}function Qi(e){for(var g=e.className,t=e.count,l=t===void 0?3:t,n=e.dateTransform,I=e.dateType,o=e.end,C=e.hover,a=e.offset,r=e.renderTile,i=e.start,s=e.step,c=s===void 0?1:s,d=e.value,Z=e.valueType,G=[],y=i;y<=o;y+=c){var p=n(y);G.push(r({classes:oF({date:p,dateType:I,hover:C,value:d,valueType:Z}),date:p}))}return D.createElement(ym,{className:g,count:l,offset:a,wrap:!0},G)}function ji(e){var g=e.activeStartDate,t=e.children,l=e.classes,n=e.date,I=e.formatAbbr,o=e.locale,C=e.maxDate,a=e.maxDateTransform,r=e.minDate,i=e.minDateTransform,s=e.onClick,c=e.onMouseOver,d=e.style,Z=e.tileClassName,G=e.tileContent,y=e.tileDisabled,p=e.view,h=u.useMemo(function(){var B={activeStartDate:g,date:n,view:p};return typeof Z=="function"?Z(B):Z},[g,n,Z,p]),b=u.useMemo(function(){var B={activeStartDate:g,date:n,view:p};return typeof G=="function"?G(B):G},[g,n,G,p]);return D.createElement("button",{className:WC(l,h),disabled:r&&i(r)>n||C&&a(C)<n||y&&y({activeStartDate:g,date:n,view:p}),onClick:s?function(B){return s(n,B)}:void 0,onFocus:c?function(){return c(n)}:void 0,onMouseOver:c?function(){return c(n)}:void 0,style:d,type:"button"},I?D.createElement("abbr",{"aria-label":I(o,n)},t):t,b)}var su=function(){return su=Object.assign||function(e){for(var g,t=1,l=arguments.length;t<l;t++){g=arguments[t];for(var n in g)Object.prototype.hasOwnProperty.call(g,n)&&(e[n]=g[n])}return e},su.apply(this,arguments)},rF=function(e,g){var t={};for(var l in e)Object.prototype.hasOwnProperty.call(e,l)&&g.indexOf(l)<0&&(t[l]=e[l]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,l=Object.getOwnPropertySymbols(e);n<l.length;n++)g.indexOf(l[n])<0&&Object.prototype.propertyIsEnumerable.call(e,l[n])&&(t[l[n]]=e[l[n]]);return t},Sc="react-calendar__century-view__decades__decade";function iF(e){var g=e.classes,t=g===void 0?[]:g,l=e.currentCentury,n=e.formatYear,I=n===void 0?Li:n,o=rF(e,["classes","currentCentury","formatYear"]),C=o.date,a=o.locale,r=[];return t&&r.push.apply(r,t),Sc&&r.push(Sc),$I(C).getFullYear()!==l&&r.push("".concat(Sc,"--neighboringCentury")),D.createElement(ji,su({},o,{classes:r,maxDateTransform:zi,minDateTransform:Ol,view:"century"}),qV(a,I,C))}var cu=function(){return cu=Object.assign||function(e){for(var g,t=1,l=arguments.length;t<l;t++){g=arguments[t];for(var n in g)Object.prototype.hasOwnProperty.call(g,n)&&(e[n]=g[n])}return e},cu.apply(this,arguments)},ch=function(e,g){var t={};for(var l in e)Object.prototype.hasOwnProperty.call(e,l)&&g.indexOf(l)<0&&(t[l]=e[l]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,l=Object.getOwnPropertySymbols(e);n<l.length;n++)g.indexOf(l[n])<0&&Object.prototype.propertyIsEnumerable.call(e,l[n])&&(t[l[n]]=e[l[n]]);return t};function sF(e){var g=e.activeStartDate,t=e.hover,l=e.showNeighboringCentury,n=e.value,I=e.valueType,o=ch(e,["activeStartDate","hover","showNeighboringCentury","value","valueType"]),C=D3(g),a=C+(l?119:99);return D.createElement(Qi,{className:"react-calendar__century-view__decades",dateTransform:Ol,dateType:"decade",end:a,hover:t,renderTile:function(r){var i=r.date,s=ch(r,["date"]);return D.createElement(iF,cu({key:i.getTime()},o,s,{activeStartDate:g,currentCentury:C,date:i}))},start:C,step:10,value:n,valueType:I})}var dh=function(e,g,t){if(t||arguments.length===2)for(var l=0,n=g.length,I;l<n;l++)(I||!(l in g))&&(I||(I=Array.prototype.slice.call(g,0,l)),I[l]=g[l]);return e.concat(I||Array.prototype.slice.call(g))},cF=Object.values(he),dF=Object.values(pI),du=["century","decade","year","month"],gW=w.oneOf(dh(dh([],cF,!0),dF,!0)),jr=w.oneOfType([w.string,w.arrayOf(w.string)]),Bm=function(g,t,l){var n=g,I=t,o=n[I];if(!o)return null;if(!(o instanceof Date))return new Error("Invalid prop `".concat(t,"` of type `").concat(typeof o,"` supplied to `").concat(l,"`, expected instance of `Date`."));var C=g.maxDate;return C&&o>C?new Error("Invalid prop `".concat(t,"` of type `").concat(typeof o,"` supplied to `").concat(l,"`, minDate cannot be larger than maxDate.")):null},fm=function(g,t,l){var n=g,I=t,o=n[I];if(!o)return null;if(!(o instanceof Date))return new Error("Invalid prop `".concat(t,"` of type `").concat(typeof o,"` supplied to `").concat(l,"`, expected instance of `Date`."));var C=g.minDate;return C&&o<C?new Error("Invalid prop `".concat(t,"` of type `").concat(typeof o,"` supplied to `").concat(l,"`, maxDate cannot be smaller than minDate.")):null},uF=w.oneOfType([w.func,w.exact({current:w.any})]),AF=w.arrayOf(w.oneOfType([w.instanceOf(Date),w.oneOf([null])]).isRequired),mF=w.oneOfType([w.instanceOf(Date),w.oneOf([null]),AF]);w.arrayOf(w.oneOf(du));var Pr=function(g,t,l){var n=g,I=t,o=n[I];return o!==void 0&&(typeof o!="string"||du.indexOf(o)===-1)?new Error("Invalid prop `".concat(t,"` of value `").concat(o,"` supplied to `").concat(l,"`, expected one of [").concat(du.map(function(C){return'"'.concat(C,'"')}).join(", "),"].")):null};Pr.isRequired=function(g,t,l,n,I){var o=g,C=t,a=o[C];return a?Pr(g,t,l):new Error("The prop `".concat(t,"` is marked as required in `").concat(l,"`, but its value is `").concat(a,"`."))};var bF=function(e){return w.arrayOf(e)},Pi={activeStartDate:w.instanceOf(Date).isRequired,hover:w.instanceOf(Date),locale:w.string,maxDate:fm,minDate:Bm,onClick:w.func,onMouseOver:w.func,tileClassName:w.oneOfType([w.func,jr]),tileContent:w.oneOfType([w.func,w.node]),value:mF,valueType:w.oneOf(["century","decade","year","month","day"]).isRequired};w.instanceOf(Date).isRequired,w.arrayOf(w.string.isRequired).isRequired,w.instanceOf(Date).isRequired,w.string,w.func,w.func,w.objectOf(w.oneOfType([w.string,w.number])),w.oneOfType([w.func,jr]),w.oneOfType([w.func,w.node]),w.func;var uC=function(){return uC=Object.assign||function(e){for(var g,t=1,l=arguments.length;t<l;t++){g=arguments[t];for(var n in g)Object.prototype.hasOwnProperty.call(g,n)&&(e[n]=g[n])}return e},uC.apply(this,arguments)},tW=function(g){function t(){return D.createElement(sF,uC({},g))}return D.createElement("div",{className:"react-calendar__century-view"},t())};tW.propTypes=uC(uC({},Pi),{showNeighboringCentury:w.bool});const ZF=tW;var uu=function(){return uu=Object.assign||function(e){for(var g,t=1,l=arguments.length;t<l;t++){g=arguments[t];for(var n in g)Object.prototype.hasOwnProperty.call(g,n)&&(e[n]=g[n])}return e},uu.apply(this,arguments)},hF=function(e,g){var t={};for(var l in e)Object.prototype.hasOwnProperty.call(e,l)&&g.indexOf(l)<0&&(t[l]=e[l]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,l=Object.getOwnPropertySymbols(e);n<l.length;n++)g.indexOf(l[n])<0&&Object.prototype.propertyIsEnumerable.call(e,l[n])&&(t[l[n]]=e[l[n]]);return t},Vc="react-calendar__decade-view__years__year";function pF(e){var g=e.classes,t=g===void 0?[]:g,l=e.currentDecade,n=e.formatYear,I=n===void 0?Li:n,o=hF(e,["classes","currentDecade","formatYear"]),C=o.date,a=o.locale,r=[];return t&&r.push.apply(r,t),Vc&&r.push(Vc),Ol(C).getFullYear()!==l&&r.push("".concat(Vc,"--neighboringDecade")),D.createElement(ji,uu({},o,{classes:r,maxDateTransform:Ti,minDateTransform:qI,view:"decade"}),I(a,C))}var Au=function(){return Au=Object.assign||function(e){for(var g,t=1,l=arguments.length;t<l;t++){g=arguments[t];for(var n in g)Object.prototype.hasOwnProperty.call(g,n)&&(e[n]=g[n])}return e},Au.apply(this,arguments)},uh=function(e,g){var t={};for(var l in e)Object.prototype.hasOwnProperty.call(e,l)&&g.indexOf(l)<0&&(t[l]=e[l]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,l=Object.getOwnPropertySymbols(e);n<l.length;n++)g.indexOf(l[n])<0&&Object.prototype.propertyIsEnumerable.call(e,l[n])&&(t[l[n]]=e[l[n]]);return t};function GF(e){var g=e.activeStartDate,t=e.hover,l=e.showNeighboringDecade,n=e.value,I=e.valueType,o=uh(e,["activeStartDate","hover","showNeighboringDecade","value","valueType"]),C=M3(g),a=C+(l?11:9);return D.createElement(Qi,{className:"react-calendar__decade-view__years",dateTransform:qI,dateType:"year",end:a,hover:t,renderTile:function(r){var i=r.date,s=uh(r,["date"]);return D.createElement(pF,Au({key:i.getTime()},o,s,{activeStartDate:g,currentDecade:C,date:i}))},start:C,value:n,valueType:I})}var AC=function(){return AC=Object.assign||function(e){for(var g,t=1,l=arguments.length;t<l;t++){g=arguments[t];for(var n in g)Object.prototype.hasOwnProperty.call(g,n)&&(e[n]=g[n])}return e},AC.apply(this,arguments)},lW=function(g){function t(){return D.createElement(GF,AC({},g))}return D.createElement("div",{className:"react-calendar__decade-view"},t())};lW.propTypes=AC(AC({},Pi),{showNeighboringDecade:w.bool});const yF=lW;var mu=function(){return mu=Object.assign||function(e){for(var g,t=1,l=arguments.length;t<l;t++){g=arguments[t];for(var n in g)Object.prototype.hasOwnProperty.call(g,n)&&(e[n]=g[n])}return e},mu.apply(this,arguments)},BF=function(e,g){var t={};for(var l in e)Object.prototype.hasOwnProperty.call(e,l)&&g.indexOf(l)<0&&(t[l]=e[l]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,l=Object.getOwnPropertySymbols(e);n<l.length;n++)g.indexOf(l[n])<0&&Object.prototype.propertyIsEnumerable.call(e,l[n])&&(t[l[n]]=e[l[n]]);return t},Ah=function(e,g,t){if(t||arguments.length===2)for(var l=0,n=g.length,I;l<n;l++)(I||!(l in g))&&(I||(I=Array.prototype.slice.call(g,0,l)),I[l]=g[l]);return e.concat(I||Array.prototype.slice.call(g))},fF="react-calendar__year-view__months__month";function SF(e){var g=e.classes,t=g===void 0?[]:g,l=e.formatMonth,n=l===void 0?N3:l,I=e.formatMonthYear,o=I===void 0?jV:I,C=BF(e,["classes","formatMonth","formatMonthYear"]),a=C.date,r=C.locale;return D.createElement(ji,mu({},C,{classes:Ah(Ah([],t,!0),[fF],!1),formatAbbr:o,maxDateTransform:HC,minDateTransform:Kn,view:"year"}),n(r,a))}var bu=function(){return bu=Object.assign||function(e){for(var g,t=1,l=arguments.length;t<l;t++){g=arguments[t];for(var n in g)Object.prototype.hasOwnProperty.call(g,n)&&(e[n]=g[n])}return e},bu.apply(this,arguments)},mh=function(e,g){var t={};for(var l in e)Object.prototype.hasOwnProperty.call(e,l)&&g.indexOf(l)<0&&(t[l]=e[l]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,l=Object.getOwnPropertySymbols(e);n<l.length;n++)g.indexOf(l[n])<0&&Object.prototype.propertyIsEnumerable.call(e,l[n])&&(t[l[n]]=e[l[n]]);return t};function VF(e){var g=e.activeStartDate,t=e.hover,l=e.value,n=e.valueType,I=mh(e,["activeStartDate","hover","value","valueType"]),o=0,C=11,a=fe(g);return D.createElement(Qi,{className:"react-calendar__year-view__months",dateTransform:function(r){var i=new Date;return i.setFullYear(a,r,1),Kn(i)},dateType:"month",end:C,hover:t,renderTile:function(r){var i=r.date,s=mh(r,["date"]);return D.createElement(SF,bu({key:i.getTime()},I,s,{activeStartDate:g,date:i}))},start:o,value:l,valueType:n})}var Or=function(){return Or=Object.assign||function(e){for(var g,t=1,l=arguments.length;t<l;t++){g=arguments[t];for(var n in g)Object.prototype.hasOwnProperty.call(g,n)&&(e[n]=g[n])}return e},Or.apply(this,arguments)},nW=function(g){function t(){return D.createElement(VF,Or({},g))}return D.createElement("div",{className:"react-calendar__year-view"},t())};nW.propTypes=Or({},Pi);const WF=nW;var Zu=function(){return Zu=Object.assign||function(e){for(var g,t=1,l=arguments.length;t<l;t++){g=arguments[t];for(var n in g)Object.prototype.hasOwnProperty.call(g,n)&&(e[n]=g[n])}return e},Zu.apply(this,arguments)},vF=function(e,g){var t={};for(var l in e)Object.prototype.hasOwnProperty.call(e,l)&&g.indexOf(l)<0&&(t[l]=e[l]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,l=Object.getOwnPropertySymbols(e);n<l.length;n++)g.indexOf(l[n])<0&&Object.prototype.propertyIsEnumerable.call(e,l[n])&&(t[l[n]]=e[l[n]]);return t},Ra="react-calendar__month-view__days__day";function RF(e){var g=e.calendarType,t=e.classes,l=t===void 0?[]:t,n=e.currentMonthIndex,I=e.formatDay,o=I===void 0?w3:I,C=e.formatLongDate,a=C===void 0?H3:C,r=vF(e,["calendarType","classes","currentMonthIndex","formatDay","formatLongDate"]),i=Ui(g),s=r.date,c=r.locale,d=[];return l&&d.push.apply(d,l),Ra&&d.push(Ra),_V(s,i)&&d.push("".concat(Ra,"--weekend")),s.getMonth()!==n&&d.push("".concat(Ra,"--neighboringMonth")),D.createElement(ji,Zu({},r,{classes:d,formatAbbr:a,maxDateTransform:pm,minDateTransform:NC,view:"month"}),o(c,s))}var hu=function(){return hu=Object.assign||function(e){for(var g,t=1,l=arguments.length;t<l;t++){g=arguments[t];for(var n in g)Object.prototype.hasOwnProperty.call(g,n)&&(e[n]=g[n])}return e},hu.apply(this,arguments)},bh=function(e,g){var t={};for(var l in e)Object.prototype.hasOwnProperty.call(e,l)&&g.indexOf(l)<0&&(t[l]=e[l]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,l=Object.getOwnPropertySymbols(e);n<l.length;n++)g.indexOf(l[n])<0&&Object.prototype.propertyIsEnumerable.call(e,l[n])&&(t[l[n]]=e[l[n]]);return t};function XF(e){var g=e.activeStartDate,t=e.calendarType,l=e.hover,n=e.showFixedNumberOfWeeks,I=e.showNeighboringMonth,o=e.value,C=e.valueType,a=bh(e,["activeStartDate","calendarType","hover","showFixedNumberOfWeeks","showNeighboringMonth","value","valueType"]),r=Ui(t),i=fe(g),s=Pl(g),c=n||I,d=cC(g,r),Z=c?0:d,G=(c?-d:0)+1,y=function(){if(n)return G+6*7-1;var p=QV(g);if(I){var h=new Date;h.setFullYear(i,s,p),h.setHours(0,0,0,0);var b=7-cC(h,r)-1;return p+b}return p}();return D.createElement(Qi,{className:"react-calendar__month-view__days",count:7,dateTransform:function(p){var h=new Date;return h.setFullYear(i,s,p),NC(h)},dateType:"day",hover:l,end:y,renderTile:function(p){var h=p.date,b=bh(p,["date"]);return D.createElement(RF,hu({key:h.getTime()},a,b,{activeStartDate:g,calendarType:t,currentMonthIndex:s,date:h}))},offset:Z,start:G,value:o,valueType:C})}var IW="react-calendar__month-view__weekdays",Wc="".concat(IW,"__weekday");function kF(e){for(var g=e.calendarType,t=e.formatShortWeekday,l=t===void 0?K3:t,n=e.formatWeekday,I=n===void 0?F3:n,o=e.locale,C=e.onMouseLeave,a=Ui(g),r=new Date,i=Kn(r),s=fe(i),c=Pl(i),d=[],Z=1;Z<=7;Z+=1){var G=new Date(s,c,Z-cC(i,a)),y=I(o,G);d.push(D.createElement("div",{key:Z,className:WC(Wc,$3(G)&&"".concat(Wc,"--current"),_V(G,a)&&"".concat(Wc,"--weekend"))},D.createElement("abbr",{"aria-label":y,title:y},l(o,G).replace(".",""))))}return D.createElement(ym,{className:IW,count:7,onFocus:C,onMouseOver:C},d)}var $r=function(){return $r=Object.assign||function(e){for(var g,t=1,l=arguments.length;t<l;t++){g=arguments[t];for(var n in g)Object.prototype.hasOwnProperty.call(g,n)&&(e[n]=g[n])}return e},$r.apply(this,arguments)},Zh=function(e,g){var t={};for(var l in e)Object.prototype.hasOwnProperty.call(e,l)&&g.indexOf(l)<0&&(t[l]=e[l]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,l=Object.getOwnPropertySymbols(e);n<l.length;n++)g.indexOf(l[n])<0&&Object.prototype.propertyIsEnumerable.call(e,l[n])&&(t[l[n]]=e[l[n]]);return t},hh="react-calendar__tile";function JF(e){var g=e.onClickWeekNumber,t=e.weekNumber,l=D.createElement("span",null,t);if(g){var n=e.date,I=e.onClickWeekNumber,o=e.weekNumber,C=Zh(e,["date","onClickWeekNumber","weekNumber"]);return D.createElement("button",$r({},C,{className:hh,onClick:function(a){return I(o,n,a)},type:"button"}),l)}else{e.date,e.onClickWeekNumber,e.weekNumber;var C=Zh(e,["date","onClickWeekNumber","weekNumber"]);return D.createElement("div",$r({},C,{className:hh}),l)}}function YF(e){var g=e.activeStartDate,t=e.calendarType,l=e.onClickWeekNumber,n=e.onMouseLeave,I=e.showFixedNumberOfWeeks,o=Ui(t),C=function(){if(I)return 6;var i=QV(g),s=cC(g,o),c=i-(7-s);return 1+Math.ceil(c/7)}(),a=function(){for(var i=fe(g),s=Pl(g),c=Mi(g),d=[],Z=0;Z<C;Z+=1)d.push(iu(new Date(i,s,c+Z*7),o));return d}(),r=a.map(function(i){return z3(i,o)});return D.createElement(ym,{className:"react-calendar__month-view__weekNumbers",count:C,direction:"column",onFocus:n,onMouseOver:n,style:{flexBasis:"calc(100% * (1 / 8)",flexShrink:0}},r.map(function(i,s){var c=a[s];if(!c)throw new Error("date is not defined");return D.createElement(JF,{key:i,date:c,onClickWeekNumber:l,weekNumber:i})}))}var mC=function(){return mC=Object.assign||function(e){for(var g,t=1,l=arguments.length;t<l;t++){g=arguments[t];for(var n in g)Object.prototype.hasOwnProperty.call(g,n)&&(e[n]=g[n])}return e},mC.apply(this,arguments)},wF=function(e,g){var t={};for(var l in e)Object.prototype.hasOwnProperty.call(e,l)&&g.indexOf(l)<0&&(t[l]=e[l]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,l=Object.getOwnPropertySymbols(e);n<l.length;n++)g.indexOf(l[n])<0&&Object.prototype.propertyIsEnumerable.call(e,l[n])&&(t[l[n]]=e[l[n]]);return t};function HF(e){if(e)for(var g=0,t=Object.entries(f3);g<t.length;g++){var l=t[g],n=l[0],I=l[1];if(I.includes(e))return n}return he.ISO_8601}var oW=function(g){var t=g.activeStartDate,l=g.locale,n=g.onMouseLeave,I=g.showFixedNumberOfWeeks,o=g.calendarType,C=o===void 0?HF(l):o,a=g.formatShortWeekday,r=g.formatWeekday,i=g.onClickWeekNumber,s=g.showWeekNumbers,c=wF(g,["calendarType","formatShortWeekday","formatWeekday","onClickWeekNumber","showWeekNumbers"]);function d(){return D.createElement(kF,{calendarType:C,formatShortWeekday:a,formatWeekday:r,locale:l,onMouseLeave:n})}function Z(){return s?D.createElement(YF,{activeStartDate:t,calendarType:C,onClickWeekNumber:i,onMouseLeave:n,showFixedNumberOfWeeks:I}):null}function G(){return D.createElement(XF,mC({calendarType:C},c))}var y="react-calendar__month-view";return D.createElement("div",{className:WC(y,s?"".concat(y,"--weekNumbers"):"")},D.createElement("div",{style:{display:"flex",alignItems:"flex-end"}},Z(),D.createElement("div",{style:{flexGrow:1,width:"100%"}},d(),G())))};oW.propTypes=mC(mC({},Pi),{calendarType:gW,formatDay:w.func,formatLongDate:w.func,formatShortWeekday:w.func,formatWeekday:w.func,onClickWeekNumber:w.func,onMouseLeave:w.func,showFixedNumberOfWeeks:w.bool,showNeighboringMonth:w.bool,showWeekNumbers:w.bool});const NF=oW;var yI=function(){return yI=Object.assign||function(e){for(var g,t=1,l=arguments.length;t<l;t++){g=arguments[t];for(var n in g)Object.prototype.hasOwnProperty.call(g,n)&&(e[n]=g[n])}return e},yI.apply(this,arguments)},Xa="react-calendar",RI=["century","decade","year","month"],KF=["decade","year","month","day"],Sm=new Date;Sm.setFullYear(1,0,1);Sm.setHours(0,0,0,0);var FF=new Date(864e13);function So(e){return e instanceof Date?e:new Date(e)}function CW(e,g){return RI.slice(RI.indexOf(e),RI.indexOf(g)+1)}function xF(e,g,t){var l=CW(g,t);return l.indexOf(e)!==-1}function Vm(e,g,t){return e&&xF(e,g,t)?e:t}function aW(e){var g=RI.indexOf(e);return KF[g]}function EF(e,g){var t=Array.isArray(e)?e[g]:e;if(!t)return null;var l=So(t);if(isNaN(l.getTime()))throw new Error("Invalid date: ".concat(e));return l}function rW(e,g){var t=e.value,l=e.minDate,n=e.maxDate,I=e.maxDetail,o=EF(t,g);if(!o)return null;var C=aW(I),a=function(){switch(g){case 0:return Gn(C,o);case 1:return OV(C,o);default:throw new Error("Invalid index value: ".concat(g))}}();return lF(a,l,n)}var Wm=function(e){return rW(e,0)},iW=function(e){return rW(e,1)},DF=function(e){return[Wm,iW].map(function(g){return g(e)})};function sW(e){var g=e.maxDate,t=e.maxDetail,l=e.minDate,n=e.minDetail,I=e.value,o=e.view,C=Vm(o,n,t),a=Wm({value:I,minDate:l,maxDate:g,maxDetail:t})||new Date;return Gn(C,a)}function MF(e){var g=e.activeStartDate,t=e.defaultActiveStartDate,l=e.defaultValue,n=e.defaultView,I=e.maxDate,o=e.maxDetail,C=e.minDate,a=e.minDetail,r=e.value,i=e.view,s=Vm(i,a,o),c=g||t;return c?Gn(s,c):sW({maxDate:I,maxDetail:o,minDate:C,minDetail:a,value:r||l,view:i||n})}function vc(e){return e&&(!Array.isArray(e)||e.length===1)}function ka(e,g){return e instanceof Date&&g instanceof Date&&e.getTime()===g.getTime()}var cW=u.forwardRef(function(g,t){var l=g.activeStartDate,n=g.allowPartialRange,I=g.calendarType,o=g.className,C=g.defaultActiveStartDate,a=g.defaultValue,r=g.defaultView,i=g.formatDay,s=g.formatLongDate,c=g.formatMonth,d=g.formatMonthYear,Z=g.formatShortWeekday,G=g.formatWeekday,y=g.formatYear,p=g.goToRangeStartOnSelect,h=p===void 0?!0:p,b=g.inputRef,B=g.locale,S=g.maxDate,X=S===void 0?FF:S,k=g.maxDetail,m=k===void 0?"month":k,v=g.minDate,R=v===void 0?Sm:v,W=g.minDetail,J=W===void 0?"century":W,f=g.navigationAriaLabel,V=g.navigationAriaLive,K=g.navigationLabel,x=g.next2AriaLabel,Y=g.next2Label,N=g.nextAriaLabel,F=g.nextLabel,H=g.onActiveStartDateChange,E=g.onChange,z=g.onClickDay,U=g.onClickDecade,j=g.onClickMonth,ge=g.onClickWeekNumber,$=g.onClickYear,ae=g.onDrillDown,Je=g.onDrillUp,oe=g.onViewChange,Q=g.prev2AriaLabel,re=g.prev2Label,Se=g.prevAriaLabel,Ue=g.prevLabel,ee=g.returnValue,Ye=ee===void 0?"start":ee,ie=g.selectRange,pg=g.showDoubleView,og=g.showFixedNumberOfWeeks,Ne=g.showNavigation,xn=Ne===void 0?!0:Ne,ql=g.showNeighboringCentury,En=g.showNeighboringDecade,Dn=g.showNeighboringMonth,al=Dn===void 0?!0:Dn,nt=g.showWeekNumbers,It=g.tileClassName,as=g.tileContent,rs=g.tileDisabled,Ge=g.value,xC=g.view,EC=u.useState(C),is=EC[0],Mn=EC[1],DC=u.useState(null),ss=DC[0],MC=DC[1],zC=u.useState(Array.isArray(a)?a.map(function(te){return te!==null?So(te):null}):a!=null?So(a):null),_I=zC[0],cs=zC[1],q=u.useState(r),_l=q[0],Ym=q[1],Gg=l||is||MF({activeStartDate:l,defaultActiveStartDate:C,defaultValue:a,defaultView:r,maxDate:X,maxDetail:m,minDate:R,minDetail:J,value:Ge,view:xC}),yg=function(){var te=function(){return ie&&vc(_I)?_I:Ge!==void 0?Ge:_I}();return te?Array.isArray(te)?te.map(function(we){return we!==null?So(we):null}):te!==null?So(te):null:null}(),TC=aW(m),Ve=Vm(xC||_l,J,m),Gt=CW(J,m),kW=ie?ss:null,ds=Gt.indexOf(Ve)<Gt.length-1,wm=Gt.indexOf(Ve)>0,Hm=u.useCallback(function(te){var we=function(){switch(Ye){case"start":return Wm;case"end":return iW;case"range":return DF;default:throw new Error("Invalid returnValue.")}}();return we({maxDate:X,maxDetail:m,minDate:R,value:te})},[X,m,R,Ye]),us=u.useCallback(function(te,we){Mn(te);var Ee={action:we,activeStartDate:te,value:yg,view:Ve};H&&!ka(Gg,te)&&H(Ee)},[Gg,H,yg,Ve]),LC=u.useCallback(function(te,we){var Ee=function(){switch(Ve){case"century":return U;case"decade":return $;case"year":return j;case"month":return z;default:throw new Error("Invalid view: ".concat(Ve,"."))}}();Ee&&Ee(te,we)},[z,U,j,$,Ve]),As=u.useCallback(function(te,we){if(ds){LC(te,we);var Ee=Gt[Gt.indexOf(Ve)+1];if(!Ee)throw new Error("Attempted to drill down from the lowest view.");Mn(te),Ym(Ee);var ot={action:"drillDown",activeStartDate:te,value:yg,view:Ee};H&&!ka(Gg,te)&&H(ot),oe&&Ve!==Ee&&oe(ot),ae&&ae(ot)}},[Gg,ds,H,LC,ae,oe,yg,Ve,Gt]),ms=u.useCallback(function(){if(wm){var te=Gt[Gt.indexOf(Ve)-1];if(!te)throw new Error("Attempted to drill up from the highest view.");var we=Gn(te,Gg);Mn(we),Ym(te);var Ee={action:"drillUp",activeStartDate:we,value:yg,view:te};H&&!ka(Gg,we)&&H(Ee),oe&&Ve!==te&&oe(Ee),Je&&Je(Ee)}},[Gg,wm,H,Je,oe,yg,Ve,Gt]),bs=u.useCallback(function(te,we){var Ee=yg;LC(te,we);var ot=ie&&!vc(Ee),Ct;if(ie)if(ot)Ct=Gn(TC,te);else{if(!Ee)throw new Error("previousValue is required");if(Array.isArray(Ee))throw new Error("previousValue must not be an array");Ct=P3(TC,Ee,te)}else Ct=Hm(te);var hs=!ie||ot||h?sW({maxDate:X,maxDetail:m,minDate:R,minDetail:J,value:Ct,view:Ve}):null;we.persist(),Mn(hs),cs(Ct);var HW={action:"onChange",activeStartDate:hs,value:Ct,view:Ve};if(H&&!ka(Gg,hs)&&H(HW),E)if(ie){var NW=vc(Ct);if(!NW)E(Ct||null,we);else if(n){if(Array.isArray(Ct))throw new Error("value must not be an array");E([Ct||null,null],we)}}else E(Ct||null,we)},[Gg,n,Hm,h,X,m,R,J,H,E,LC,ie,yg,TC,Ve]);function JW(te){MC(te)}function Zs(){MC(null)}u.useImperativeHandle(t,function(){return{activeStartDate:Gg,drillDown:As,drillUp:ms,onChange:bs,setActiveStartDate:us,value:yg,view:Ve}},[Gg,As,ms,bs,us,yg,Ve]);function Nm(te){var we=te?PV(Ve,Gg):Gn(Ve,Gg),Ee=ds?As:bs,ot={activeStartDate:we,hover:kW,locale:B,maxDate:X,minDate:R,onClick:Ee,onMouseOver:ie?JW:void 0,tileClassName:It,tileContent:as,tileDisabled:rs,value:yg,valueType:TC};switch(Ve){case"century":return D.createElement(ZF,yI({formatYear:y,showNeighboringCentury:ql},ot));case"decade":return D.createElement(yF,yI({formatYear:y,showNeighboringDecade:En},ot));case"year":return D.createElement(WF,yI({formatMonth:c,formatMonthYear:d},ot));case"month":return D.createElement(NF,yI({calendarType:I,formatDay:i,formatLongDate:s,formatShortWeekday:Z,formatWeekday:G,onClickWeekNumber:ge,onMouseLeave:ie?Zs:void 0,showFixedNumberOfWeeks:typeof og<"u"?og:pg,showNeighboringMonth:al,showWeekNumbers:nt},ot));default:throw new Error("Invalid view: ".concat(Ve,"."))}}function YW(){return xn?D.createElement(q3,{activeStartDate:Gg,drillUp:ms,formatMonthYear:d,formatYear:y,locale:B,maxDate:X,minDate:R,navigationAriaLabel:f,navigationAriaLive:V,navigationLabel:K,next2AriaLabel:x,next2Label:Y,nextAriaLabel:N,nextLabel:F,prev2AriaLabel:Q,prev2Label:re,prevAriaLabel:Se,prevLabel:Ue,setActiveStartDate:us,showDoubleView:pg,view:Ve,views:Gt}):null}var wW=Array.isArray(yg)?yg:[yg];return D.createElement("div",{className:WC(Xa,ie&&wW.length===1&&"".concat(Xa,"--selectRange"),pg&&"".concat(Xa,"--doubleView"),o),ref:b},YW(),D.createElement("div",{className:"".concat(Xa,"__viewContainer"),onBlur:ie?Zs:void 0,onMouseLeave:ie?Zs:void 0},Nm(),pg?Nm(!0):null))}),ph=w.instanceOf(Date),Gh=w.oneOfType([w.string,w.instanceOf(Date)]),yh=w.oneOfType([Gh,bF(Gh)]);cW.propTypes={activeStartDate:ph,allowPartialRange:w.bool,calendarType:gW,className:jr,defaultActiveStartDate:ph,defaultValue:yh,defaultView:Pr,formatDay:w.func,formatLongDate:w.func,formatMonth:w.func,formatMonthYear:w.func,formatShortWeekday:w.func,formatWeekday:w.func,formatYear:w.func,goToRangeStartOnSelect:w.bool,inputRef:uF,locale:w.string,maxDate:fm,maxDetail:w.oneOf(RI),minDate:Bm,minDetail:w.oneOf(RI),navigationAriaLabel:w.string,navigationAriaLive:w.oneOf(["off","polite","assertive"]),navigationLabel:w.func,next2AriaLabel:w.string,next2Label:w.node,nextAriaLabel:w.string,nextLabel:w.node,onActiveStartDateChange:w.func,onChange:w.func,onClickDay:w.func,onClickDecade:w.func,onClickMonth:w.func,onClickWeekNumber:w.func,onClickYear:w.func,onDrillDown:w.func,onDrillUp:w.func,onViewChange:w.func,prev2AriaLabel:w.string,prev2Label:w.node,prevAriaLabel:w.string,prevLabel:w.node,returnValue:w.oneOf(["start","end","range"]),selectRange:w.bool,showDoubleView:w.bool,showFixedNumberOfWeeks:w.bool,showNavigation:w.bool,showNeighboringCentury:w.bool,showNeighboringDecade:w.bool,showNeighboringMonth:w.bool,showWeekNumbers:w.bool,tileClassName:w.oneOfType([w.func,jr]),tileContent:w.oneOfType([w.func,w.node]),tileDisabled:w.func,value:yh,view:Pr};const dW=cW,zF=({isOpen:e,onClose:g,user:t,onSubmit:l})=>{const[n,I]=u.useState({id:t?t.id:null,roll_number:t?t.roll_number:"",name:t?t.name:"",email:t?t.email:"",status:t?t.status:""});u.useEffect(()=>{I(t?{id:t.id,roll_number:t.roll_number,name:t.name,email:t.email,status:t.status}:{id:null,roll_number:"",name:"",email:"",status:""})},[t]);const o=a=>{const{name:r,value:i}=a.target;I(s=>({...s,[r]:i}))},C=()=>{l(n)};return A.jsxs(va,{open:e,onClose:g,children:[A.jsx(va.Header,{children:"Manage Attendance"}),A.jsx(va.Content,{children:A.jsxs("div",{className:"flex flex-col gap-4",children:[A.jsx(Wa,{label:"Roll Number",name:"roll_number",value:n.roll_number,onChange:o}),A.jsx(Wa,{label:"Name",name:"name",value:n.name,onChange:o}),A.jsx(Wa,{label:"Email",name:"email",value:n.email,onChange:o}),A.jsx(Wa,{label:"Status",name:"status",value:n.status,onChange:o})]})}),A.jsxs(va.Footer,{children:[A.jsx(Q0,{onClick:g,auto:!0,children:"Cancel"}),A.jsx(Q0,{onClick:C,auto:!0,children:"Save"})]})]})},TF=()=>{const[e,g]=u.useState(!0),[t,l]=u.useState([]),[n,I]=u.useState(new Date),[o,C]=u.useState(1),[a,r]=u.useState(!1),[i,s]=u.useState(null),c=10,d=n.getFullYear(),Z=String(n.getMonth()+1).padStart(2,"0"),G=String(n.getDate()).padStart(2,"0"),y=[d,Z,G].join("-"),p=Math.ceil(t.length/c),h=u.useMemo(()=>{const S=(o-1)*c,X=S+c;return t.slice(S,X)},[o,t]),b=async()=>{try{const S=await hK(y);l(S),g(!1)}catch(S){console.error("Error fetching table data:",S),g(!1)}};u.useEffect(()=>{g(!0),l([]),b()},[n]);const B=async S=>{try{const{email:X}=S,k=Date.now();await VK({qr_code_data:`${X}_${k}`,latitude:"37.7749",longitude:"-122.4194"}),b()}catch(X){console.error("Error marking attendance:",X)}};return A.jsxs("div",{className:"w-full flex-col-reverse gap-y-5 md:flex-row flex md:justify-between items-start",children:[A.jsx("div",{className:"w-full md:w-[calc(100% - 290px)] lg:w-[calc(100% - 400px)] flex-center flex-col gap-10",children:A.jsxs(Ni,{"aria-label":"Attendance table with client side pagination",isStriped:!0,bottomContent:A.jsx("div",{className:"flex w-full justify-center",children:A.jsx(Yi,{isCompact:!0,showControls:!0,showShadow:!0,page:o,total:p,onChange:S=>C(S),classNames:{cursor:"bg-primary-black shadow-none"}})}),classNames:{base:"",wrapper:"min-h-[222px] bg-white shadow-lg rounded-md",th:"bg-primary-black text-primary-white rounded-none"},children:[A.jsxs(xi,{children:[A.jsx(mg,{children:"Roll No."},"roll_number"),A.jsx(mg,{children:"Name"},"name"),A.jsx(mg,{children:"Email"},"email"),A.jsx(mg,{children:"Status"},"status"),A.jsx(mg,{children:"Actions"},"actions")]}),A.jsx(Fi,{emptyContent:e?"Searching...":"No Attendance Data Found!",items:h,children:S=>A.jsxs(Ki,{children:[A.jsx(Bl,{children:S.roll_number}),A.jsx(Bl,{children:S.name}),A.jsx(Bl,{children:S.email}),A.jsx(Bl,{children:S.status}),A.jsx(Bl,{children:A.jsx("button",{onClick:()=>B(S),children:"Mark Attendance"})})]},S.roll_number)})]})}),A.jsx("div",{id:"calendar",className:"w-full flex-center md:w-[280px] lg:w-[350px]",children:A.jsx(dW,{onChange:I,value:n})}),a&&A.jsx(zF,{isOpen:a,onClose:()=>r(!1),user:i,onSubmit:B})]})},LF=()=>{const[e,g]=u.useState(),[t,l]=u.useState(!0),[n,I]=u.useState([]),[o,C]=u.useState([]),[a,r]=u.useState(1),[i,s]=u.useState(!1),[c,d]=u.useState(!1),Z=10,G=Math.ceil(n.length/Z),y=async()=>{const X=(await pK()).map(k=>({...k,status:k.attendance?"Present":"Absent"}));I(X),l(!1)},p=async()=>{o.length!=0&&o.size!=0?(s(!0),g(await nh(o.currentKey,"POST"))):et.error("Select a row in Table"),s(!1)},h=async()=>{o.length!=0&&o.size!=0?(d(!0),g(await nh(o.currentKey,"DELETE"))):et.error("Select a row in Table"),d(!1)},b=async S=>{const X=n.map(k=>(k.email===S&&(k.attendance=!0,k.status="Present"),k));I(X),await SK(S)},B=u.useMemo(()=>{const S=(a-1)*Z,X=S+Z;return n.slice(S,X)},[a,n]);return u.useEffect(()=>{y(),s(!1),d(!1)},[e]),A.jsxs("div",{className:"w-full flex-col-reverse gap-y-5 md:flex-row flex md:justify-between  items-start",children:[A.jsx("div",{className:"w-full md:w-[calc(100%-220px)] lg:w-[calc(100%-270px)] flex-center flex-col gap-8",children:A.jsxs(Ni,{"aria-label":"Example table with client side pagination",selectionMode:"single",selectedKeys:o,onSelectionChange:C,bottomContent:A.jsx("div",{className:"flex w-full justify-center",children:A.jsx(Yi,{isCompact:!0,showControls:!0,showShadow:!0,page:a,total:G,onChange:S=>r(S),classNames:{cursor:"bg-primary-black shadow-none"}})}),classNames:{base:"",wrapper:"min-h-[250px] bg-white shadow-lg rounded-md",th:"bg-primary-black text-primary-white rounded-none",td:"data-[selected=true]:before:bg-blue-400 data-[selected=true]:text-primary-white cursor-pointer "},children:[A.jsxs(xi,{children:[A.jsx(mg,{children:"NAME"},"name"),A.jsx(mg,{children:"EMAIL"},"email"),A.jsx(mg,{children:"MOBILE NO."},"mobile_number"),A.jsx(mg,{children:"STATUS"},"status")," "]}),A.jsx(Fi,{emptyContent:t?"Loading...":"No Pending Requests Found",items:B,children:S=>A.jsx(Ki,{children:X=>A.jsx(Bl,{children:X==="status"?A.jsx("span",{children:S.status}):A.jsx("span",{children:qy(S,X)})})},S.email)})]})}),A.jsxs("div",{className:"w-full bg-white rounded-md shadow-md flex-center md:flex-col p-4 gap-3 md:w-[200px] lg:w-[250px]",children:[A.jsx("h1",{className:"hidden md:block text-lg font-semibold",children:"Action Centre"}),A.jsx("button",{disabled:i||c,onClick:p,className:"md:w-full bg-green-400 px-5 py-2 rounded-md text-white font-medium border-2 border-transparent hover:border-green-400 hover:bg-transparent hover:text-green-400",children:i?"Approving...":"Approve"}),A.jsx("button",{disabled:c||i,onClick:h,className:"md:w-full bg-transparent text-red-400 border-2 border-red-400 px-5 py-2 rounded-md font-medium hover:bg-red-400 hover:text-white transition-effect",children:c?"Deleting...":"Delete"}),A.jsx("button",{onClick:()=>b(o.email),className:"md:w-full bg-blue-400 px-5 py-2 rounded-md text-white font-medium border-2 border-transparent hover:border-blue-400 hover:bg-transparent hover:text-blue-400",children:"Mark Attendance"})]})]})},UF=()=>{const[e,g]=u.useState(!0),[t,l]=u.useState(0),[n,I]=u.useState(0),[o,C]=u.useState(!0),[a,r]=u.useState(!1),[i,s]=u.useState(!1),[c,d]=u.useState({admin:"",email:"",totalStudents:"",presentStudents:"",absentStudents:""});u.useState(null);const Z=()=>{s(!1),C(!0),r(!1)},G=()=>{s(!1),C(!1),r(!0)},y=()=>{s(!0),C(!1),r(!1)};u.useEffect(()=>{p()},[]),u.useEffect(()=>{if(c.totalStudents&&c.presentStudents){const b=c.totalStudents,S=c.presentStudents/b*100,X=100-S;l(S),I(X)}},[c.totalStudents,c.presentStudents]);const p=async()=>{try{const b=await ZK();d({admin:(b==null?void 0:b.admin_name)||"",email:(b==null?void 0:b.admin_email)||"",totalStudents:(b==null?void 0:b.total_students)||"",presentStudents:(b==null?void 0:b.present_students)||"",absentStudents:(b==null?void 0:b.absent_students)||""}),g(!1)}catch(b){console.error("API request failed:",b),g(!1)}};let h;return a?h=A.jsx(TF,{}):i?h=A.jsx(LF,{}):h=A.jsx(WK,{}),A.jsxs("section",{className:"w-full px-2 mt-24 md:mt-28",children:[A.jsx(cm,{role:"admin",name:c.admin,email:c.email}),A.jsxs("section",{className:"panel_section flex flex-col items-center md:items-stretch md:flex-row gap-8 md:gap-4 md:justify-between flex-wrap",children:[A.jsx("div",{className:"hidden md:block w-full md:w-[200px] lg:w-[300px]",children:A.jsx(vV,{})}),A.jsxs("div",{className:"w-full md:w-[calc(100%-250px)] lg:w-[calc(100%-400px)] flex flex-col gap-4 lg:gap-10 justify-between",children:[A.jsxs("div",{className:"flex items-center justify-between",children:[A.jsx(pn,{loading:e,title:"Total Students",value:c.totalStudents}),A.jsx(pn,{loading:e,title:"Total Present",value:c.presentStudents}),A.jsx(pn,{loading:e,title:"Total Absent",value:c.absentStudents})]}),A.jsxs("div",{children:[A.jsx("h1",{className:"mb-4 text-xl font-medium",children:"Quick Access Links"}),A.jsxs("div",{className:"flex max-sm:flex-wrap max-sm:justify-center gap-2 items-center justify-between",children:[A.jsx("button",{onClick:Z,className:o?"toggle_btn":"toggle_btn_bordered",children:"Manage Students"}),A.jsx("button",{value:"attendance-section",onClick:G,className:a?"toggle_btn":"toggle_btn_bordered",children:"Manage Attendance"}),A.jsx("button",{value:"attendance-section",onClick:y,className:i?"toggle_btn":"toggle_btn_bordered",children:"Pending Approvals"})]})]})]})]}),A.jsxs("section",{className:"panel_section",children:[t!==null&&n!==null&&A.jsxs("div",{className:"flex flex-col items-center justify-center bg-gray-100 p-8 rounded-lg shadow-md",children:[A.jsx("h1",{className:"text-xl font-semibold mb-4",children:"Statistiques de présence"}),A.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[A.jsxs("div",{children:[A.jsx("h2",{className:"text-lg font-medium",children:"Pourcentage de présence :"}),A.jsxs("p",{className:"text-2xl text-green-600",children:[t,"%"]})]}),A.jsxs("div",{children:[A.jsx("h2",{className:"text-lg font-medium",children:"Pourcentage d'absence :"}),A.jsxs("p",{className:"text-2xl text-red-600",children:[n,"'%"]})]})]})]}),h]})]})},QF=()=>{const[e,g]=u.useState(!0),[t,l]=u.useState(new Date),[n,I]=u.useState(1),[o,C]=u.useState([]),a=10,r=t.getFullYear(),i=String(t.getMonth()+1).padStart(2,"0"),s=String(t.getDate()).padStart(2,"0"),c=[r,i,s].join("-"),d=Math.ceil(o.length/a),Z=u.useMemo(()=>{const y=(n-1)*a,p=y+a;return o.slice(y,p)},[n,o]),G=async()=>{try{const y=await fK(c);C([y]),g(!1)}catch(y){console.error("Error fetching attendance data:",y)}};return u.useEffect(()=>{g(!0),C([]),G()},[t]),A.jsxs("div",{className:"w-full flex-col-reverse gap-y-5 md:flex-row flex md:justify-between items-start",children:[A.jsx("div",{className:"w-full md:w-[calc(100%-400px)] lg:w-[calc(100%-400px)] flex-center flex-col",children:A.jsxs(Ni,{"aria-label":"Example table with client side pagination",bottomContent:A.jsx("div",{className:"flex w-full justify-center",children:A.jsx(Yi,{isCompact:!0,showControls:!0,showShadow:!0,page:n,total:d,onChange:y=>I(y),classNames:{cursor:"bg-primary-black shadow-none"}})}),classNames:{wrapper:"min-h-[222px] bg-white shadow-lg rounded-md",th:"bg-primary-black text-primary-white rounded-none"},children:[A.jsxs(xi,{children:[A.jsx(mg,{children:"Date"},"requested_date"),A.jsx(mg,{children:"Status"},"attendance_status")]}),A.jsx(Fi,{emptyContent:e?"Loading...":"No Attendance Record Found",items:Z,children:y=>A.jsx(Ki,{children:p=>A.jsx(Bl,{children:y[p]})},y.requested_date)})]})}),A.jsx("div",{id:"calendar",className:"w-full flex-center md:justify-end md:w-[300px] lg:w-[350px]",children:A.jsx(dW,{onChange:l,value:t})})]})};var Oi={},uW={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8},jF=uW;function AW(e){this.mode=jF.MODE_8BIT_BYTE,this.data=e}AW.prototype={getLength:function(e){return this.data.length},write:function(e){for(var g=0;g<this.data.length;g++)e.put(this.data.charCodeAt(g),8)}};var PF=AW,mW={L:1,M:0,Q:3,H:2},Ja=mW;function Vt(e,g){this.totalCount=e,this.dataCount=g}Vt.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]];Vt.getRSBlocks=function(e,g){var t=Vt.getRsBlockTable(e,g);if(t==null)throw new Error("bad rs block @ typeNumber:"+e+"/errorCorrectLevel:"+g);for(var l=t.length/3,n=new Array,I=0;I<l;I++)for(var o=t[I*3+0],C=t[I*3+1],a=t[I*3+2],r=0;r<o;r++)n.push(new Vt(C,a));return n};Vt.getRsBlockTable=function(e,g){switch(g){case Ja.L:return Vt.RS_BLOCK_TABLE[(e-1)*4+0];case Ja.M:return Vt.RS_BLOCK_TABLE[(e-1)*4+1];case Ja.Q:return Vt.RS_BLOCK_TABLE[(e-1)*4+2];case Ja.H:return Vt.RS_BLOCK_TABLE[(e-1)*4+3];default:return}};var OF=Vt;function bW(){this.buffer=new Array,this.length=0}bW.prototype={get:function(e){var g=Math.floor(e/8);return(this.buffer[g]>>>7-e%8&1)==1},put:function(e,g){for(var t=0;t<g;t++)this.putBit((e>>>g-t-1&1)==1)},getLengthInBits:function(){return this.length},putBit:function(e){var g=Math.floor(this.length/8);this.buffer.length<=g&&this.buffer.push(0),e&&(this.buffer[g]|=128>>>this.length%8),this.length++}};var $F=bW,At={glog:function(e){if(e<1)throw new Error("glog("+e+")");return At.LOG_TABLE[e]},gexp:function(e){for(;e<0;)e+=255;for(;e>=256;)e-=255;return At.EXP_TABLE[e]},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)};for(var lg=0;lg<8;lg++)At.EXP_TABLE[lg]=1<<lg;for(var lg=8;lg<256;lg++)At.EXP_TABLE[lg]=At.EXP_TABLE[lg-4]^At.EXP_TABLE[lg-5]^At.EXP_TABLE[lg-6]^At.EXP_TABLE[lg-8];for(var lg=0;lg<255;lg++)At.LOG_TABLE[At.EXP_TABLE[lg]]=lg;var ZW=At,tn=ZW;function er(e,g){if(e.length==null)throw new Error(e.length+"/"+g);for(var t=0;t<e.length&&e[t]==0;)t++;this.num=new Array(e.length-t+g);for(var l=0;l<e.length-t;l++)this.num[l]=e[l+t]}er.prototype={get:function(e){return this.num[e]},getLength:function(){return this.num.length},multiply:function(e){for(var g=new Array(this.getLength()+e.getLength()-1),t=0;t<this.getLength();t++)for(var l=0;l<e.getLength();l++)g[t+l]^=tn.gexp(tn.glog(this.get(t))+tn.glog(e.get(l)));return new er(g,0)},mod:function(e){if(this.getLength()-e.getLength()<0)return this;for(var g=tn.glog(this.get(0))-tn.glog(e.get(0)),t=new Array(this.getLength()),l=0;l<this.getLength();l++)t[l]=this.get(l);for(var l=0;l<e.getLength();l++)t[l]^=tn.gexp(tn.glog(e.get(l))+g);return new er(t,0).mod(e)}};var hW=er,Tg=uW,Bh=hW,qF=ZW,cl={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7},gg={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(e){for(var g=e<<10;gg.getBCHDigit(g)-gg.getBCHDigit(gg.G15)>=0;)g^=gg.G15<<gg.getBCHDigit(g)-gg.getBCHDigit(gg.G15);return(e<<10|g)^gg.G15_MASK},getBCHTypeNumber:function(e){for(var g=e<<12;gg.getBCHDigit(g)-gg.getBCHDigit(gg.G18)>=0;)g^=gg.G18<<gg.getBCHDigit(g)-gg.getBCHDigit(gg.G18);return e<<12|g},getBCHDigit:function(e){for(var g=0;e!=0;)g++,e>>>=1;return g},getPatternPosition:function(e){return gg.PATTERN_POSITION_TABLE[e-1]},getMask:function(e,g,t){switch(e){case cl.PATTERN000:return(g+t)%2==0;case cl.PATTERN001:return g%2==0;case cl.PATTERN010:return t%3==0;case cl.PATTERN011:return(g+t)%3==0;case cl.PATTERN100:return(Math.floor(g/2)+Math.floor(t/3))%2==0;case cl.PATTERN101:return g*t%2+g*t%3==0;case cl.PATTERN110:return(g*t%2+g*t%3)%2==0;case cl.PATTERN111:return(g*t%3+(g+t)%2)%2==0;default:throw new Error("bad maskPattern:"+e)}},getErrorCorrectPolynomial:function(e){for(var g=new Bh([1],0),t=0;t<e;t++)g=g.multiply(new Bh([1,qF.gexp(t)],0));return g},getLengthInBits:function(e,g){if(1<=g&&g<10)switch(e){case Tg.MODE_NUMBER:return 10;case Tg.MODE_ALPHA_NUM:return 9;case Tg.MODE_8BIT_BYTE:return 8;case Tg.MODE_KANJI:return 8;default:throw new Error("mode:"+e)}else if(g<27)switch(e){case Tg.MODE_NUMBER:return 12;case Tg.MODE_ALPHA_NUM:return 11;case Tg.MODE_8BIT_BYTE:return 16;case Tg.MODE_KANJI:return 10;default:throw new Error("mode:"+e)}else if(g<41)switch(e){case Tg.MODE_NUMBER:return 14;case Tg.MODE_ALPHA_NUM:return 13;case Tg.MODE_8BIT_BYTE:return 16;case Tg.MODE_KANJI:return 12;default:throw new Error("mode:"+e)}else throw new Error("type:"+g)},getLostPoint:function(e){for(var g=e.getModuleCount(),t=0,l=0;l<g;l++)for(var n=0;n<g;n++){for(var I=0,o=e.isDark(l,n),C=-1;C<=1;C++)if(!(l+C<0||g<=l+C))for(var a=-1;a<=1;a++)n+a<0||g<=n+a||C==0&&a==0||o==e.isDark(l+C,n+a)&&I++;I>5&&(t+=3+I-5)}for(var l=0;l<g-1;l++)for(var n=0;n<g-1;n++){var r=0;e.isDark(l,n)&&r++,e.isDark(l+1,n)&&r++,e.isDark(l,n+1)&&r++,e.isDark(l+1,n+1)&&r++,(r==0||r==4)&&(t+=3)}for(var l=0;l<g;l++)for(var n=0;n<g-6;n++)e.isDark(l,n)&&!e.isDark(l,n+1)&&e.isDark(l,n+2)&&e.isDark(l,n+3)&&e.isDark(l,n+4)&&!e.isDark(l,n+5)&&e.isDark(l,n+6)&&(t+=40);for(var n=0;n<g;n++)for(var l=0;l<g-6;l++)e.isDark(l,n)&&!e.isDark(l+1,n)&&e.isDark(l+2,n)&&e.isDark(l+3,n)&&e.isDark(l+4,n)&&!e.isDark(l+5,n)&&e.isDark(l+6,n)&&(t+=40);for(var i=0,n=0;n<g;n++)for(var l=0;l<g;l++)e.isDark(l,n)&&i++;var s=Math.abs(100*i/g/g-50)/5;return t+=s*10,t}},_F=gg,ex=PF,pW=OF,GW=$F,$l=_F,gx=hW;function Wt(e,g){this.typeNumber=e,this.errorCorrectLevel=g,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}var Eg=Wt.prototype;Eg.addData=function(e){var g=new ex(e);this.dataList.push(g),this.dataCache=null};Eg.isDark=function(e,g){if(e<0||this.moduleCount<=e||g<0||this.moduleCount<=g)throw new Error(e+","+g);return this.modules[e][g]};Eg.getModuleCount=function(){return this.moduleCount};Eg.make=function(){if(this.typeNumber<1){var e=1;for(e=1;e<40;e++){for(var g=pW.getRSBlocks(e,this.errorCorrectLevel),t=new GW,l=0,n=0;n<g.length;n++)l+=g[n].dataCount;for(var n=0;n<this.dataList.length;n++){var I=this.dataList[n];t.put(I.mode,4),t.put(I.getLength(),$l.getLengthInBits(I.mode,e)),I.write(t)}if(t.getLengthInBits()<=l*8)break}this.typeNumber=e}this.makeImpl(!1,this.getBestMaskPattern())};Eg.makeImpl=function(e,g){this.moduleCount=this.typeNumber*4+17,this.modules=new Array(this.moduleCount);for(var t=0;t<this.moduleCount;t++){this.modules[t]=new Array(this.moduleCount);for(var l=0;l<this.moduleCount;l++)this.modules[t][l]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(e,g),this.typeNumber>=7&&this.setupTypeNumber(e),this.dataCache==null&&(this.dataCache=Wt.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,g)};Eg.setupPositionProbePattern=function(e,g){for(var t=-1;t<=7;t++)if(!(e+t<=-1||this.moduleCount<=e+t))for(var l=-1;l<=7;l++)g+l<=-1||this.moduleCount<=g+l||(0<=t&&t<=6&&(l==0||l==6)||0<=l&&l<=6&&(t==0||t==6)||2<=t&&t<=4&&2<=l&&l<=4?this.modules[e+t][g+l]=!0:this.modules[e+t][g+l]=!1)};Eg.getBestMaskPattern=function(){for(var e=0,g=0,t=0;t<8;t++){this.makeImpl(!0,t);var l=$l.getLostPoint(this);(t==0||e>l)&&(e=l,g=t)}return g};Eg.createMovieClip=function(e,g,t){var l=e.createEmptyMovieClip(g,t),n=1;this.make();for(var I=0;I<this.modules.length;I++)for(var o=I*n,C=0;C<this.modules[I].length;C++){var a=C*n,r=this.modules[I][C];r&&(l.beginFill(0,100),l.moveTo(a,o),l.lineTo(a+n,o),l.lineTo(a+n,o+n),l.lineTo(a,o+n),l.endFill())}return l};Eg.setupTimingPattern=function(){for(var e=8;e<this.moduleCount-8;e++)this.modules[e][6]==null&&(this.modules[e][6]=e%2==0);for(var g=8;g<this.moduleCount-8;g++)this.modules[6][g]==null&&(this.modules[6][g]=g%2==0)};Eg.setupPositionAdjustPattern=function(){for(var e=$l.getPatternPosition(this.typeNumber),g=0;g<e.length;g++)for(var t=0;t<e.length;t++){var l=e[g],n=e[t];if(this.modules[l][n]==null)for(var I=-2;I<=2;I++)for(var o=-2;o<=2;o++)I==-2||I==2||o==-2||o==2||I==0&&o==0?this.modules[l+I][n+o]=!0:this.modules[l+I][n+o]=!1}};Eg.setupTypeNumber=function(e){for(var g=$l.getBCHTypeNumber(this.typeNumber),t=0;t<18;t++){var l=!e&&(g>>t&1)==1;this.modules[Math.floor(t/3)][t%3+this.moduleCount-8-3]=l}for(var t=0;t<18;t++){var l=!e&&(g>>t&1)==1;this.modules[t%3+this.moduleCount-8-3][Math.floor(t/3)]=l}};Eg.setupTypeInfo=function(e,g){for(var t=this.errorCorrectLevel<<3|g,l=$l.getBCHTypeInfo(t),n=0;n<15;n++){var I=!e&&(l>>n&1)==1;n<6?this.modules[n][8]=I:n<8?this.modules[n+1][8]=I:this.modules[this.moduleCount-15+n][8]=I}for(var n=0;n<15;n++){var I=!e&&(l>>n&1)==1;n<8?this.modules[8][this.moduleCount-n-1]=I:n<9?this.modules[8][15-n-1+1]=I:this.modules[8][15-n-1]=I}this.modules[this.moduleCount-8][8]=!e};Eg.mapData=function(e,g){for(var t=-1,l=this.moduleCount-1,n=7,I=0,o=this.moduleCount-1;o>0;o-=2)for(o==6&&o--;;){for(var C=0;C<2;C++)if(this.modules[l][o-C]==null){var a=!1;I<e.length&&(a=(e[I]>>>n&1)==1);var r=$l.getMask(g,l,o-C);r&&(a=!a),this.modules[l][o-C]=a,n--,n==-1&&(I++,n=7)}if(l+=t,l<0||this.moduleCount<=l){l-=t,t=-t;break}}};Wt.PAD0=236;Wt.PAD1=17;Wt.createData=function(e,g,t){for(var l=pW.getRSBlocks(e,g),n=new GW,I=0;I<t.length;I++){var o=t[I];n.put(o.mode,4),n.put(o.getLength(),$l.getLengthInBits(o.mode,e)),o.write(n)}for(var C=0,I=0;I<l.length;I++)C+=l[I].dataCount;if(n.getLengthInBits()>C*8)throw new Error("code length overflow. ("+n.getLengthInBits()+">"+C*8+")");for(n.getLengthInBits()+4<=C*8&&n.put(0,4);n.getLengthInBits()%8!=0;)n.putBit(!1);for(;!(n.getLengthInBits()>=C*8||(n.put(Wt.PAD0,8),n.getLengthInBits()>=C*8));)n.put(Wt.PAD1,8);return Wt.createBytes(n,l)};Wt.createBytes=function(e,g){for(var t=0,l=0,n=0,I=new Array(g.length),o=new Array(g.length),C=0;C<g.length;C++){var a=g[C].dataCount,r=g[C].totalCount-a;l=Math.max(l,a),n=Math.max(n,r),I[C]=new Array(a);for(var i=0;i<I[C].length;i++)I[C][i]=255&e.buffer[i+t];t+=a;var s=$l.getErrorCorrectPolynomial(r),c=new gx(I[C],s.getLength()-1),d=c.mod(s);o[C]=new Array(s.getLength()-1);for(var i=0;i<o[C].length;i++){var Z=i+d.getLength()-o[C].length;o[C][i]=Z>=0?d.get(Z):0}}for(var G=0,i=0;i<g.length;i++)G+=g[i].totalCount;for(var y=new Array(G),p=0,i=0;i<l;i++)for(var C=0;C<g.length;C++)i<I[C].length&&(y[p++]=I[C][i]);for(var i=0;i<n;i++)for(var C=0;C<g.length;C++)i<o[C].length&&(y[p++]=o[C][i]);return y};var tx=Wt,vm={};Object.defineProperty(vm,"__esModule",{value:!0});var lx=Object.assign||function(e){for(var g=1;g<arguments.length;g++){var t=arguments[g];for(var l in t)Object.prototype.hasOwnProperty.call(t,l)&&(e[l]=t[l])}return e},nx=pA,Lg=BW(nx),yW=u,Ya=BW(yW);function BW(e){return e&&e.__esModule?e:{default:e}}function Ix(e,g){var t={};for(var l in e)g.indexOf(l)>=0||Object.prototype.hasOwnProperty.call(e,l)&&(t[l]=e[l]);return t}var ox={bgColor:Lg.default.oneOfType([Lg.default.object,Lg.default.string]).isRequired,bgD:Lg.default.string.isRequired,fgColor:Lg.default.oneOfType([Lg.default.object,Lg.default.string]).isRequired,fgD:Lg.default.string.isRequired,size:Lg.default.number.isRequired,title:Lg.default.string,viewBoxSize:Lg.default.number.isRequired,xmlns:Lg.default.string},Cx={title:void 0,xmlns:"http://www.w3.org/2000/svg"},$i=(0,yW.forwardRef)(function(e,g){var t=e.bgColor,l=e.bgD,n=e.fgD,I=e.fgColor,o=e.size,C=e.title,a=e.viewBoxSize,r=Ix(e,["bgColor","bgD","fgD","fgColor","size","title","viewBoxSize"]);return Ya.default.createElement("svg",lx({},r,{height:o,ref:g,viewBox:"0 0 "+a+" "+a,width:o}),C?Ya.default.createElement("title",null,C):null,Ya.default.createElement("path",{d:l,fill:t}),Ya.default.createElement("path",{d:n,fill:I}))});$i.displayName="QRCodeSvg";$i.propTypes=ox;$i.defaultProps=Cx;vm.default=$i;Object.defineProperty(Oi,"__esModule",{value:!0});Oi.QRCode=void 0;var ax=Object.assign||function(e){for(var g=1;g<arguments.length;g++){var t=arguments[g];for(var l in t)Object.prototype.hasOwnProperty.call(t,l)&&(e[l]=t[l])}return e},rx=tx,ix=KC(rx),sx=mW,cx=KC(sx),dx=pA,xt=KC(dx),fW=u,ux=KC(fW),Ax=vm,mx=KC(Ax);function KC(e){return e&&e.__esModule?e:{default:e}}function bx(e,g){var t={};for(var l in e)g.indexOf(l)>=0||Object.prototype.hasOwnProperty.call(e,l)&&(t[l]=e[l]);return t}var Zx={bgColor:xt.default.oneOfType([xt.default.object,xt.default.string]),fgColor:xt.default.oneOfType([xt.default.object,xt.default.string]),level:xt.default.string,size:xt.default.number,value:xt.default.string.isRequired},hx={bgColor:"#FFFFFF",fgColor:"#000000",level:"L",size:256},FC=(0,fW.forwardRef)(function(e,g){var t=e.bgColor,l=e.fgColor,n=e.level,I=e.size,o=e.value,C=bx(e,["bgColor","fgColor","level","size","value"]),a=new ix.default(-1,cx.default[n]);a.addData(o),a.make();var r=a.modules;return ux.default.createElement(mx.default,ax({},C,{bgColor:t,bgD:r.map(function(i,s){return i.map(function(c,d){return c?"":"M "+d+" "+s+" l 1 0 0 1 -1 0 Z"}).join(" ")}).join(" "),fgColor:l,fgD:r.map(function(i,s){return i.map(function(c,d){return c?"M "+d+" "+s+" l 1 0 0 1 -1 0 Z":""}).join(" ")}).join(" "),ref:g,size:I,viewBoxSize:r.length}))});Oi.QRCode=FC;FC.displayName="QRCode";FC.propTypes=Zx;FC.defaultProps=hx;var px=Oi.default=FC;const SW=({setGenerateQR:e})=>{const[g,t]=u.useState(5),[l,n]=u.useState(65),[I,o]=u.useState("");u.useEffect(()=>{if(g>0){const a=setInterval(()=>{t(g-1)},1e3);return()=>clearInterval(a)}else C()},[g]),u.useEffect(()=>{if(l>0){const a=setInterval(()=>{n(l-1)},1e3);return()=>clearInterval(a)}C(),n(65)},[l,I]);const C=async()=>{const a=await yK();o(a.data)};return A.jsxs("section",{className:"w-full px-2 mt-24 md:mt-32",children:[A.jsx("button",{onClick:()=>e(!1),className:"px-2 py-1 rounded-full border-2 text-gray-light border-gray-light hover:border-primary-black hover:text-primary-black transition-effect",children:A.jsx("i",{className:"fa-solid fa-arrow-left-long"})}),A.jsx("section",{className:"panel_section w-fit mx-auto flex items-center justify-center",children:A.jsx("div",{className:"w-full border-2 border-transparent hover:border-blue-400 transition-effect bg-white shadow-lg p-8 rounded-md",children:g==0?A.jsxs("div",{className:"flex flex-col items-center gap-10",children:[A.jsx(px,{value:I+""}),A.jsxs("h1",{className:"text-xl",children:["Re-generating QR in"," ",A.jsxs("span",{className:"font-semibold",children:[l," seconds"]})]})]}):A.jsxs("h1",{className:"text-xl text-center",children:["Generating QR in"," ",A.jsxs("span",{className:"font-semibold",children:[g," seconds"]})]})})})]})};SW.propTypes={setGenerateQR:w.func.isRequired};function bC(e){"@babel/helpers - typeof";return bC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(g){return typeof g}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g},bC(e)}function Gx(e,g){if(bC(e)!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var l=t.call(e,g||"default");if(bC(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(g==="string"?String:Number)(e)}function yx(e){var g=Gx(e,"string");return bC(g)=="symbol"?g:String(g)}function Bx(e,g,t){return g=yx(g),g in e?Object.defineProperty(e,g,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[g]=t,e}function fx(e){if(Array.isArray(e))return e}function Sx(e,g){var t=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(t!=null){var l,n,I,o,C=[],a=!0,r=!1;try{if(I=(t=t.call(e)).next,g===0){if(Object(t)!==t)return;a=!1}else for(;!(a=(l=I.call(t)).done)&&(C.push(l.value),C.length!==g);a=!0);}catch(i){r=!0,n=i}finally{try{if(!a&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(r)throw n}}return C}}function fh(e,g){(g==null||g>e.length)&&(g=e.length);for(var t=0,l=new Array(g);t<g;t++)l[t]=e[t];return l}function Vx(e,g){if(e){if(typeof e=="string")return fh(e,g);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return fh(e,g)}}function Wx(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vx(e,g){return fx(e)||Sx(e,g)||Vx(e,g)||Wx()}function Rx(e,g){if(e==null)return{};var t=SN(e,g),l,n;if(Object.getOwnPropertySymbols){var I=Object.getOwnPropertySymbols(e);for(n=0;n<I.length;n++)l=I[n],!(g.indexOf(l)>=0)&&Object.prototype.propertyIsEnumerable.call(e,l)&&(t[l]=e[l])}return t}var VW={exports:{}},de={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var eg=typeof Symbol=="function"&&Symbol.for,Rm=eg?Symbol.for("react.element"):60103,Xm=eg?Symbol.for("react.portal"):60106,qi=eg?Symbol.for("react.fragment"):60107,_i=eg?Symbol.for("react.strict_mode"):60108,es=eg?Symbol.for("react.profiler"):60114,gs=eg?Symbol.for("react.provider"):60109,ts=eg?Symbol.for("react.context"):60110,km=eg?Symbol.for("react.async_mode"):60111,ls=eg?Symbol.for("react.concurrent_mode"):60111,ns=eg?Symbol.for("react.forward_ref"):60112,Is=eg?Symbol.for("react.suspense"):60113,Xx=eg?Symbol.for("react.suspense_list"):60120,os=eg?Symbol.for("react.memo"):60115,Cs=eg?Symbol.for("react.lazy"):60116,kx=eg?Symbol.for("react.block"):60121,Jx=eg?Symbol.for("react.fundamental"):60117,Yx=eg?Symbol.for("react.responder"):60118,wx=eg?Symbol.for("react.scope"):60119;function Dg(e){if(typeof e=="object"&&e!==null){var g=e.$$typeof;switch(g){case Rm:switch(e=e.type,e){case km:case ls:case qi:case es:case _i:case Is:return e;default:switch(e=e&&e.$$typeof,e){case ts:case ns:case Cs:case os:case gs:return e;default:return g}}case Xm:return g}}}function WW(e){return Dg(e)===ls}de.AsyncMode=km;de.ConcurrentMode=ls;de.ContextConsumer=ts;de.ContextProvider=gs;de.Element=Rm;de.ForwardRef=ns;de.Fragment=qi;de.Lazy=Cs;de.Memo=os;de.Portal=Xm;de.Profiler=es;de.StrictMode=_i;de.Suspense=Is;de.isAsyncMode=function(e){return WW(e)||Dg(e)===km};de.isConcurrentMode=WW;de.isContextConsumer=function(e){return Dg(e)===ts};de.isContextProvider=function(e){return Dg(e)===gs};de.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===Rm};de.isForwardRef=function(e){return Dg(e)===ns};de.isFragment=function(e){return Dg(e)===qi};de.isLazy=function(e){return Dg(e)===Cs};de.isMemo=function(e){return Dg(e)===os};de.isPortal=function(e){return Dg(e)===Xm};de.isProfiler=function(e){return Dg(e)===es};de.isStrictMode=function(e){return Dg(e)===_i};de.isSuspense=function(e){return Dg(e)===Is};de.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===qi||e===ls||e===es||e===_i||e===Is||e===Xx||typeof e=="object"&&e!==null&&(e.$$typeof===Cs||e.$$typeof===os||e.$$typeof===gs||e.$$typeof===ts||e.$$typeof===ns||e.$$typeof===Jx||e.$$typeof===Yx||e.$$typeof===wx||e.$$typeof===kx)};de.typeOf=Dg;/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var Sh=Object.getOwnPropertySymbols,Hx=Object.prototype.hasOwnProperty,Nx=Object.prototype.propertyIsEnumerable;function Kx(e){if(e==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}function Fx(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de",Object.getOwnPropertyNames(e)[0]==="5")return!1;for(var g={},t=0;t<10;t++)g["_"+String.fromCharCode(t)]=t;var l=Object.getOwnPropertyNames(g).map(function(I){return g[I]});if(l.join("")!=="0123456789")return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach(function(I){n[I]=I}),Object.keys(Object.assign({},n)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}Fx();var xx="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",Ex=xx;Function.call.bind(Object.prototype.hasOwnProperty);var Dx=Ex;function vW(){}function RW(){}RW.resetWarningCache=vW;var Mx=function(){function e(l,n,I,o,C,a){if(a!==Dx){var r=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw r.name="Invariant Violation",r}}e.isRequired=e;function g(){return e}var t={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:g,element:e,elementType:e,instanceOf:g,node:e,objectOf:g,oneOf:g,oneOfType:g,shape:g,exact:g,checkPropTypes:RW,resetWarningCache:vW};return t.PropTypes=t,t};VW.exports=Mx();var Pn=VW.exports;function zx(e,g){var t=atob(e);if(g){for(var l=new Uint8Array(t.length),n=0,I=t.length;n<I;++n)l[n]=t.charCodeAt(n);return String.fromCharCode.apply(null,new Uint16Array(l.buffer))}return t}function Tx(e,g,t){var l=g===void 0?null:g,n=t===void 0?!1:t,I=zx(e,n),o=I.indexOf(`
`,10)+1,C=I.substring(o)+(l?"//# sourceMappingURL="+l:""),a=new Blob([C],{type:"application/javascript"});return URL.createObjectURL(a)}function Lx(e,g,t){var l;return function(I){return l=l||Tx(e,g,t),new Worker(l,I)}}var Ux=Lx("Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwooZnVuY3Rpb24gKCkgewoJJ3VzZSBzdHJpY3QnOwoKCXZhciBjb21tb25qc0dsb2JhbCA9IHR5cGVvZiBnbG9iYWxUaGlzICE9PSAndW5kZWZpbmVkJyA/IGdsb2JhbFRoaXMgOiB0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyA/IHdpbmRvdyA6IHR5cGVvZiBnbG9iYWwgIT09ICd1bmRlZmluZWQnID8gZ2xvYmFsIDogdHlwZW9mIHNlbGYgIT09ICd1bmRlZmluZWQnID8gc2VsZiA6IHt9OwoKCWZ1bmN0aW9uIGdldEF1Z21lbnRlZE5hbWVzcGFjZShuKSB7CgkJaWYgKG4uX19lc01vZHVsZSkgcmV0dXJuIG47CgkJdmFyIGEgPSBPYmplY3QuZGVmaW5lUHJvcGVydHkoe30sICdfX2VzTW9kdWxlJywge3ZhbHVlOiB0cnVlfSk7CgkJT2JqZWN0LmtleXMobikuZm9yRWFjaChmdW5jdGlvbiAoaykgewoJCQl2YXIgZCA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iobiwgayk7CgkJCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShhLCBrLCBkLmdldCA/IGQgOiB7CgkJCQllbnVtZXJhYmxlOiB0cnVlLAoJCQkJZ2V0OiBmdW5jdGlvbiAoKSB7CgkJCQkJcmV0dXJuIG5ba107CgkJCQl9CgkJCX0pOwoJCX0pOwoJCXJldHVybiBhOwoJfQoKCXZhciBCaW5hcnlCaXRtYXAkMSA9IHt9OwoKCXZhciBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24kMSA9IHt9OwoKCXZhciBFeGNlcHRpb24kMSA9IHt9OwoKCWZ1bmN0aW9uIGZpeFByb3RvKHRhcmdldCwgcHJvdG90eXBlKSB7CgkgIHZhciBzZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZjsKCSAgc2V0UHJvdG90eXBlT2YgPyBzZXRQcm90b3R5cGVPZih0YXJnZXQsIHByb3RvdHlwZSkgOiB0YXJnZXQuX19wcm90b19fID0gcHJvdG90eXBlOwoJfQoJZnVuY3Rpb24gZml4U3RhY2sodGFyZ2V0LCBmbikgewoJICBpZiAoZm4gPT09IHZvaWQgMCkgewoJICAgIGZuID0gdGFyZ2V0LmNvbnN0cnVjdG9yOwoJICB9CgoJICB2YXIgY2FwdHVyZVN0YWNrVHJhY2UgPSBFcnJvci5jYXB0dXJlU3RhY2tUcmFjZTsKCSAgY2FwdHVyZVN0YWNrVHJhY2UgJiYgY2FwdHVyZVN0YWNrVHJhY2UodGFyZ2V0LCBmbik7Cgl9CgoJdmFyIF9fZXh0ZW5kcyRrID0gZnVuY3Rpb24gKCkgewoJICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fCB7CgkgICAgICBfX3Byb3RvX186IFtdCgkgICAgfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICBkLl9fcHJvdG9fXyA9IGI7CgkgICAgfSB8fCBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgZm9yICh2YXIgcCBpbiBiKSB7IGlmIChiLmhhc093blByb3BlcnR5KHApKSB7IGRbcF0gPSBiW3BdOyB9IH0KCSAgICB9OwoKCSAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgfTsKCgkgIHJldHVybiBmdW5jdGlvbiAoZCwgYikgewoJICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgoJICAgIGZ1bmN0aW9uIF9fKCkgewoJICAgICAgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7CgkgICAgfQoKCSAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgIH07Cgl9KCk7CgoJdmFyIEN1c3RvbUVycm9yID0gZnVuY3Rpb24gKF9zdXBlcikgewoJICBfX2V4dGVuZHMkayhDdXN0b21FcnJvciwgX3N1cGVyKTsKCgkgIGZ1bmN0aW9uIEN1c3RvbUVycm9yKG1lc3NhZ2UpIHsKCSAgICB2YXIgX25ld1RhcmdldCA9IHRoaXMuY29uc3RydWN0b3I7CgoJICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIG1lc3NhZ2UpIHx8IHRoaXM7CgoJICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShfdGhpcywgJ25hbWUnLCB7CgkgICAgICB2YWx1ZTogX25ld1RhcmdldC5uYW1lLAoJICAgICAgZW51bWVyYWJsZTogZmFsc2UsCgkgICAgICBjb25maWd1cmFibGU6IHRydWUKCSAgICB9KTsKCSAgICBmaXhQcm90byhfdGhpcywgX25ld1RhcmdldC5wcm90b3R5cGUpOwoJICAgIGZpeFN0YWNrKF90aGlzKTsKCSAgICByZXR1cm4gX3RoaXM7CgkgIH0KCgkgIHJldHVybiBDdXN0b21FcnJvcjsKCX0oRXJyb3IpOwoKCXZhciBfX3NwcmVhZEFycmF5cyA9IGZ1bmN0aW9uICgpIHsKCSAgdmFyIGFyZ3VtZW50cyQxID0gYXJndW1lbnRzOwoKCSAgZm9yICh2YXIgcyA9IDAsIGkgPSAwLCBpbCA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBpbDsgaSsrKSB7IHMgKz0gYXJndW1lbnRzJDFbaV0ubGVuZ3RoOyB9CgoJICBmb3IgKHZhciByID0gQXJyYXkocyksIGsgPSAwLCBpID0gMDsgaSA8IGlsOyBpKyspIHsgZm9yICh2YXIgYSA9IGFyZ3VtZW50c1tpXSwgaiA9IDAsIGpsID0gYS5sZW5ndGg7IGogPCBqbDsgaisrLCBrKyspIHsgcltrXSA9IGFbal07IH0gfQoKCSAgcmV0dXJuIHI7Cgl9OwoJZnVuY3Rpb24gY3VzdG9tRXJyb3JGYWN0b3J5KGZuLCBwYXJlbnQpIHsKCSAgaWYgKHBhcmVudCA9PT0gdm9pZCAwKSB7CgkgICAgcGFyZW50ID0gRXJyb3I7CgkgIH0KCgkgIGZ1bmN0aW9uIEN1c3RvbUVycm9yKCkgewoJICAgIHZhciBhcmd1bWVudHMkMSA9IGFyZ3VtZW50czsKCgkgICAgdmFyIGFyZ3MgPSBbXTsKCgkgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHsKCSAgICAgIGFyZ3NbX2ldID0gYXJndW1lbnRzJDFbX2ldOwoJICAgIH0KCgkgICAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIEN1c3RvbUVycm9yKSkgeyByZXR1cm4gbmV3IChDdXN0b21FcnJvci5iaW5kLmFwcGx5KEN1c3RvbUVycm9yLCBfX3NwcmVhZEFycmF5cyhbdm9pZCAwXSwgYXJncykpKSgpOyB9CgkgICAgcGFyZW50LmFwcGx5KHRoaXMsIGFyZ3MpOwoJICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAnbmFtZScsIHsKCSAgICAgIHZhbHVlOiBmbi5uYW1lIHx8IHBhcmVudC5uYW1lLAoJICAgICAgZW51bWVyYWJsZTogZmFsc2UsCgkgICAgICBjb25maWd1cmFibGU6IHRydWUKCSAgICB9KTsKCSAgICBmbi5hcHBseSh0aGlzLCBhcmdzKTsKCSAgICBmaXhTdGFjayh0aGlzLCBDdXN0b21FcnJvcik7CgkgIH0KCgkgIHJldHVybiBPYmplY3QuZGVmaW5lUHJvcGVydGllcyhDdXN0b21FcnJvciwgewoJICAgIHByb3RvdHlwZTogewoJICAgICAgdmFsdWU6IE9iamVjdC5jcmVhdGUocGFyZW50LnByb3RvdHlwZSwgewoJICAgICAgICBjb25zdHJ1Y3RvcjogewoJICAgICAgICAgIHZhbHVlOiBDdXN0b21FcnJvciwKCSAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKCSAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUKCSAgICAgICAgfQoJICAgICAgfSkKCSAgICB9CgkgIH0pOwoJfQoKCXZhciBjdXN0b21FcnJvciA9IC8qI19fUFVSRV9fKi9PYmplY3QuZnJlZXplKHsKCQlfX3Byb3RvX186IG51bGwsCgkJQ3VzdG9tRXJyb3I6IEN1c3RvbUVycm9yLAoJCWN1c3RvbUVycm9yRmFjdG9yeTogY3VzdG9tRXJyb3JGYWN0b3J5Cgl9KTsKCgl2YXIgcmVxdWlyZSQkMCA9IC8qQF9fUFVSRV9fKi9nZXRBdWdtZW50ZWROYW1lc3BhY2UoY3VzdG9tRXJyb3IpOwoKCXZhciBfX2V4dGVuZHMkaiA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShFeGNlcHRpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIHRzX2N1c3RvbV9lcnJvcl8xID0gcmVxdWlyZSQkMDsKCS8qKgoJICogQ3VzdG9tIEVycm9yIGNsYXNzIG9mIHR5cGUgRXhjZXB0aW9uLgoJICovCgl2YXIgRXhjZXB0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikgewoJICAgIF9fZXh0ZW5kcyRqKEV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICAvKioKCSAgICAgKiBBbGxvd3MgRXhjZXB0aW9uIHRvIGJlIGNvbnN0cnVjdGVkIGRpcmVjdGx5CgkgICAgICogd2l0aCBzb21lIG1lc3NhZ2UgYW5kIHByb3RvdHlwZSBkZWZpbml0aW9uLgoJICAgICAqLwoJICAgIGZ1bmN0aW9uIEV4Y2VwdGlvbihtZXNzYWdlKSB7CgkgICAgICAgIGlmIChtZXNzYWdlID09PSB2b2lkIDApIHsgbWVzc2FnZSA9IHVuZGVmaW5lZDsgfQoJICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBtZXNzYWdlKSB8fCB0aGlzOwoJICAgICAgICBfdGhpcy5tZXNzYWdlID0gbWVzc2FnZTsKCSAgICAgICAgcmV0dXJuIF90aGlzOwoJICAgIH0KCSAgICBFeGNlcHRpb24ucHJvdG90eXBlLmdldEtpbmQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHZhciBleCA9IHRoaXMuY29uc3RydWN0b3I7CgkgICAgICAgIHJldHVybiBleC5raW5kOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogSXQncyB0eXBlZCBhcyBzdHJpbmcgc28gaXQgY2FuIGJlIGV4dGVuZGVkIGFuZCBvdmVycmlkZW4uCgkgICAgICovCgkgICAgRXhjZXB0aW9uLmtpbmQgPSAnRXhjZXB0aW9uJzsKCSAgICByZXR1cm4gRXhjZXB0aW9uOwoJfSh0c19jdXN0b21fZXJyb3JfMS5DdXN0b21FcnJvcikpOwoJRXhjZXB0aW9uJDEuZGVmYXVsdCA9IEV4Y2VwdGlvbjsKCgl2YXIgX19leHRlbmRzJGkgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBFeGNlcHRpb25fMSQ5ID0gRXhjZXB0aW9uJDE7CgkvKioKCSAqIEN1c3RvbSBFcnJvciBjbGFzcyBvZiB0eXBlIEV4Y2VwdGlvbi4KCSAqLwoJdmFyIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkaShJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24sIF9zdXBlcik7CgkgICAgZnVuY3Rpb24gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uKCkgewoJICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7CgkgICAgfQoJICAgIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbi5raW5kID0gJ0lsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbic7CgkgICAgcmV0dXJuIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbjsKCX0oRXhjZXB0aW9uXzEkOS5kZWZhdWx0KSk7CglJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24kMS5kZWZhdWx0ID0gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwOSBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoQmluYXJ5Qml0bWFwJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSRhID0gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uJDE7Cgl2YXIgQmluYXJ5Qml0bWFwID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIEJpbmFyeUJpdG1hcChiaW5hcml6ZXIpIHsKCSAgICAgICAgdGhpcy5iaW5hcml6ZXIgPSBiaW5hcml6ZXI7CgkgICAgICAgIGlmIChiaW5hcml6ZXIgPT09IG51bGwpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSRhLmRlZmF1bHQoJ0JpbmFyaXplciBtdXN0IGJlIG5vbi1udWxsLicpOwoJICAgICAgICB9CgkgICAgfQoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gVGhlIHdpZHRoIG9mIHRoZSBiaXRtYXAuCgkgICAgICovCgkgICAgQmluYXJ5Qml0bWFwLnByb3RvdHlwZS5nZXRXaWR0aCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYmluYXJpemVyLmdldFdpZHRoKCk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIFRoZSBoZWlnaHQgb2YgdGhlIGJpdG1hcC4KCSAgICAgKi8KCSAgICBCaW5hcnlCaXRtYXAucHJvdG90eXBlLmdldEhlaWdodCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYmluYXJpemVyLmdldEhlaWdodCgpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQ29udmVydHMgb25lIHJvdyBvZiBsdW1pbmFuY2UgZGF0YSB0byAxIGJpdCBkYXRhLiBNYXkgYWN0dWFsbHkgZG8gdGhlIGNvbnZlcnNpb24sIG9yIHJldHVybgoJICAgICAqIGNhY2hlZCBkYXRhLiBDYWxsZXJzIHNob3VsZCBhc3N1bWUgdGhpcyBtZXRob2QgaXMgZXhwZW5zaXZlIGFuZCBjYWxsIGl0IGFzIHNlbGRvbSBhcyBwb3NzaWJsZS4KCSAgICAgKiBUaGlzIG1ldGhvZCBpcyBpbnRlbmRlZCBmb3IgZGVjb2RpbmcgMUQgYmFyY29kZXMgYW5kIG1heSBjaG9vc2UgdG8gYXBwbHkgc2hhcnBlbmluZy4KCSAgICAgKgoJICAgICAqIEBwYXJhbSB5IFRoZSByb3cgdG8gZmV0Y2gsIHdoaWNoIG11c3QgYmUgaW4gWzAsIGJpdG1hcCBoZWlnaHQpCgkgICAgICogQHBhcmFtIHJvdyBBbiBvcHRpb25hbCBwcmVhbGxvY2F0ZWQgYXJyYXkuIElmIG51bGwgb3IgdG9vIHNtYWxsLCBpdCB3aWxsIGJlIGlnbm9yZWQuCgkgICAgICogICAgICAgICAgICBJZiB1c2VkLCB0aGUgQmluYXJpemVyIHdpbGwgY2FsbCBCaXRBcnJheS5jbGVhcigpLiBBbHdheXMgdXNlIHRoZSByZXR1cm5lZCBvYmplY3QuCgkgICAgICogQHJldHVybiBUaGUgYXJyYXkgb2YgYml0cyBmb3IgdGhpcyByb3cgKHRydWUgbWVhbnMgYmxhY2spLgoJICAgICAqIEB0aHJvd3MgTm90Rm91bmRFeGNlcHRpb24gaWYgcm93IGNhbid0IGJlIGJpbmFyaXplZAoJICAgICAqLwoJICAgIEJpbmFyeUJpdG1hcC5wcm90b3R5cGUuZ2V0QmxhY2tSb3cgPSBmdW5jdGlvbiAoeSAvKmludCovLCByb3cpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYmluYXJpemVyLmdldEJsYWNrUm93KHksIHJvdyk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBDb252ZXJ0cyBhIDJEIGFycmF5IG9mIGx1bWluYW5jZSBkYXRhIHRvIDEgYml0LiBBcyBhYm92ZSwgYXNzdW1lIHRoaXMgbWV0aG9kIGlzIGV4cGVuc2l2ZQoJICAgICAqIGFuZCBkbyBub3QgY2FsbCBpdCByZXBlYXRlZGx5LiBUaGlzIG1ldGhvZCBpcyBpbnRlbmRlZCBmb3IgZGVjb2RpbmcgMkQgYmFyY29kZXMgYW5kIG1heSBvcgoJICAgICAqIG1heSBub3QgYXBwbHkgc2hhcnBlbmluZy4gVGhlcmVmb3JlLCBhIHJvdyBmcm9tIHRoaXMgbWF0cml4IG1heSBub3QgYmUgaWRlbnRpY2FsIHRvIG9uZQoJICAgICAqIGZldGNoZWQgdXNpbmcgZ2V0QmxhY2tSb3coKSwgc28gZG9uJ3QgbWl4IGFuZCBtYXRjaCBiZXR3ZWVuIHRoZW0uCgkgICAgICoKCSAgICAgKiBAcmV0dXJuIFRoZSAyRCBhcnJheSBvZiBiaXRzIGZvciB0aGUgaW1hZ2UgKHRydWUgbWVhbnMgYmxhY2spLgoJICAgICAqIEB0aHJvd3MgTm90Rm91bmRFeGNlcHRpb24gaWYgaW1hZ2UgY2FuJ3QgYmUgYmluYXJpemVkIHRvIG1ha2UgYSBtYXRyaXgKCSAgICAgKi8KCSAgICBCaW5hcnlCaXRtYXAucHJvdG90eXBlLmdldEJsYWNrTWF0cml4ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICAvLyBUaGUgbWF0cml4IGlzIGNyZWF0ZWQgb24gZGVtYW5kIHRoZSBmaXJzdCB0aW1lIGl0IGlzIHJlcXVlc3RlZCwgdGhlbiBjYWNoZWQuIFRoZXJlIGFyZSB0d28KCSAgICAgICAgLy8gcmVhc29ucyBmb3IgdGhpczoKCSAgICAgICAgLy8gMS4gVGhpcyB3b3JrIHdpbGwgbmV2ZXIgYmUgZG9uZSBpZiB0aGUgY2FsbGVyIG9ubHkgaW5zdGFsbHMgMUQgUmVhZGVyIG9iamVjdHMsIG9yIGlmIGEKCSAgICAgICAgLy8gICAgMUQgUmVhZGVyIGZpbmRzIGEgYmFyY29kZSBiZWZvcmUgdGhlIDJEIFJlYWRlcnMgcnVuLgoJICAgICAgICAvLyAyLiBUaGlzIHdvcmsgd2lsbCBvbmx5IGJlIGRvbmUgb25jZSBldmVuIGlmIHRoZSBjYWxsZXIgaW5zdGFsbHMgbXVsdGlwbGUgMkQgUmVhZGVycy4KCSAgICAgICAgaWYgKHRoaXMubWF0cml4ID09PSBudWxsIHx8IHRoaXMubWF0cml4ID09PSB1bmRlZmluZWQpIHsKCSAgICAgICAgICAgIHRoaXMubWF0cml4ID0gdGhpcy5iaW5hcml6ZXIuZ2V0QmxhY2tNYXRyaXgoKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gdGhpcy5tYXRyaXg7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIFdoZXRoZXIgdGhpcyBiaXRtYXAgY2FuIGJlIGNyb3BwZWQuCgkgICAgICovCgkgICAgQmluYXJ5Qml0bWFwLnByb3RvdHlwZS5pc0Nyb3BTdXBwb3J0ZWQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmJpbmFyaXplci5nZXRMdW1pbmFuY2VTb3VyY2UoKS5pc0Nyb3BTdXBwb3J0ZWQoKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgYSBuZXcgb2JqZWN0IHdpdGggY3JvcHBlZCBpbWFnZSBkYXRhLiBJbXBsZW1lbnRhdGlvbnMgbWF5IGtlZXAgYSByZWZlcmVuY2UgdG8gdGhlCgkgICAgICogb3JpZ2luYWwgZGF0YSByYXRoZXIgdGhhbiBhIGNvcHkuIE9ubHkgY2FsbGFibGUgaWYgaXNDcm9wU3VwcG9ydGVkKCkgaXMgdHJ1ZS4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBsZWZ0IFRoZSBsZWZ0IGNvb3JkaW5hdGUsIHdoaWNoIG11c3QgYmUgaW4gWzAsZ2V0V2lkdGgoKSkKCSAgICAgKiBAcGFyYW0gdG9wIFRoZSB0b3AgY29vcmRpbmF0ZSwgd2hpY2ggbXVzdCBiZSBpbiBbMCxnZXRIZWlnaHQoKSkKCSAgICAgKiBAcGFyYW0gd2lkdGggVGhlIHdpZHRoIG9mIHRoZSByZWN0YW5nbGUgdG8gY3JvcC4KCSAgICAgKiBAcGFyYW0gaGVpZ2h0IFRoZSBoZWlnaHQgb2YgdGhlIHJlY3RhbmdsZSB0byBjcm9wLgoJICAgICAqIEByZXR1cm4gQSBjcm9wcGVkIHZlcnNpb24gb2YgdGhpcyBvYmplY3QuCgkgICAgICovCgkgICAgQmluYXJ5Qml0bWFwLnByb3RvdHlwZS5jcm9wID0gZnVuY3Rpb24gKGxlZnQgLyppbnQqLywgdG9wIC8qaW50Ki8sIHdpZHRoIC8qaW50Ki8sIGhlaWdodCAvKmludCovKSB7CgkgICAgICAgIHZhciBuZXdTb3VyY2UgPSB0aGlzLmJpbmFyaXplci5nZXRMdW1pbmFuY2VTb3VyY2UoKS5jcm9wKGxlZnQsIHRvcCwgd2lkdGgsIGhlaWdodCk7CgkgICAgICAgIHJldHVybiBuZXcgQmluYXJ5Qml0bWFwKHRoaXMuYmluYXJpemVyLmNyZWF0ZUJpbmFyaXplcihuZXdTb3VyY2UpKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gV2hldGhlciB0aGlzIGJpdG1hcCBzdXBwb3J0cyBjb3VudGVyLWNsb2Nrd2lzZSByb3RhdGlvbi4KCSAgICAgKi8KCSAgICBCaW5hcnlCaXRtYXAucHJvdG90eXBlLmlzUm90YXRlU3VwcG9ydGVkID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5iaW5hcml6ZXIuZ2V0THVtaW5hbmNlU291cmNlKCkuaXNSb3RhdGVTdXBwb3J0ZWQoKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgYSBuZXcgb2JqZWN0IHdpdGggcm90YXRlZCBpbWFnZSBkYXRhIGJ5IDkwIGRlZ3JlZXMgY291bnRlcmNsb2Nrd2lzZS4KCSAgICAgKiBPbmx5IGNhbGxhYmxlIGlmIHtAbGluayAjaXNSb3RhdGVTdXBwb3J0ZWQoKX0gaXMgdHJ1ZS4KCSAgICAgKgoJICAgICAqIEByZXR1cm4gQSByb3RhdGVkIHZlcnNpb24gb2YgdGhpcyBvYmplY3QuCgkgICAgICovCgkgICAgQmluYXJ5Qml0bWFwLnByb3RvdHlwZS5yb3RhdGVDb3VudGVyQ2xvY2t3aXNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgbmV3U291cmNlID0gdGhpcy5iaW5hcml6ZXIuZ2V0THVtaW5hbmNlU291cmNlKCkucm90YXRlQ291bnRlckNsb2Nrd2lzZSgpOwoJICAgICAgICByZXR1cm4gbmV3IEJpbmFyeUJpdG1hcCh0aGlzLmJpbmFyaXplci5jcmVhdGVCaW5hcml6ZXIobmV3U291cmNlKSk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBSZXR1cm5zIGEgbmV3IG9iamVjdCB3aXRoIHJvdGF0ZWQgaW1hZ2UgZGF0YSBieSA0NSBkZWdyZWVzIGNvdW50ZXJjbG9ja3dpc2UuCgkgICAgICogT25seSBjYWxsYWJsZSBpZiB7QGxpbmsgI2lzUm90YXRlU3VwcG9ydGVkKCl9IGlzIHRydWUuCgkgICAgICoKCSAgICAgKiBAcmV0dXJuIEEgcm90YXRlZCB2ZXJzaW9uIG9mIHRoaXMgb2JqZWN0LgoJICAgICAqLwoJICAgIEJpbmFyeUJpdG1hcC5wcm90b3R5cGUucm90YXRlQ291bnRlckNsb2Nrd2lzZTQ1ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgbmV3U291cmNlID0gdGhpcy5iaW5hcml6ZXIuZ2V0THVtaW5hbmNlU291cmNlKCkucm90YXRlQ291bnRlckNsb2Nrd2lzZTQ1KCk7CgkgICAgICAgIHJldHVybiBuZXcgQmluYXJ5Qml0bWFwKHRoaXMuYmluYXJpemVyLmNyZWF0ZUJpbmFyaXplcihuZXdTb3VyY2UpKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBCaW5hcnlCaXRtYXAucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0QmxhY2tNYXRyaXgoKS50b1N0cmluZygpOwoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChlIC8qOiBOb3RGb3VuZEV4Y2VwdGlvbiovKSB7CgkgICAgICAgICAgICByZXR1cm4gJyc7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIHJldHVybiBCaW5hcnlCaXRtYXA7Cgl9KCkpOwoJdmFyIF9kZWZhdWx0JDMgPSBCaW5hcnlCaXRtYXAkMS5kZWZhdWx0ID0gQmluYXJ5Qml0bWFwOwoKCXZhciBIeWJyaWRCaW5hcml6ZXIkMSA9IHt9OwoKCXZhciBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIkMSA9IHt9OwoKCXZhciBCaW5hcml6ZXIkMSA9IHt9OwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwOSBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoQmluYXJpemVyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qKgoJICogVGhpcyBjbGFzcyBoaWVyYXJjaHkgcHJvdmlkZXMgYSBzZXQgb2YgbWV0aG9kcyB0byBjb252ZXJ0IGx1bWluYW5jZSBkYXRhIHRvIDEgYml0IGRhdGEuCgkgKiBJdCBhbGxvd3MgdGhlIGFsZ29yaXRobSB0byB2YXJ5IHBvbHltb3JwaGljYWxseSwgZm9yIGV4YW1wbGUgYWxsb3dpbmcgYSB2ZXJ5IGV4cGVuc2l2ZQoJICogdGhyZXNob2xkaW5nIHRlY2huaXF1ZSBmb3Igc2VydmVycyBhbmQgYSBmYXN0IG9uZSBmb3IgbW9iaWxlLiBJdCBhbHNvIHBlcm1pdHMgdGhlIGltcGxlbWVudGF0aW9uCgkgKiB0byB2YXJ5LCBlLmcuIGEgSk5JIHZlcnNpb24gZm9yIEFuZHJvaWQgYW5kIGEgSmF2YSBmYWxsYmFjayB2ZXJzaW9uIGZvciBvdGhlciBwbGF0Zm9ybXMuCgkgKgoJICogQGF1dGhvciBkc3dpdGtpbkBnb29nbGUuY29tIChEYW5pZWwgU3dpdGtpbikKCSAqLwoJdmFyIEJpbmFyaXplciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBCaW5hcml6ZXIoc291cmNlKSB7CgkgICAgICAgIHRoaXMuc291cmNlID0gc291cmNlOwoJICAgIH0KCSAgICBCaW5hcml6ZXIucHJvdG90eXBlLmdldEx1bWluYW5jZVNvdXJjZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuc291cmNlOwoJICAgIH07CgkgICAgQmluYXJpemVyLnByb3RvdHlwZS5nZXRXaWR0aCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuc291cmNlLmdldFdpZHRoKCk7CgkgICAgfTsKCSAgICBCaW5hcml6ZXIucHJvdG90eXBlLmdldEhlaWdodCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuc291cmNlLmdldEhlaWdodCgpOwoJICAgIH07CgkgICAgcmV0dXJuIEJpbmFyaXplcjsKCX0oKSk7CglCaW5hcml6ZXIkMS5kZWZhdWx0ID0gQmluYXJpemVyOwoKCXZhciBCaXRBcnJheSQxID0ge307CgoJdmFyIEFycmF5cyQxID0ge307CgoJdmFyIFN5c3RlbSQxID0ge307CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KFN5c3RlbSQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgU3lzdGVtID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIFN5c3RlbSgpIHsKCSAgICB9CgkgICAgLy8gcHVibGljIHN0YXRpYyB2b2lkIGFycmF5Y29weShPYmplY3Qgc3JjLCBpbnQgc3JjUG9zLCBPYmplY3QgZGVzdCwgaW50IGRlc3RQb3MsIGludCBsZW5ndGgpCgkgICAgLyoqCgkgICAgICogTWFrZXMgYSBjb3B5IG9mIGEgYXJyYXkuCgkgICAgICovCgkgICAgU3lzdGVtLmFycmF5Y29weSA9IGZ1bmN0aW9uIChzcmMsIHNyY1BvcywgZGVzdCwgZGVzdFBvcywgbGVuZ3RoKSB7CgkgICAgICAgIC8vIFRPRE86IGJldHRlciB1c2Ugc3BsaXQgb3Igc2V0PwoJICAgICAgICB3aGlsZSAobGVuZ3RoLS0pIHsKCSAgICAgICAgICAgIGRlc3RbZGVzdFBvcysrXSA9IHNyY1tzcmNQb3MrK107CgkgICAgICAgIH0KCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgdGhlIGN1cnJlbnQgdGltZSBpbiBtaWxsaXNlY29uZHMuCgkgICAgICovCgkgICAgU3lzdGVtLmN1cnJlbnRUaW1lTWlsbGlzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gRGF0ZS5ub3coKTsKCSAgICB9OwoJICAgIHJldHVybiBTeXN0ZW07Cgl9KCkpOwoJU3lzdGVtJDEuZGVmYXVsdCA9IFN5c3RlbTsKCgl2YXIgQXJyYXlJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uJDEgPSB7fTsKCgl2YXIgSW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbiQxID0ge307CgoJdmFyIF9fZXh0ZW5kcyRoID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHsKCSAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwKCSAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHwKCSAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9OwoJICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICB9OwoJICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH0KCSAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpOwoJICAgIH07Cgl9KSgpOwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIEV4Y2VwdGlvbl8xJDggPSBFeGNlcHRpb24kMTsKCS8qKgoJICogQ3VzdG9tIEVycm9yIGNsYXNzIG9mIHR5cGUgRXhjZXB0aW9uLgoJICovCgl2YXIgSW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkaChJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uLCBfc3VwZXIpOwoJICAgIGZ1bmN0aW9uIEluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24oKSB7CgkgICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpczsKCSAgICB9CgkgICAgSW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbi5raW5kID0gJ0luZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24nOwoJICAgIHJldHVybiBJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uOwoJfShFeGNlcHRpb25fMSQ4LmRlZmF1bHQpKTsKCUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24kMS5kZWZhdWx0ID0gSW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbjsKCgl2YXIgX19leHRlbmRzJGcgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoQXJyYXlJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uXzEgPSBJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uJDE7CgkvKioKCSAqIEN1c3RvbSBFcnJvciBjbGFzcyBvZiB0eXBlIEV4Y2VwdGlvbi4KCSAqLwoJdmFyIEFycmF5SW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkZyhBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24sIF9zdXBlcik7CgkgICAgZnVuY3Rpb24gQXJyYXlJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uKGluZGV4LCBtZXNzYWdlKSB7CgkgICAgICAgIGlmIChpbmRleCA9PT0gdm9pZCAwKSB7IGluZGV4ID0gdW5kZWZpbmVkOyB9CgkgICAgICAgIGlmIChtZXNzYWdlID09PSB2b2lkIDApIHsgbWVzc2FnZSA9IHVuZGVmaW5lZDsgfQoJICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBtZXNzYWdlKSB8fCB0aGlzOwoJICAgICAgICBfdGhpcy5pbmRleCA9IGluZGV4OwoJICAgICAgICBfdGhpcy5tZXNzYWdlID0gbWVzc2FnZTsKCSAgICAgICAgcmV0dXJuIF90aGlzOwoJICAgIH0KCSAgICBBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24ua2luZCA9ICdBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24nOwoJICAgIHJldHVybiBBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb247Cgl9KEluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb25fMS5kZWZhdWx0KSk7CglBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24kMS5kZWZhdWx0ID0gQXJyYXlJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uOwoKCXZhciBfX3ZhbHVlcyQ3ID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fdmFsdWVzKSB8fCBmdW5jdGlvbihvKSB7CgkgICAgdmFyIHMgPSB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIFN5bWJvbC5pdGVyYXRvciwgbSA9IHMgJiYgb1tzXSwgaSA9IDA7CgkgICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7CgkgICAgaWYgKG8gJiYgdHlwZW9mIG8ubGVuZ3RoID09PSAibnVtYmVyIikgcmV0dXJuIHsKCSAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkgewoJICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDsKCSAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihzID8gIk9iamVjdCBpcyBub3QgaXRlcmFibGUuIiA6ICJTeW1ib2wuaXRlcmF0b3IgaXMgbm90IGRlZmluZWQuIik7Cgl9OwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEFycmF5cyQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgU3lzdGVtXzEkNSA9IFN5c3RlbSQxOwoJdmFyIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDkgPSBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24kMTsKCXZhciBBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb25fMSA9IEFycmF5SW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbiQxOwoJdmFyIEFycmF5cyA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBBcnJheXMoKSB7CgkgICAgfQoJICAgIC8qKgoJICAgICAqIEFzc2lnbnMgdGhlIHNwZWNpZmllZCBpbnQgdmFsdWUgdG8gZWFjaCBlbGVtZW50IG9mIHRoZSBzcGVjaWZpZWQgYXJyYXkKCSAgICAgKiBvZiBpbnRzLgoJICAgICAqCgkgICAgICogQHBhcmFtIGEgdGhlIGFycmF5IHRvIGJlIGZpbGxlZAoJICAgICAqIEBwYXJhbSB2YWwgdGhlIHZhbHVlIHRvIGJlIHN0b3JlZCBpbiBhbGwgZWxlbWVudHMgb2YgdGhlIGFycmF5CgkgICAgICovCgkgICAgQXJyYXlzLmZpbGwgPSBmdW5jdGlvbiAoYSwgdmFsKSB7CgkgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBhLmxlbmd0aDsgaSA8IGxlbjsgaSsrKQoJICAgICAgICAgICAgYVtpXSA9IHZhbDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEFzc2lnbnMgdGhlIHNwZWNpZmllZCBpbnQgdmFsdWUgdG8gZWFjaCBlbGVtZW50IG9mIHRoZSBzcGVjaWZpZWQKCSAgICAgKiByYW5nZSBvZiB0aGUgc3BlY2lmaWVkIGFycmF5IG9mIGludHMuICBUaGUgcmFuZ2UgdG8gYmUgZmlsbGVkCgkgICAgICogZXh0ZW5kcyBmcm9tIGluZGV4IHtAY29kZSBmcm9tSW5kZXh9LCBpbmNsdXNpdmUsIHRvIGluZGV4CgkgICAgICoge0Bjb2RlIHRvSW5kZXh9LCBleGNsdXNpdmUuICAoSWYge0Bjb2RlIGZyb21JbmRleD09dG9JbmRleH0sIHRoZQoJICAgICAqIHJhbmdlIHRvIGJlIGZpbGxlZCBpcyBlbXB0eS4pCgkgICAgICoKCSAgICAgKiBAcGFyYW0gYSB0aGUgYXJyYXkgdG8gYmUgZmlsbGVkCgkgICAgICogQHBhcmFtIGZyb21JbmRleCB0aGUgaW5kZXggb2YgdGhlIGZpcnN0IGVsZW1lbnQgKGluY2x1c2l2ZSkgdG8gYmUKCSAgICAgKiAgICAgICAgZmlsbGVkIHdpdGggdGhlIHNwZWNpZmllZCB2YWx1ZQoJICAgICAqIEBwYXJhbSB0b0luZGV4IHRoZSBpbmRleCBvZiB0aGUgbGFzdCBlbGVtZW50IChleGNsdXNpdmUpIHRvIGJlCgkgICAgICogICAgICAgIGZpbGxlZCB3aXRoIHRoZSBzcGVjaWZpZWQgdmFsdWUKCSAgICAgKiBAcGFyYW0gdmFsIHRoZSB2YWx1ZSB0byBiZSBzdG9yZWQgaW4gYWxsIGVsZW1lbnRzIG9mIHRoZSBhcnJheQoJICAgICAqIEB0aHJvd3MgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uIGlmIHtAY29kZSBmcm9tSW5kZXggPiB0b0luZGV4fQoJICAgICAqIEB0aHJvd3MgQXJyYXlJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uIGlmIHtAY29kZSBmcm9tSW5kZXggPCAwfSBvcgoJICAgICAqICAgICAgICAge0Bjb2RlIHRvSW5kZXggPiBhLmxlbmd0aH0KCSAgICAgKi8KCSAgICBBcnJheXMuZmlsbFdpdGhpbiA9IGZ1bmN0aW9uIChhLCBmcm9tSW5kZXgsIHRvSW5kZXgsIHZhbCkgewoJICAgICAgICBBcnJheXMucmFuZ2VDaGVjayhhLmxlbmd0aCwgZnJvbUluZGV4LCB0b0luZGV4KTsKCSAgICAgICAgZm9yICh2YXIgaSA9IGZyb21JbmRleDsgaSA8IHRvSW5kZXg7IGkrKykKCSAgICAgICAgICAgIGFbaV0gPSB2YWw7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBDaGVja3MgdGhhdCB7QGNvZGUgZnJvbUluZGV4fSBhbmQge0Bjb2RlIHRvSW5kZXh9IGFyZSBpbgoJICAgICAqIHRoZSByYW5nZSBhbmQgdGhyb3dzIGFuIGV4Y2VwdGlvbiBpZiB0aGV5IGFyZW4ndC4KCSAgICAgKi8KCSAgICBBcnJheXMucmFuZ2VDaGVjayA9IGZ1bmN0aW9uIChhcnJheUxlbmd0aCwgZnJvbUluZGV4LCB0b0luZGV4KSB7CgkgICAgICAgIGlmIChmcm9tSW5kZXggPiB0b0luZGV4KSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkOS5kZWZhdWx0KCdmcm9tSW5kZXgoJyArIGZyb21JbmRleCArICcpID4gdG9JbmRleCgnICsgdG9JbmRleCArICcpJyk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGZyb21JbmRleCA8IDApIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb25fMS5kZWZhdWx0KGZyb21JbmRleCk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHRvSW5kZXggPiBhcnJheUxlbmd0aCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IEFycmF5SW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbl8xLmRlZmF1bHQodG9JbmRleCk7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIEFycmF5cy5hc0xpc3QgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHZhciBhcmdzID0gW107CgkgICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7CgkgICAgICAgICAgICBhcmdzW19pXSA9IGFyZ3VtZW50c1tfaV07CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGFyZ3M7CgkgICAgfTsKCSAgICBBcnJheXMuY3JlYXRlID0gZnVuY3Rpb24gKHJvd3MsIGNvbHMsIHZhbHVlKSB7CgkgICAgICAgIHZhciBhcnIgPSBBcnJheS5mcm9tKHsgbGVuZ3RoOiByb3dzIH0pOwoJICAgICAgICByZXR1cm4gYXJyLm1hcChmdW5jdGlvbiAoeCkgeyByZXR1cm4gQXJyYXkuZnJvbSh7IGxlbmd0aDogY29scyB9KS5maWxsKHZhbHVlKTsgfSk7CgkgICAgfTsKCSAgICBBcnJheXMuY3JlYXRlSW50MzJBcnJheSA9IGZ1bmN0aW9uIChyb3dzLCBjb2xzLCB2YWx1ZSkgewoJICAgICAgICB2YXIgYXJyID0gQXJyYXkuZnJvbSh7IGxlbmd0aDogcm93cyB9KTsKCSAgICAgICAgcmV0dXJuIGFyci5tYXAoZnVuY3Rpb24gKHgpIHsgcmV0dXJuIEludDMyQXJyYXkuZnJvbSh7IGxlbmd0aDogY29scyB9KS5maWxsKHZhbHVlKTsgfSk7CgkgICAgfTsKCSAgICBBcnJheXMuZXF1YWxzID0gZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHsKCSAgICAgICAgaWYgKCFmaXJzdCkgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIGlmICghc2Vjb25kKSB7CgkgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKCFmaXJzdC5sZW5ndGgpIHsKCSAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoIXNlY29uZC5sZW5ndGgpIHsKCSAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoZmlyc3QubGVuZ3RoICE9PSBzZWNvbmQubGVuZ3RoKSB7CgkgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgIH0KCSAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aF8xID0gZmlyc3QubGVuZ3RoOyBpIDwgbGVuZ3RoXzE7IGkrKykgewoJICAgICAgICAgICAgaWYgKGZpcnN0W2ldICE9PSBzZWNvbmRbaV0pIHsKCSAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRydWU7CgkgICAgfTsKCSAgICBBcnJheXMuaGFzaENvZGUgPSBmdW5jdGlvbiAoYSkgewoJICAgICAgICB2YXIgZV8xLCBfYTsKCSAgICAgICAgaWYgKGEgPT09IG51bGwpIHsKCSAgICAgICAgICAgIHJldHVybiAwOwoJICAgICAgICB9CgkgICAgICAgIHZhciByZXN1bHQgPSAxOwoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgZm9yICh2YXIgYV8xID0gX192YWx1ZXMkNyhhKSwgYV8xXzEgPSBhXzEubmV4dCgpOyAhYV8xXzEuZG9uZTsgYV8xXzEgPSBhXzEubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgdmFyIGVsZW1lbnQgPSBhXzFfMS52YWx1ZTsKCSAgICAgICAgICAgICAgICByZXN1bHQgPSAzMSAqIHJlc3VsdCArIGVsZW1lbnQ7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGVfMV8xKSB7IGVfMSA9IHsgZXJyb3I6IGVfMV8xIH07IH0KCSAgICAgICAgZmluYWxseSB7CgkgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgIGlmIChhXzFfMSAmJiAhYV8xXzEuZG9uZSAmJiAoX2EgPSBhXzEucmV0dXJuKSkgX2EuY2FsbChhXzEpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZmluYWxseSB7IGlmIChlXzEpIHRocm93IGVfMS5lcnJvcjsgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiByZXN1bHQ7CgkgICAgfTsKCSAgICBBcnJheXMuZmlsbFVpbnQ4QXJyYXkgPSBmdW5jdGlvbiAoYSwgdmFsdWUpIHsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgIT09IGEubGVuZ3RoOyBpKyspIHsKCSAgICAgICAgICAgIGFbaV0gPSB2YWx1ZTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgQXJyYXlzLmNvcHlPZiA9IGZ1bmN0aW9uIChvcmlnaW5hbCwgbmV3TGVuZ3RoKSB7CgkgICAgICAgIHJldHVybiBvcmlnaW5hbC5zbGljZSgwLCBuZXdMZW5ndGgpOwoJICAgIH07CgkgICAgQXJyYXlzLmNvcHlPZlVpbnQ4QXJyYXkgPSBmdW5jdGlvbiAob3JpZ2luYWwsIG5ld0xlbmd0aCkgewoJICAgICAgICBpZiAob3JpZ2luYWwubGVuZ3RoIDw9IG5ld0xlbmd0aCkgewoJICAgICAgICAgICAgdmFyIG5ld0FycmF5ID0gbmV3IFVpbnQ4QXJyYXkobmV3TGVuZ3RoKTsKCSAgICAgICAgICAgIG5ld0FycmF5LnNldChvcmlnaW5hbCk7CgkgICAgICAgICAgICByZXR1cm4gbmV3QXJyYXk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIG9yaWdpbmFsLnNsaWNlKDAsIG5ld0xlbmd0aCk7CgkgICAgfTsKCSAgICBBcnJheXMuY29weU9mUmFuZ2UgPSBmdW5jdGlvbiAob3JpZ2luYWwsIGZyb20sIHRvKSB7CgkgICAgICAgIHZhciBuZXdMZW5ndGggPSB0byAtIGZyb207CgkgICAgICAgIHZhciBjb3B5ID0gbmV3IEludDMyQXJyYXkobmV3TGVuZ3RoKTsKCSAgICAgICAgU3lzdGVtXzEkNS5kZWZhdWx0LmFycmF5Y29weShvcmlnaW5hbCwgZnJvbSwgY29weSwgMCwgbmV3TGVuZ3RoKTsKCSAgICAgICAgcmV0dXJuIGNvcHk7CgkgICAgfTsKCSAgICAvKgoJICAgICogUmV0dXJucyB0aGUgaW5kZXggb2Ygb2YgdGhlIGVsZW1lbnQgaW4gYSBzb3J0ZWQgYXJyYXkgb3IgKC1uLTEpIHdoZXJlIG4gaXMgdGhlIGluc2VydGlvbiBwb2ludAoJICAgICogZm9yIHRoZSBuZXcgZWxlbWVudC4KCSAgICAqIFBhcmFtZXRlcnM6CgkgICAgKiAgICAgYXIgLSBBIHNvcnRlZCBhcnJheQoJICAgICogICAgIGVsIC0gQW4gZWxlbWVudCB0byBzZWFyY2ggZm9yCgkgICAgKiAgICAgY29tcGFyYXRvciAtIEEgY29tcGFyYXRvciBmdW5jdGlvbi4gVGhlIGZ1bmN0aW9uIHRha2VzIHR3byBhcmd1bWVudHM6IChhLCBiKSBhbmQgcmV0dXJuczoKCSAgICAqICAgICAgICBhIG5lZ2F0aXZlIG51bWJlciAgaWYgYSBpcyBsZXNzIHRoYW4gYjsKCSAgICAqICAgICAgICAwIGlmIGEgaXMgZXF1YWwgdG8gYjsKCSAgICAqICAgICAgICBhIHBvc2l0aXZlIG51bWJlciBvZiBhIGlzIGdyZWF0ZXIgdGhhbiBiLgoJICAgICogVGhlIGFycmF5IG1heSBjb250YWluIGR1cGxpY2F0ZSBlbGVtZW50cy4gSWYgdGhlcmUgYXJlIG1vcmUgdGhhbiBvbmUgZXF1YWwgZWxlbWVudHMgaW4gdGhlIGFycmF5LAoJICAgICogdGhlIHJldHVybmVkIHZhbHVlIGNhbiBiZSB0aGUgaW5kZXggb2YgYW55IG9uZSBvZiB0aGUgZXF1YWwgZWxlbWVudHMuCgkgICAgKgoJICAgICogaHR0cDovL2pzZmlkZGxlLm5ldC9hcnl6aG92L3BrZnN0NTUwLwoJICAgICovCgkgICAgQXJyYXlzLmJpbmFyeVNlYXJjaCA9IGZ1bmN0aW9uIChhciwgZWwsIGNvbXBhcmF0b3IpIHsKCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gY29tcGFyYXRvcikgewoJICAgICAgICAgICAgY29tcGFyYXRvciA9IEFycmF5cy5udW1iZXJDb21wYXJhdG9yOwoJICAgICAgICB9CgkgICAgICAgIHZhciBtID0gMDsKCSAgICAgICAgdmFyIG4gPSBhci5sZW5ndGggLSAxOwoJICAgICAgICB3aGlsZSAobSA8PSBuKSB7CgkgICAgICAgICAgICB2YXIgayA9IChuICsgbSkgPj4gMTsKCSAgICAgICAgICAgIHZhciBjbXAgPSBjb21wYXJhdG9yKGVsLCBhcltrXSk7CgkgICAgICAgICAgICBpZiAoY21wID4gMCkgewoJICAgICAgICAgICAgICAgIG0gPSBrICsgMTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGVsc2UgaWYgKGNtcCA8IDApIHsKCSAgICAgICAgICAgICAgICBuID0gayAtIDE7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICByZXR1cm4gazsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gLW0gLSAxOwoJICAgIH07CgkgICAgQXJyYXlzLm51bWJlckNvbXBhcmF0b3IgPSBmdW5jdGlvbiAoYSwgYikgewoJICAgICAgICByZXR1cm4gYSAtIGI7CgkgICAgfTsKCSAgICByZXR1cm4gQXJyYXlzOwoJfSgpKTsKCUFycmF5cyQxLmRlZmF1bHQgPSBBcnJheXM7CgoJdmFyIEludGVnZXIkMSA9IHt9OwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShJbnRlZ2VyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qKgoJICogUG9ueWZpbGwgZm9yIEphdmEncyBJbnRlZ2VyIGNsYXNzLgoJICovCgl2YXIgSW50ZWdlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBJbnRlZ2VyKCkgewoJICAgIH0KCSAgICBJbnRlZ2VyLm51bWJlck9mVHJhaWxpbmdaZXJvcyA9IGZ1bmN0aW9uIChpKSB7CgkgICAgICAgIHZhciB5OwoJICAgICAgICBpZiAoaSA9PT0gMCkKCSAgICAgICAgICAgIHJldHVybiAzMjsKCSAgICAgICAgdmFyIG4gPSAzMTsKCSAgICAgICAgeSA9IGkgPDwgMTY7CgkgICAgICAgIGlmICh5ICE9PSAwKSB7CgkgICAgICAgICAgICBuIC09IDE2OwoJICAgICAgICAgICAgaSA9IHk7CgkgICAgICAgIH0KCSAgICAgICAgeSA9IGkgPDwgODsKCSAgICAgICAgaWYgKHkgIT09IDApIHsKCSAgICAgICAgICAgIG4gLT0gODsKCSAgICAgICAgICAgIGkgPSB5OwoJICAgICAgICB9CgkgICAgICAgIHkgPSBpIDw8IDQ7CgkgICAgICAgIGlmICh5ICE9PSAwKSB7CgkgICAgICAgICAgICBuIC09IDQ7CgkgICAgICAgICAgICBpID0geTsKCSAgICAgICAgfQoJICAgICAgICB5ID0gaSA8PCAyOwoJICAgICAgICBpZiAoeSAhPT0gMCkgewoJICAgICAgICAgICAgbiAtPSAyOwoJICAgICAgICAgICAgaSA9IHk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIG4gLSAoKGkgPDwgMSkgPj4+IDMxKTsKCSAgICB9OwoJICAgIEludGVnZXIubnVtYmVyT2ZMZWFkaW5nWmVyb3MgPSBmdW5jdGlvbiAoaSkgewoJICAgICAgICAvLyBIRCwgRmlndXJlIDUtNgoJICAgICAgICBpZiAoaSA9PT0gMCkgewoJICAgICAgICAgICAgcmV0dXJuIDMyOwoJICAgICAgICB9CgkgICAgICAgIHZhciBuID0gMTsKCSAgICAgICAgaWYgKGkgPj4+IDE2ID09PSAwKSB7CgkgICAgICAgICAgICBuICs9IDE2OwoJICAgICAgICAgICAgaSA8PD0gMTY7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGkgPj4+IDI0ID09PSAwKSB7CgkgICAgICAgICAgICBuICs9IDg7CgkgICAgICAgICAgICBpIDw8PSA4OwoJICAgICAgICB9CgkgICAgICAgIGlmIChpID4+PiAyOCA9PT0gMCkgewoJICAgICAgICAgICAgbiArPSA0OwoJICAgICAgICAgICAgaSA8PD0gNDsKCSAgICAgICAgfQoJICAgICAgICBpZiAoaSA+Pj4gMzAgPT09IDApIHsKCSAgICAgICAgICAgIG4gKz0gMjsKCSAgICAgICAgICAgIGkgPDw9IDI7CgkgICAgICAgIH0KCSAgICAgICAgbiAtPSBpID4+PiAzMTsKCSAgICAgICAgcmV0dXJuIG47CgkgICAgfTsKCSAgICBJbnRlZ2VyLnRvSGV4U3RyaW5nID0gZnVuY3Rpb24gKGkpIHsKCSAgICAgICAgcmV0dXJuIGkudG9TdHJpbmcoMTYpOwoJICAgIH07CgkgICAgSW50ZWdlci50b0JpbmFyeVN0cmluZyA9IGZ1bmN0aW9uIChpbnROdW1iZXIpIHsKCSAgICAgICAgcmV0dXJuIFN0cmluZyhwYXJzZUludChTdHJpbmcoaW50TnVtYmVyKSwgMikpOwoJICAgIH07CgkgICAgLy8gUmV0dXJucyB0aGUgbnVtYmVyIG9mIG9uZS1iaXRzIGluIHRoZSB0d28ncyBjb21wbGVtZW50IGJpbmFyeSByZXByZXNlbnRhdGlvbiBvZiB0aGUgc3BlY2lmaWVkIGludCB2YWx1ZS4gVGhpcyBmdW5jdGlvbiBpcyBzb21ldGltZXMgcmVmZXJyZWQgdG8gYXMgdGhlIHBvcHVsYXRpb24gY291bnQuCgkgICAgLy8gUmV0dXJuczoKCSAgICAvLyB0aGUgbnVtYmVyIG9mIG9uZS1iaXRzIGluIHRoZSB0d28ncyBjb21wbGVtZW50IGJpbmFyeSByZXByZXNlbnRhdGlvbiBvZiB0aGUgc3BlY2lmaWVkIGludCB2YWx1ZS4KCSAgICBJbnRlZ2VyLmJpdENvdW50ID0gZnVuY3Rpb24gKGkpIHsKCSAgICAgICAgLy8gSEQsIEZpZ3VyZSA1LTIKCSAgICAgICAgaSA9IGkgLSAoKGkgPj4+IDEpICYgMHg1NTU1NTU1NSk7CgkgICAgICAgIGkgPSAoaSAmIDB4MzMzMzMzMzMpICsgKChpID4+PiAyKSAmIDB4MzMzMzMzMzMpOwoJICAgICAgICBpID0gKGkgKyAoaSA+Pj4gNCkpICYgMHgwZjBmMGYwZjsKCSAgICAgICAgaSA9IGkgKyAoaSA+Pj4gOCk7CgkgICAgICAgIGkgPSBpICsgKGkgPj4+IDE2KTsKCSAgICAgICAgcmV0dXJuIGkgJiAweDNmOwoJICAgIH07CgkgICAgSW50ZWdlci50cnVuY0RpdmlzaW9uID0gZnVuY3Rpb24gKGRpdmlkZW5kLCBkaXZpc29yKSB7CgkgICAgICAgIHJldHVybiBNYXRoLnRydW5jKGRpdmlkZW5kIC8gZGl2aXNvcik7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBDb252ZXJ0cyBBIHN0cmluZyB0byBhbiBpbnRlZ2VyLgoJICAgICAqIEBwYXJhbSBzIEEgc3RyaW5nIHRvIGNvbnZlcnQgaW50byBhIG51bWJlci4KCSAgICAgKiBAcGFyYW0gcmFkaXggQSB2YWx1ZSBiZXR3ZWVuIDIgYW5kIDM2IHRoYXQgc3BlY2lmaWVzIHRoZSBiYXNlIG9mIHRoZSBudW1iZXIgaW4gbnVtU3RyaW5nLiBJZiB0aGlzIGFyZ3VtZW50IGlzIG5vdCBzdXBwbGllZCwgc3RyaW5ncyB3aXRoIGEgcHJlZml4IG9mICcweCcgYXJlIGNvbnNpZGVyZWQgaGV4YWRlY2ltYWwuIEFsbCBvdGhlciBzdHJpbmdzIGFyZSBjb25zaWRlcmVkIGRlY2ltYWwuCgkgICAgICovCgkgICAgSW50ZWdlci5wYXJzZUludCA9IGZ1bmN0aW9uIChudW0sIHJhZGl4KSB7CgkgICAgICAgIGlmIChyYWRpeCA9PT0gdm9pZCAwKSB7IHJhZGl4ID0gdW5kZWZpbmVkOyB9CgkgICAgICAgIHJldHVybiBwYXJzZUludChudW0sIHJhZGl4KTsKCSAgICB9OwoJICAgIEludGVnZXIuTUlOX1ZBTFVFXzMyX0JJVFMgPSAtMjE0NzQ4MzY0ODsKCSAgICBJbnRlZ2VyLk1BWF9WQUxVRSA9IE51bWJlci5NQVhfU0FGRV9JTlRFR0VSOwoJICAgIHJldHVybiBJbnRlZ2VyOwoJfSgpKTsKCUludGVnZXIkMS5kZWZhdWx0ID0gSW50ZWdlcjsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEJpdEFycmF5JDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJLyppbXBvcnQgamF2YS51dGlsLkFycmF5czsqLwoJdmFyIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDggPSBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24kMTsKCXZhciBBcnJheXNfMSQxID0gQXJyYXlzJDE7Cgl2YXIgSW50ZWdlcl8xJDIgPSBJbnRlZ2VyJDE7Cgl2YXIgU3lzdGVtXzEkNCA9IFN5c3RlbSQxOwoJLyoqCgkgKiA8cD5BIHNpbXBsZSwgZmFzdCBhcnJheSBvZiBiaXRzLCByZXByZXNlbnRlZCBjb21wYWN0bHkgYnkgYW4gYXJyYXkgb2YgaW50cyBpbnRlcm5hbGx5LjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgQml0QXJyYXkgLyppbXBsZW1lbnRzIENsb25lYWJsZSovID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIC8vIHB1YmxpYyBjb25zdHJ1Y3RvcigpIHsKCSAgICAvLyAgIHRoaXMuc2l6ZSA9IDAKCSAgICAvLyAgIHRoaXMuYml0cyA9IG5ldyBJbnQzMkFycmF5KDEpCgkgICAgLy8gfQoJICAgIC8vIHB1YmxpYyBjb25zdHJ1Y3RvcihzaXplPzogbnVtYmVyIC8qaW50Ki8pIHsKCSAgICAvLyAgIGlmICh1bmRlZmluZWQgPT09IHNpemUpIHsKCSAgICAvLyAgICAgdGhpcy5zaXplID0gMAoJICAgIC8vICAgfSBlbHNlIHsKCSAgICAvLyAgICAgdGhpcy5zaXplID0gc2l6ZQoJICAgIC8vICAgfQoJICAgIC8vICAgdGhpcy5iaXRzID0gdGhpcy5tYWtlQXJyYXkoc2l6ZSkKCSAgICAvLyB9CgkgICAgLy8gRm9yIHRlc3Rpbmcgb25seQoJICAgIGZ1bmN0aW9uIEJpdEFycmF5KHNpemUgLyppbnQqLywgYml0cykgewoJICAgICAgICBpZiAodW5kZWZpbmVkID09PSBzaXplKSB7CgkgICAgICAgICAgICB0aGlzLnNpemUgPSAwOwoJICAgICAgICAgICAgdGhpcy5iaXRzID0gbmV3IEludDMyQXJyYXkoMSk7CgkgICAgICAgIH0KCSAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICB0aGlzLnNpemUgPSBzaXplOwoJICAgICAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gYml0cyB8fCBudWxsID09PSBiaXRzKSB7CgkgICAgICAgICAgICAgICAgdGhpcy5iaXRzID0gQml0QXJyYXkubWFrZUFycmF5KHNpemUpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgdGhpcy5iaXRzID0gYml0czsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgIH0KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuZ2V0U2l6ZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuc2l6ZTsKCSAgICB9OwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5nZXRTaXplSW5CeXRlcyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIE1hdGguZmxvb3IoKHRoaXMuc2l6ZSArIDcpIC8gOCk7CgkgICAgfTsKCSAgICBCaXRBcnJheS5wcm90b3R5cGUuZW5zdXJlQ2FwYWNpdHkgPSBmdW5jdGlvbiAoc2l6ZSAvKmludCovKSB7CgkgICAgICAgIGlmIChzaXplID4gdGhpcy5iaXRzLmxlbmd0aCAqIDMyKSB7CgkgICAgICAgICAgICB2YXIgbmV3Qml0cyA9IEJpdEFycmF5Lm1ha2VBcnJheShzaXplKTsKCSAgICAgICAgICAgIFN5c3RlbV8xJDQuZGVmYXVsdC5hcnJheWNvcHkodGhpcy5iaXRzLCAwLCBuZXdCaXRzLCAwLCB0aGlzLmJpdHMubGVuZ3RoKTsKCSAgICAgICAgICAgIHRoaXMuYml0cyA9IG5ld0JpdHM7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBpIGJpdCB0byBnZXQKCSAgICAgKiBAcmV0dXJuIHRydWUgaWZmIGJpdCBpIGlzIHNldAoJICAgICAqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbiAoaSAvKmludCovKSB7CgkgICAgICAgIHJldHVybiAodGhpcy5iaXRzW01hdGguZmxvb3IoaSAvIDMyKV0gJiAoMSA8PCAoaSAmIDB4MUYpKSkgIT09IDA7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBTZXRzIGJpdCBpLgoJICAgICAqCgkgICAgICogQHBhcmFtIGkgYml0IHRvIHNldAoJICAgICAqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbiAoaSAvKmludCovKSB7CgkgICAgICAgIHRoaXMuYml0c1tNYXRoLmZsb29yKGkgLyAzMildIHw9IDEgPDwgKGkgJiAweDFGKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEZsaXBzIGJpdCBpLgoJICAgICAqCgkgICAgICogQHBhcmFtIGkgYml0IHRvIHNldAoJICAgICAqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5mbGlwID0gZnVuY3Rpb24gKGkgLyppbnQqLykgewoJICAgICAgICB0aGlzLmJpdHNbTWF0aC5mbG9vcihpIC8gMzIpXSBePSAxIDw8IChpICYgMHgxRik7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gZnJvbSBmaXJzdCBiaXQgdG8gY2hlY2sKCSAgICAgKiBAcmV0dXJuIGluZGV4IG9mIGZpcnN0IGJpdCB0aGF0IGlzIHNldCwgc3RhcnRpbmcgZnJvbSB0aGUgZ2l2ZW4gaW5kZXgsIG9yIHNpemUgaWYgbm9uZSBhcmUgc2V0CgkgICAgICogIGF0IG9yIGJleW9uZCB0aGlzIGdpdmVuIGluZGV4CgkgICAgICogQHNlZSAjZ2V0TmV4dFVuc2V0KGludCkKCSAgICAgKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuZ2V0TmV4dFNldCA9IGZ1bmN0aW9uIChmcm9tIC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIHNpemUgPSB0aGlzLnNpemU7CgkgICAgICAgIGlmIChmcm9tID49IHNpemUpIHsKCSAgICAgICAgICAgIHJldHVybiBzaXplOwoJICAgICAgICB9CgkgICAgICAgIHZhciBiaXRzID0gdGhpcy5iaXRzOwoJICAgICAgICB2YXIgYml0c09mZnNldCA9IE1hdGguZmxvb3IoZnJvbSAvIDMyKTsKCSAgICAgICAgdmFyIGN1cnJlbnRCaXRzID0gYml0c1tiaXRzT2Zmc2V0XTsKCSAgICAgICAgLy8gbWFzayBvZmYgbGVzc2VyIGJpdHMgZmlyc3QKCSAgICAgICAgY3VycmVudEJpdHMgJj0gfigoMSA8PCAoZnJvbSAmIDB4MUYpKSAtIDEpOwoJICAgICAgICB2YXIgbGVuZ3RoID0gYml0cy5sZW5ndGg7CgkgICAgICAgIHdoaWxlIChjdXJyZW50Qml0cyA9PT0gMCkgewoJICAgICAgICAgICAgaWYgKCsrYml0c09mZnNldCA9PT0gbGVuZ3RoKSB7CgkgICAgICAgICAgICAgICAgcmV0dXJuIHNpemU7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBjdXJyZW50Qml0cyA9IGJpdHNbYml0c09mZnNldF07CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHJlc3VsdCA9IChiaXRzT2Zmc2V0ICogMzIpICsgSW50ZWdlcl8xJDIuZGVmYXVsdC5udW1iZXJPZlRyYWlsaW5nWmVyb3MoY3VycmVudEJpdHMpOwoJICAgICAgICByZXR1cm4gcmVzdWx0ID4gc2l6ZSA/IHNpemUgOiByZXN1bHQ7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gZnJvbSBpbmRleCB0byBzdGFydCBsb29raW5nIGZvciB1bnNldCBiaXQKCSAgICAgKiBAcmV0dXJuIGluZGV4IG9mIG5leHQgdW5zZXQgYml0LCBvciB7QGNvZGUgc2l6ZX0gaWYgbm9uZSBhcmUgdW5zZXQgdW50aWwgdGhlIGVuZAoJICAgICAqIEBzZWUgI2dldE5leHRTZXQoaW50KQoJICAgICAqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5nZXROZXh0VW5zZXQgPSBmdW5jdGlvbiAoZnJvbSAvKmludCovKSB7CgkgICAgICAgIHZhciBzaXplID0gdGhpcy5zaXplOwoJICAgICAgICBpZiAoZnJvbSA+PSBzaXplKSB7CgkgICAgICAgICAgICByZXR1cm4gc2l6ZTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgYml0cyA9IHRoaXMuYml0czsKCSAgICAgICAgdmFyIGJpdHNPZmZzZXQgPSBNYXRoLmZsb29yKGZyb20gLyAzMik7CgkgICAgICAgIHZhciBjdXJyZW50Qml0cyA9IH5iaXRzW2JpdHNPZmZzZXRdOwoJICAgICAgICAvLyBtYXNrIG9mZiBsZXNzZXIgYml0cyBmaXJzdAoJICAgICAgICBjdXJyZW50Qml0cyAmPSB+KCgxIDw8IChmcm9tICYgMHgxRikpIC0gMSk7CgkgICAgICAgIHZhciBsZW5ndGggPSBiaXRzLmxlbmd0aDsKCSAgICAgICAgd2hpbGUgKGN1cnJlbnRCaXRzID09PSAwKSB7CgkgICAgICAgICAgICBpZiAoKytiaXRzT2Zmc2V0ID09PSBsZW5ndGgpIHsKCSAgICAgICAgICAgICAgICByZXR1cm4gc2l6ZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGN1cnJlbnRCaXRzID0gfmJpdHNbYml0c09mZnNldF07CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHJlc3VsdCA9IChiaXRzT2Zmc2V0ICogMzIpICsgSW50ZWdlcl8xJDIuZGVmYXVsdC5udW1iZXJPZlRyYWlsaW5nWmVyb3MoY3VycmVudEJpdHMpOwoJICAgICAgICByZXR1cm4gcmVzdWx0ID4gc2l6ZSA/IHNpemUgOiByZXN1bHQ7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBTZXRzIGEgYmxvY2sgb2YgMzIgYml0cywgc3RhcnRpbmcgYXQgYml0IGkuCgkgICAgICoKCSAgICAgKiBAcGFyYW0gaSBmaXJzdCBiaXQgdG8gc2V0CgkgICAgICogQHBhcmFtIG5ld0JpdHMgdGhlIG5ldyB2YWx1ZSBvZiB0aGUgbmV4dCAzMiBiaXRzLiBOb3RlIGFnYWluIHRoYXQgdGhlIGxlYXN0LXNpZ25pZmljYW50IGJpdAoJICAgICAqIGNvcnJlc3BvbmRzIHRvIGJpdCBpLCB0aGUgbmV4dC1sZWFzdC1zaWduaWZpY2FudCB0byBpKzEsIGFuZCBzbyBvbi4KCSAgICAgKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuc2V0QnVsayA9IGZ1bmN0aW9uIChpIC8qaW50Ki8sIG5ld0JpdHMgLyppbnQqLykgewoJICAgICAgICB0aGlzLmJpdHNbTWF0aC5mbG9vcihpIC8gMzIpXSA9IG5ld0JpdHM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBTZXRzIGEgcmFuZ2Ugb2YgYml0cy4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBzdGFydCBzdGFydCBvZiByYW5nZSwgaW5jbHVzaXZlLgoJICAgICAqIEBwYXJhbSBlbmQgZW5kIG9mIHJhbmdlLCBleGNsdXNpdmUKCSAgICAgKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuc2V0UmFuZ2UgPSBmdW5jdGlvbiAoc3RhcnQgLyppbnQqLywgZW5kIC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKGVuZCA8IHN0YXJ0IHx8IHN0YXJ0IDwgMCB8fCBlbmQgPiB0aGlzLnNpemUpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ4LmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoZW5kID09PSBzdGFydCkgewoJICAgICAgICAgICAgcmV0dXJuOwoJICAgICAgICB9CgkgICAgICAgIGVuZC0tOyAvLyB3aWxsIGJlIGVhc2llciB0byB0cmVhdCB0aGlzIGFzIHRoZSBsYXN0IGFjdHVhbGx5IHNldCBiaXQgLS0gaW5jbHVzaXZlCgkgICAgICAgIHZhciBmaXJzdEludCA9IE1hdGguZmxvb3Ioc3RhcnQgLyAzMik7CgkgICAgICAgIHZhciBsYXN0SW50ID0gTWF0aC5mbG9vcihlbmQgLyAzMik7CgkgICAgICAgIHZhciBiaXRzID0gdGhpcy5iaXRzOwoJICAgICAgICBmb3IgKHZhciBpID0gZmlyc3RJbnQ7IGkgPD0gbGFzdEludDsgaSsrKSB7CgkgICAgICAgICAgICB2YXIgZmlyc3RCaXQgPSBpID4gZmlyc3RJbnQgPyAwIDogc3RhcnQgJiAweDFGOwoJICAgICAgICAgICAgdmFyIGxhc3RCaXQgPSBpIDwgbGFzdEludCA/IDMxIDogZW5kICYgMHgxRjsKCSAgICAgICAgICAgIC8vIE9uZXMgZnJvbSBmaXJzdEJpdCB0byBsYXN0Qml0LCBpbmNsdXNpdmUKCSAgICAgICAgICAgIHZhciBtYXNrID0gKDIgPDwgbGFzdEJpdCkgLSAoMSA8PCBmaXJzdEJpdCk7CgkgICAgICAgICAgICBiaXRzW2ldIHw9IG1hc2s7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIC8qKgoJICAgICAqIENsZWFycyBhbGwgYml0cyAoc2V0cyB0byBmYWxzZSkuCgkgICAgICovCgkgICAgQml0QXJyYXkucHJvdG90eXBlLmNsZWFyID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgbWF4ID0gdGhpcy5iaXRzLmxlbmd0aDsKCSAgICAgICAgdmFyIGJpdHMgPSB0aGlzLmJpdHM7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbWF4OyBpKyspIHsKCSAgICAgICAgICAgIGJpdHNbaV0gPSAwOwoJICAgICAgICB9CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBFZmZpY2llbnQgbWV0aG9kIHRvIGNoZWNrIGlmIGEgcmFuZ2Ugb2YgYml0cyBpcyBzZXQsIG9yIG5vdCBzZXQuCgkgICAgICoKCSAgICAgKiBAcGFyYW0gc3RhcnQgc3RhcnQgb2YgcmFuZ2UsIGluY2x1c2l2ZS4KCSAgICAgKiBAcGFyYW0gZW5kIGVuZCBvZiByYW5nZSwgZXhjbHVzaXZlCgkgICAgICogQHBhcmFtIHZhbHVlIGlmIHRydWUsIGNoZWNrcyB0aGF0IGJpdHMgaW4gcmFuZ2UgYXJlIHNldCwgb3RoZXJ3aXNlIGNoZWNrcyB0aGF0IHRoZXkgYXJlIG5vdCBzZXQKCSAgICAgKiBAcmV0dXJuIHRydWUgaWZmIGFsbCBiaXRzIGFyZSBzZXQgb3Igbm90IHNldCBpbiByYW5nZSwgYWNjb3JkaW5nIHRvIHZhbHVlIGFyZ3VtZW50CgkgICAgICogQHRocm93cyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24gaWYgZW5kIGlzIGxlc3MgdGhhbiBzdGFydCBvciB0aGUgcmFuZ2UgaXMgbm90IGNvbnRhaW5lZCBpbiB0aGUgYXJyYXkKCSAgICAgKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuaXNSYW5nZSA9IGZ1bmN0aW9uIChzdGFydCAvKmludCovLCBlbmQgLyppbnQqLywgdmFsdWUpIHsKCSAgICAgICAgaWYgKGVuZCA8IHN0YXJ0IHx8IHN0YXJ0IDwgMCB8fCBlbmQgPiB0aGlzLnNpemUpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ4LmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoZW5kID09PSBzdGFydCkgewoJICAgICAgICAgICAgcmV0dXJuIHRydWU7IC8vIGVtcHR5IHJhbmdlIG1hdGNoZXMKCSAgICAgICAgfQoJICAgICAgICBlbmQtLTsgLy8gd2lsbCBiZSBlYXNpZXIgdG8gdHJlYXQgdGhpcyBhcyB0aGUgbGFzdCBhY3R1YWxseSBzZXQgYml0IC0tIGluY2x1c2l2ZQoJICAgICAgICB2YXIgZmlyc3RJbnQgPSBNYXRoLmZsb29yKHN0YXJ0IC8gMzIpOwoJICAgICAgICB2YXIgbGFzdEludCA9IE1hdGguZmxvb3IoZW5kIC8gMzIpOwoJICAgICAgICB2YXIgYml0cyA9IHRoaXMuYml0czsKCSAgICAgICAgZm9yICh2YXIgaSA9IGZpcnN0SW50OyBpIDw9IGxhc3RJbnQ7IGkrKykgewoJICAgICAgICAgICAgdmFyIGZpcnN0Qml0ID0gaSA+IGZpcnN0SW50ID8gMCA6IHN0YXJ0ICYgMHgxRjsKCSAgICAgICAgICAgIHZhciBsYXN0Qml0ID0gaSA8IGxhc3RJbnQgPyAzMSA6IGVuZCAmIDB4MUY7CgkgICAgICAgICAgICAvLyBPbmVzIGZyb20gZmlyc3RCaXQgdG8gbGFzdEJpdCwgaW5jbHVzaXZlCgkgICAgICAgICAgICB2YXIgbWFzayA9ICgyIDw8IGxhc3RCaXQpIC0gKDEgPDwgZmlyc3RCaXQpICYgMHhGRkZGRkZGRjsKCSAgICAgICAgICAgIC8vIFRZUEVTQ1JJUFRQT1JUOiAmIDB4RkZGRkZGRkYgYWRkZWQgdG8gZGlzY2FyZCBhbnl0aGluZyBhZnRlciAzMiBiaXRzLCBhcyBFUyBoYXMgNTMgYml0cwoJICAgICAgICAgICAgLy8gUmV0dXJuIGZhbHNlIGlmIHdlJ3JlIGxvb2tpbmcgZm9yIDFzIGFuZCB0aGUgbWFza2VkIGJpdHNbaV0gaXNuJ3QgYWxsIDFzIChpczogdGhhdCwKCSAgICAgICAgICAgIC8vIGVxdWFscyB0aGUgbWFzaywgb3Igd2UncmUgbG9va2luZyBmb3IgMHMgYW5kIHRoZSBtYXNrZWQgcG9ydGlvbiBpcyBub3QgYWxsIDBzCgkgICAgICAgICAgICBpZiAoKGJpdHNbaV0gJiBtYXNrKSAhPT0gKHZhbHVlID8gbWFzayA6IDApKSB7CgkgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiB0cnVlOwoJICAgIH07CgkgICAgQml0QXJyYXkucHJvdG90eXBlLmFwcGVuZEJpdCA9IGZ1bmN0aW9uIChiaXQpIHsKCSAgICAgICAgdGhpcy5lbnN1cmVDYXBhY2l0eSh0aGlzLnNpemUgKyAxKTsKCSAgICAgICAgaWYgKGJpdCkgewoJICAgICAgICAgICAgdGhpcy5iaXRzW01hdGguZmxvb3IodGhpcy5zaXplIC8gMzIpXSB8PSAxIDw8ICh0aGlzLnNpemUgJiAweDFGKTsKCSAgICAgICAgfQoJICAgICAgICB0aGlzLnNpemUrKzsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEFwcGVuZHMgdGhlIGxlYXN0LXNpZ25pZmljYW50IGJpdHMsIGZyb20gdmFsdWUsIGluIG9yZGVyIGZyb20gbW9zdC1zaWduaWZpY2FudCB0bwoJICAgICAqIGxlYXN0LXNpZ25pZmljYW50LiBGb3IgZXhhbXBsZSwgYXBwZW5kaW5nIDYgYml0cyBmcm9tIDB4MDAwMDAxRSB3aWxsIGFwcGVuZCB0aGUgYml0cwoJICAgICAqIDAsIDEsIDEsIDEsIDEsIDAgaW4gdGhhdCBvcmRlci4KCSAgICAgKgoJICAgICAqIEBwYXJhbSB2YWx1ZSB7QGNvZGUgaW50fSBjb250YWluaW5nIGJpdHMgdG8gYXBwZW5kCgkgICAgICogQHBhcmFtIG51bUJpdHMgYml0cyBmcm9tIHZhbHVlIHRvIGFwcGVuZAoJICAgICAqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5hcHBlbmRCaXRzID0gZnVuY3Rpb24gKHZhbHVlIC8qaW50Ki8sIG51bUJpdHMgLyppbnQqLykgewoJICAgICAgICBpZiAobnVtQml0cyA8IDAgfHwgbnVtQml0cyA+IDMyKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkOC5kZWZhdWx0KCdOdW0gYml0cyBtdXN0IGJlIGJldHdlZW4gMCBhbmQgMzInKTsKCSAgICAgICAgfQoJICAgICAgICB0aGlzLmVuc3VyZUNhcGFjaXR5KHRoaXMuc2l6ZSArIG51bUJpdHMpOwoJICAgICAgICAvLyBjb25zdCBhcHBlbmRCaXQgPSB0aGlzLmFwcGVuZEJpdDsKCSAgICAgICAgZm9yICh2YXIgbnVtQml0c0xlZnQgPSBudW1CaXRzOyBudW1CaXRzTGVmdCA+IDA7IG51bUJpdHNMZWZ0LS0pIHsKCSAgICAgICAgICAgIHRoaXMuYXBwZW5kQml0KCgodmFsdWUgPj4gKG51bUJpdHNMZWZ0IC0gMSkpICYgMHgwMSkgPT09IDEpOwoJICAgICAgICB9CgkgICAgfTsKCSAgICBCaXRBcnJheS5wcm90b3R5cGUuYXBwZW5kQml0QXJyYXkgPSBmdW5jdGlvbiAob3RoZXIpIHsKCSAgICAgICAgdmFyIG90aGVyU2l6ZSA9IG90aGVyLnNpemU7CgkgICAgICAgIHRoaXMuZW5zdXJlQ2FwYWNpdHkodGhpcy5zaXplICsgb3RoZXJTaXplKTsKCSAgICAgICAgLy8gY29uc3QgYXBwZW5kQml0ID0gdGhpcy5hcHBlbmRCaXQ7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgb3RoZXJTaXplOyBpKyspIHsKCSAgICAgICAgICAgIHRoaXMuYXBwZW5kQml0KG90aGVyLmdldChpKSk7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS54b3IgPSBmdW5jdGlvbiAob3RoZXIpIHsKCSAgICAgICAgaWYgKHRoaXMuc2l6ZSAhPT0gb3RoZXIuc2l6ZSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDguZGVmYXVsdCgnU2l6ZXMgZG9uXCd0IG1hdGNoJyk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGJpdHMgPSB0aGlzLmJpdHM7CgkgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGhfMSA9IGJpdHMubGVuZ3RoOyBpIDwgbGVuZ3RoXzE7IGkrKykgewoJICAgICAgICAgICAgLy8gVGhlIGxhc3QgaW50IGNvdWxkIGJlIGluY29tcGxldGUgKGkuZS4gbm90IGhhdmUgMzIgYml0cyBpbgoJICAgICAgICAgICAgLy8gaXQpIGJ1dCB0aGVyZSBpcyBubyBwcm9ibGVtIHNpbmNlIDAgWE9SIDAgPT0gMC4KCSAgICAgICAgICAgIGJpdHNbaV0gXj0gb3RoZXIuYml0c1tpXTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgLyoqCgkgICAgICoKCSAgICAgKiBAcGFyYW0gYml0T2Zmc2V0IGZpcnN0IGJpdCB0byBzdGFydCB3cml0aW5nCgkgICAgICogQHBhcmFtIGFycmF5IGFycmF5IHRvIHdyaXRlIGludG8uIEJ5dGVzIGFyZSB3cml0dGVuIG1vc3Qtc2lnbmlmaWNhbnQgYnl0ZSBmaXJzdC4gVGhpcyBpcyB0aGUgb3Bwb3NpdGUKCSAgICAgKiAgb2YgdGhlIGludGVybmFsIHJlcHJlc2VudGF0aW9uLCB3aGljaCBpcyBleHBvc2VkIGJ5IHtAbGluayAjZ2V0Qml0QXJyYXkoKX0KCSAgICAgKiBAcGFyYW0gb2Zmc2V0IHBvc2l0aW9uIGluIGFycmF5IHRvIHN0YXJ0IHdyaXRpbmcKCSAgICAgKiBAcGFyYW0gbnVtQnl0ZXMgaG93IG1hbnkgYnl0ZXMgdG8gd3JpdGUKCSAgICAgKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUudG9CeXRlcyA9IGZ1bmN0aW9uIChiaXRPZmZzZXQgLyppbnQqLywgYXJyYXksIG9mZnNldCAvKmludCovLCBudW1CeXRlcyAvKmludCovKSB7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbnVtQnl0ZXM7IGkrKykgewoJICAgICAgICAgICAgdmFyIHRoZUJ5dGUgPSAwOwoJICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCA4OyBqKyspIHsKCSAgICAgICAgICAgICAgICBpZiAodGhpcy5nZXQoYml0T2Zmc2V0KSkgewoJICAgICAgICAgICAgICAgICAgICB0aGVCeXRlIHw9IDEgPDwgKDcgLSBqKTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgYml0T2Zmc2V0Kys7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBhcnJheVtvZmZzZXQgKyBpXSA9IC8qKGJ5dGUpKi8gdGhlQnl0ZTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiB1bmRlcmx5aW5nIGFycmF5IG9mIGludHMuIFRoZSBmaXJzdCBlbGVtZW50IGhvbGRzIHRoZSBmaXJzdCAzMiBiaXRzLCBhbmQgdGhlIGxlYXN0CgkgICAgICogICAgICAgICBzaWduaWZpY2FudCBiaXQgaXMgYml0IDAuCgkgICAgICovCgkgICAgQml0QXJyYXkucHJvdG90eXBlLmdldEJpdEFycmF5ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5iaXRzOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogUmV2ZXJzZXMgYWxsIGJpdHMgaW4gdGhlIGFycmF5LgoJICAgICAqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5yZXZlcnNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgbmV3Qml0cyA9IG5ldyBJbnQzMkFycmF5KHRoaXMuYml0cy5sZW5ndGgpOwoJICAgICAgICAvLyByZXZlcnNlIGFsbCBpbnQncyBmaXJzdAoJICAgICAgICB2YXIgbGVuID0gTWF0aC5mbG9vcigodGhpcy5zaXplIC0gMSkgLyAzMik7CgkgICAgICAgIHZhciBvbGRCaXRzTGVuID0gbGVuICsgMTsKCSAgICAgICAgdmFyIGJpdHMgPSB0aGlzLmJpdHM7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgb2xkQml0c0xlbjsgaSsrKSB7CgkgICAgICAgICAgICB2YXIgeCA9IGJpdHNbaV07CgkgICAgICAgICAgICB4ID0gKCh4ID4+IDEpICYgMHg1NTU1NTU1NSkgfCAoKHggJiAweDU1NTU1NTU1KSA8PCAxKTsKCSAgICAgICAgICAgIHggPSAoKHggPj4gMikgJiAweDMzMzMzMzMzKSB8ICgoeCAmIDB4MzMzMzMzMzMpIDw8IDIpOwoJICAgICAgICAgICAgeCA9ICgoeCA+PiA0KSAmIDB4MGYwZjBmMGYpIHwgKCh4ICYgMHgwZjBmMGYwZikgPDwgNCk7CgkgICAgICAgICAgICB4ID0gKCh4ID4+IDgpICYgMHgwMGZmMDBmZikgfCAoKHggJiAweDAwZmYwMGZmKSA8PCA4KTsKCSAgICAgICAgICAgIHggPSAoKHggPj4gMTYpICYgMHgwMDAwZmZmZikgfCAoKHggJiAweDAwMDBmZmZmKSA8PCAxNik7CgkgICAgICAgICAgICBuZXdCaXRzW2xlbiAtIGldID0gLyooaW50KSovIHg7CgkgICAgICAgIH0KCSAgICAgICAgLy8gbm93IGNvcnJlY3QgdGhlIGludCdzIGlmIHRoZSBiaXQgc2l6ZSBpc24ndCBhIG11bHRpcGxlIG9mIDMyCgkgICAgICAgIGlmICh0aGlzLnNpemUgIT09IG9sZEJpdHNMZW4gKiAzMikgewoJICAgICAgICAgICAgdmFyIGxlZnRPZmZzZXQgPSBvbGRCaXRzTGVuICogMzIgLSB0aGlzLnNpemU7CgkgICAgICAgICAgICB2YXIgY3VycmVudEludCA9IG5ld0JpdHNbMF0gPj4+IGxlZnRPZmZzZXQ7CgkgICAgICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IG9sZEJpdHNMZW47IGkrKykgewoJICAgICAgICAgICAgICAgIHZhciBuZXh0SW50ID0gbmV3Qml0c1tpXTsKCSAgICAgICAgICAgICAgICBjdXJyZW50SW50IHw9IG5leHRJbnQgPDwgKDMyIC0gbGVmdE9mZnNldCk7CgkgICAgICAgICAgICAgICAgbmV3Qml0c1tpIC0gMV0gPSBjdXJyZW50SW50OwoJICAgICAgICAgICAgICAgIGN1cnJlbnRJbnQgPSBuZXh0SW50ID4+PiBsZWZ0T2Zmc2V0OwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgbmV3Qml0c1tvbGRCaXRzTGVuIC0gMV0gPSBjdXJyZW50SW50OwoJICAgICAgICB9CgkgICAgICAgIHRoaXMuYml0cyA9IG5ld0JpdHM7CgkgICAgfTsKCSAgICBCaXRBcnJheS5tYWtlQXJyYXkgPSBmdW5jdGlvbiAoc2l6ZSAvKmludCovKSB7CgkgICAgICAgIHJldHVybiBuZXcgSW50MzJBcnJheShNYXRoLmZsb29yKChzaXplICsgMzEpIC8gMzIpKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuZXF1YWxzID0gZnVuY3Rpb24gKG8pIHsKCSAgICAgICAgaWYgKCEobyBpbnN0YW5jZW9mIEJpdEFycmF5KSkgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIHZhciBvdGhlciA9IG87CgkgICAgICAgIHJldHVybiB0aGlzLnNpemUgPT09IG90aGVyLnNpemUgJiYgQXJyYXlzXzEkMS5kZWZhdWx0LmVxdWFscyh0aGlzLmJpdHMsIG90aGVyLmJpdHMpOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5oYXNoQ29kZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIDMxICogdGhpcy5zaXplICsgQXJyYXlzXzEkMS5kZWZhdWx0Lmhhc2hDb2RlKHRoaXMuYml0cyk7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgQml0QXJyYXkucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgcmVzdWx0ID0gJyc7CgkgICAgICAgIGZvciAodmFyIGkgPSAwLCBzaXplID0gdGhpcy5zaXplOyBpIDwgc2l6ZTsgaSsrKSB7CgkgICAgICAgICAgICBpZiAoKGkgJiAweDA3KSA9PT0gMCkgewoJICAgICAgICAgICAgICAgIHJlc3VsdCArPSAnICc7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICByZXN1bHQgKz0gdGhpcy5nZXQoaSkgPyAnWCcgOiAnLic7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuY2xvbmUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiBuZXcgQml0QXJyYXkodGhpcy5zaXplLCB0aGlzLmJpdHMuc2xpY2UoKSk7CgkgICAgfTsKCSAgICByZXR1cm4gQml0QXJyYXk7Cgl9KCkpOwoJQml0QXJyYXkkMS5kZWZhdWx0ID0gQml0QXJyYXk7CgoJdmFyIEJpdE1hdHJpeCQxID0ge307CgoJdmFyIFN0cmluZ0J1aWxkZXIkMSA9IHt9OwoKCXZhciBTdHJpbmdVdGlscyQxID0ge307CgoJdmFyIERlY29kZUhpbnRUeXBlJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDkgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KERlY29kZUhpbnRUeXBlJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcgeyovCgkvKioKCSAqIEVuY2Fwc3VsYXRlcyBhIHR5cGUgb2YgaGludCB0aGF0IGEgY2FsbGVyIG1heSBwYXNzIHRvIGEgYmFyY29kZSByZWFkZXIgdG8gaGVscCBpdAoJICogbW9yZSBxdWlja2x5IG9yIGFjY3VyYXRlbHkgZGVjb2RlIGl0LiBJdCBpcyB1cCB0byBpbXBsZW1lbnRhdGlvbnMgdG8gZGVjaWRlIHdoYXQsCgkgKiBpZiBhbnl0aGluZywgdG8gZG8gd2l0aCB0aGUgaW5mb3JtYXRpb24gdGhhdCBpcyBzdXBwbGllZC4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICogQGF1dGhvciBkc3dpdGtpbkBnb29nbGUuY29tIChEYW5pZWwgU3dpdGtpbikKCSAqIEBzZWUgUmVhZGVyI2RlY29kZShCaW5hcnlCaXRtYXAsamF2YS51dGlsLk1hcCkKCSAqLwoJdmFyIERlY29kZUhpbnRUeXBlOwoJKGZ1bmN0aW9uIChEZWNvZGVIaW50VHlwZSkgewoJICAgIC8qKgoJICAgICAqIFVuc3BlY2lmaWVkLCBhcHBsaWNhdGlvbi1zcGVjaWZpYyBoaW50LiBNYXBzIHRvIGFuIHVuc3BlY2lmaWVkIHtAbGluayBPYmplY3R9LgoJICAgICAqLwoJICAgIERlY29kZUhpbnRUeXBlW0RlY29kZUhpbnRUeXBlWyJPVEhFUiJdID0gMF0gPSAiT1RIRVIiOyAvKihPYmplY3QuY2xhc3MpKi8KCSAgICAvKioKCSAgICAgKiBJbWFnZSBpcyBhIHB1cmUgbW9ub2Nocm9tZSBpbWFnZSBvZiBhIGJhcmNvZGUuIERvZXNuJ3QgbWF0dGVyIHdoYXQgaXQgbWFwcyB0bzsKCSAgICAgKiB1c2Uge0BsaW5rIEJvb2xlYW4jVFJVRX0uCgkgICAgICovCgkgICAgRGVjb2RlSGludFR5cGVbRGVjb2RlSGludFR5cGVbIlBVUkVfQkFSQ09ERSJdID0gMV0gPSAiUFVSRV9CQVJDT0RFIjsgLyooVm9pZC5jbGFzcykqLwoJICAgIC8qKgoJICAgICAqIEltYWdlIGlzIGtub3duIHRvIGJlIG9mIG9uZSBvZiBhIGZldyBwb3NzaWJsZSBmb3JtYXRzLgoJICAgICAqIE1hcHMgdG8gYSB7QGxpbmsgTGlzdH0gb2Yge0BsaW5rIEJhcmNvZGVGb3JtYXR9cy4KCSAgICAgKi8KCSAgICBEZWNvZGVIaW50VHlwZVtEZWNvZGVIaW50VHlwZVsiUE9TU0lCTEVfRk9STUFUUyJdID0gMl0gPSAiUE9TU0lCTEVfRk9STUFUUyI7IC8qKExpc3QuY2xhc3MpKi8KCSAgICAvKioKCSAgICAgKiBTcGVuZCBtb3JlIHRpbWUgdG8gdHJ5IHRvIGZpbmQgYSBiYXJjb2RlOyBvcHRpbWl6ZSBmb3IgYWNjdXJhY3ksIG5vdCBzcGVlZC4KCSAgICAgKiBEb2Vzbid0IG1hdHRlciB3aGF0IGl0IG1hcHMgdG87IHVzZSB7QGxpbmsgQm9vbGVhbiNUUlVFfS4KCSAgICAgKi8KCSAgICBEZWNvZGVIaW50VHlwZVtEZWNvZGVIaW50VHlwZVsiVFJZX0hBUkRFUiJdID0gM10gPSAiVFJZX0hBUkRFUiI7IC8qKFZvaWQuY2xhc3MpKi8KCSAgICAvKioKCSAgICAgKiBTcGVjaWZpZXMgd2hhdCBjaGFyYWN0ZXIgZW5jb2RpbmcgdG8gdXNlIHdoZW4gZGVjb2RpbmcsIHdoZXJlIGFwcGxpY2FibGUgKHR5cGUgU3RyaW5nKQoJICAgICAqLwoJICAgIERlY29kZUhpbnRUeXBlW0RlY29kZUhpbnRUeXBlWyJDSEFSQUNURVJfU0VUIl0gPSA0XSA9ICJDSEFSQUNURVJfU0VUIjsgLyooU3RyaW5nLmNsYXNzKSovCgkgICAgLyoqCgkgICAgICogQWxsb3dlZCBsZW5ndGhzIG9mIGVuY29kZWQgZGF0YSAtLSByZWplY3QgYW55dGhpbmcgZWxzZS4gTWFwcyB0byBhbiB7QGNvZGUgSW50MzJBcnJheX0uCgkgICAgICovCgkgICAgRGVjb2RlSGludFR5cGVbRGVjb2RlSGludFR5cGVbIkFMTE9XRURfTEVOR1RIUyJdID0gNV0gPSAiQUxMT1dFRF9MRU5HVEhTIjsgLyooSW50MzJBcnJheS5jbGFzcykqLwoJICAgIC8qKgoJICAgICAqIEFzc3VtZSBDb2RlIDM5IGNvZGVzIGVtcGxveSBhIGNoZWNrIGRpZ2l0LiBEb2Vzbid0IG1hdHRlciB3aGF0IGl0IG1hcHMgdG87CgkgICAgICogdXNlIHtAbGluayBCb29sZWFuI1RSVUV9LgoJICAgICAqLwoJICAgIERlY29kZUhpbnRUeXBlW0RlY29kZUhpbnRUeXBlWyJBU1NVTUVfQ09ERV8zOV9DSEVDS19ESUdJVCJdID0gNl0gPSAiQVNTVU1FX0NPREVfMzlfQ0hFQ0tfRElHSVQiOyAvKihWb2lkLmNsYXNzKSovCgkgICAgLyoqCgkgICAgICogQXNzdW1lIHRoZSBiYXJjb2RlIGlzIGJlaW5nIHByb2Nlc3NlZCBhcyBhIEdTMSBiYXJjb2RlLCBhbmQgbW9kaWZ5IGJlaGF2aW9yIGFzIG5lZWRlZC4KCSAgICAgKiBGb3IgZXhhbXBsZSB0aGlzIGFmZmVjdHMgRk5DMSBoYW5kbGluZyBmb3IgQ29kZSAxMjggKGFrYSBHUzEtMTI4KS4gRG9lc24ndCBtYXR0ZXIgd2hhdCBpdCBtYXBzIHRvOwoJICAgICAqIHVzZSB7QGxpbmsgQm9vbGVhbiNUUlVFfS4KCSAgICAgKi8KCSAgICBEZWNvZGVIaW50VHlwZVtEZWNvZGVIaW50VHlwZVsiQVNTVU1FX0dTMSJdID0gN10gPSAiQVNTVU1FX0dTMSI7IC8qKFZvaWQuY2xhc3MpKi8KCSAgICAvKioKCSAgICAgKiBJZiB0cnVlLCByZXR1cm4gdGhlIHN0YXJ0IGFuZCBlbmQgZGlnaXRzIGluIGEgQ29kYWJhciBiYXJjb2RlIGluc3RlYWQgb2Ygc3RyaXBwaW5nIHRoZW0uIFRoZXkKCSAgICAgKiBhcmUgYWxwaGEsIHdoZXJlYXMgdGhlIHJlc3QgYXJlIG51bWVyaWMuIEJ5IGRlZmF1bHQsIHRoZXkgYXJlIHN0cmlwcGVkLCBidXQgdGhpcyBjYXVzZXMgdGhlbQoJICAgICAqIHRvIG5vdCBiZS4gRG9lc24ndCBtYXR0ZXIgd2hhdCBpdCBtYXBzIHRvOyB1c2Uge0BsaW5rIEJvb2xlYW4jVFJVRX0uCgkgICAgICovCgkgICAgRGVjb2RlSGludFR5cGVbRGVjb2RlSGludFR5cGVbIlJFVFVSTl9DT0RBQkFSX1NUQVJUX0VORCJdID0gOF0gPSAiUkVUVVJOX0NPREFCQVJfU1RBUlRfRU5EIjsgLyooVm9pZC5jbGFzcykqLwoJICAgIC8qKgoJICAgICAqIFRoZSBjYWxsZXIgbmVlZHMgdG8gYmUgbm90aWZpZWQgdmlhIGNhbGxiYWNrIHdoZW4gYSBwb3NzaWJsZSB7QGxpbmsgUmVzdWx0UG9pbnR9CgkgICAgICogaXMgZm91bmQuIE1hcHMgdG8gYSB7QGxpbmsgUmVzdWx0UG9pbnRDYWxsYmFja30uCgkgICAgICovCgkgICAgRGVjb2RlSGludFR5cGVbRGVjb2RlSGludFR5cGVbIk5FRURfUkVTVUxUX1BPSU5UX0NBTExCQUNLIl0gPSA5XSA9ICJORUVEX1JFU1VMVF9QT0lOVF9DQUxMQkFDSyI7IC8qKFJlc3VsdFBvaW50Q2FsbGJhY2suY2xhc3MpKi8KCSAgICAvKioKCSAgICAgKiBBbGxvd2VkIGV4dGVuc2lvbiBsZW5ndGhzIGZvciBFQU4gb3IgVVBDIGJhcmNvZGVzLiBPdGhlciBmb3JtYXRzIHdpbGwgaWdub3JlIHRoaXMuCgkgICAgICogTWFwcyB0byBhbiB7QGNvZGUgSW50MzJBcnJheX0gb2YgdGhlIGFsbG93ZWQgZXh0ZW5zaW9uIGxlbmd0aHMsIGZvciBleGFtcGxlIFsyXSwgWzVdLCBvciBbMiwgNV0uCgkgICAgICogSWYgaXQgaXMgb3B0aW9uYWwgdG8gaGF2ZSBhbiBleHRlbnNpb24sIGRvIG5vdCBzZXQgdGhpcyBoaW50LiBJZiB0aGlzIGlzIHNldCwKCSAgICAgKiBhbmQgYSBVUEMgb3IgRUFOIGJhcmNvZGUgaXMgZm91bmQgYnV0IGFuIGV4dGVuc2lvbiBpcyBub3QsIHRoZW4gbm8gcmVzdWx0IHdpbGwgYmUgcmV0dXJuZWQKCSAgICAgKiBhdCBhbGwuCgkgICAgICovCgkgICAgRGVjb2RlSGludFR5cGVbRGVjb2RlSGludFR5cGVbIkFMTE9XRURfRUFOX0VYVEVOU0lPTlMiXSA9IDEwXSA9ICJBTExPV0VEX0VBTl9FWFRFTlNJT05TIjsgLyooSW50MzJBcnJheS5jbGFzcykqLwoJICAgIC8vIEVuZCBvZiBlbnVtZXJhdGlvbiB2YWx1ZXMuCgkgICAgLyoqCgkgICAgICogRGF0YSB0eXBlIHRoZSBoaW50IGlzIGV4cGVjdGluZy4KCSAgICAgKiBBbW9uZyB0aGUgcG9zc2libGUgdmFsdWVzIHRoZSB7QGxpbmsgVm9pZH0gc3RhbmRzIG91dCBhcyBiZWluZyB1c2VkIGZvcgoJICAgICAqIGhpbnRzIHRoYXQgZG8gbm90IGV4cGVjdCBhIHZhbHVlIHRvIGJlIHN1cHBsaWVkIChmbGFnIGhpbnRzKS4gU3VjaCBoaW50cwoJICAgICAqIHdpbGwgcG9zc2libHkgaGF2ZSB0aGVpciB2YWx1ZSBpZ25vcmVkLCBvciByZXBsYWNlZCBieSBhCgkgICAgICoge0BsaW5rIEJvb2xlYW4jVFJVRX0uIEhpbnQgc3VwcGxpZXJzIHNob3VsZCBwcm9iYWJseSB1c2UKCSAgICAgKiB7QGxpbmsgQm9vbGVhbiNUUlVFfSBhcyBkaXJlY3RlZCBieSB0aGUgYWN0dWFsIGhpbnQgZG9jdW1lbnRhdGlvbi4KCSAgICAgKi8KCSAgICAvLyBwcml2YXRlIHZhbHVlVHlwZTogQ2xhc3M8Pz4KCSAgICAvLyBEZWNvZGVIaW50VHlwZSh2YWx1ZVR5cGU6IENsYXNzPD8+KSB7CgkgICAgLy8gICB0aGlzLnZhbHVlVHlwZSA9IHZhbHVlVHlwZQoJICAgIC8vIH0KCSAgICAvLyBwdWJsaWMgZ2V0VmFsdWVUeXBlKCk6IENsYXNzPD8+IHsKCSAgICAvLyAgIHJldHVybiB2YWx1ZVR5cGUKCSAgICAvLyB9Cgl9KShEZWNvZGVIaW50VHlwZSB8fCAoRGVjb2RlSGludFR5cGUgPSB7fSkpOwoJRGVjb2RlSGludFR5cGUkMS5kZWZhdWx0ID0gRGVjb2RlSGludFR5cGU7CgoJdmFyIENoYXJhY3RlclNldEVDSSA9IHt9OwoKCXZhciBGb3JtYXRFeGNlcHRpb24kMSA9IHt9OwoKCXZhciBfX2V4dGVuZHMkZiA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShGb3JtYXRFeGNlcHRpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIEV4Y2VwdGlvbl8xJDcgPSBFeGNlcHRpb24kMTsKCS8qKgoJICogQ3VzdG9tIEVycm9yIGNsYXNzIG9mIHR5cGUgRXhjZXB0aW9uLgoJICovCgl2YXIgRm9ybWF0RXhjZXB0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikgewoJICAgIF9fZXh0ZW5kcyRmKEZvcm1hdEV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBGb3JtYXRFeGNlcHRpb24oKSB7CgkgICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpczsKCSAgICB9CgkgICAgRm9ybWF0RXhjZXB0aW9uLmdldEZvcm1hdEluc3RhbmNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gbmV3IEZvcm1hdEV4Y2VwdGlvbigpOwoJICAgIH07CgkgICAgRm9ybWF0RXhjZXB0aW9uLmtpbmQgPSAnRm9ybWF0RXhjZXB0aW9uJzsKCSAgICByZXR1cm4gRm9ybWF0RXhjZXB0aW9uOwoJfShFeGNlcHRpb25fMSQ3LmRlZmF1bHQpKTsKCUZvcm1hdEV4Y2VwdGlvbiQxLmRlZmF1bHQgPSBGb3JtYXRFeGNlcHRpb247CgoJKGZ1bmN0aW9uIChleHBvcnRzKSB7CgkvKgoJICogQ29weXJpZ2h0IDIwMDggWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fdmFsdWVzID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fdmFsdWVzKSB8fCBmdW5jdGlvbihvKSB7CgkgICAgdmFyIHMgPSB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIFN5bWJvbC5pdGVyYXRvciwgbSA9IHMgJiYgb1tzXSwgaSA9IDA7CgkgICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7CgkgICAgaWYgKG8gJiYgdHlwZW9mIG8ubGVuZ3RoID09PSAibnVtYmVyIikgcmV0dXJuIHsKCSAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkgewoJICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDsKCSAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihzID8gIk9iamVjdCBpcyBub3QgaXRlcmFibGUuIiA6ICJTeW1ib2wuaXRlcmF0b3IgaXMgbm90IGRlZmluZWQuIik7Cgl9OwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCWV4cG9ydHMuQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycyA9IHZvaWQgMDsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJdmFyIEZvcm1hdEV4Y2VwdGlvbl8xID0gRm9ybWF0RXhjZXB0aW9uJDE7CgkvKmltcG9ydCBqYXZhLnV0aWwuSGFzaE1hcDsqLwoJLyppbXBvcnQgamF2YS51dGlsLk1hcDsqLwoJdmFyIENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnM7CgkoZnVuY3Rpb24gKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMpIHsKCSAgICBDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzW0NoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbIkNwNDM3Il0gPSAwXSA9ICJDcDQzNyI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzEiXSA9IDFdID0gIklTTzg4NTlfMSI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzIiXSA9IDJdID0gIklTTzg4NTlfMiI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzMiXSA9IDNdID0gIklTTzg4NTlfMyI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzQiXSA9IDRdID0gIklTTzg4NTlfNCI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzUiXSA9IDVdID0gIklTTzg4NTlfNSI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzYiXSA9IDZdID0gIklTTzg4NTlfNiI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzciXSA9IDddID0gIklTTzg4NTlfNyI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzgiXSA9IDhdID0gIklTTzg4NTlfOCI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzkiXSA9IDldID0gIklTTzg4NTlfOSI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzEwIl0gPSAxMF0gPSAiSVNPODg1OV8xMCI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzExIl0gPSAxMV0gPSAiSVNPODg1OV8xMSI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzEzIl0gPSAxMl0gPSAiSVNPODg1OV8xMyI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzE0Il0gPSAxM10gPSAiSVNPODg1OV8xNCI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzE1Il0gPSAxNF0gPSAiSVNPODg1OV8xNSI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzE2Il0gPSAxNV0gPSAiSVNPODg1OV8xNiI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJTSklTIl0gPSAxNl0gPSAiU0pJUyI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJDcDEyNTAiXSA9IDE3XSA9ICJDcDEyNTAiOwoJICAgIENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1siQ3AxMjUxIl0gPSAxOF0gPSAiQ3AxMjUxIjsKCSAgICBDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzW0NoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbIkNwMTI1MiJdID0gMTldID0gIkNwMTI1MiI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJDcDEyNTYiXSA9IDIwXSA9ICJDcDEyNTYiOwoJICAgIENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1siVW5pY29kZUJpZ1VubWFya2VkIl0gPSAyMV0gPSAiVW5pY29kZUJpZ1VubWFya2VkIjsKCSAgICBDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzW0NoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbIlVURjgiXSA9IDIyXSA9ICJVVEY4IjsKCSAgICBDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzW0NoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbIkFTQ0lJIl0gPSAyM10gPSAiQVNDSUkiOwoJICAgIENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1siQmlnNSJdID0gMjRdID0gIkJpZzUiOwoJICAgIENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1siR0IxODAzMCJdID0gMjVdID0gIkdCMTgwMzAiOwoJICAgIENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1siRVVDX0tSIl0gPSAyNl0gPSAiRVVDX0tSIjsKCX0pKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMgPSBleHBvcnRzLkNoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMgfHwgKGV4cG9ydHMuQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycyA9IHt9KSk7CgkvKioKCSAqIEVuY2Fwc3VsYXRlcyBhIENoYXJhY3RlciBTZXQgRUNJLCBhY2NvcmRpbmcgdG8gIkV4dGVuZGVkIENoYW5uZWwgSW50ZXJwcmV0YXRpb25zIiA1LjMuMS4xCgkgKiBvZiBJU08gMTgwMDQuCgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIENoYXJhY3RlclNldEVDSSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBDaGFyYWN0ZXJTZXRFQ0kodmFsdWVJZGVudGlmaWVyLCB2YWx1ZXNQYXJhbSwgbmFtZSkgewoJICAgICAgICB2YXIgZV8xLCBfYTsKCSAgICAgICAgdmFyIG90aGVyRW5jb2RpbmdOYW1lcyA9IFtdOwoJICAgICAgICBmb3IgKHZhciBfaSA9IDM7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykgewoJICAgICAgICAgICAgb3RoZXJFbmNvZGluZ05hbWVzW19pIC0gM10gPSBhcmd1bWVudHNbX2ldOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMudmFsdWVJZGVudGlmaWVyID0gdmFsdWVJZGVudGlmaWVyOwoJICAgICAgICB0aGlzLm5hbWUgPSBuYW1lOwoJICAgICAgICBpZiAodHlwZW9mIHZhbHVlc1BhcmFtID09PSAnbnVtYmVyJykgewoJICAgICAgICAgICAgdGhpcy52YWx1ZXMgPSBJbnQzMkFycmF5LmZyb20oW3ZhbHVlc1BhcmFtXSk7CgkgICAgICAgIH0KCSAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICB0aGlzLnZhbHVlcyA9IHZhbHVlc1BhcmFtOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMub3RoZXJFbmNvZGluZ05hbWVzID0gb3RoZXJFbmNvZGluZ05hbWVzOwoJICAgICAgICBDaGFyYWN0ZXJTZXRFQ0kuVkFMVUVfSURFTlRJRklFUl9UT19FQ0kuc2V0KHZhbHVlSWRlbnRpZmllciwgdGhpcyk7CgkgICAgICAgIENoYXJhY3RlclNldEVDSS5OQU1FX1RPX0VDSS5zZXQobmFtZSwgdGhpcyk7CgkgICAgICAgIHZhciB2YWx1ZXMgPSB0aGlzLnZhbHVlczsKCSAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aF8xID0gdmFsdWVzLmxlbmd0aDsgaSAhPT0gbGVuZ3RoXzE7IGkrKykgewoJICAgICAgICAgICAgdmFyIHYgPSB2YWx1ZXNbaV07CgkgICAgICAgICAgICBDaGFyYWN0ZXJTZXRFQ0kuVkFMVUVTX1RPX0VDSS5zZXQodiwgdGhpcyk7CgkgICAgICAgIH0KCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIGZvciAodmFyIG90aGVyRW5jb2RpbmdOYW1lc18xID0gX192YWx1ZXMob3RoZXJFbmNvZGluZ05hbWVzKSwgb3RoZXJFbmNvZGluZ05hbWVzXzFfMSA9IG90aGVyRW5jb2RpbmdOYW1lc18xLm5leHQoKTsgIW90aGVyRW5jb2RpbmdOYW1lc18xXzEuZG9uZTsgb3RoZXJFbmNvZGluZ05hbWVzXzFfMSA9IG90aGVyRW5jb2RpbmdOYW1lc18xLm5leHQoKSkgewoJICAgICAgICAgICAgICAgIHZhciBvdGhlck5hbWUgPSBvdGhlckVuY29kaW5nTmFtZXNfMV8xLnZhbHVlOwoJICAgICAgICAgICAgICAgIENoYXJhY3RlclNldEVDSS5OQU1FX1RPX0VDSS5zZXQob3RoZXJOYW1lLCB0aGlzKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoZV8xXzEpIHsgZV8xID0geyBlcnJvcjogZV8xXzEgfTsgfQoJICAgICAgICBmaW5hbGx5IHsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgaWYgKG90aGVyRW5jb2RpbmdOYW1lc18xXzEgJiYgIW90aGVyRW5jb2RpbmdOYW1lc18xXzEuZG9uZSAmJiAoX2EgPSBvdGhlckVuY29kaW5nTmFtZXNfMS5yZXR1cm4pKSBfYS5jYWxsKG90aGVyRW5jb2RpbmdOYW1lc18xKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGZpbmFsbHkgeyBpZiAoZV8xKSB0aHJvdyBlXzEuZXJyb3I7IH0KCSAgICAgICAgfQoJICAgIH0KCSAgICAvLyBDaGFyYWN0ZXJTZXRFQ0kodmFsdWU6IG51bWJlciAvKmludCovKSB7CgkgICAgLy8gICB0aGlzKG5ldyBJbnQzMkFycmF5IHt2YWx1ZX0pCgkgICAgLy8gfQoJICAgIC8vIENoYXJhY3RlclNldEVDSSh2YWx1ZTogbnVtYmVyIC8qaW50Ki8sIFN0cmluZy4uLiBvdGhlckVuY29kaW5nTmFtZXMpIHsKCSAgICAvLyAgIHRoaXMudmFsdWVzID0gbmV3IEludDMyQXJyYXkge3ZhbHVlfQoJICAgIC8vICAgdGhpcy5vdGhlckVuY29kaW5nTmFtZXMgPSBvdGhlckVuY29kaW5nTmFtZXMKCSAgICAvLyB9CgkgICAgLy8gQ2hhcmFjdGVyU2V0RUNJKHZhbHVlczogSW50MzJBcnJheSwgU3RyaW5nLi4uIG90aGVyRW5jb2RpbmdOYW1lcykgewoJICAgIC8vICAgdGhpcy52YWx1ZXMgPSB2YWx1ZXMKCSAgICAvLyAgIHRoaXMub3RoZXJFbmNvZGluZ05hbWVzID0gb3RoZXJFbmNvZGluZ05hbWVzCgkgICAgLy8gfQoJICAgIENoYXJhY3RlclNldEVDSS5wcm90b3R5cGUuZ2V0VmFsdWVJZGVudGlmaWVyID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy52YWx1ZUlkZW50aWZpZXI7CgkgICAgfTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kucHJvdG90eXBlLmdldE5hbWUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLm5hbWU7CgkgICAgfTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kucHJvdG90eXBlLmdldFZhbHVlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy52YWx1ZXNbMF07CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gdmFsdWUgY2hhcmFjdGVyIHNldCBFQ0kgdmFsdWUKCSAgICAgKiBAcmV0dXJuIHtAY29kZSBDaGFyYWN0ZXJTZXRFQ0l9IHJlcHJlc2VudGluZyBFQ0kgb2YgZ2l2ZW4gdmFsdWUsIG9yIG51bGwgaWYgaXQgaXMgbGVnYWwgYnV0CgkgICAgICogICB1bnN1cHBvcnRlZAoJICAgICAqIEB0aHJvd3MgRm9ybWF0RXhjZXB0aW9uIGlmIEVDSSB2YWx1ZSBpcyBpbnZhbGlkCgkgICAgICovCgkgICAgQ2hhcmFjdGVyU2V0RUNJLmdldENoYXJhY3RlclNldEVDSUJ5VmFsdWUgPSBmdW5jdGlvbiAodmFsdWUgLyppbnQqLykgewoJICAgICAgICBpZiAodmFsdWUgPCAwIHx8IHZhbHVlID49IDkwMCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoJ2luY29yZWN0IHZhbHVlJyk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGNoYXJhY3RlclNldCA9IENoYXJhY3RlclNldEVDSS5WQUxVRVNfVE9fRUNJLmdldCh2YWx1ZSk7CgkgICAgICAgIGlmICh1bmRlZmluZWQgPT09IGNoYXJhY3RlclNldCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoJ2luY29yZWN0IHZhbHVlJyk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGNoYXJhY3RlclNldDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBuYW1lIGNoYXJhY3RlciBzZXQgRUNJIGVuY29kaW5nIG5hbWUKCSAgICAgKiBAcmV0dXJuIENoYXJhY3RlclNldEVDSSByZXByZXNlbnRpbmcgRUNJIGZvciBjaGFyYWN0ZXIgZW5jb2RpbmcsIG9yIG51bGwgaWYgaXQgaXMgbGVnYWwKCSAgICAgKiAgIGJ1dCB1bnN1cHBvcnRlZAoJICAgICAqLwoJICAgIENoYXJhY3RlclNldEVDSS5nZXRDaGFyYWN0ZXJTZXRFQ0lCeU5hbWUgPSBmdW5jdGlvbiAobmFtZSkgewoJICAgICAgICB2YXIgY2hhcmFjdGVyU2V0ID0gQ2hhcmFjdGVyU2V0RUNJLk5BTUVfVE9fRUNJLmdldChuYW1lKTsKCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gY2hhcmFjdGVyU2V0KSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgnaW5jb3JlY3QgdmFsdWUnKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gY2hhcmFjdGVyU2V0OwoJICAgIH07CgkgICAgQ2hhcmFjdGVyU2V0RUNJLnByb3RvdHlwZS5lcXVhbHMgPSBmdW5jdGlvbiAobykgewoJICAgICAgICBpZiAoIShvIGluc3RhbmNlb2YgQ2hhcmFjdGVyU2V0RUNJKSkgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIHZhciBvdGhlciA9IG87CgkgICAgICAgIHJldHVybiB0aGlzLmdldE5hbWUoKSA9PT0gb3RoZXIuZ2V0TmFtZSgpOwoJICAgIH07CgkgICAgQ2hhcmFjdGVyU2V0RUNJLlZBTFVFX0lERU5USUZJRVJfVE9fRUNJID0gbmV3IE1hcCgpOwoJICAgIENoYXJhY3RlclNldEVDSS5WQUxVRVNfVE9fRUNJID0gbmV3IE1hcCgpOwoJICAgIENoYXJhY3RlclNldEVDSS5OQU1FX1RPX0VDSSA9IG5ldyBNYXAoKTsKCSAgICAvLyBFbnVtIG5hbWUgaXMgYSBKYXZhIGVuY29kaW5nIHZhbGlkIGZvciBqYXZhLmxhbmcgYW5kIGphdmEuaW8KCSAgICAvLyBUWVBFU0NSSVBUUE9SVDogY2hhbmdlZCB0aGUgbWFpbiBsYWJlbCBmb3IgSVNPIGFzIHRoZSBUZXh0RW5jb2RlciBkaWQgbm90IHJlY29nbml6ZWQgdGhlbSBpbiB0aGUgZm9ybSBmcm9tIGphdmEKCSAgICAvLyAoZWcgSVNPODg1OV8xIG11c3QgYmUgSVNPODg1OTEgb3IgSVNPODg1OS0xIG9yIElTTy04ODU5LTEpCgkgICAgLy8gbGF0ZXIgb246IHdlbGwsIGV4Y2VwdCAxNiB3aWNoIGRvZXMgbm90IHdvcmsgd2l0aCBJU084ODU5MTYgc28gdXNlZCBJU08tODg1OS0xIGZvcm0gZm9yIGRlZmF1bHQKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuQ3A0MzcgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuQ3A0MzcsIEludDMyQXJyYXkuZnJvbShbMCwgMl0pLCAnQ3A0MzcnKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuSVNPODg1OV8xID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLklTTzg4NTlfMSwgSW50MzJBcnJheS5mcm9tKFsxLCAzXSksICdJU08tODg1OS0xJywgJ0lTTzg4NTkxJywgJ0lTTzg4NTlfMScpOwoJICAgIENoYXJhY3RlclNldEVDSS5JU084ODU5XzIgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuSVNPODg1OV8yLCA0LCAnSVNPLTg4NTktMicsICdJU084ODU5MicsICdJU084ODU5XzInKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuSVNPODg1OV8zID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLklTTzg4NTlfMywgNSwgJ0lTTy04ODU5LTMnLCAnSVNPODg1OTMnLCAnSVNPODg1OV8zJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLklTTzg4NTlfNCA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5JU084ODU5XzQsIDYsICdJU08tODg1OS00JywgJ0lTTzg4NTk0JywgJ0lTTzg4NTlfNCcpOwoJICAgIENoYXJhY3RlclNldEVDSS5JU084ODU5XzUgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuSVNPODg1OV81LCA3LCAnSVNPLTg4NTktNScsICdJU084ODU5NScsICdJU084ODU5XzUnKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuSVNPODg1OV82ID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLklTTzg4NTlfNiwgOCwgJ0lTTy04ODU5LTYnLCAnSVNPODg1OTYnLCAnSVNPODg1OV82Jyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLklTTzg4NTlfNyA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5JU084ODU5XzcsIDksICdJU08tODg1OS03JywgJ0lTTzg4NTk3JywgJ0lTTzg4NTlfNycpOwoJICAgIENoYXJhY3RlclNldEVDSS5JU084ODU5XzggPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuSVNPODg1OV84LCAxMCwgJ0lTTy04ODU5LTgnLCAnSVNPODg1OTgnLCAnSVNPODg1OV84Jyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLklTTzg4NTlfOSA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5JU084ODU5XzksIDExLCAnSVNPLTg4NTktOScsICdJU084ODU5OScsICdJU084ODU5XzknKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuSVNPODg1OV8xMCA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5JU084ODU5XzEwLCAxMiwgJ0lTTy04ODU5LTEwJywgJ0lTTzg4NTkxMCcsICdJU084ODU5XzEwJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLklTTzg4NTlfMTEgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuSVNPODg1OV8xMSwgMTMsICdJU08tODg1OS0xMScsICdJU084ODU5MTEnLCAnSVNPODg1OV8xMScpOwoJICAgIENoYXJhY3RlclNldEVDSS5JU084ODU5XzEzID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLklTTzg4NTlfMTMsIDE1LCAnSVNPLTg4NTktMTMnLCAnSVNPODg1OTEzJywgJ0lTTzg4NTlfMTMnKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuSVNPODg1OV8xNCA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5JU084ODU5XzE0LCAxNiwgJ0lTTy04ODU5LTE0JywgJ0lTTzg4NTkxNCcsICdJU084ODU5XzE0Jyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLklTTzg4NTlfMTUgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuSVNPODg1OV8xNSwgMTcsICdJU08tODg1OS0xNScsICdJU084ODU5MTUnLCAnSVNPODg1OV8xNScpOwoJICAgIENoYXJhY3RlclNldEVDSS5JU084ODU5XzE2ID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLklTTzg4NTlfMTYsIDE4LCAnSVNPLTg4NTktMTYnLCAnSVNPODg1OTE2JywgJ0lTTzg4NTlfMTYnKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuU0pJUyA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5TSklTLCAyMCwgJ1NKSVMnLCAnU2hpZnRfSklTJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLkNwMTI1MCA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5DcDEyNTAsIDIxLCAnQ3AxMjUwJywgJ3dpbmRvd3MtMTI1MCcpOwoJICAgIENoYXJhY3RlclNldEVDSS5DcDEyNTEgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuQ3AxMjUxLCAyMiwgJ0NwMTI1MScsICd3aW5kb3dzLTEyNTEnKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuQ3AxMjUyID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLkNwMTI1MiwgMjMsICdDcDEyNTInLCAnd2luZG93cy0xMjUyJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLkNwMTI1NiA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5DcDEyNTYsIDI0LCAnQ3AxMjU2JywgJ3dpbmRvd3MtMTI1NicpOwoJICAgIENoYXJhY3RlclNldEVDSS5Vbmljb2RlQmlnVW5tYXJrZWQgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuVW5pY29kZUJpZ1VubWFya2VkLCAyNSwgJ1VuaWNvZGVCaWdVbm1hcmtlZCcsICdVVEYtMTZCRScsICdVbmljb2RlQmlnJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLlVURjggPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuVVRGOCwgMjYsICdVVEY4JywgJ1VURi04Jyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLkFTQ0lJID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLkFTQ0lJLCBJbnQzMkFycmF5LmZyb20oWzI3LCAxNzBdKSwgJ0FTQ0lJJywgJ1VTLUFTQ0lJJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLkJpZzUgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuQmlnNSwgMjgsICdCaWc1Jyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLkdCMTgwMzAgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuR0IxODAzMCwgMjksICdHQjE4MDMwJywgJ0dCMjMxMicsICdFVUNfQ04nLCAnR0JLJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLkVVQ19LUiA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5FVUNfS1IsIDMwLCAnRVVDX0tSJywgJ0VVQy1LUicpOwoJICAgIHJldHVybiBDaGFyYWN0ZXJTZXRFQ0k7Cgl9KCkpOwoJZXhwb3J0cy5kZWZhdWx0ID0gQ2hhcmFjdGVyU2V0RUNJOwoKCX0oQ2hhcmFjdGVyU2V0RUNJKSk7CgoJdmFyIFN0cmluZ0VuY29kaW5nJDEgPSB7fTsKCgl2YXIgVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb24kMSA9IHt9OwoKCXZhciBfX2V4dGVuZHMkZSA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbiQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgRXhjZXB0aW9uXzEkNiA9IEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBDdXN0b20gRXJyb3IgY2xhc3Mgb2YgdHlwZSBFeGNlcHRpb24uCgkgKi8KCXZhciBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkZShVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbigpIHsKCSAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwoJICAgIH0KCSAgICBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbi5raW5kID0gJ1Vuc3VwcG9ydGVkT3BlcmF0aW9uRXhjZXB0aW9uJzsKCSAgICByZXR1cm4gVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb247Cgl9KEV4Y2VwdGlvbl8xJDYuZGVmYXVsdCkpOwoJVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb24kMS5kZWZhdWx0ID0gVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb247CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KFN0cmluZ0VuY29kaW5nJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbl8xJDEgPSBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbiQxOwoJdmFyIENoYXJhY3RlclNldEVDSV8xJDIgPSBDaGFyYWN0ZXJTZXRFQ0k7CgkvKioKCSAqIFJlc3BvbnNpYmxlIGZvciBlbi9kZWNvZGluZyBzdHJpbmdzLgoJICovCgl2YXIgU3RyaW5nRW5jb2RpbmcgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gU3RyaW5nRW5jb2RpbmcoKSB7CgkgICAgfQoJICAgIC8qKgoJICAgICAqIERlY29kZXMgc29tZSBVaW50OEFycmF5IHRvIGEgc3RyaW5nIGZvcm1hdC4KCSAgICAgKi8KCSAgICBTdHJpbmdFbmNvZGluZy5kZWNvZGUgPSBmdW5jdGlvbiAoYnl0ZXMsIGVuY29kaW5nKSB7CgkgICAgICAgIHZhciBlbmNvZGluZ05hbWUgPSB0aGlzLmVuY29kaW5nTmFtZShlbmNvZGluZyk7CgkgICAgICAgIGlmICh0aGlzLmN1c3RvbURlY29kZXIpIHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzLmN1c3RvbURlY29kZXIoYnl0ZXMsIGVuY29kaW5nTmFtZSk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gSW5jcmVhc2VzIGJyb3dzZXIgc3VwcG9ydC4KCSAgICAgICAgaWYgKHR5cGVvZiBUZXh0RGVjb2RlciA9PT0gJ3VuZGVmaW5lZCcgfHwgdGhpcy5zaG91bGREZWNvZGVPbkZhbGxiYWNrKGVuY29kaW5nTmFtZSkpIHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzLmRlY29kZUZhbGxiYWNrKGJ5dGVzLCBlbmNvZGluZ05hbWUpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBuZXcgVGV4dERlY29kZXIoZW5jb2RpbmdOYW1lKS5kZWNvZGUoYnl0ZXMpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQ2hlY2tzIGlmIHRoZSBkZWNvZGluZyBtZXRob2Qgc2hvdWxkIHVzZSB0aGUgZmFsbGJhY2sgZm9yIGRlY29kaW5nCgkgICAgICogb25jZSBOb2RlIFRleHREZWNvZGVyIGRvZXNuJ3Qgc3VwcG9ydCBhbGwgZW5jb2RpbmcgZm9ybWF0cy4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBlbmNvZGluZ05hbWUKCSAgICAgKi8KCSAgICBTdHJpbmdFbmNvZGluZy5zaG91bGREZWNvZGVPbkZhbGxiYWNrID0gZnVuY3Rpb24gKGVuY29kaW5nTmFtZSkgewoJICAgICAgICByZXR1cm4gIVN0cmluZ0VuY29kaW5nLmlzQnJvd3NlcigpICYmIGVuY29kaW5nTmFtZSA9PT0gJ0lTTy04ODU5LTEnOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogRW5jb2RlcyBzb21lIHN0cmluZyBpbnRvIGEgVWludDhBcnJheS4KCSAgICAgKi8KCSAgICBTdHJpbmdFbmNvZGluZy5lbmNvZGUgPSBmdW5jdGlvbiAocywgZW5jb2RpbmcpIHsKCSAgICAgICAgdmFyIGVuY29kaW5nTmFtZSA9IHRoaXMuZW5jb2RpbmdOYW1lKGVuY29kaW5nKTsKCSAgICAgICAgaWYgKHRoaXMuY3VzdG9tRW5jb2RlcikgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMuY3VzdG9tRW5jb2RlcihzLCBlbmNvZGluZ05hbWUpOwoJICAgICAgICB9CgkgICAgICAgIC8vIEluY3JlYXNlcyBicm93c2VyIHN1cHBvcnQuCgkgICAgICAgIGlmICh0eXBlb2YgVGV4dEVuY29kZXIgPT09ICd1bmRlZmluZWQnKSB7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy5lbmNvZGVGYWxsYmFjayhzKTsKCSAgICAgICAgfQoJICAgICAgICAvLyBUZXh0RW5jb2RlciBvbmx5IGVuY29kZXMgdG8gVVRGOCBieSBkZWZhdWx0IGFzIHNwZWNpZmllZCBieSBlbmNvZGluZy5zcGVjLndoYXR3Zy5vcmcKCSAgICAgICAgcmV0dXJuIG5ldyBUZXh0RW5jb2RlcigpLmVuY29kZShzKTsKCSAgICB9OwoJICAgIFN0cmluZ0VuY29kaW5nLmlzQnJvd3NlciA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJiB7fS50b1N0cmluZy5jYWxsKHdpbmRvdykgPT09ICdbb2JqZWN0IFdpbmRvd10nKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgdGhlIHN0cmluZyB2YWx1ZSBmcm9tIHNvbWUgZW5jb2RpbmcgY2hhcmFjdGVyIHNldC4KCSAgICAgKi8KCSAgICBTdHJpbmdFbmNvZGluZy5lbmNvZGluZ05hbWUgPSBmdW5jdGlvbiAoZW5jb2RpbmcpIHsKCSAgICAgICAgcmV0dXJuIHR5cGVvZiBlbmNvZGluZyA9PT0gJ3N0cmluZycKCSAgICAgICAgICAgID8gZW5jb2RpbmcKCSAgICAgICAgICAgIDogZW5jb2RpbmcuZ2V0TmFtZSgpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogUmV0dXJucyBjaGFyYWN0ZXIgc2V0IGZyb20gc29tZSBlbmNvZGluZyBjaGFyYWN0ZXIgc2V0LgoJICAgICAqLwoJICAgIFN0cmluZ0VuY29kaW5nLmVuY29kaW5nQ2hhcmFjdGVyU2V0ID0gZnVuY3Rpb24gKGVuY29kaW5nKSB7CgkgICAgICAgIGlmIChlbmNvZGluZyBpbnN0YW5jZW9mIENoYXJhY3RlclNldEVDSV8xJDIuZGVmYXVsdCkgewoJICAgICAgICAgICAgcmV0dXJuIGVuY29kaW5nOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBDaGFyYWN0ZXJTZXRFQ0lfMSQyLmRlZmF1bHQuZ2V0Q2hhcmFjdGVyU2V0RUNJQnlOYW1lKGVuY29kaW5nKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJ1bnMgYSBmYWxsYmFjayBmb3IgdGhlIG5hdGl2ZSBkZWNvZGluZyBmdW5jaW9uLgoJICAgICAqLwoJICAgIFN0cmluZ0VuY29kaW5nLmRlY29kZUZhbGxiYWNrID0gZnVuY3Rpb24gKGJ5dGVzLCBlbmNvZGluZykgewoJICAgICAgICB2YXIgY2hhcmFjdGVyU2V0ID0gdGhpcy5lbmNvZGluZ0NoYXJhY3RlclNldChlbmNvZGluZyk7CgkgICAgICAgIGlmIChTdHJpbmdFbmNvZGluZy5pc0RlY29kZUZhbGxiYWNrU3VwcG9ydGVkKGNoYXJhY3RlclNldCkpIHsKCSAgICAgICAgICAgIHZhciBzID0gJyc7CgkgICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuZ3RoXzEgPSBieXRlcy5sZW5ndGg7IGkgPCBsZW5ndGhfMTsgaSsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIGggPSBieXRlc1tpXS50b1N0cmluZygxNik7CgkgICAgICAgICAgICAgICAgaWYgKGgubGVuZ3RoIDwgMikgewoJICAgICAgICAgICAgICAgICAgICBoID0gJzAnICsgaDsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgcyArPSAnJScgKyBoOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmV0dXJuIGRlY29kZVVSSUNvbXBvbmVudChzKTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoY2hhcmFjdGVyU2V0LmVxdWFscyhDaGFyYWN0ZXJTZXRFQ0lfMSQyLmRlZmF1bHQuVW5pY29kZUJpZ1VubWFya2VkKSkgewoJICAgICAgICAgICAgcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUuYXBwbHkobnVsbCwgbmV3IFVpbnQxNkFycmF5KGJ5dGVzLmJ1ZmZlcikpOwoJICAgICAgICB9CgkgICAgICAgIHRocm93IG5ldyBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbl8xJDEuZGVmYXVsdCgiRW5jb2RpbmcgIiArIHRoaXMuZW5jb2RpbmdOYW1lKGVuY29kaW5nKSArICIgbm90IHN1cHBvcnRlZCBieSBmYWxsYmFjay4iKTsKCSAgICB9OwoJICAgIFN0cmluZ0VuY29kaW5nLmlzRGVjb2RlRmFsbGJhY2tTdXBwb3J0ZWQgPSBmdW5jdGlvbiAoY2hhcmFjdGVyU2V0KSB7CgkgICAgICAgIHJldHVybiBjaGFyYWN0ZXJTZXQuZXF1YWxzKENoYXJhY3RlclNldEVDSV8xJDIuZGVmYXVsdC5VVEY4KSB8fAoJICAgICAgICAgICAgY2hhcmFjdGVyU2V0LmVxdWFscyhDaGFyYWN0ZXJTZXRFQ0lfMSQyLmRlZmF1bHQuSVNPODg1OV8xKSB8fAoJICAgICAgICAgICAgY2hhcmFjdGVyU2V0LmVxdWFscyhDaGFyYWN0ZXJTZXRFQ0lfMSQyLmRlZmF1bHQuQVNDSUkpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogUnVucyBhIGZhbGxiYWNrIGZvciB0aGUgbmF0aXZlIGVuY29kaW5nIGZ1bmNpb24uCgkgICAgICoKCSAgICAgKiBAc2VlIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vYS8xNzE5Mjg0NS80MzY3NjgzCgkgICAgICovCgkgICAgU3RyaW5nRW5jb2RpbmcuZW5jb2RlRmFsbGJhY2sgPSBmdW5jdGlvbiAocykgewoJICAgICAgICB2YXIgZW5jb2RlZFVSSXN0cmluZyA9IGJ0b2EodW5lc2NhcGUoZW5jb2RlVVJJQ29tcG9uZW50KHMpKSk7CgkgICAgICAgIHZhciBjaGFyTGlzdCA9IGVuY29kZWRVUklzdHJpbmcuc3BsaXQoJycpOwoJICAgICAgICB2YXIgdWludEFycmF5ID0gW107CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2hhckxpc3QubGVuZ3RoOyBpKyspIHsKCSAgICAgICAgICAgIHVpbnRBcnJheS5wdXNoKGNoYXJMaXN0W2ldLmNoYXJDb2RlQXQoMCkpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBuZXcgVWludDhBcnJheSh1aW50QXJyYXkpOwoJICAgIH07CgkgICAgcmV0dXJuIFN0cmluZ0VuY29kaW5nOwoJfSgpKTsKCVN0cmluZ0VuY29kaW5nJDEuZGVmYXVsdCA9IFN0cmluZ0VuY29kaW5nOwoKCS8qCgkgKiBDb3B5cmlnaHQgKEMpIDIwMTAgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KFN0cmluZ1V0aWxzJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJLyppbXBvcnQgamF2YS5uaW8uY2hhcnNldC5DaGFyc2V0OyovCgkvKmltcG9ydCBqYXZhLnV0aWwuTWFwOyovCgl2YXIgRGVjb2RlSGludFR5cGVfMSQzID0gRGVjb2RlSGludFR5cGUkMTsKCXZhciBDaGFyYWN0ZXJTZXRFQ0lfMSQxID0gQ2hhcmFjdGVyU2V0RUNJOwoJdmFyIFN0cmluZ0VuY29kaW5nXzEkMSA9IFN0cmluZ0VuY29kaW5nJDE7CgkvKioKCSAqIENvbW1vbiBzdHJpbmctcmVsYXRlZCBmdW5jdGlvbnMuCgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqIEBhdXRob3IgQWxleCBEdXByZQoJICovCgl2YXIgU3RyaW5nVXRpbHMgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gU3RyaW5nVXRpbHMoKSB7CgkgICAgfQoJICAgIC8vIFNISUZUX0pJUy5lcXVhbHNJZ25vcmVDYXNlKFBMQVRGT1JNX0RFRkFVTFRfRU5DT0RJTkcpIHx8CgkgICAgLy8gRVVDX0pQLmVxdWFsc0lnbm9yZUNhc2UoUExBVEZPUk1fREVGQVVMVF9FTkNPRElORyk7CgkgICAgU3RyaW5nVXRpbHMuY2FzdEFzTm9uVXRmOENoYXIgPSBmdW5jdGlvbiAoY29kZSwgZW5jb2RpbmcpIHsKCSAgICAgICAgaWYgKGVuY29kaW5nID09PSB2b2lkIDApIHsgZW5jb2RpbmcgPSBudWxsOyB9CgkgICAgICAgIC8vIElTTyA4ODU5LTEgaXMgdGhlIEphdmEgZGVmYXVsdCBhcyBVVEYtOCBpcyBKYXZhU2NyaXB0cwoJICAgICAgICAvLyB5b3UgY2FuIHNlZSB0aGlzIG1ldGhvZCBhcyBhIEphdmEgdmVyc2lvbiBvZiBTdHJpbmcuZnJvbUNoYXJDb2RlCgkgICAgICAgIHZhciBlID0gZW5jb2RpbmcgPyBlbmNvZGluZy5nZXROYW1lKCkgOiB0aGlzLklTTzg4NTkxOwoJICAgICAgICAvLyB1c2UgcGFzc2VkIGZvcm1hdCAoZnJvbUNoYXJDb2RlIHdpbGwgcmV0dXJuIFVURjggZW5jb2RpbmcpCgkgICAgICAgIHJldHVybiBTdHJpbmdFbmNvZGluZ18xJDEuZGVmYXVsdC5kZWNvZGUobmV3IFVpbnQ4QXJyYXkoW2NvZGVdKSwgZSk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gYnl0ZXMgYnl0ZXMgZW5jb2RpbmcgYSBzdHJpbmcsIHdob3NlIGVuY29kaW5nIHNob3VsZCBiZSBndWVzc2VkCgkgICAgICogQHBhcmFtIGhpbnRzIGRlY29kZSBoaW50cyBpZiBhcHBsaWNhYmxlCgkgICAgICogQHJldHVybiBuYW1lIG9mIGd1ZXNzZWQgZW5jb2Rpbmc7IGF0IHRoZSBtb21lbnQgd2lsbCBvbmx5IGd1ZXNzIG9uZSBvZjoKCSAgICAgKiAge0BsaW5rICNTSElGVF9KSVN9LCB7QGxpbmsgI1VURjh9LCB7QGxpbmsgI0lTTzg4NTkxfSwgb3IgdGhlIHBsYXRmb3JtCgkgICAgICogIGRlZmF1bHQgZW5jb2RpbmcgaWYgbm9uZSBvZiB0aGVzZSBjYW4gcG9zc2libHkgYmUgY29ycmVjdAoJICAgICAqLwoJICAgIFN0cmluZ1V0aWxzLmd1ZXNzRW5jb2RpbmcgPSBmdW5jdGlvbiAoYnl0ZXMsIGhpbnRzKSB7CgkgICAgICAgIGlmIChoaW50cyAhPT0gbnVsbCAmJiBoaW50cyAhPT0gdW5kZWZpbmVkICYmIHVuZGVmaW5lZCAhPT0gaGludHMuZ2V0KERlY29kZUhpbnRUeXBlXzEkMy5kZWZhdWx0LkNIQVJBQ1RFUl9TRVQpKSB7CgkgICAgICAgICAgICByZXR1cm4gaGludHMuZ2V0KERlY29kZUhpbnRUeXBlXzEkMy5kZWZhdWx0LkNIQVJBQ1RFUl9TRVQpLnRvU3RyaW5nKCk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gRm9yIG5vdywgbWVyZWx5IHRyaWVzIHRvIGRpc3Rpbmd1aXNoIElTTy04ODU5LTEsIFVURi04IGFuZCBTaGlmdF9KSVMsCgkgICAgICAgIC8vIHdoaWNoIHNob3VsZCBiZSBieSBmYXIgdGhlIG1vc3QgY29tbW9uIGVuY29kaW5ncy4KCSAgICAgICAgdmFyIGxlbmd0aCA9IGJ5dGVzLmxlbmd0aDsKCSAgICAgICAgdmFyIGNhbkJlSVNPODg1OTEgPSB0cnVlOwoJICAgICAgICB2YXIgY2FuQmVTaGlmdEpJUyA9IHRydWU7CgkgICAgICAgIHZhciBjYW5CZVVURjggPSB0cnVlOwoJICAgICAgICB2YXIgdXRmOEJ5dGVzTGVmdCA9IDA7CgkgICAgICAgIC8vIGludCB1dGY4TG93Q2hhcnMgPSAwCgkgICAgICAgIHZhciB1dGYyQnl0ZXNDaGFycyA9IDA7CgkgICAgICAgIHZhciB1dGYzQnl0ZXNDaGFycyA9IDA7CgkgICAgICAgIHZhciB1dGY0Qnl0ZXNDaGFycyA9IDA7CgkgICAgICAgIHZhciBzamlzQnl0ZXNMZWZ0ID0gMDsKCSAgICAgICAgLy8gaW50IHNqaXNMb3dDaGFycyA9IDAKCSAgICAgICAgdmFyIHNqaXNLYXRha2FuYUNoYXJzID0gMDsKCSAgICAgICAgLy8gaW50IHNqaXNEb3VibGVCeXRlc0NoYXJzID0gMAoJICAgICAgICB2YXIgc2ppc0N1ckthdGFrYW5hV29yZExlbmd0aCA9IDA7CgkgICAgICAgIHZhciBzamlzQ3VyRG91YmxlQnl0ZXNXb3JkTGVuZ3RoID0gMDsKCSAgICAgICAgdmFyIHNqaXNNYXhLYXRha2FuYVdvcmRMZW5ndGggPSAwOwoJICAgICAgICB2YXIgc2ppc01heERvdWJsZUJ5dGVzV29yZExlbmd0aCA9IDA7CgkgICAgICAgIC8vIGludCBpc29Mb3dDaGFycyA9IDAKCSAgICAgICAgLy8gaW50IGlzb0hpZ2hDaGFycyA9IDAKCSAgICAgICAgdmFyIGlzb0hpZ2hPdGhlciA9IDA7CgkgICAgICAgIHZhciB1dGY4Ym9tID0gYnl0ZXMubGVuZ3RoID4gMyAmJgoJICAgICAgICAgICAgYnl0ZXNbMF0gPT09IC8qKGJ5dGUpICovIDB4RUYgJiYKCSAgICAgICAgICAgIGJ5dGVzWzFdID09PSAvKihieXRlKSAqLyAweEJCICYmCgkgICAgICAgICAgICBieXRlc1syXSA9PT0gLyooYnl0ZSkgKi8gMHhCRjsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGggJiYgKGNhbkJlSVNPODg1OTEgfHwgY2FuQmVTaGlmdEpJUyB8fCBjYW5CZVVURjgpOyBpKyspIHsKCSAgICAgICAgICAgIHZhciB2YWx1ZSA9IGJ5dGVzW2ldICYgMHhGRjsKCSAgICAgICAgICAgIC8vIFVURi04IHN0dWZmCgkgICAgICAgICAgICBpZiAoY2FuQmVVVEY4KSB7CgkgICAgICAgICAgICAgICAgaWYgKHV0ZjhCeXRlc0xlZnQgPiAwKSB7CgkgICAgICAgICAgICAgICAgICAgIGlmICgodmFsdWUgJiAweDgwKSA9PT0gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgY2FuQmVVVEY4ID0gZmFsc2U7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICB1dGY4Qnl0ZXNMZWZ0LS07CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSBpZiAoKHZhbHVlICYgMHg4MCkgIT09IDApIHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKCh2YWx1ZSAmIDB4NDApID09PSAwKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBjYW5CZVVURjggPSBmYWxzZTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHV0ZjhCeXRlc0xlZnQrKzsKCSAgICAgICAgICAgICAgICAgICAgICAgIGlmICgodmFsdWUgJiAweDIwKSA9PT0gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHV0ZjJCeXRlc0NoYXJzKys7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICB1dGY4Qnl0ZXNMZWZ0Kys7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCh2YWx1ZSAmIDB4MTApID09PSAwKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHV0ZjNCeXRlc0NoYXJzKys7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1dGY4Qnl0ZXNMZWZ0Kys7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgodmFsdWUgJiAweDA4KSA9PT0gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXRmNEJ5dGVzQ2hhcnMrKzsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbkJlVVRGOCA9IGZhbHNlOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfSAvLyBlbHNlIHsKCSAgICAgICAgICAgICAgICAvLyB1dGY4TG93Q2hhcnMrKwoJICAgICAgICAgICAgICAgIC8vIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIC8vIElTTy04ODU5LTEgc3R1ZmYKCSAgICAgICAgICAgIGlmIChjYW5CZUlTTzg4NTkxKSB7CgkgICAgICAgICAgICAgICAgaWYgKHZhbHVlID4gMHg3RiAmJiB2YWx1ZSA8IDB4QTApIHsKCSAgICAgICAgICAgICAgICAgICAgY2FuQmVJU084ODU5MSA9IGZhbHNlOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBlbHNlIGlmICh2YWx1ZSA+IDB4OUYpIHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlIDwgMHhDMCB8fCB2YWx1ZSA9PT0gMHhENyB8fCB2YWx1ZSA9PT0gMHhGNykgewoJICAgICAgICAgICAgICAgICAgICAgICAgaXNvSGlnaE90aGVyKys7CgkgICAgICAgICAgICAgICAgICAgIH0gLy8gZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgIC8vIGlzb0hpZ2hDaGFycysrCgkgICAgICAgICAgICAgICAgICAgIC8vIH0KCSAgICAgICAgICAgICAgICB9IC8vIGVsc2UgewoJICAgICAgICAgICAgICAgIC8vIGlzb0xvd0NoYXJzKysKCSAgICAgICAgICAgICAgICAvLyB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICAvLyBTaGlmdF9KSVMgc3R1ZmYKCSAgICAgICAgICAgIGlmIChjYW5CZVNoaWZ0SklTKSB7CgkgICAgICAgICAgICAgICAgaWYgKHNqaXNCeXRlc0xlZnQgPiAwKSB7CgkgICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZSA8IDB4NDAgfHwgdmFsdWUgPT09IDB4N0YgfHwgdmFsdWUgPiAweEZDKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBjYW5CZVNoaWZ0SklTID0gZmFsc2U7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBzamlzQnl0ZXNMZWZ0LS07CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSBpZiAodmFsdWUgPT09IDB4ODAgfHwgdmFsdWUgPT09IDB4QTAgfHwgdmFsdWUgPiAweEVGKSB7CgkgICAgICAgICAgICAgICAgICAgIGNhbkJlU2hpZnRKSVMgPSBmYWxzZTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSBpZiAodmFsdWUgPiAweEEwICYmIHZhbHVlIDwgMHhFMCkgewoJICAgICAgICAgICAgICAgICAgICBzamlzS2F0YWthbmFDaGFycysrOwoJICAgICAgICAgICAgICAgICAgICBzamlzQ3VyRG91YmxlQnl0ZXNXb3JkTGVuZ3RoID0gMDsKCSAgICAgICAgICAgICAgICAgICAgc2ppc0N1ckthdGFrYW5hV29yZExlbmd0aCsrOwoJICAgICAgICAgICAgICAgICAgICBpZiAoc2ppc0N1ckthdGFrYW5hV29yZExlbmd0aCA+IHNqaXNNYXhLYXRha2FuYVdvcmRMZW5ndGgpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHNqaXNNYXhLYXRha2FuYVdvcmRMZW5ndGggPSBzamlzQ3VyS2F0YWthbmFXb3JkTGVuZ3RoOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGVsc2UgaWYgKHZhbHVlID4gMHg3RikgewoJICAgICAgICAgICAgICAgICAgICBzamlzQnl0ZXNMZWZ0Kys7CgkgICAgICAgICAgICAgICAgICAgIC8vIHNqaXNEb3VibGVCeXRlc0NoYXJzKysKCSAgICAgICAgICAgICAgICAgICAgc2ppc0N1ckthdGFrYW5hV29yZExlbmd0aCA9IDA7CgkgICAgICAgICAgICAgICAgICAgIHNqaXNDdXJEb3VibGVCeXRlc1dvcmRMZW5ndGgrKzsKCSAgICAgICAgICAgICAgICAgICAgaWYgKHNqaXNDdXJEb3VibGVCeXRlc1dvcmRMZW5ndGggPiBzamlzTWF4RG91YmxlQnl0ZXNXb3JkTGVuZ3RoKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBzamlzTWF4RG91YmxlQnl0ZXNXb3JkTGVuZ3RoID0gc2ppc0N1ckRvdWJsZUJ5dGVzV29yZExlbmd0aDsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgLy8gc2ppc0xvd0NoYXJzKysKCSAgICAgICAgICAgICAgICAgICAgc2ppc0N1ckthdGFrYW5hV29yZExlbmd0aCA9IDA7CgkgICAgICAgICAgICAgICAgICAgIHNqaXNDdXJEb3VibGVCeXRlc1dvcmRMZW5ndGggPSAwOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBpZiAoY2FuQmVVVEY4ICYmIHV0ZjhCeXRlc0xlZnQgPiAwKSB7CgkgICAgICAgICAgICBjYW5CZVVURjggPSBmYWxzZTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoY2FuQmVTaGlmdEpJUyAmJiBzamlzQnl0ZXNMZWZ0ID4gMCkgewoJICAgICAgICAgICAgY2FuQmVTaGlmdEpJUyA9IGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIC8vIEVhc3kgLS0gaWYgdGhlcmUgaXMgQk9NIG9yIGF0IGxlYXN0IDEgdmFsaWQgbm90LXNpbmdsZSBieXRlIGNoYXJhY3RlciAoYW5kIG5vIGV2aWRlbmNlIGl0IGNhbid0IGJlIFVURi04KSwgZG9uZQoJICAgICAgICBpZiAoY2FuQmVVVEY4ICYmICh1dGY4Ym9tIHx8IHV0ZjJCeXRlc0NoYXJzICsgdXRmM0J5dGVzQ2hhcnMgKyB1dGY0Qnl0ZXNDaGFycyA+IDApKSB7CgkgICAgICAgICAgICByZXR1cm4gU3RyaW5nVXRpbHMuVVRGODsKCSAgICAgICAgfQoJICAgICAgICAvLyBFYXN5IC0tIGlmIGFzc3VtaW5nIFNoaWZ0X0pJUyBvciBhdCBsZWFzdCAzIHZhbGlkIGNvbnNlY3V0aXZlIG5vdC1hc2NpaSBjaGFyYWN0ZXJzIChhbmQgbm8gZXZpZGVuY2UgaXQgY2FuJ3QgYmUpLCBkb25lCgkgICAgICAgIGlmIChjYW5CZVNoaWZ0SklTICYmIChTdHJpbmdVdGlscy5BU1NVTUVfU0hJRlRfSklTIHx8IHNqaXNNYXhLYXRha2FuYVdvcmRMZW5ndGggPj0gMyB8fCBzamlzTWF4RG91YmxlQnl0ZXNXb3JkTGVuZ3RoID49IDMpKSB7CgkgICAgICAgICAgICByZXR1cm4gU3RyaW5nVXRpbHMuU0hJRlRfSklTOwoJICAgICAgICB9CgkgICAgICAgIC8vIERpc3Rpbmd1aXNoaW5nIFNoaWZ0X0pJUyBhbmQgSVNPLTg4NTktMSBjYW4gYmUgYSBsaXR0bGUgdG91Z2ggZm9yIHNob3J0IHdvcmRzLiBUaGUgY3J1ZGUgaGV1cmlzdGljIGlzOgoJICAgICAgICAvLyAtIElmIHdlIHNhdwoJICAgICAgICAvLyAgIC0gb25seSB0d28gY29uc2VjdXRpdmUga2F0YWthbmEgY2hhcnMgaW4gdGhlIHdob2xlIHRleHQsIG9yCgkgICAgICAgIC8vICAgLSBhdCBsZWFzdCAxMCUgb2YgYnl0ZXMgdGhhdCBjb3VsZCBiZSAidXBwZXIiIG5vdC1hbHBoYW51bWVyaWMgTGF0aW4xLAoJICAgICAgICAvLyAtIHRoZW4gd2UgY29uY2x1ZGUgU2hpZnRfSklTLCBlbHNlIElTTy04ODU5LTEKCSAgICAgICAgaWYgKGNhbkJlSVNPODg1OTEgJiYgY2FuQmVTaGlmdEpJUykgewoJICAgICAgICAgICAgcmV0dXJuIChzamlzTWF4S2F0YWthbmFXb3JkTGVuZ3RoID09PSAyICYmIHNqaXNLYXRha2FuYUNoYXJzID09PSAyKSB8fCBpc29IaWdoT3RoZXIgKiAxMCA+PSBsZW5ndGgKCSAgICAgICAgICAgICAgICA/IFN0cmluZ1V0aWxzLlNISUZUX0pJUyA6IFN0cmluZ1V0aWxzLklTTzg4NTkxOwoJICAgICAgICB9CgkgICAgICAgIC8vIE90aGVyd2lzZSwgdHJ5IGluIG9yZGVyIElTTy04ODU5LTEsIFNoaWZ0IEpJUywgVVRGLTggYW5kIGZhbGwgYmFjayB0byBkZWZhdWx0IHBsYXRmb3JtIGVuY29kaW5nCgkgICAgICAgIGlmIChjYW5CZUlTTzg4NTkxKSB7CgkgICAgICAgICAgICByZXR1cm4gU3RyaW5nVXRpbHMuSVNPODg1OTE7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGNhbkJlU2hpZnRKSVMpIHsKCSAgICAgICAgICAgIHJldHVybiBTdHJpbmdVdGlscy5TSElGVF9KSVM7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGNhbkJlVVRGOCkgewoJICAgICAgICAgICAgcmV0dXJuIFN0cmluZ1V0aWxzLlVURjg7CgkgICAgICAgIH0KCSAgICAgICAgLy8gT3RoZXJ3aXNlLCB3ZSB0YWtlIGEgd2lsZCBndWVzcyB3aXRoIHBsYXRmb3JtIGVuY29kaW5nCgkgICAgICAgIHJldHVybiBTdHJpbmdVdGlscy5QTEFURk9STV9ERUZBVUxUX0VOQ09ESU5HOwoJICAgIH07CgkgICAgLyoqCgkgICAgICoKCSAgICAgKiBAc2VlIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vYS8xMzQzOTcxMS80MzY3NjgzCgkgICAgICoKCSAgICAgKiBAcGFyYW0gYXBwZW5kIFRoZSBuZXcgc3RyaW5nIHRvIGFwcGVuZC4KCSAgICAgKiBAcGFyYW0gYXJncyBBcmd1bWV0cyB2YWx1ZXMgdG8gYmUgZm9ybWF0ZWQuCgkgICAgICovCgkgICAgU3RyaW5nVXRpbHMuZm9ybWF0ID0gZnVuY3Rpb24gKGFwcGVuZCkgewoJICAgICAgICB2YXIgYXJncyA9IFtdOwoJICAgICAgICBmb3IgKHZhciBfaSA9IDE7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykgewoJICAgICAgICAgICAgYXJnc1tfaSAtIDFdID0gYXJndW1lbnRzW19pXTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgaSA9IC0xOwoJICAgICAgICBmdW5jdGlvbiBjYWxsYmFjayhleHAsIHAwLCBwMSwgcDIsIHAzLCBwNCkgewoJICAgICAgICAgICAgaWYgKGV4cCA9PT0gJyUlJykKCSAgICAgICAgICAgICAgICByZXR1cm4gJyUnOwoJICAgICAgICAgICAgaWYgKGFyZ3NbKytpXSA9PT0gdW5kZWZpbmVkKQoJICAgICAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7CgkgICAgICAgICAgICBleHAgPSBwMiA/IHBhcnNlSW50KHAyLnN1YnN0cigxKSkgOiB1bmRlZmluZWQ7CgkgICAgICAgICAgICB2YXIgYmFzZSA9IHAzID8gcGFyc2VJbnQocDMuc3Vic3RyKDEpKSA6IHVuZGVmaW5lZDsKCSAgICAgICAgICAgIHZhciB2YWw7CgkgICAgICAgICAgICBzd2l0Y2ggKHA0KSB7CgkgICAgICAgICAgICAgICAgY2FzZSAncyc6CgkgICAgICAgICAgICAgICAgICAgIHZhbCA9IGFyZ3NbaV07CgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgIGNhc2UgJ2MnOgoJICAgICAgICAgICAgICAgICAgICB2YWwgPSBhcmdzW2ldWzBdOwoJICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICBjYXNlICdmJzoKCSAgICAgICAgICAgICAgICAgICAgdmFsID0gcGFyc2VGbG9hdChhcmdzW2ldKS50b0ZpeGVkKGV4cCk7CgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgIGNhc2UgJ3AnOgoJICAgICAgICAgICAgICAgICAgICB2YWwgPSBwYXJzZUZsb2F0KGFyZ3NbaV0pLnRvUHJlY2lzaW9uKGV4cCk7CgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgIGNhc2UgJ2UnOgoJICAgICAgICAgICAgICAgICAgICB2YWwgPSBwYXJzZUZsb2F0KGFyZ3NbaV0pLnRvRXhwb25lbnRpYWwoZXhwKTsKCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICAgICAgY2FzZSAneCc6CgkgICAgICAgICAgICAgICAgICAgIHZhbCA9IHBhcnNlSW50KGFyZ3NbaV0pLnRvU3RyaW5nKGJhc2UgPyBiYXNlIDogMTYpOwoJICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICBjYXNlICdkJzoKCSAgICAgICAgICAgICAgICAgICAgdmFsID0gcGFyc2VGbG9hdChwYXJzZUludChhcmdzW2ldLCBiYXNlID8gYmFzZSA6IDEwKS50b1ByZWNpc2lvbihleHApKS50b0ZpeGVkKDApOwoJICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHZhbCA9IHR5cGVvZiB2YWwgPT09ICdvYmplY3QnID8gSlNPTi5zdHJpbmdpZnkodmFsKSA6ICgrdmFsKS50b1N0cmluZyhiYXNlKTsKCSAgICAgICAgICAgIHZhciBzaXplID0gcGFyc2VJbnQocDEpOyAvKiBwYWRkaW5nIHNpemUgKi8KCSAgICAgICAgICAgIHZhciBjaCA9IHAxICYmIChwMVswXSArICcnKSA9PT0gJzAnID8gJzAnIDogJyAnOyAvKiBpc251bGw/ICovCgkgICAgICAgICAgICB3aGlsZSAodmFsLmxlbmd0aCA8IHNpemUpCgkgICAgICAgICAgICAgICAgdmFsID0gcDAgIT09IHVuZGVmaW5lZCA/IHZhbCArIGNoIDogY2ggKyB2YWw7IC8qIGlzbWludXM/ICovCgkgICAgICAgICAgICByZXR1cm4gdmFsOwoJICAgICAgICB9CgkgICAgICAgIHZhciByZWdleCA9IC8lKC0pPygwP1swLTldKyk/KFsuXVswLTldKyk/KFsjXVswLTldKyk/KFtzY2ZwZXhkJV0pL2c7CgkgICAgICAgIHJldHVybiBhcHBlbmQucmVwbGFjZShyZWdleCwgY2FsbGJhY2spOwoJICAgIH07CgkgICAgLyoqCgkgICAgICoKCSAgICAgKi8KCSAgICBTdHJpbmdVdGlscy5nZXRCeXRlcyA9IGZ1bmN0aW9uIChzdHIsIGVuY29kaW5nKSB7CgkgICAgICAgIHJldHVybiBTdHJpbmdFbmNvZGluZ18xJDEuZGVmYXVsdC5lbmNvZGUoc3RyLCBlbmNvZGluZyk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBSZXR1cm5zIHRoZSBjaGFyY29kZSBhdCB0aGUgc3BlY2lmaWVkIGluZGV4IG9yIGF0IGluZGV4IHplcm8uCgkgICAgICovCgkgICAgU3RyaW5nVXRpbHMuZ2V0Q2hhckNvZGUgPSBmdW5jdGlvbiAoc3RyLCBpbmRleCkgewoJICAgICAgICBpZiAoaW5kZXggPT09IHZvaWQgMCkgeyBpbmRleCA9IDA7IH0KCSAgICAgICAgcmV0dXJuIHN0ci5jaGFyQ29kZUF0KGluZGV4KTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgY2hhciBmb3IgZ2l2ZW4gY2hhcmNvZGUKCSAgICAgKi8KCSAgICBTdHJpbmdVdGlscy5nZXRDaGFyQXQgPSBmdW5jdGlvbiAoY2hhckNvZGUpIHsKCSAgICAgICAgcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUoY2hhckNvZGUpOwoJICAgIH07CgkgICAgU3RyaW5nVXRpbHMuU0hJRlRfSklTID0gQ2hhcmFjdGVyU2V0RUNJXzEkMS5kZWZhdWx0LlNKSVMuZ2V0TmFtZSgpOyAvLyAiU0pJUyIKCSAgICBTdHJpbmdVdGlscy5HQjIzMTIgPSAnR0IyMzEyJzsKCSAgICBTdHJpbmdVdGlscy5JU084ODU5MSA9IENoYXJhY3RlclNldEVDSV8xJDEuZGVmYXVsdC5JU084ODU5XzEuZ2V0TmFtZSgpOyAvLyAiSVNPODg1OV8xIgoJICAgIFN0cmluZ1V0aWxzLkVVQ19KUCA9ICdFVUNfSlAnOwoJICAgIFN0cmluZ1V0aWxzLlVURjggPSBDaGFyYWN0ZXJTZXRFQ0lfMSQxLmRlZmF1bHQuVVRGOC5nZXROYW1lKCk7IC8vICJVVEY4IgoJICAgIFN0cmluZ1V0aWxzLlBMQVRGT1JNX0RFRkFVTFRfRU5DT0RJTkcgPSBTdHJpbmdVdGlscy5VVEY4OyAvLyAiVVRGOCIvL0NoYXJzZXQuZGVmYXVsdENoYXJzZXQoKS5uYW1lKCkKCSAgICBTdHJpbmdVdGlscy5BU1NVTUVfU0hJRlRfSklTID0gZmFsc2U7CgkgICAgcmV0dXJuIFN0cmluZ1V0aWxzOwoJfSgpKTsKCVN0cmluZ1V0aWxzJDEuZGVmYXVsdCA9IFN0cmluZ1V0aWxzOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdHJpbmdCdWlsZGVyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBTdHJpbmdVdGlsc18xJDEgPSBTdHJpbmdVdGlscyQxOwoJdmFyIFN0cmluZ0J1aWxkZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gU3RyaW5nQnVpbGRlcih2YWx1ZSkgewoJICAgICAgICBpZiAodmFsdWUgPT09IHZvaWQgMCkgeyB2YWx1ZSA9ICcnOyB9CgkgICAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTsKCSAgICB9CgkgICAgU3RyaW5nQnVpbGRlci5wcm90b3R5cGUuZW5hYmxlRGVjb2RpbmcgPSBmdW5jdGlvbiAoZW5jb2RpbmcpIHsKCSAgICAgICAgdGhpcy5lbmNvZGluZyA9IGVuY29kaW5nOwoJICAgICAgICByZXR1cm4gdGhpczsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLmFwcGVuZCA9IGZ1bmN0aW9uIChzKSB7CgkgICAgICAgIGlmICh0eXBlb2YgcyA9PT0gJ3N0cmluZycpIHsKCSAgICAgICAgICAgIHRoaXMudmFsdWUgKz0gcy50b1N0cmluZygpOwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgaWYgKHRoaXMuZW5jb2RpbmcpIHsKCSAgICAgICAgICAgIC8vIHVzZSBwYXNzZWQgZm9ybWF0IChmcm9tQ2hhckNvZGUgd2lsbCByZXR1cm4gVVRGOCBlbmNvZGluZykKCSAgICAgICAgICAgIHRoaXMudmFsdWUgKz0gU3RyaW5nVXRpbHNfMSQxLmRlZmF1bHQuY2FzdEFzTm9uVXRmOENoYXIocywgdGhpcy5lbmNvZGluZyk7CgkgICAgICAgIH0KCSAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAvLyBjb3JyZWN0bHkgY29udmVydHMgZnJvbSBVVEYtOCwgYnV0IG5vdCBvdGhlciBlbmNvZGluZ3MKCSAgICAgICAgICAgIHRoaXMudmFsdWUgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShzKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gdGhpczsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLmFwcGVuZENoYXJzID0gZnVuY3Rpb24gKHN0ciwgb2Zmc2V0LCBsZW4pIHsKCSAgICAgICAgZm9yICh2YXIgaSA9IG9mZnNldDsgb2Zmc2V0IDwgb2Zmc2V0ICsgbGVuOyBpKyspIHsKCSAgICAgICAgICAgIHRoaXMuYXBwZW5kKHN0cltpXSk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRoaXM7CgkgICAgfTsKCSAgICBTdHJpbmdCdWlsZGVyLnByb3RvdHlwZS5sZW5ndGggPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnZhbHVlLmxlbmd0aDsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLmNoYXJBdCA9IGZ1bmN0aW9uIChuKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnZhbHVlLmNoYXJBdChuKTsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLmRlbGV0ZUNoYXJBdCA9IGZ1bmN0aW9uIChuKSB7CgkgICAgICAgIHRoaXMudmFsdWUgPSB0aGlzLnZhbHVlLnN1YnN0cigwLCBuKSArIHRoaXMudmFsdWUuc3Vic3RyaW5nKG4gKyAxKTsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLnNldENoYXJBdCA9IGZ1bmN0aW9uIChuLCBjKSB7CgkgICAgICAgIHRoaXMudmFsdWUgPSB0aGlzLnZhbHVlLnN1YnN0cigwLCBuKSArIGMgKyB0aGlzLnZhbHVlLnN1YnN0cihuICsgMSk7CgkgICAgfTsKCSAgICBTdHJpbmdCdWlsZGVyLnByb3RvdHlwZS5zdWJzdHJpbmcgPSBmdW5jdGlvbiAoc3RhcnQsIGVuZCkgewoJICAgICAgICByZXR1cm4gdGhpcy52YWx1ZS5zdWJzdHJpbmcoc3RhcnQsIGVuZCk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAbm90ZSBoZWxwZXIgbWV0aG9kIGZvciBSU1MgRXhwYW5kZWQKCSAgICAgKi8KCSAgICBTdHJpbmdCdWlsZGVyLnByb3RvdHlwZS5zZXRMZW5ndGhUb1plcm8gPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHRoaXMudmFsdWUgPSAnJzsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy52YWx1ZTsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLmluc2VydCA9IGZ1bmN0aW9uIChuLCBjKSB7CgkgICAgICAgIHRoaXMudmFsdWUgPSB0aGlzLnZhbHVlLnN1YnN0cigwLCBuKSArIGMgKyB0aGlzLnZhbHVlLnN1YnN0cihuICsgYy5sZW5ndGgpOwoJICAgIH07CgkgICAgcmV0dXJuIFN0cmluZ0J1aWxkZXI7Cgl9KCkpOwoJU3RyaW5nQnVpbGRlciQxLmRlZmF1bHQgPSBTdHJpbmdCdWlsZGVyOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoQml0TWF0cml4JDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJLyppbXBvcnQgamF2YS51dGlsLkFycmF5czsqLwoJdmFyIEJpdEFycmF5XzEkMSA9IEJpdEFycmF5JDE7Cgl2YXIgU3lzdGVtXzEkMyA9IFN5c3RlbSQxOwoJdmFyIEFycmF5c18xID0gQXJyYXlzJDE7Cgl2YXIgU3RyaW5nQnVpbGRlcl8xJDIgPSBTdHJpbmdCdWlsZGVyJDE7Cgl2YXIgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNyA9IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiA8cD5SZXByZXNlbnRzIGEgMkQgbWF0cml4IG9mIGJpdHMuIEluIGZ1bmN0aW9uIGFyZ3VtZW50cyBiZWxvdywgYW5kIHRocm91Z2hvdXQgdGhlIGNvbW1vbgoJICogbW9kdWxlLCB4IGlzIHRoZSBjb2x1bW4gcG9zaXRpb24sIGFuZCB5IGlzIHRoZSByb3cgcG9zaXRpb24uIFRoZSBvcmRlcmluZyBpcyBhbHdheXMgeCwgeS4KCSAqIFRoZSBvcmlnaW4gaXMgYXQgdGhlIHRvcC1sZWZ0LjwvcD4KCSAqCgkgKiA8cD5JbnRlcm5hbGx5IHRoZSBiaXRzIGFyZSByZXByZXNlbnRlZCBpbiBhIDEtRCBhcnJheSBvZiAzMi1iaXQgaW50cy4gSG93ZXZlciwgZWFjaCByb3cgYmVnaW5zCgkgKiB3aXRoIGEgbmV3IGludC4gVGhpcyBpcyBkb25lIGludGVudGlvbmFsbHkgc28gdGhhdCB3ZSBjYW4gY29weSBvdXQgYSByb3cgaW50byBhIEJpdEFycmF5IHZlcnkKCSAqIGVmZmljaWVudGx5LjwvcD4KCSAqCgkgKiA8cD5UaGUgb3JkZXJpbmcgb2YgYml0cyBpcyByb3ctbWFqb3IuIFdpdGhpbiBlYWNoIGludCwgdGhlIGxlYXN0IHNpZ25pZmljYW50IGJpdHMgYXJlIHVzZWQgZmlyc3QsCgkgKiBtZWFuaW5nIHRoZXkgcmVwcmVzZW50IGxvd2VyIHggdmFsdWVzLiBUaGlzIGlzIGNvbXBhdGlibGUgd2l0aCBCaXRBcnJheSdzIGltcGxlbWVudGF0aW9uLjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICogQGF1dGhvciBkc3dpdGtpbkBnb29nbGUuY29tIChEYW5pZWwgU3dpdGtpbikKCSAqLwoJdmFyIEJpdE1hdHJpeCAvKmltcGxlbWVudHMgQ2xvbmVhYmxlKi8gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgLyoqCgkgICAgICogQ3JlYXRlcyBhbiBlbXB0eSBzcXVhcmUge0BsaW5rIEJpdE1hdHJpeH0uCgkgICAgICoKCSAgICAgKiBAcGFyYW0gZGltZW5zaW9uIGhlaWdodCBhbmQgd2lkdGgKCSAgICAgKi8KCSAgICAvLyBwdWJsaWMgY29uc3RydWN0b3IoZGltZW5zaW9uOiBudW1iZXIgLyppbnQqLykgewoJICAgIC8vICAgdGhpcyhkaW1lbnNpb24sIGRpbWVuc2lvbikKCSAgICAvLyB9CgkgICAgLyoqCgkgICAgICogQ3JlYXRlcyBhbiBlbXB0eSB7QGxpbmsgQml0TWF0cml4fS4KCSAgICAgKgoJICAgICAqIEBwYXJhbSB3aWR0aCBiaXQgbWF0cml4IHdpZHRoCgkgICAgICogQHBhcmFtIGhlaWdodCBiaXQgbWF0cml4IGhlaWdodAoJICAgICAqLwoJICAgIC8vIHB1YmxpYyBjb25zdHJ1Y3Rvcih3aWR0aDogbnVtYmVyIC8qaW50Ki8sIGhlaWdodDogbnVtYmVyIC8qaW50Ki8pIHsKCSAgICAvLyAgIGlmICh3aWR0aCA8IDEgfHwgaGVpZ2h0IDwgMSkgewoJICAgIC8vICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uKCJCb3RoIGRpbWVuc2lvbnMgbXVzdCBiZSBncmVhdGVyIHRoYW4gMCIpCgkgICAgLy8gICB9CgkgICAgLy8gICB0aGlzLndpZHRoID0gd2lkdGgKCSAgICAvLyAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0CgkgICAgLy8gICB0aGlzLnJvd1NpemUgPSAod2lkdGggKyAzMSkgLyAzMgoJICAgIC8vICAgYml0cyA9IG5ldyBpbnRbcm93U2l6ZSAqIGhlaWdodF07CgkgICAgLy8gfQoJICAgIGZ1bmN0aW9uIEJpdE1hdHJpeCh3aWR0aCAvKmludCovLCBoZWlnaHQgLyppbnQqLywgcm93U2l6ZSAvKmludCovLCBiaXRzKSB7CgkgICAgICAgIHRoaXMud2lkdGggPSB3aWR0aDsKCSAgICAgICAgdGhpcy5oZWlnaHQgPSBoZWlnaHQ7CgkgICAgICAgIHRoaXMucm93U2l6ZSA9IHJvd1NpemU7CgkgICAgICAgIHRoaXMuYml0cyA9IGJpdHM7CgkgICAgICAgIGlmICh1bmRlZmluZWQgPT09IGhlaWdodCB8fCBudWxsID09PSBoZWlnaHQpIHsKCSAgICAgICAgICAgIGhlaWdodCA9IHdpZHRoOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0OwoJICAgICAgICBpZiAod2lkdGggPCAxIHx8IGhlaWdodCA8IDEpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ3LmRlZmF1bHQoJ0JvdGggZGltZW5zaW9ucyBtdXN0IGJlIGdyZWF0ZXIgdGhhbiAwJyk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gcm93U2l6ZSB8fCBudWxsID09PSByb3dTaXplKSB7CgkgICAgICAgICAgICByb3dTaXplID0gTWF0aC5mbG9vcigod2lkdGggKyAzMSkgLyAzMik7CgkgICAgICAgIH0KCSAgICAgICAgdGhpcy5yb3dTaXplID0gcm93U2l6ZTsKCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gYml0cyB8fCBudWxsID09PSBiaXRzKSB7CgkgICAgICAgICAgICB0aGlzLmJpdHMgPSBuZXcgSW50MzJBcnJheSh0aGlzLnJvd1NpemUgKiB0aGlzLmhlaWdodCk7CgkgICAgICAgIH0KCSAgICB9CgkgICAgLyoqCgkgICAgICogSW50ZXJwcmV0cyBhIDJEIGFycmF5IG9mIGJvb2xlYW5zIGFzIGEge0BsaW5rIEJpdE1hdHJpeH0sIHdoZXJlICJ0cnVlIiBtZWFucyBhbiAib24iIGJpdC4KCSAgICAgKgoJICAgICAqIEBmdW5jdGlvbiBwYXJzZQoJICAgICAqIEBwYXJhbSBpbWFnZSBiaXRzIG9mIHRoZSBpbWFnZSwgYXMgYSByb3ctbWFqb3IgMkQgYXJyYXkuIEVsZW1lbnRzIGFyZSBhcnJheXMgcmVwcmVzZW50aW5nIHJvd3MKCSAgICAgKiBAcmV0dXJuIHtAbGluayBCaXRNYXRyaXh9IHJlcHJlc2VudGF0aW9uIG9mIGltYWdlCgkgICAgICovCgkgICAgQml0TWF0cml4LnBhcnNlRnJvbUJvb2xlYW5BcnJheSA9IGZ1bmN0aW9uIChpbWFnZSkgewoJICAgICAgICB2YXIgaGVpZ2h0ID0gaW1hZ2UubGVuZ3RoOwoJICAgICAgICB2YXIgd2lkdGggPSBpbWFnZVswXS5sZW5ndGg7CgkgICAgICAgIHZhciBiaXRzID0gbmV3IEJpdE1hdHJpeCh3aWR0aCwgaGVpZ2h0KTsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBoZWlnaHQ7IGkrKykgewoJICAgICAgICAgICAgdmFyIGltYWdlSSA9IGltYWdlW2ldOwoJICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCB3aWR0aDsgaisrKSB7CgkgICAgICAgICAgICAgICAgaWYgKGltYWdlSVtqXSkgewoJICAgICAgICAgICAgICAgICAgICBiaXRzLnNldChqLCBpKTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGJpdHM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKgoJICAgICAqIEBmdW5jdGlvbiBwYXJzZQoJICAgICAqIEBwYXJhbSBzdHJpbmdSZXByZXNlbnRhdGlvbgoJICAgICAqIEBwYXJhbSBzZXRTdHJpbmcKCSAgICAgKiBAcGFyYW0gdW5zZXRTdHJpbmcKCSAgICAgKi8KCSAgICBCaXRNYXRyaXgucGFyc2VGcm9tU3RyaW5nID0gZnVuY3Rpb24gKHN0cmluZ1JlcHJlc2VudGF0aW9uLCBzZXRTdHJpbmcsIHVuc2V0U3RyaW5nKSB7CgkgICAgICAgIGlmIChzdHJpbmdSZXByZXNlbnRhdGlvbiA9PT0gbnVsbCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDcuZGVmYXVsdCgnc3RyaW5nUmVwcmVzZW50YXRpb24gY2Fubm90IGJlIG51bGwnKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgYml0cyA9IG5ldyBBcnJheShzdHJpbmdSZXByZXNlbnRhdGlvbi5sZW5ndGgpOwoJICAgICAgICB2YXIgYml0c1BvcyA9IDA7CgkgICAgICAgIHZhciByb3dTdGFydFBvcyA9IDA7CgkgICAgICAgIHZhciByb3dMZW5ndGggPSAtMTsKCSAgICAgICAgdmFyIG5Sb3dzID0gMDsKCSAgICAgICAgdmFyIHBvcyA9IDA7CgkgICAgICAgIHdoaWxlIChwb3MgPCBzdHJpbmdSZXByZXNlbnRhdGlvbi5sZW5ndGgpIHsKCSAgICAgICAgICAgIGlmIChzdHJpbmdSZXByZXNlbnRhdGlvbi5jaGFyQXQocG9zKSA9PT0gJ1xuJyB8fAoJICAgICAgICAgICAgICAgIHN0cmluZ1JlcHJlc2VudGF0aW9uLmNoYXJBdChwb3MpID09PSAnXHInKSB7CgkgICAgICAgICAgICAgICAgaWYgKGJpdHNQb3MgPiByb3dTdGFydFBvcykgewoJICAgICAgICAgICAgICAgICAgICBpZiAocm93TGVuZ3RoID09PSAtMSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgcm93TGVuZ3RoID0gYml0c1BvcyAtIHJvd1N0YXJ0UG9zOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGJpdHNQb3MgLSByb3dTdGFydFBvcyAhPT0gcm93TGVuZ3RoKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNy5kZWZhdWx0KCdyb3cgbGVuZ3RocyBkbyBub3QgbWF0Y2gnKTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICByb3dTdGFydFBvcyA9IGJpdHNQb3M7CgkgICAgICAgICAgICAgICAgICAgIG5Sb3dzKys7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIHBvcysrOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSBpZiAoc3RyaW5nUmVwcmVzZW50YXRpb24uc3Vic3RyaW5nKHBvcywgcG9zICsgc2V0U3RyaW5nLmxlbmd0aCkgPT09IHNldFN0cmluZykgewoJICAgICAgICAgICAgICAgIHBvcyArPSBzZXRTdHJpbmcubGVuZ3RoOwoJICAgICAgICAgICAgICAgIGJpdHNbYml0c1Bvc10gPSB0cnVlOwoJICAgICAgICAgICAgICAgIGJpdHNQb3MrKzsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGVsc2UgaWYgKHN0cmluZ1JlcHJlc2VudGF0aW9uLnN1YnN0cmluZyhwb3MsIHBvcyArIHVuc2V0U3RyaW5nLmxlbmd0aCkgPT09IHVuc2V0U3RyaW5nKSB7CgkgICAgICAgICAgICAgICAgcG9zICs9IHVuc2V0U3RyaW5nLmxlbmd0aDsKCSAgICAgICAgICAgICAgICBiaXRzW2JpdHNQb3NdID0gZmFsc2U7CgkgICAgICAgICAgICAgICAgYml0c1BvcysrOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDcuZGVmYXVsdCgnaWxsZWdhbCBjaGFyYWN0ZXIgZW5jb3VudGVyZWQ6ICcgKyBzdHJpbmdSZXByZXNlbnRhdGlvbi5zdWJzdHJpbmcocG9zKSk7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gbm8gRU9MIGF0IGVuZD8KCSAgICAgICAgaWYgKGJpdHNQb3MgPiByb3dTdGFydFBvcykgewoJICAgICAgICAgICAgaWYgKHJvd0xlbmd0aCA9PT0gLTEpIHsKCSAgICAgICAgICAgICAgICByb3dMZW5ndGggPSBiaXRzUG9zIC0gcm93U3RhcnRQb3M7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBlbHNlIGlmIChiaXRzUG9zIC0gcm93U3RhcnRQb3MgIT09IHJvd0xlbmd0aCkgewoJICAgICAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ3LmRlZmF1bHQoJ3JvdyBsZW5ndGhzIGRvIG5vdCBtYXRjaCcpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgblJvd3MrKzsKCSAgICAgICAgfQoJICAgICAgICB2YXIgbWF0cml4ID0gbmV3IEJpdE1hdHJpeChyb3dMZW5ndGgsIG5Sb3dzKTsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBiaXRzUG9zOyBpKyspIHsKCSAgICAgICAgICAgIGlmIChiaXRzW2ldKSB7CgkgICAgICAgICAgICAgICAgbWF0cml4LnNldChNYXRoLmZsb29yKGkgJSByb3dMZW5ndGgpLCBNYXRoLmZsb29yKGkgLyByb3dMZW5ndGgpKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gbWF0cml4OwoJICAgIH07CgkgICAgLyoqCgkgICAgICogPHA+R2V0cyB0aGUgcmVxdWVzdGVkIGJpdCwgd2hlcmUgdHJ1ZSBtZWFucyBibGFjay48L3A+CgkgICAgICoKCSAgICAgKiBAcGFyYW0geCBUaGUgaG9yaXpvbnRhbCBjb21wb25lbnQgKGkuZS4gd2hpY2ggY29sdW1uKQoJICAgICAqIEBwYXJhbSB5IFRoZSB2ZXJ0aWNhbCBjb21wb25lbnQgKGkuZS4gd2hpY2ggcm93KQoJICAgICAqIEByZXR1cm4gdmFsdWUgb2YgZ2l2ZW4gYml0IGluIG1hdHJpeAoJICAgICAqLwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gKHggLyppbnQqLywgeSAvKmludCovKSB7CgkgICAgICAgIHZhciBvZmZzZXQgPSB5ICogdGhpcy5yb3dTaXplICsgTWF0aC5mbG9vcih4IC8gMzIpOwoJICAgICAgICByZXR1cm4gKCh0aGlzLmJpdHNbb2Zmc2V0XSA+Pj4gKHggJiAweDFmKSkgJiAxKSAhPT0gMDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPlNldHMgdGhlIGdpdmVuIGJpdCB0byB0cnVlLjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSB4IFRoZSBob3Jpem9udGFsIGNvbXBvbmVudCAoaS5lLiB3aGljaCBjb2x1bW4pCgkgICAgICogQHBhcmFtIHkgVGhlIHZlcnRpY2FsIGNvbXBvbmVudCAoaS5lLiB3aGljaCByb3cpCgkgICAgICovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbiAoeCAvKmludCovLCB5IC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIG9mZnNldCA9IHkgKiB0aGlzLnJvd1NpemUgKyBNYXRoLmZsb29yKHggLyAzMik7CgkgICAgICAgIHRoaXMuYml0c1tvZmZzZXRdIHw9ICgxIDw8ICh4ICYgMHgxZikpICYgMHhGRkZGRkZGRjsKCSAgICB9OwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUudW5zZXQgPSBmdW5jdGlvbiAoeCAvKmludCovLCB5IC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIG9mZnNldCA9IHkgKiB0aGlzLnJvd1NpemUgKyBNYXRoLmZsb29yKHggLyAzMik7CgkgICAgICAgIHRoaXMuYml0c1tvZmZzZXRdICY9IH4oKDEgPDwgKHggJiAweDFmKSkgJiAweEZGRkZGRkZGKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPkZsaXBzIHRoZSBnaXZlbiBiaXQuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIHggVGhlIGhvcml6b250YWwgY29tcG9uZW50IChpLmUuIHdoaWNoIGNvbHVtbikKCSAgICAgKiBAcGFyYW0geSBUaGUgdmVydGljYWwgY29tcG9uZW50IChpLmUuIHdoaWNoIHJvdykKCSAgICAgKi8KCSAgICBCaXRNYXRyaXgucHJvdG90eXBlLmZsaXAgPSBmdW5jdGlvbiAoeCAvKmludCovLCB5IC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIG9mZnNldCA9IHkgKiB0aGlzLnJvd1NpemUgKyBNYXRoLmZsb29yKHggLyAzMik7CgkgICAgICAgIHRoaXMuYml0c1tvZmZzZXRdIF49ICgoMSA8PCAoeCAmIDB4MWYpKSAmIDB4RkZGRkZGRkYpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogRXhjbHVzaXZlLW9yIChYT1IpOiBGbGlwIHRoZSBiaXQgaW4gdGhpcyB7QGNvZGUgQml0TWF0cml4fSBpZiB0aGUgY29ycmVzcG9uZGluZwoJICAgICAqIG1hc2sgYml0IGlzIHNldC4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBtYXNrIFhPUiBtYXNrCgkgICAgICovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS54b3IgPSBmdW5jdGlvbiAobWFzaykgewoJICAgICAgICBpZiAodGhpcy53aWR0aCAhPT0gbWFzay5nZXRXaWR0aCgpIHx8IHRoaXMuaGVpZ2h0ICE9PSBtYXNrLmdldEhlaWdodCgpCgkgICAgICAgICAgICB8fCB0aGlzLnJvd1NpemUgIT09IG1hc2suZ2V0Um93U2l6ZSgpKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNy5kZWZhdWx0KCdpbnB1dCBtYXRyaXggZGltZW5zaW9ucyBkbyBub3QgbWF0Y2gnKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgcm93QXJyYXkgPSBuZXcgQml0QXJyYXlfMSQxLmRlZmF1bHQoTWF0aC5mbG9vcih0aGlzLndpZHRoIC8gMzIpICsgMSk7CgkgICAgICAgIHZhciByb3dTaXplID0gdGhpcy5yb3dTaXplOwoJICAgICAgICB2YXIgYml0cyA9IHRoaXMuYml0czsKCSAgICAgICAgZm9yICh2YXIgeSA9IDAsIGhlaWdodCA9IHRoaXMuaGVpZ2h0OyB5IDwgaGVpZ2h0OyB5KyspIHsKCSAgICAgICAgICAgIHZhciBvZmZzZXQgPSB5ICogcm93U2l6ZTsKCSAgICAgICAgICAgIHZhciByb3cgPSBtYXNrLmdldFJvdyh5LCByb3dBcnJheSkuZ2V0Qml0QXJyYXkoKTsKCSAgICAgICAgICAgIGZvciAodmFyIHggPSAwOyB4IDwgcm93U2l6ZTsgeCsrKSB7CgkgICAgICAgICAgICAgICAgYml0c1tvZmZzZXQgKyB4XSBePSByb3dbeF07CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICB9OwoJICAgIC8qKgoJICAgICAqIENsZWFycyBhbGwgYml0cyAoc2V0cyB0byBmYWxzZSkuCgkgICAgICovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS5jbGVhciA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIGJpdHMgPSB0aGlzLmJpdHM7CgkgICAgICAgIHZhciBtYXggPSBiaXRzLmxlbmd0aDsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtYXg7IGkrKykgewoJICAgICAgICAgICAgYml0c1tpXSA9IDA7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPlNldHMgYSBzcXVhcmUgcmVnaW9uIG9mIHRoZSBiaXQgbWF0cml4IHRvIHRydWUuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGxlZnQgVGhlIGhvcml6b250YWwgcG9zaXRpb24gdG8gYmVnaW4gYXQgKGluY2x1c2l2ZSkKCSAgICAgKiBAcGFyYW0gdG9wIFRoZSB2ZXJ0aWNhbCBwb3NpdGlvbiB0byBiZWdpbiBhdCAoaW5jbHVzaXZlKQoJICAgICAqIEBwYXJhbSB3aWR0aCBUaGUgd2lkdGggb2YgdGhlIHJlZ2lvbgoJICAgICAqIEBwYXJhbSBoZWlnaHQgVGhlIGhlaWdodCBvZiB0aGUgcmVnaW9uCgkgICAgICovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS5zZXRSZWdpb24gPSBmdW5jdGlvbiAobGVmdCAvKmludCovLCB0b3AgLyppbnQqLywgd2lkdGggLyppbnQqLywgaGVpZ2h0IC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKHRvcCA8IDAgfHwgbGVmdCA8IDApIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ3LmRlZmF1bHQoJ0xlZnQgYW5kIHRvcCBtdXN0IGJlIG5vbm5lZ2F0aXZlJyk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGhlaWdodCA8IDEgfHwgd2lkdGggPCAxKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNy5kZWZhdWx0KCdIZWlnaHQgYW5kIHdpZHRoIG11c3QgYmUgYXQgbGVhc3QgMScpOwoJICAgICAgICB9CgkgICAgICAgIHZhciByaWdodCA9IGxlZnQgKyB3aWR0aDsKCSAgICAgICAgdmFyIGJvdHRvbSA9IHRvcCArIGhlaWdodDsKCSAgICAgICAgaWYgKGJvdHRvbSA+IHRoaXMuaGVpZ2h0IHx8IHJpZ2h0ID4gdGhpcy53aWR0aCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDcuZGVmYXVsdCgnVGhlIHJlZ2lvbiBtdXN0IGZpdCBpbnNpZGUgdGhlIG1hdHJpeCcpOwoJICAgICAgICB9CgkgICAgICAgIHZhciByb3dTaXplID0gdGhpcy5yb3dTaXplOwoJICAgICAgICB2YXIgYml0cyA9IHRoaXMuYml0czsKCSAgICAgICAgZm9yICh2YXIgeSA9IHRvcDsgeSA8IGJvdHRvbTsgeSsrKSB7CgkgICAgICAgICAgICB2YXIgb2Zmc2V0ID0geSAqIHJvd1NpemU7CgkgICAgICAgICAgICBmb3IgKHZhciB4ID0gbGVmdDsgeCA8IHJpZ2h0OyB4KyspIHsKCSAgICAgICAgICAgICAgICBiaXRzW29mZnNldCArIE1hdGguZmxvb3IoeCAvIDMyKV0gfD0gKCgxIDw8ICh4ICYgMHgxZikpICYgMHhGRkZGRkZGRik7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEEgZmFzdCBtZXRob2QgdG8gcmV0cmlldmUgb25lIHJvdyBvZiBkYXRhIGZyb20gdGhlIG1hdHJpeCBhcyBhIEJpdEFycmF5LgoJICAgICAqCgkgICAgICogQHBhcmFtIHkgVGhlIHJvdyB0byByZXRyaWV2ZQoJICAgICAqIEBwYXJhbSByb3cgQW4gb3B0aW9uYWwgY2FsbGVyLWFsbG9jYXRlZCBCaXRBcnJheSwgd2lsbCBiZSBhbGxvY2F0ZWQgaWYgbnVsbCBvciB0b28gc21hbGwKCSAgICAgKiBAcmV0dXJuIFRoZSByZXN1bHRpbmcgQml0QXJyYXkgLSB0aGlzIHJlZmVyZW5jZSBzaG91bGQgYWx3YXlzIGJlIHVzZWQgZXZlbiB3aGVuIHBhc3NpbmcKCSAgICAgKiAgICAgICAgIHlvdXIgb3duIHJvdwoJICAgICAqLwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUuZ2V0Um93ID0gZnVuY3Rpb24gKHkgLyppbnQqLywgcm93KSB7CgkgICAgICAgIGlmIChyb3cgPT09IG51bGwgfHwgcm93ID09PSB1bmRlZmluZWQgfHwgcm93LmdldFNpemUoKSA8IHRoaXMud2lkdGgpIHsKCSAgICAgICAgICAgIHJvdyA9IG5ldyBCaXRBcnJheV8xJDEuZGVmYXVsdCh0aGlzLndpZHRoKTsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgIHJvdy5jbGVhcigpOwoJICAgICAgICB9CgkgICAgICAgIHZhciByb3dTaXplID0gdGhpcy5yb3dTaXplOwoJICAgICAgICB2YXIgYml0cyA9IHRoaXMuYml0czsKCSAgICAgICAgdmFyIG9mZnNldCA9IHkgKiByb3dTaXplOwoJICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IHJvd1NpemU7IHgrKykgewoJICAgICAgICAgICAgcm93LnNldEJ1bGsoeCAqIDMyLCBiaXRzW29mZnNldCArIHhdKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gcm93OwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHBhcmFtIHkgcm93IHRvIHNldAoJICAgICAqIEBwYXJhbSByb3cge0BsaW5rIEJpdEFycmF5fSB0byBjb3B5IGZyb20KCSAgICAgKi8KCSAgICBCaXRNYXRyaXgucHJvdG90eXBlLnNldFJvdyA9IGZ1bmN0aW9uICh5IC8qaW50Ki8sIHJvdykgewoJICAgICAgICBTeXN0ZW1fMSQzLmRlZmF1bHQuYXJyYXljb3B5KHJvdy5nZXRCaXRBcnJheSgpLCAwLCB0aGlzLmJpdHMsIHkgKiB0aGlzLnJvd1NpemUsIHRoaXMucm93U2l6ZSk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBNb2RpZmllcyB0aGlzIHtAY29kZSBCaXRNYXRyaXh9IHRvIHJlcHJlc2VudCB0aGUgc2FtZSBidXQgcm90YXRlZCAxODAgZGVncmVlcwoJICAgICAqLwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUucm90YXRlMTgwID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgd2lkdGggPSB0aGlzLmdldFdpZHRoKCk7CgkgICAgICAgIHZhciBoZWlnaHQgPSB0aGlzLmdldEhlaWdodCgpOwoJICAgICAgICB2YXIgdG9wUm93ID0gbmV3IEJpdEFycmF5XzEkMS5kZWZhdWx0KHdpZHRoKTsKCSAgICAgICAgdmFyIGJvdHRvbVJvdyA9IG5ldyBCaXRBcnJheV8xJDEuZGVmYXVsdCh3aWR0aCk7CgkgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGhfMSA9IE1hdGguZmxvb3IoKGhlaWdodCArIDEpIC8gMik7IGkgPCBsZW5ndGhfMTsgaSsrKSB7CgkgICAgICAgICAgICB0b3BSb3cgPSB0aGlzLmdldFJvdyhpLCB0b3BSb3cpOwoJICAgICAgICAgICAgYm90dG9tUm93ID0gdGhpcy5nZXRSb3coaGVpZ2h0IC0gMSAtIGksIGJvdHRvbVJvdyk7CgkgICAgICAgICAgICB0b3BSb3cucmV2ZXJzZSgpOwoJICAgICAgICAgICAgYm90dG9tUm93LnJldmVyc2UoKTsKCSAgICAgICAgICAgIHRoaXMuc2V0Um93KGksIGJvdHRvbVJvdyk7CgkgICAgICAgICAgICB0aGlzLnNldFJvdyhoZWlnaHQgLSAxIC0gaSwgdG9wUm93KTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgLyoqCgkgICAgICogVGhpcyBpcyB1c2VmdWwgaW4gZGV0ZWN0aW5nIHRoZSBlbmNsb3NpbmcgcmVjdGFuZ2xlIG9mIGEgJ3B1cmUnIGJhcmNvZGUuCgkgICAgICoKCSAgICAgKiBAcmV0dXJuIHtAY29kZSBsZWZ0LHRvcCx3aWR0aCxoZWlnaHR9IGVuY2xvc2luZyByZWN0YW5nbGUgb2YgYWxsIDEgYml0cywgb3IgbnVsbCBpZiBpdCBpcyBhbGwgd2hpdGUKCSAgICAgKi8KCSAgICBCaXRNYXRyaXgucHJvdG90eXBlLmdldEVuY2xvc2luZ1JlY3RhbmdsZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIHdpZHRoID0gdGhpcy53aWR0aDsKCSAgICAgICAgdmFyIGhlaWdodCA9IHRoaXMuaGVpZ2h0OwoJICAgICAgICB2YXIgcm93U2l6ZSA9IHRoaXMucm93U2l6ZTsKCSAgICAgICAgdmFyIGJpdHMgPSB0aGlzLmJpdHM7CgkgICAgICAgIHZhciBsZWZ0ID0gd2lkdGg7CgkgICAgICAgIHZhciB0b3AgPSBoZWlnaHQ7CgkgICAgICAgIHZhciByaWdodCA9IC0xOwoJICAgICAgICB2YXIgYm90dG9tID0gLTE7CgkgICAgICAgIGZvciAodmFyIHkgPSAwOyB5IDwgaGVpZ2h0OyB5KyspIHsKCSAgICAgICAgICAgIGZvciAodmFyIHgzMiA9IDA7IHgzMiA8IHJvd1NpemU7IHgzMisrKSB7CgkgICAgICAgICAgICAgICAgdmFyIHRoZUJpdHMgPSBiaXRzW3kgKiByb3dTaXplICsgeDMyXTsKCSAgICAgICAgICAgICAgICBpZiAodGhlQml0cyAhPT0gMCkgewoJICAgICAgICAgICAgICAgICAgICBpZiAoeSA8IHRvcCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgdG9wID0geTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICBpZiAoeSA+IGJvdHRvbSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgYm90dG9tID0geTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICBpZiAoeDMyICogMzIgPCBsZWZ0KSB7CgkgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYml0ID0gMDsKCSAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICgoKHRoZUJpdHMgPDwgKDMxIC0gYml0KSkgJiAweEZGRkZGRkZGKSA9PT0gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJpdCsrOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCh4MzIgKiAzMiArIGJpdCkgPCBsZWZ0KSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGVmdCA9IHgzMiAqIDMyICsgYml0OwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIGlmICh4MzIgKiAzMiArIDMxID4gcmlnaHQpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHZhciBiaXQgPSAzMTsKCSAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICgodGhlQml0cyA+Pj4gYml0KSA9PT0gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJpdC0tOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCh4MzIgKiAzMiArIGJpdCkgPiByaWdodCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJpZ2h0ID0geDMyICogMzIgKyBiaXQ7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHJpZ2h0IDwgbGVmdCB8fCBib3R0b20gPCB0b3ApIHsKCSAgICAgICAgICAgIHJldHVybiBudWxsOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBJbnQzMkFycmF5LmZyb20oW2xlZnQsIHRvcCwgcmlnaHQgLSBsZWZ0ICsgMSwgYm90dG9tIC0gdG9wICsgMV0pOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogVGhpcyBpcyB1c2VmdWwgaW4gZGV0ZWN0aW5nIGEgY29ybmVyIG9mIGEgJ3B1cmUnIGJhcmNvZGUuCgkgICAgICoKCSAgICAgKiBAcmV0dXJuIHtAY29kZSB4LHl9IGNvb3JkaW5hdGUgb2YgdG9wLWxlZnQtbW9zdCAxIGJpdCwgb3IgbnVsbCBpZiBpdCBpcyBhbGwgd2hpdGUKCSAgICAgKi8KCSAgICBCaXRNYXRyaXgucHJvdG90eXBlLmdldFRvcExlZnRPbkJpdCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIHJvd1NpemUgPSB0aGlzLnJvd1NpemU7CgkgICAgICAgIHZhciBiaXRzID0gdGhpcy5iaXRzOwoJICAgICAgICB2YXIgYml0c09mZnNldCA9IDA7CgkgICAgICAgIHdoaWxlIChiaXRzT2Zmc2V0IDwgYml0cy5sZW5ndGggJiYgYml0c1tiaXRzT2Zmc2V0XSA9PT0gMCkgewoJICAgICAgICAgICAgYml0c09mZnNldCsrOwoJICAgICAgICB9CgkgICAgICAgIGlmIChiaXRzT2Zmc2V0ID09PSBiaXRzLmxlbmd0aCkgewoJICAgICAgICAgICAgcmV0dXJuIG51bGw7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHkgPSBiaXRzT2Zmc2V0IC8gcm93U2l6ZTsKCSAgICAgICAgdmFyIHggPSAoYml0c09mZnNldCAlIHJvd1NpemUpICogMzI7CgkgICAgICAgIHZhciB0aGVCaXRzID0gYml0c1tiaXRzT2Zmc2V0XTsKCSAgICAgICAgdmFyIGJpdCA9IDA7CgkgICAgICAgIHdoaWxlICgoKHRoZUJpdHMgPDwgKDMxIC0gYml0KSkgJiAweEZGRkZGRkZGKSA9PT0gMCkgewoJICAgICAgICAgICAgYml0Kys7CgkgICAgICAgIH0KCSAgICAgICAgeCArPSBiaXQ7CgkgICAgICAgIHJldHVybiBJbnQzMkFycmF5LmZyb20oW3gsIHldKTsKCSAgICB9OwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUuZ2V0Qm90dG9tUmlnaHRPbkJpdCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIHJvd1NpemUgPSB0aGlzLnJvd1NpemU7CgkgICAgICAgIHZhciBiaXRzID0gdGhpcy5iaXRzOwoJICAgICAgICB2YXIgYml0c09mZnNldCA9IGJpdHMubGVuZ3RoIC0gMTsKCSAgICAgICAgd2hpbGUgKGJpdHNPZmZzZXQgPj0gMCAmJiBiaXRzW2JpdHNPZmZzZXRdID09PSAwKSB7CgkgICAgICAgICAgICBiaXRzT2Zmc2V0LS07CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGJpdHNPZmZzZXQgPCAwKSB7CgkgICAgICAgICAgICByZXR1cm4gbnVsbDsKCSAgICAgICAgfQoJICAgICAgICB2YXIgeSA9IE1hdGguZmxvb3IoYml0c09mZnNldCAvIHJvd1NpemUpOwoJICAgICAgICB2YXIgeCA9IE1hdGguZmxvb3IoYml0c09mZnNldCAlIHJvd1NpemUpICogMzI7CgkgICAgICAgIHZhciB0aGVCaXRzID0gYml0c1tiaXRzT2Zmc2V0XTsKCSAgICAgICAgdmFyIGJpdCA9IDMxOwoJICAgICAgICB3aGlsZSAoKHRoZUJpdHMgPj4+IGJpdCkgPT09IDApIHsKCSAgICAgICAgICAgIGJpdC0tOwoJICAgICAgICB9CgkgICAgICAgIHggKz0gYml0OwoJICAgICAgICByZXR1cm4gSW50MzJBcnJheS5mcm9tKFt4LCB5XSk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIFRoZSB3aWR0aCBvZiB0aGUgbWF0cml4CgkgICAgICovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS5nZXRXaWR0aCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMud2lkdGg7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIFRoZSBoZWlnaHQgb2YgdGhlIG1hdHJpeAoJICAgICAqLwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUuZ2V0SGVpZ2h0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5oZWlnaHQ7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIFRoZSByb3cgc2l6ZSBvZiB0aGUgbWF0cml4CgkgICAgICovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS5nZXRSb3dTaXplID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5yb3dTaXplOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUuZXF1YWxzID0gZnVuY3Rpb24gKG8pIHsKCSAgICAgICAgaWYgKCEobyBpbnN0YW5jZW9mIEJpdE1hdHJpeCkpIHsKCSAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgb3RoZXIgPSBvOwoJICAgICAgICByZXR1cm4gdGhpcy53aWR0aCA9PT0gb3RoZXIud2lkdGggJiYgdGhpcy5oZWlnaHQgPT09IG90aGVyLmhlaWdodCAmJiB0aGlzLnJvd1NpemUgPT09IG90aGVyLnJvd1NpemUgJiYKCSAgICAgICAgICAgIEFycmF5c18xLmRlZmF1bHQuZXF1YWxzKHRoaXMuYml0cywgb3RoZXIuYml0cyk7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS5oYXNoQ29kZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIGhhc2ggPSB0aGlzLndpZHRoOwoJICAgICAgICBoYXNoID0gMzEgKiBoYXNoICsgdGhpcy53aWR0aDsKCSAgICAgICAgaGFzaCA9IDMxICogaGFzaCArIHRoaXMuaGVpZ2h0OwoJICAgICAgICBoYXNoID0gMzEgKiBoYXNoICsgdGhpcy5yb3dTaXplOwoJICAgICAgICBoYXNoID0gMzEgKiBoYXNoICsgQXJyYXlzXzEuZGVmYXVsdC5oYXNoQ29kZSh0aGlzLmJpdHMpOwoJICAgICAgICByZXR1cm4gaGFzaDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gc3RyaW5nIHJlcHJlc2VudGF0aW9uIHVzaW5nICJYIiBmb3Igc2V0IGFuZCAiICIgZm9yIHVuc2V0IGJpdHMKCSAgICAgKi8KCSAgICAvKkBPdmVycmlkZSovCgkgICAgLy8gcHVibGljIHRvU3RyaW5nKCk6IHN0cmluZyB7CgkgICAgLy8gICByZXR1cm4gdG9TdHJpbmcoIjogIlgsICIgICIpCgkgICAgLy8gfQoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBzZXRTdHJpbmcgcmVwcmVzZW50YXRpb24gb2YgYSBzZXQgYml0CgkgICAgICogQHBhcmFtIHVuc2V0U3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIGFuIHVuc2V0IGJpdAoJICAgICAqIEByZXR1cm4gc3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIGVudGlyZSBtYXRyaXggdXRpbGl6aW5nIGdpdmVuIHN0cmluZ3MKCSAgICAgKi8KCSAgICAvLyBwdWJsaWMgdG9TdHJpbmcoc2V0U3RyaW5nOiBzdHJpbmcgPSAiWCAiLCB1bnNldFN0cmluZzogc3RyaW5nID0gIiAgIik6IHN0cmluZyB7CgkgICAgLy8gICByZXR1cm4gdGhpcy5idWlsZFRvU3RyaW5nKHNldFN0cmluZywgdW5zZXRTdHJpbmcsICJcbiIpCgkgICAgLy8gfQoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBzZXRTdHJpbmcgcmVwcmVzZW50YXRpb24gb2YgYSBzZXQgYml0CgkgICAgICogQHBhcmFtIHVuc2V0U3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIGFuIHVuc2V0IGJpdAoJICAgICAqIEBwYXJhbSBsaW5lU2VwYXJhdG9yIG5ld2xpbmUgY2hhcmFjdGVyIGluIHN0cmluZyByZXByZXNlbnRhdGlvbgoJICAgICAqIEByZXR1cm4gc3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIGVudGlyZSBtYXRyaXggdXRpbGl6aW5nIGdpdmVuIHN0cmluZ3MgYW5kIGxpbmUgc2VwYXJhdG9yCgkgICAgICogQGRlcHJlY2F0ZWQgY2FsbCB7QGxpbmsgI3RvU3RyaW5nKFN0cmluZyxTdHJpbmcpfSBvbmx5LCB3aGljaCB1c2VzIFxuIGxpbmUgc2VwYXJhdG9yIGFsd2F5cwoJICAgICAqLwoJICAgIC8vIEBEZXByZWNhdGVkCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uIChzZXRTdHJpbmcsIHVuc2V0U3RyaW5nLCBsaW5lU2VwYXJhdG9yKSB7CgkgICAgICAgIGlmIChzZXRTdHJpbmcgPT09IHZvaWQgMCkgeyBzZXRTdHJpbmcgPSAnWCAnOyB9CgkgICAgICAgIGlmICh1bnNldFN0cmluZyA9PT0gdm9pZCAwKSB7IHVuc2V0U3RyaW5nID0gJyAgJzsgfQoJICAgICAgICBpZiAobGluZVNlcGFyYXRvciA9PT0gdm9pZCAwKSB7IGxpbmVTZXBhcmF0b3IgPSAnXG4nOyB9CgkgICAgICAgIHJldHVybiB0aGlzLmJ1aWxkVG9TdHJpbmcoc2V0U3RyaW5nLCB1bnNldFN0cmluZywgbGluZVNlcGFyYXRvcik7CgkgICAgfTsKCSAgICBCaXRNYXRyaXgucHJvdG90eXBlLmJ1aWxkVG9TdHJpbmcgPSBmdW5jdGlvbiAoc2V0U3RyaW5nLCB1bnNldFN0cmluZywgbGluZVNlcGFyYXRvcikgewoJICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IFN0cmluZ0J1aWxkZXJfMSQyLmRlZmF1bHQoKTsKCSAgICAgICAgLy8gcmVzdWx0LmFwcGVuZChsaW5lU2VwYXJhdG9yKTsKCSAgICAgICAgZm9yICh2YXIgeSA9IDAsIGhlaWdodCA9IHRoaXMuaGVpZ2h0OyB5IDwgaGVpZ2h0OyB5KyspIHsKCSAgICAgICAgICAgIGZvciAodmFyIHggPSAwLCB3aWR0aCA9IHRoaXMud2lkdGg7IHggPCB3aWR0aDsgeCsrKSB7CgkgICAgICAgICAgICAgICAgcmVzdWx0LmFwcGVuZCh0aGlzLmdldCh4LCB5KSA/IHNldFN0cmluZyA6IHVuc2V0U3RyaW5nKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQobGluZVNlcGFyYXRvcik7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdC50b1N0cmluZygpOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUuY2xvbmUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiBuZXcgQml0TWF0cml4KHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0LCB0aGlzLnJvd1NpemUsIHRoaXMuYml0cy5zbGljZSgpKTsKCSAgICB9OwoJICAgIHJldHVybiBCaXRNYXRyaXg7Cgl9KCkpOwoJQml0TWF0cml4JDEuZGVmYXVsdCA9IEJpdE1hdHJpeDsKCgl2YXIgTm90Rm91bmRFeGNlcHRpb24kMSA9IHt9OwoKCXZhciBfX2V4dGVuZHMkZCA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShOb3RGb3VuZEV4Y2VwdGlvbiQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgRXhjZXB0aW9uXzEkNSA9IEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBDdXN0b20gRXJyb3IgY2xhc3Mgb2YgdHlwZSBFeGNlcHRpb24uCgkgKi8KCXZhciBOb3RGb3VuZEV4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkZChOb3RGb3VuZEV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBOb3RGb3VuZEV4Y2VwdGlvbigpIHsKCSAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwoJICAgIH0KCSAgICBOb3RGb3VuZEV4Y2VwdGlvbi5nZXROb3RGb3VuZEluc3RhbmNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gbmV3IE5vdEZvdW5kRXhjZXB0aW9uKCk7CgkgICAgfTsKCSAgICBOb3RGb3VuZEV4Y2VwdGlvbi5raW5kID0gJ05vdEZvdW5kRXhjZXB0aW9uJzsKCSAgICByZXR1cm4gTm90Rm91bmRFeGNlcHRpb247Cgl9KEV4Y2VwdGlvbl8xJDUuZGVmYXVsdCkpOwoJTm90Rm91bmRFeGNlcHRpb24kMS5kZWZhdWx0ID0gTm90Rm91bmRFeGNlcHRpb247CgoJLyoKCSAqIENvcHlyaWdodCAyMDA5IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCXZhciBfX2V4dGVuZHMkYyA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5jb21tb24geyovCgl2YXIgQmluYXJpemVyXzEgPSBCaW5hcml6ZXIkMTsKCXZhciBCaXRBcnJheV8xID0gQml0QXJyYXkkMTsKCXZhciBCaXRNYXRyaXhfMSQ1ID0gQml0TWF0cml4JDE7Cgl2YXIgTm90Rm91bmRFeGNlcHRpb25fMSQ2ID0gTm90Rm91bmRFeGNlcHRpb24kMTsKCS8qKgoJICogVGhpcyBCaW5hcml6ZXIgaW1wbGVtZW50YXRpb24gdXNlcyB0aGUgb2xkIFpYaW5nIGdsb2JhbCBoaXN0b2dyYW0gYXBwcm9hY2guIEl0IGlzIHN1aXRhYmxlCgkgKiBmb3IgbG93LWVuZCBtb2JpbGUgZGV2aWNlcyB3aGljaCBkb24ndCBoYXZlIGVub3VnaCBDUFUgb3IgbWVtb3J5IHRvIHVzZSBhIGxvY2FsIHRocmVzaG9sZGluZwoJICogYWxnb3JpdGhtLiBIb3dldmVyLCBiZWNhdXNlIGl0IHBpY2tzIGEgZ2xvYmFsIGJsYWNrIHBvaW50LCBpdCBjYW5ub3QgaGFuZGxlIGRpZmZpY3VsdCBzaGFkb3dzCgkgKiBhbmQgZ3JhZGllbnRzLgoJICoKCSAqIEZhc3RlciBtb2JpbGUgZGV2aWNlcyBhbmQgYWxsIGRlc2t0b3AgYXBwbGljYXRpb25zIHNob3VsZCBwcm9iYWJseSB1c2UgSHlicmlkQmluYXJpemVyIGluc3RlYWQuCgkgKgoJICogQGF1dGhvciBkc3dpdGtpbkBnb29nbGUuY29tIChEYW5pZWwgU3dpdGtpbikKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJGMoR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLCBfc3VwZXIpOwoJICAgIGZ1bmN0aW9uIEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplcihzb3VyY2UpIHsKCSAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgc291cmNlKSB8fCB0aGlzOwoJICAgICAgICBfdGhpcy5sdW1pbmFuY2VzID0gR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLkVNUFRZOwoJICAgICAgICBfdGhpcy5idWNrZXRzID0gbmV3IEludDMyQXJyYXkoR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLkxVTUlOQU5DRV9CVUNLRVRTKTsKCSAgICAgICAgcmV0dXJuIF90aGlzOwoJICAgIH0KCSAgICAvLyBBcHBsaWVzIHNpbXBsZSBzaGFycGVuaW5nIHRvIHRoZSByb3cgZGF0YSB0byBpbXByb3ZlIHBlcmZvcm1hbmNlIG9mIHRoZSAxRCBSZWFkZXJzLgoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIucHJvdG90eXBlLmdldEJsYWNrUm93ID0gZnVuY3Rpb24gKHkgLyppbnQqLywgcm93KSB7CgkgICAgICAgIHZhciBzb3VyY2UgPSB0aGlzLmdldEx1bWluYW5jZVNvdXJjZSgpOwoJICAgICAgICB2YXIgd2lkdGggPSBzb3VyY2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgaWYgKHJvdyA9PT0gdW5kZWZpbmVkIHx8IHJvdyA9PT0gbnVsbCB8fCByb3cuZ2V0U2l6ZSgpIDwgd2lkdGgpIHsKCSAgICAgICAgICAgIHJvdyA9IG5ldyBCaXRBcnJheV8xLmRlZmF1bHQod2lkdGgpOwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgcm93LmNsZWFyKCk7CgkgICAgICAgIH0KCSAgICAgICAgdGhpcy5pbml0QXJyYXlzKHdpZHRoKTsKCSAgICAgICAgdmFyIGxvY2FsTHVtaW5hbmNlcyA9IHNvdXJjZS5nZXRSb3coeSwgdGhpcy5sdW1pbmFuY2VzKTsKCSAgICAgICAgdmFyIGxvY2FsQnVja2V0cyA9IHRoaXMuYnVja2V0czsKCSAgICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCB3aWR0aDsgeCsrKSB7CgkgICAgICAgICAgICBsb2NhbEJ1Y2tldHNbKGxvY2FsTHVtaW5hbmNlc1t4XSAmIDB4ZmYpID4+IEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplci5MVU1JTkFOQ0VfU0hJRlRdKys7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGJsYWNrUG9pbnQgPSBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIuZXN0aW1hdGVCbGFja1BvaW50KGxvY2FsQnVja2V0cyk7CgkgICAgICAgIGlmICh3aWR0aCA8IDMpIHsKCSAgICAgICAgICAgIC8vIFNwZWNpYWwgY2FzZSBmb3IgdmVyeSBzbWFsbCBpbWFnZXMKCSAgICAgICAgICAgIGZvciAodmFyIHggPSAwOyB4IDwgd2lkdGg7IHgrKykgewoJICAgICAgICAgICAgICAgIGlmICgobG9jYWxMdW1pbmFuY2VzW3hdICYgMHhmZikgPCBibGFja1BvaW50KSB7CgkgICAgICAgICAgICAgICAgICAgIHJvdy5zZXQoeCk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgdmFyIGxlZnQgPSBsb2NhbEx1bWluYW5jZXNbMF0gJiAweGZmOwoJICAgICAgICAgICAgdmFyIGNlbnRlciA9IGxvY2FsTHVtaW5hbmNlc1sxXSAmIDB4ZmY7CgkgICAgICAgICAgICBmb3IgKHZhciB4ID0gMTsgeCA8IHdpZHRoIC0gMTsgeCsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIHJpZ2h0ID0gbG9jYWxMdW1pbmFuY2VzW3ggKyAxXSAmIDB4ZmY7CgkgICAgICAgICAgICAgICAgLy8gQSBzaW1wbGUgLTEgNCAtMSBib3ggZmlsdGVyIHdpdGggYSB3ZWlnaHQgb2YgMi4KCSAgICAgICAgICAgICAgICBpZiAoKChjZW50ZXIgKiA0KSAtIGxlZnQgLSByaWdodCkgLyAyIDwgYmxhY2tQb2ludCkgewoJICAgICAgICAgICAgICAgICAgICByb3cuc2V0KHgpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBsZWZ0ID0gY2VudGVyOwoJICAgICAgICAgICAgICAgIGNlbnRlciA9IHJpZ2h0OwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiByb3c7CgkgICAgfTsKCSAgICAvLyBEb2VzIG5vdCBzaGFycGVuIHRoZSBkYXRhLCBhcyB0aGlzIGNhbGwgaXMgaW50ZW5kZWQgdG8gb25seSBiZSB1c2VkIGJ5IDJEIFJlYWRlcnMuCgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplci5wcm90b3R5cGUuZ2V0QmxhY2tNYXRyaXggPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHZhciBzb3VyY2UgPSB0aGlzLmdldEx1bWluYW5jZVNvdXJjZSgpOwoJICAgICAgICB2YXIgd2lkdGggPSBzb3VyY2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgdmFyIGhlaWdodCA9IHNvdXJjZS5nZXRIZWlnaHQoKTsKCSAgICAgICAgdmFyIG1hdHJpeCA9IG5ldyBCaXRNYXRyaXhfMSQ1LmRlZmF1bHQod2lkdGgsIGhlaWdodCk7CgkgICAgICAgIC8vIFF1aWNrbHkgY2FsY3VsYXRlcyB0aGUgaGlzdG9ncmFtIGJ5IHNhbXBsaW5nIGZvdXIgcm93cyBmcm9tIHRoZSBpbWFnZS4gVGhpcyBwcm92ZWQgdG8gYmUKCSAgICAgICAgLy8gbW9yZSByb2J1c3Qgb24gdGhlIGJsYWNrYm94IHRlc3RzIHRoYW4gc2FtcGxpbmcgYSBkaWFnb25hbCBhcyB3ZSB1c2VkIHRvIGRvLgoJICAgICAgICB0aGlzLmluaXRBcnJheXMod2lkdGgpOwoJICAgICAgICB2YXIgbG9jYWxCdWNrZXRzID0gdGhpcy5idWNrZXRzOwoJICAgICAgICBmb3IgKHZhciB5ID0gMTsgeSA8IDU7IHkrKykgewoJICAgICAgICAgICAgdmFyIHJvdyA9IE1hdGguZmxvb3IoKGhlaWdodCAqIHkpIC8gNSk7CgkgICAgICAgICAgICB2YXIgbG9jYWxMdW1pbmFuY2VzXzEgPSBzb3VyY2UuZ2V0Um93KHJvdywgdGhpcy5sdW1pbmFuY2VzKTsKCSAgICAgICAgICAgIHZhciByaWdodCA9IE1hdGguZmxvb3IoKHdpZHRoICogNCkgLyA1KTsKCSAgICAgICAgICAgIGZvciAodmFyIHggPSBNYXRoLmZsb29yKHdpZHRoIC8gNSk7IHggPCByaWdodDsgeCsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIHBpeGVsID0gbG9jYWxMdW1pbmFuY2VzXzFbeF0gJiAweGZmOwoJICAgICAgICAgICAgICAgIGxvY2FsQnVja2V0c1twaXhlbCA+PiBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIuTFVNSU5BTkNFX1NISUZUXSsrOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHZhciBibGFja1BvaW50ID0gR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLmVzdGltYXRlQmxhY2tQb2ludChsb2NhbEJ1Y2tldHMpOwoJICAgICAgICAvLyBXZSBkZWxheSByZWFkaW5nIHRoZSBlbnRpcmUgaW1hZ2UgbHVtaW5hbmNlIHVudGlsIHRoZSBibGFjayBwb2ludCBlc3RpbWF0aW9uIHN1Y2NlZWRzLgoJICAgICAgICAvLyBBbHRob3VnaCB3ZSBlbmQgdXAgcmVhZGluZyBmb3VyIHJvd3MgdHdpY2UsIGl0IGlzIGNvbnNpc3RlbnQgd2l0aCBvdXIgbW90dG8gb2YKCSAgICAgICAgLy8gImZhaWwgcXVpY2tseSIgd2hpY2ggaXMgbmVjZXNzYXJ5IGZvciBjb250aW51b3VzIHNjYW5uaW5nLgoJICAgICAgICB2YXIgbG9jYWxMdW1pbmFuY2VzID0gc291cmNlLmdldE1hdHJpeCgpOwoJICAgICAgICBmb3IgKHZhciB5ID0gMDsgeSA8IGhlaWdodDsgeSsrKSB7CgkgICAgICAgICAgICB2YXIgb2Zmc2V0ID0geSAqIHdpZHRoOwoJICAgICAgICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCB3aWR0aDsgeCsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIHBpeGVsID0gbG9jYWxMdW1pbmFuY2VzW29mZnNldCArIHhdICYgMHhmZjsKCSAgICAgICAgICAgICAgICBpZiAocGl4ZWwgPCBibGFja1BvaW50KSB7CgkgICAgICAgICAgICAgICAgICAgIG1hdHJpeC5zZXQoeCwgeSk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBtYXRyaXg7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLnByb3RvdHlwZS5jcmVhdGVCaW5hcml6ZXIgPSBmdW5jdGlvbiAoc291cmNlKSB7CgkgICAgICAgIHJldHVybiBuZXcgR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyKHNvdXJjZSk7CgkgICAgfTsKCSAgICBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIucHJvdG90eXBlLmluaXRBcnJheXMgPSBmdW5jdGlvbiAobHVtaW5hbmNlU2l6ZSAvKmludCovKSB7CgkgICAgICAgIGlmICh0aGlzLmx1bWluYW5jZXMubGVuZ3RoIDwgbHVtaW5hbmNlU2l6ZSkgewoJICAgICAgICAgICAgdGhpcy5sdW1pbmFuY2VzID0gbmV3IFVpbnQ4Q2xhbXBlZEFycmF5KGx1bWluYW5jZVNpemUpOwoJICAgICAgICB9CgkgICAgICAgIHZhciBidWNrZXRzID0gdGhpcy5idWNrZXRzOwoJICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplci5MVU1JTkFOQ0VfQlVDS0VUUzsgeCsrKSB7CgkgICAgICAgICAgICBidWNrZXRzW3hdID0gMDsKCSAgICAgICAgfQoJICAgIH07CgkgICAgR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLmVzdGltYXRlQmxhY2tQb2ludCA9IGZ1bmN0aW9uIChidWNrZXRzKSB7CgkgICAgICAgIC8vIEZpbmQgdGhlIHRhbGxlc3QgcGVhayBpbiB0aGUgaGlzdG9ncmFtLgoJICAgICAgICB2YXIgbnVtQnVja2V0cyA9IGJ1Y2tldHMubGVuZ3RoOwoJICAgICAgICB2YXIgbWF4QnVja2V0Q291bnQgPSAwOwoJICAgICAgICB2YXIgZmlyc3RQZWFrID0gMDsKCSAgICAgICAgdmFyIGZpcnN0UGVha1NpemUgPSAwOwoJICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IG51bUJ1Y2tldHM7IHgrKykgewoJICAgICAgICAgICAgaWYgKGJ1Y2tldHNbeF0gPiBmaXJzdFBlYWtTaXplKSB7CgkgICAgICAgICAgICAgICAgZmlyc3RQZWFrID0geDsKCSAgICAgICAgICAgICAgICBmaXJzdFBlYWtTaXplID0gYnVja2V0c1t4XTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGlmIChidWNrZXRzW3hdID4gbWF4QnVja2V0Q291bnQpIHsKCSAgICAgICAgICAgICAgICBtYXhCdWNrZXRDb3VudCA9IGJ1Y2tldHNbeF07CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gRmluZCB0aGUgc2Vjb25kLXRhbGxlc3QgcGVhayB3aGljaCBpcyBzb21ld2hhdCBmYXIgZnJvbSB0aGUgdGFsbGVzdCBwZWFrLgoJICAgICAgICB2YXIgc2Vjb25kUGVhayA9IDA7CgkgICAgICAgIHZhciBzZWNvbmRQZWFrU2NvcmUgPSAwOwoJICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IG51bUJ1Y2tldHM7IHgrKykgewoJICAgICAgICAgICAgdmFyIGRpc3RhbmNlVG9CaWdnZXN0ID0geCAtIGZpcnN0UGVhazsKCSAgICAgICAgICAgIC8vIEVuY291cmFnZSBtb3JlIGRpc3RhbnQgc2Vjb25kIHBlYWtzIGJ5IG11bHRpcGx5aW5nIGJ5IHNxdWFyZSBvZiBkaXN0YW5jZS4KCSAgICAgICAgICAgIHZhciBzY29yZSA9IGJ1Y2tldHNbeF0gKiBkaXN0YW5jZVRvQmlnZ2VzdCAqIGRpc3RhbmNlVG9CaWdnZXN0OwoJICAgICAgICAgICAgaWYgKHNjb3JlID4gc2Vjb25kUGVha1Njb3JlKSB7CgkgICAgICAgICAgICAgICAgc2Vjb25kUGVhayA9IHg7CgkgICAgICAgICAgICAgICAgc2Vjb25kUGVha1Njb3JlID0gc2NvcmU7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gTWFrZSBzdXJlIGZpcnN0UGVhayBjb3JyZXNwb25kcyB0byB0aGUgYmxhY2sgcGVhay4KCSAgICAgICAgaWYgKGZpcnN0UGVhayA+IHNlY29uZFBlYWspIHsKCSAgICAgICAgICAgIHZhciB0ZW1wID0gZmlyc3RQZWFrOwoJICAgICAgICAgICAgZmlyc3RQZWFrID0gc2Vjb25kUGVhazsKCSAgICAgICAgICAgIHNlY29uZFBlYWsgPSB0ZW1wOwoJICAgICAgICB9CgkgICAgICAgIC8vIElmIHRoZXJlIGlzIHRvbyBsaXR0bGUgY29udHJhc3QgaW4gdGhlIGltYWdlIHRvIHBpY2sgYSBtZWFuaW5nZnVsIGJsYWNrIHBvaW50LCB0aHJvdyByYXRoZXIKCSAgICAgICAgLy8gdGhhbiB3YXN0ZSB0aW1lIHRyeWluZyB0byBkZWNvZGUgdGhlIGltYWdlLCBhbmQgcmlzayBmYWxzZSBwb3NpdGl2ZXMuCgkgICAgICAgIGlmIChzZWNvbmRQZWFrIC0gZmlyc3RQZWFrIDw9IG51bUJ1Y2tldHMgLyAxNikgewoJICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uXzEkNi5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gRmluZCBhIHZhbGxleSBiZXR3ZWVuIHRoZW0gdGhhdCBpcyBsb3cgYW5kIGNsb3NlciB0byB0aGUgd2hpdGUgcGVhay4KCSAgICAgICAgdmFyIGJlc3RWYWxsZXkgPSBzZWNvbmRQZWFrIC0gMTsKCSAgICAgICAgdmFyIGJlc3RWYWxsZXlTY29yZSA9IC0xOwoJICAgICAgICBmb3IgKHZhciB4ID0gc2Vjb25kUGVhayAtIDE7IHggPiBmaXJzdFBlYWs7IHgtLSkgewoJICAgICAgICAgICAgdmFyIGZyb21GaXJzdCA9IHggLSBmaXJzdFBlYWs7CgkgICAgICAgICAgICB2YXIgc2NvcmUgPSBmcm9tRmlyc3QgKiBmcm9tRmlyc3QgKiAoc2Vjb25kUGVhayAtIHgpICogKG1heEJ1Y2tldENvdW50IC0gYnVja2V0c1t4XSk7CgkgICAgICAgICAgICBpZiAoc2NvcmUgPiBiZXN0VmFsbGV5U2NvcmUpIHsKCSAgICAgICAgICAgICAgICBiZXN0VmFsbGV5ID0geDsKCSAgICAgICAgICAgICAgICBiZXN0VmFsbGV5U2NvcmUgPSBzY29yZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gYmVzdFZhbGxleSA8PCBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIuTFVNSU5BTkNFX1NISUZUOwoJICAgIH07CgkgICAgR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLkxVTUlOQU5DRV9CSVRTID0gNTsKCSAgICBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIuTFVNSU5BTkNFX1NISUZUID0gOCAtIEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplci5MVU1JTkFOQ0VfQklUUzsKCSAgICBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIuTFVNSU5BTkNFX0JVQ0tFVFMgPSAxIDw8IEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplci5MVU1JTkFOQ0VfQklUUzsKCSAgICBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIuRU1QVFkgPSBVaW50OENsYW1wZWRBcnJheS5mcm9tKFswXSk7CgkgICAgcmV0dXJuIEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplcjsKCX0oQmluYXJpemVyXzEuZGVmYXVsdCkpOwoJR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyJDEuZGVmYXVsdCA9IEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplcjsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDkgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fZXh0ZW5kcyRiID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHsKCSAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwKCSAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHwKCSAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9OwoJICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICB9OwoJICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH0KCSAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpOwoJICAgIH07Cgl9KSgpOwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEh5YnJpZEJpbmFyaXplciQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyXzEgPSBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIkMTsKCXZhciBCaXRNYXRyaXhfMSQ0ID0gQml0TWF0cml4JDE7CgkvKioKCSAqIFRoaXMgY2xhc3MgaW1wbGVtZW50cyBhIGxvY2FsIHRocmVzaG9sZGluZyBhbGdvcml0aG0sIHdoaWNoIHdoaWxlIHNsb3dlciB0aGFuIHRoZQoJICogR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLCBpcyBmYWlybHkgZWZmaWNpZW50IGZvciB3aGF0IGl0IGRvZXMuIEl0IGlzIGRlc2lnbmVkIGZvcgoJICogaGlnaCBmcmVxdWVuY3kgaW1hZ2VzIG9mIGJhcmNvZGVzIHdpdGggYmxhY2sgZGF0YSBvbiB3aGl0ZSBiYWNrZ3JvdW5kcy4gRm9yIHRoaXMgYXBwbGljYXRpb24sCgkgKiBpdCBkb2VzIGEgbXVjaCBiZXR0ZXIgam9iIHRoYW4gYSBnbG9iYWwgYmxhY2twb2ludCB3aXRoIHNldmVyZSBzaGFkb3dzIGFuZCBncmFkaWVudHMuCgkgKiBIb3dldmVyIGl0IHRlbmRzIHRvIHByb2R1Y2UgYXJ0aWZhY3RzIG9uIGxvd2VyIGZyZXF1ZW5jeSBpbWFnZXMgYW5kIGlzIHRoZXJlZm9yZSBub3QKCSAqIGEgZ29vZCBnZW5lcmFsIHB1cnBvc2UgYmluYXJpemVyIGZvciB1c2VzIG91dHNpZGUgWlhpbmcuCgkgKgoJICogVGhpcyBjbGFzcyBleHRlbmRzIEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplciwgdXNpbmcgdGhlIG9sZGVyIGhpc3RvZ3JhbSBhcHByb2FjaCBmb3IgMUQgcmVhZGVycywKCSAqIGFuZCB0aGUgbmV3ZXIgbG9jYWwgYXBwcm9hY2ggZm9yIDJEIHJlYWRlcnMuIDFEIGRlY29kaW5nIHVzaW5nIGEgcGVyLXJvdyBoaXN0b2dyYW0gaXMgYWxyZWFkeQoJICogaW5oZXJlbnRseSBsb2NhbCwgYW5kIG9ubHkgZmFpbHMgZm9yIGhvcml6b250YWwgZ3JhZGllbnRzLiBXZSBjYW4gcmV2aXNpdCB0aGF0IHByb2JsZW0gbGF0ZXIsCgkgKiBidXQgZm9yIG5vdyBpdCB3YXMgbm90IGEgd2luIHRvIHVzZSBsb2NhbCBibG9ja3MgZm9yIDFELgoJICoKCSAqIFRoaXMgQmluYXJpemVyIGlzIHRoZSBkZWZhdWx0IGZvciB0aGUgdW5pdCB0ZXN0cyBhbmQgdGhlIHJlY29tbWVuZGVkIGNsYXNzIGZvciBsaWJyYXJ5IHVzZXJzLgoJICoKCSAqIEBhdXRob3IgZHN3aXRraW5AZ29vZ2xlLmNvbSAoRGFuaWVsIFN3aXRraW4pCgkgKi8KCXZhciBIeWJyaWRCaW5hcml6ZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJGIoSHlicmlkQmluYXJpemVyLCBfc3VwZXIpOwoJICAgIGZ1bmN0aW9uIEh5YnJpZEJpbmFyaXplcihzb3VyY2UpIHsKCSAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgc291cmNlKSB8fCB0aGlzOwoJICAgICAgICBfdGhpcy5tYXRyaXggPSBudWxsOwoJICAgICAgICByZXR1cm4gX3RoaXM7CgkgICAgfQoJICAgIC8qKgoJICAgICAqIENhbGN1bGF0ZXMgdGhlIGZpbmFsIEJpdE1hdHJpeCBvbmNlIGZvciBhbGwgcmVxdWVzdHMuIFRoaXMgY291bGQgYmUgY2FsbGVkIG9uY2UgZnJvbSB0aGUKCSAgICAgKiBjb25zdHJ1Y3RvciBpbnN0ZWFkLCBidXQgdGhlcmUgYXJlIHNvbWUgYWR2YW50YWdlcyB0byBkb2luZyBpdCBsYXppbHksIHN1Y2ggYXMgbWFraW5nCgkgICAgICogcHJvZmlsaW5nIGVhc2llciwgYW5kIG5vdCBkb2luZyBoZWF2eSBsaWZ0aW5nIHdoZW4gY2FsbGVycyBkb24ndCBleHBlY3QgaXQuCgkgICAgICovCgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEh5YnJpZEJpbmFyaXplci5wcm90b3R5cGUuZ2V0QmxhY2tNYXRyaXggPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIGlmICh0aGlzLm1hdHJpeCAhPT0gbnVsbCkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMubWF0cml4OwoJICAgICAgICB9CgkgICAgICAgIHZhciBzb3VyY2UgPSB0aGlzLmdldEx1bWluYW5jZVNvdXJjZSgpOwoJICAgICAgICB2YXIgd2lkdGggPSBzb3VyY2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgdmFyIGhlaWdodCA9IHNvdXJjZS5nZXRIZWlnaHQoKTsKCSAgICAgICAgaWYgKHdpZHRoID49IEh5YnJpZEJpbmFyaXplci5NSU5JTVVNX0RJTUVOU0lPTiAmJiBoZWlnaHQgPj0gSHlicmlkQmluYXJpemVyLk1JTklNVU1fRElNRU5TSU9OKSB7CgkgICAgICAgICAgICB2YXIgbHVtaW5hbmNlcyA9IHNvdXJjZS5nZXRNYXRyaXgoKTsKCSAgICAgICAgICAgIHZhciBzdWJXaWR0aCA9IHdpZHRoID4+IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX1BPV0VSOwoJICAgICAgICAgICAgaWYgKCh3aWR0aCAmIEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX01BU0spICE9PSAwKSB7CgkgICAgICAgICAgICAgICAgc3ViV2lkdGgrKzsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHZhciBzdWJIZWlnaHQgPSBoZWlnaHQgPj4gSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkVfUE9XRVI7CgkgICAgICAgICAgICBpZiAoKGhlaWdodCAmIEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX01BU0spICE9PSAwKSB7CgkgICAgICAgICAgICAgICAgc3ViSGVpZ2h0Kys7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB2YXIgYmxhY2tQb2ludHMgPSBIeWJyaWRCaW5hcml6ZXIuY2FsY3VsYXRlQmxhY2tQb2ludHMobHVtaW5hbmNlcywgc3ViV2lkdGgsIHN1YkhlaWdodCwgd2lkdGgsIGhlaWdodCk7CgkgICAgICAgICAgICB2YXIgbmV3TWF0cml4ID0gbmV3IEJpdE1hdHJpeF8xJDQuZGVmYXVsdCh3aWR0aCwgaGVpZ2h0KTsKCSAgICAgICAgICAgIEh5YnJpZEJpbmFyaXplci5jYWxjdWxhdGVUaHJlc2hvbGRGb3JCbG9jayhsdW1pbmFuY2VzLCBzdWJXaWR0aCwgc3ViSGVpZ2h0LCB3aWR0aCwgaGVpZ2h0LCBibGFja1BvaW50cywgbmV3TWF0cml4KTsKCSAgICAgICAgICAgIHRoaXMubWF0cml4ID0gbmV3TWF0cml4OwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgLy8gSWYgdGhlIGltYWdlIGlzIHRvbyBzbWFsbCwgZmFsbCBiYWNrIHRvIHRoZSBnbG9iYWwgaGlzdG9ncmFtIGFwcHJvYWNoLgoJICAgICAgICAgICAgdGhpcy5tYXRyaXggPSBfc3VwZXIucHJvdG90eXBlLmdldEJsYWNrTWF0cml4LmNhbGwodGhpcyk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRoaXMubWF0cml4OwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEh5YnJpZEJpbmFyaXplci5wcm90b3R5cGUuY3JlYXRlQmluYXJpemVyID0gZnVuY3Rpb24gKHNvdXJjZSkgewoJICAgICAgICByZXR1cm4gbmV3IEh5YnJpZEJpbmFyaXplcihzb3VyY2UpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogRm9yIGVhY2ggYmxvY2sgaW4gdGhlIGltYWdlLCBjYWxjdWxhdGUgdGhlIGF2ZXJhZ2UgYmxhY2sgcG9pbnQgdXNpbmcgYSA1eDUgZ3JpZAoJICAgICAqIG9mIHRoZSBibG9ja3MgYXJvdW5kIGl0LiBBbHNvIGhhbmRsZXMgdGhlIGNvcm5lciBjYXNlcyAoZnJhY3Rpb25hbCBibG9ja3MgYXJlIGNvbXB1dGVkIGJhc2VkCgkgICAgICogb24gdGhlIGxhc3QgcGl4ZWxzIGluIHRoZSByb3cvY29sdW1uIHdoaWNoIGFyZSBhbHNvIHVzZWQgaW4gdGhlIHByZXZpb3VzIGJsb2NrKS4KCSAgICAgKi8KCSAgICBIeWJyaWRCaW5hcml6ZXIuY2FsY3VsYXRlVGhyZXNob2xkRm9yQmxvY2sgPSBmdW5jdGlvbiAobHVtaW5hbmNlcywgc3ViV2lkdGggLyppbnQqLywgc3ViSGVpZ2h0IC8qaW50Ki8sIHdpZHRoIC8qaW50Ki8sIGhlaWdodCAvKmludCovLCBibGFja1BvaW50cywgbWF0cml4KSB7CgkgICAgICAgIHZhciBtYXhZT2Zmc2V0ID0gaGVpZ2h0IC0gSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkU7CgkgICAgICAgIHZhciBtYXhYT2Zmc2V0ID0gd2lkdGggLSBIeWJyaWRCaW5hcml6ZXIuQkxPQ0tfU0laRTsKCSAgICAgICAgZm9yICh2YXIgeSA9IDA7IHkgPCBzdWJIZWlnaHQ7IHkrKykgewoJICAgICAgICAgICAgdmFyIHlvZmZzZXQgPSB5IDw8IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX1BPV0VSOwoJICAgICAgICAgICAgaWYgKHlvZmZzZXQgPiBtYXhZT2Zmc2V0KSB7CgkgICAgICAgICAgICAgICAgeW9mZnNldCA9IG1heFlPZmZzZXQ7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB2YXIgdG9wXzEgPSBIeWJyaWRCaW5hcml6ZXIuY2FwKHksIDIsIHN1YkhlaWdodCAtIDMpOwoJICAgICAgICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCBzdWJXaWR0aDsgeCsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIHhvZmZzZXQgPSB4IDw8IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX1BPV0VSOwoJICAgICAgICAgICAgICAgIGlmICh4b2Zmc2V0ID4gbWF4WE9mZnNldCkgewoJICAgICAgICAgICAgICAgICAgICB4b2Zmc2V0ID0gbWF4WE9mZnNldDsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgdmFyIGxlZnQgPSBIeWJyaWRCaW5hcml6ZXIuY2FwKHgsIDIsIHN1YldpZHRoIC0gMyk7CgkgICAgICAgICAgICAgICAgdmFyIHN1bSA9IDA7CgkgICAgICAgICAgICAgICAgZm9yICh2YXIgeiA9IC0yOyB6IDw9IDI7IHorKykgewoJICAgICAgICAgICAgICAgICAgICB2YXIgYmxhY2tSb3cgPSBibGFja1BvaW50c1t0b3BfMSArIHpdOwoJICAgICAgICAgICAgICAgICAgICBzdW0gKz0gYmxhY2tSb3dbbGVmdCAtIDJdICsgYmxhY2tSb3dbbGVmdCAtIDFdICsgYmxhY2tSb3dbbGVmdF0gKyBibGFja1Jvd1tsZWZ0ICsgMV0gKyBibGFja1Jvd1tsZWZ0ICsgMl07CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIHZhciBhdmVyYWdlID0gc3VtIC8gMjU7CgkgICAgICAgICAgICAgICAgSHlicmlkQmluYXJpemVyLnRocmVzaG9sZEJsb2NrKGx1bWluYW5jZXMsIHhvZmZzZXQsIHlvZmZzZXQsIGF2ZXJhZ2UsIHdpZHRoLCBtYXRyaXgpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfTsKCSAgICBIeWJyaWRCaW5hcml6ZXIuY2FwID0gZnVuY3Rpb24gKHZhbHVlIC8qaW50Ki8sIG1pbiAvKmludCovLCBtYXggLyppbnQqLykgewoJICAgICAgICByZXR1cm4gdmFsdWUgPCBtaW4gPyBtaW4gOiB2YWx1ZSA+IG1heCA/IG1heCA6IHZhbHVlOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQXBwbGllcyBhIHNpbmdsZSB0aHJlc2hvbGQgdG8gYSBibG9jayBvZiBwaXhlbHMuCgkgICAgICovCgkgICAgSHlicmlkQmluYXJpemVyLnRocmVzaG9sZEJsb2NrID0gZnVuY3Rpb24gKGx1bWluYW5jZXMsIHhvZmZzZXQgLyppbnQqLywgeW9mZnNldCAvKmludCovLCB0aHJlc2hvbGQgLyppbnQqLywgc3RyaWRlIC8qaW50Ki8sIG1hdHJpeCkgewoJICAgICAgICBmb3IgKHZhciB5ID0gMCwgb2Zmc2V0ID0geW9mZnNldCAqIHN0cmlkZSArIHhvZmZzZXQ7IHkgPCBIeWJyaWRCaW5hcml6ZXIuQkxPQ0tfU0laRTsgeSsrLCBvZmZzZXQgKz0gc3RyaWRlKSB7CgkgICAgICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFOyB4KyspIHsKCSAgICAgICAgICAgICAgICAvLyBDb21wYXJpc29uIG5lZWRzIHRvIGJlIDw9IHNvIHRoYXQgYmxhY2sgPT0gMCBwaXhlbHMgYXJlIGJsYWNrIGV2ZW4gaWYgdGhlIHRocmVzaG9sZCBpcyAwLgoJICAgICAgICAgICAgICAgIGlmICgobHVtaW5hbmNlc1tvZmZzZXQgKyB4XSAmIDB4RkYpIDw9IHRocmVzaG9sZCkgewoJICAgICAgICAgICAgICAgICAgICBtYXRyaXguc2V0KHhvZmZzZXQgKyB4LCB5b2Zmc2V0ICsgeSk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBDYWxjdWxhdGVzIGEgc2luZ2xlIGJsYWNrIHBvaW50IGZvciBlYWNoIGJsb2NrIG9mIHBpeGVscyBhbmQgc2F2ZXMgaXQgYXdheS4KCSAgICAgKiBTZWUgdGhlIGZvbGxvd2luZyB0aHJlYWQgZm9yIGEgZGlzY3Vzc2lvbiBvZiB0aGlzIGFsZ29yaXRobToKCSAgICAgKiAgaHR0cDovL2dyb3Vwcy5nb29nbGUuY29tL2dyb3VwL3p4aW5nL2Jyb3dzZV90aHJlYWQvdGhyZWFkL2QwNmVmYTJjMzVhN2RkYzAKCSAgICAgKi8KCSAgICBIeWJyaWRCaW5hcml6ZXIuY2FsY3VsYXRlQmxhY2tQb2ludHMgPSBmdW5jdGlvbiAobHVtaW5hbmNlcywgc3ViV2lkdGggLyppbnQqLywgc3ViSGVpZ2h0IC8qaW50Ki8sIHdpZHRoIC8qaW50Ki8sIGhlaWdodCAvKmludCovKSB7CgkgICAgICAgIHZhciBtYXhZT2Zmc2V0ID0gaGVpZ2h0IC0gSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkU7CgkgICAgICAgIHZhciBtYXhYT2Zmc2V0ID0gd2lkdGggLSBIeWJyaWRCaW5hcml6ZXIuQkxPQ0tfU0laRTsKCSAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOndoaXRlc3BhY2UKCSAgICAgICAgdmFyIGJsYWNrUG9pbnRzID0gbmV3IEFycmF5KHN1YkhlaWdodCk7IC8vIHN1YldpZHRoCgkgICAgICAgIGZvciAodmFyIHkgPSAwOyB5IDwgc3ViSGVpZ2h0OyB5KyspIHsKCSAgICAgICAgICAgIGJsYWNrUG9pbnRzW3ldID0gbmV3IEludDMyQXJyYXkoc3ViV2lkdGgpOwoJICAgICAgICAgICAgdmFyIHlvZmZzZXQgPSB5IDw8IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX1BPV0VSOwoJICAgICAgICAgICAgaWYgKHlvZmZzZXQgPiBtYXhZT2Zmc2V0KSB7CgkgICAgICAgICAgICAgICAgeW9mZnNldCA9IG1heFlPZmZzZXQ7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IHN1YldpZHRoOyB4KyspIHsKCSAgICAgICAgICAgICAgICB2YXIgeG9mZnNldCA9IHggPDwgSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkVfUE9XRVI7CgkgICAgICAgICAgICAgICAgaWYgKHhvZmZzZXQgPiBtYXhYT2Zmc2V0KSB7CgkgICAgICAgICAgICAgICAgICAgIHhvZmZzZXQgPSBtYXhYT2Zmc2V0OwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB2YXIgc3VtID0gMDsKCSAgICAgICAgICAgICAgICB2YXIgbWluID0gMHhGRjsKCSAgICAgICAgICAgICAgICB2YXIgbWF4ID0gMDsKCSAgICAgICAgICAgICAgICBmb3IgKHZhciB5eSA9IDAsIG9mZnNldCA9IHlvZmZzZXQgKiB3aWR0aCArIHhvZmZzZXQ7IHl5IDwgSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkU7IHl5KyssIG9mZnNldCArPSB3aWR0aCkgewoJICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciB4eCA9IDA7IHh4IDwgSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkU7IHh4KyspIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwaXhlbCA9IGx1bWluYW5jZXNbb2Zmc2V0ICsgeHhdICYgMHhGRjsKCSAgICAgICAgICAgICAgICAgICAgICAgIHN1bSArPSBwaXhlbDsKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIHN0aWxsIGxvb2tpbmcgZm9yIGdvb2QgY29udHJhc3QKCSAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwaXhlbCA8IG1pbikgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1pbiA9IHBpeGVsOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBpeGVsID4gbWF4KSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF4ID0gcGl4ZWw7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgLy8gc2hvcnQtY2lyY3VpdCBtaW4vbWF4IHRlc3RzIG9uY2UgZHluYW1pYyByYW5nZSBpcyBtZXQKCSAgICAgICAgICAgICAgICAgICAgaWYgKG1heCAtIG1pbiA+IEh5YnJpZEJpbmFyaXplci5NSU5fRFlOQU1JQ19SQU5HRSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gZmluaXNoIHRoZSByZXN0IG9mIHRoZSByb3dzIHF1aWNrbHkKCSAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoeXkrKywgb2Zmc2V0ICs9IHdpZHRoOyB5eSA8IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFOyB5eSsrLCBvZmZzZXQgKz0gd2lkdGgpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciB4eCA9IDA7IHh4IDwgSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkU7IHh4KyspIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VtICs9IGx1bWluYW5jZXNbb2Zmc2V0ICsgeHhdICYgMHhGRjsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgLy8gVGhlIGRlZmF1bHQgZXN0aW1hdGUgaXMgdGhlIGF2ZXJhZ2Ugb2YgdGhlIHZhbHVlcyBpbiB0aGUgYmxvY2suCgkgICAgICAgICAgICAgICAgdmFyIGF2ZXJhZ2UgPSBzdW0gPj4gKEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX1BPV0VSICogMik7CgkgICAgICAgICAgICAgICAgaWYgKG1heCAtIG1pbiA8PSBIeWJyaWRCaW5hcml6ZXIuTUlOX0RZTkFNSUNfUkFOR0UpIHsKCSAgICAgICAgICAgICAgICAgICAgLy8gSWYgdmFyaWF0aW9uIHdpdGhpbiB0aGUgYmxvY2sgaXMgbG93LCBhc3N1bWUgdGhpcyBpcyBhIGJsb2NrIHdpdGggb25seSBsaWdodCBvciBvbmx5CgkgICAgICAgICAgICAgICAgICAgIC8vIGRhcmsgcGl4ZWxzLiBJbiB0aGF0IGNhc2Ugd2UgZG8gbm90IHdhbnQgdG8gdXNlIHRoZSBhdmVyYWdlLCBhcyBpdCB3b3VsZCBkaXZpZGUgdGhpcwoJICAgICAgICAgICAgICAgICAgICAvLyBsb3cgY29udHJhc3QgYXJlYSBpbnRvIGJsYWNrIGFuZCB3aGl0ZSBwaXhlbHMsIGVzc2VudGlhbGx5IGNyZWF0aW5nIGRhdGEgb3V0IG9mIG5vaXNlLgoJICAgICAgICAgICAgICAgICAgICAvLwoJICAgICAgICAgICAgICAgICAgICAvLyBUaGUgZGVmYXVsdCBhc3N1bXB0aW9uIGlzIHRoYXQgdGhlIGJsb2NrIGlzIGxpZ2h0L2JhY2tncm91bmQuIFNpbmNlIG5vIGVzdGltYXRlIGZvcgoJICAgICAgICAgICAgICAgICAgICAvLyB0aGUgbGV2ZWwgb2YgZGFyayBwaXhlbHMgZXhpc3RzIGxvY2FsbHksIHVzZSBoYWxmIHRoZSBtaW4gZm9yIHRoZSBibG9jay4KCSAgICAgICAgICAgICAgICAgICAgYXZlcmFnZSA9IG1pbiAvIDI7CgkgICAgICAgICAgICAgICAgICAgIGlmICh5ID4gMCAmJiB4ID4gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ29ycmVjdCB0aGUgIndoaXRlIGJhY2tncm91bmQiIGFzc3VtcHRpb24gZm9yIGJsb2NrcyB0aGF0IGhhdmUgbmVpZ2hib3JzIGJ5IGNvbXBhcmluZwoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhlIHBpeGVscyBpbiB0aGlzIGJsb2NrIHRvIHRoZSBwcmV2aW91c2x5IGNhbGN1bGF0ZWQgYmxhY2sgcG9pbnRzLiBUaGlzIGlzIGJhc2VkIG9uCgkgICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGUgZmFjdCB0aGF0IGRhcmsgYmFyY29kZSBzeW1ib2xvZ3kgaXMgYWx3YXlzIHN1cnJvdW5kZWQgYnkgc29tZSBhbW91bnQgb2YgbGlnaHQKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIGJhY2tncm91bmQgZm9yIHdoaWNoIHJlYXNvbmFibGUgYmxhY2sgcG9pbnQgZXN0aW1hdGVzIHdlcmUgbWFkZS4gVGhlIGJwIGVzdGltYXRlZCBhdAoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhlIGJvdW5kYXJpZXMgaXMgdXNlZCBmb3IgdGhlIGludGVyaW9yLgoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhlIChtaW4gPCBicCkgaXMgYXJiaXRyYXJ5IGJ1dCB3b3JrcyBiZXR0ZXIgdGhhbiBvdGhlciBoZXVyaXN0aWNzIHRoYXQgd2VyZSB0cmllZC4KCSAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhdmVyYWdlTmVpZ2hib3JCbGFja1BvaW50ID0gKGJsYWNrUG9pbnRzW3kgLSAxXVt4XSArICgyICogYmxhY2tQb2ludHNbeV1beCAtIDFdKSArIGJsYWNrUG9pbnRzW3kgLSAxXVt4IC0gMV0pIC8gNDsKCSAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtaW4gPCBhdmVyYWdlTmVpZ2hib3JCbGFja1BvaW50KSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXZlcmFnZSA9IGF2ZXJhZ2VOZWlnaGJvckJsYWNrUG9pbnQ7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgYmxhY2tQb2ludHNbeV1beF0gPSBhdmVyYWdlOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBibGFja1BvaW50czsKCSAgICB9OwoJICAgIC8vIFRoaXMgY2xhc3MgdXNlcyA1eDUgYmxvY2tzIHRvIGNvbXB1dGUgbG9jYWwgbHVtaW5hbmNlLCB3aGVyZSBlYWNoIGJsb2NrIGlzIDh4OCBwaXhlbHMuCgkgICAgLy8gU28gdGhpcyBpcyB0aGUgc21hbGxlc3QgZGltZW5zaW9uIGluIGVhY2ggYXhpcyB3ZSBjYW4gYWNjZXB0LgoJICAgIEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX1BPV0VSID0gMzsKCSAgICBIeWJyaWRCaW5hcml6ZXIuQkxPQ0tfU0laRSA9IDEgPDwgSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkVfUE9XRVI7IC8vIC4uLjAxMDAuLi4wMAoJICAgIEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX01BU0sgPSBIeWJyaWRCaW5hcml6ZXIuQkxPQ0tfU0laRSAtIDE7IC8vIC4uLjAwMTEuLi4xMQoJICAgIEh5YnJpZEJpbmFyaXplci5NSU5JTVVNX0RJTUVOU0lPTiA9IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFICogNTsKCSAgICBIeWJyaWRCaW5hcml6ZXIuTUlOX0RZTkFNSUNfUkFOR0UgPSAyNDsKCSAgICByZXR1cm4gSHlicmlkQmluYXJpemVyOwoJfShHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXJfMS5kZWZhdWx0KSk7Cgl2YXIgX2RlZmF1bHQkMiA9IEh5YnJpZEJpbmFyaXplciQxLmRlZmF1bHQgPSBIeWJyaWRCaW5hcml6ZXI7CgoJdmFyIFJHQkx1bWluYW5jZVNvdXJjZSQxID0ge307CgoJdmFyIEludmVydGVkTHVtaW5hbmNlU291cmNlJDEgPSB7fTsKCgl2YXIgTHVtaW5hbmNlU291cmNlJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDkgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEx1bWluYW5jZVNvdXJjZSQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgU3RyaW5nQnVpbGRlcl8xJDEgPSBTdHJpbmdCdWlsZGVyJDE7Cgl2YXIgVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb25fMSA9IFVuc3VwcG9ydGVkT3BlcmF0aW9uRXhjZXB0aW9uJDE7CgkvKm5hbWVzcGFjZSBjb20uZ29vZ2xlLnp4aW5nIHsqLwoJLyoqCgkgKiBUaGUgcHVycG9zZSBvZiB0aGlzIGNsYXNzIGhpZXJhcmNoeSBpcyB0byBhYnN0cmFjdCBkaWZmZXJlbnQgYml0bWFwIGltcGxlbWVudGF0aW9ucyBhY3Jvc3MKCSAqIHBsYXRmb3JtcyBpbnRvIGEgc3RhbmRhcmQgaW50ZXJmYWNlIGZvciByZXF1ZXN0aW5nIGdyZXlzY2FsZSBsdW1pbmFuY2UgdmFsdWVzLiBUaGUgaW50ZXJmYWNlCgkgKiBvbmx5IHByb3ZpZGVzIGltbXV0YWJsZSBtZXRob2RzOyB0aGVyZWZvcmUgY3JvcCBhbmQgcm90YXRpb24gY3JlYXRlIGNvcGllcy4gVGhpcyBpcyB0byBlbnN1cmUKCSAqIHRoYXQgb25lIFJlYWRlciBkb2VzIG5vdCBtb2RpZnkgdGhlIG9yaWdpbmFsIGx1bWluYW5jZSBzb3VyY2UgYW5kIGxlYXZlIGl0IGluIGFuIHVua25vd24gc3RhdGUKCSAqIGZvciBvdGhlciBSZWFkZXJzIGluIHRoZSBjaGFpbi4KCSAqCgkgKiBAYXV0aG9yIGRzd2l0a2luQGdvb2dsZS5jb20gKERhbmllbCBTd2l0a2luKQoJICovCgl2YXIgTHVtaW5hbmNlU291cmNlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIEx1bWluYW5jZVNvdXJjZSh3aWR0aCAvKmludCovLCBoZWlnaHQgLyppbnQqLykgewoJICAgICAgICB0aGlzLndpZHRoID0gd2lkdGg7CgkgICAgICAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0OwoJICAgIH0KCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIFRoZSB3aWR0aCBvZiB0aGUgYml0bWFwLgoJICAgICAqLwoJICAgIEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuZ2V0V2lkdGggPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLndpZHRoOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBUaGUgaGVpZ2h0IG9mIHRoZSBiaXRtYXAuCgkgICAgICovCgkgICAgTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5nZXRIZWlnaHQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmhlaWdodDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gV2hldGhlciB0aGlzIHN1YmNsYXNzIHN1cHBvcnRzIGNyb3BwaW5nLgoJICAgICAqLwoJICAgIEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuaXNDcm9wU3VwcG9ydGVkID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBSZXR1cm5zIGEgbmV3IG9iamVjdCB3aXRoIGNyb3BwZWQgaW1hZ2UgZGF0YS4gSW1wbGVtZW50YXRpb25zIG1heSBrZWVwIGEgcmVmZXJlbmNlIHRvIHRoZQoJICAgICAqIG9yaWdpbmFsIGRhdGEgcmF0aGVyIHRoYW4gYSBjb3B5LiBPbmx5IGNhbGxhYmxlIGlmIGlzQ3JvcFN1cHBvcnRlZCgpIGlzIHRydWUuCgkgICAgICoKCSAgICAgKiBAcGFyYW0gbGVmdCBUaGUgbGVmdCBjb29yZGluYXRlLCB3aGljaCBtdXN0IGJlIGluIFswLGdldFdpZHRoKCkpCgkgICAgICogQHBhcmFtIHRvcCBUaGUgdG9wIGNvb3JkaW5hdGUsIHdoaWNoIG11c3QgYmUgaW4gWzAsZ2V0SGVpZ2h0KCkpCgkgICAgICogQHBhcmFtIHdpZHRoIFRoZSB3aWR0aCBvZiB0aGUgcmVjdGFuZ2xlIHRvIGNyb3AuCgkgICAgICogQHBhcmFtIGhlaWdodCBUaGUgaGVpZ2h0IG9mIHRoZSByZWN0YW5nbGUgdG8gY3JvcC4KCSAgICAgKiBAcmV0dXJuIEEgY3JvcHBlZCB2ZXJzaW9uIG9mIHRoaXMgb2JqZWN0LgoJICAgICAqLwoJICAgIEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuY3JvcCA9IGZ1bmN0aW9uIChsZWZ0IC8qaW50Ki8sIHRvcCAvKmludCovLCB3aWR0aCAvKmludCovLCBoZWlnaHQgLyppbnQqLykgewoJICAgICAgICB0aHJvdyBuZXcgVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb25fMS5kZWZhdWx0KCdUaGlzIGx1bWluYW5jZSBzb3VyY2UgZG9lcyBub3Qgc3VwcG9ydCBjcm9wcGluZy4nKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gV2hldGhlciB0aGlzIHN1YmNsYXNzIHN1cHBvcnRzIGNvdW50ZXItY2xvY2t3aXNlIHJvdGF0aW9uLgoJICAgICAqLwoJICAgIEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuaXNSb3RhdGVTdXBwb3J0ZWQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiBmYWxzZTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgYSBuZXcgb2JqZWN0IHdpdGggcm90YXRlZCBpbWFnZSBkYXRhIGJ5IDkwIGRlZ3JlZXMgY291bnRlcmNsb2Nrd2lzZS4KCSAgICAgKiBPbmx5IGNhbGxhYmxlIGlmIHtAbGluayAjaXNSb3RhdGVTdXBwb3J0ZWQoKX0gaXMgdHJ1ZS4KCSAgICAgKgoJICAgICAqIEByZXR1cm4gQSByb3RhdGVkIHZlcnNpb24gb2YgdGhpcyBvYmplY3QuCgkgICAgICovCgkgICAgTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5yb3RhdGVDb3VudGVyQ2xvY2t3aXNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB0aHJvdyBuZXcgVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb25fMS5kZWZhdWx0KCdUaGlzIGx1bWluYW5jZSBzb3VyY2UgZG9lcyBub3Qgc3VwcG9ydCByb3RhdGlvbiBieSA5MCBkZWdyZWVzLicpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogUmV0dXJucyBhIG5ldyBvYmplY3Qgd2l0aCByb3RhdGVkIGltYWdlIGRhdGEgYnkgNDUgZGVncmVlcyBjb3VudGVyY2xvY2t3aXNlLgoJICAgICAqIE9ubHkgY2FsbGFibGUgaWYge0BsaW5rICNpc1JvdGF0ZVN1cHBvcnRlZCgpfSBpcyB0cnVlLgoJICAgICAqCgkgICAgICogQHJldHVybiBBIHJvdGF0ZWQgdmVyc2lvbiBvZiB0aGlzIG9iamVjdC4KCSAgICAgKi8KCSAgICBMdW1pbmFuY2VTb3VyY2UucHJvdG90eXBlLnJvdGF0ZUNvdW50ZXJDbG9ja3dpc2U0NSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdGhyb3cgbmV3IFVuc3VwcG9ydGVkT3BlcmF0aW9uRXhjZXB0aW9uXzEuZGVmYXVsdCgnVGhpcyBsdW1pbmFuY2Ugc291cmNlIGRvZXMgbm90IHN1cHBvcnQgcm90YXRpb24gYnkgNDUgZGVncmVlcy4nKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBMdW1pbmFuY2VTb3VyY2UucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgcm93ID0gbmV3IFVpbnQ4Q2xhbXBlZEFycmF5KHRoaXMud2lkdGgpOwoJICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IFN0cmluZ0J1aWxkZXJfMSQxLmRlZmF1bHQoKTsKCSAgICAgICAgZm9yICh2YXIgeSA9IDA7IHkgPCB0aGlzLmhlaWdodDsgeSsrKSB7CgkgICAgICAgICAgICB2YXIgc291cmNlUm93ID0gdGhpcy5nZXRSb3coeSwgcm93KTsKCSAgICAgICAgICAgIGZvciAodmFyIHggPSAwOyB4IDwgdGhpcy53aWR0aDsgeCsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIGx1bWluYW5jZSA9IHNvdXJjZVJvd1t4XSAmIDB4RkY7CgkgICAgICAgICAgICAgICAgdmFyIGMgPSB2b2lkIDA7CgkgICAgICAgICAgICAgICAgaWYgKGx1bWluYW5jZSA8IDB4NDApIHsKCSAgICAgICAgICAgICAgICAgICAgYyA9ICcjJzsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSBpZiAobHVtaW5hbmNlIDwgMHg4MCkgewoJICAgICAgICAgICAgICAgICAgICBjID0gJysnOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBlbHNlIGlmIChsdW1pbmFuY2UgPCAweEMwKSB7CgkgICAgICAgICAgICAgICAgICAgIGMgPSAnLic7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgICAgICAgICBjID0gJyAnOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICByZXN1bHQuYXBwZW5kKGMpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmVzdWx0LmFwcGVuZCgnXG4nKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gcmVzdWx0LnRvU3RyaW5nKCk7CgkgICAgfTsKCSAgICByZXR1cm4gTHVtaW5hbmNlU291cmNlOwoJfSgpKTsKCUx1bWluYW5jZVNvdXJjZSQxLmRlZmF1bHQgPSBMdW1pbmFuY2VTb3VyY2U7CgoJLyoKCSAqIENvcHlyaWdodCAyMDA5IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCXZhciBfX2V4dGVuZHMkYSA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShJbnZlcnRlZEx1bWluYW5jZVNvdXJjZSQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgTHVtaW5hbmNlU291cmNlXzEkMSA9IEx1bWluYW5jZVNvdXJjZSQxOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZyB7Ki8KCS8qKgoJICogQSB3cmFwcGVyIGltcGxlbWVudGF0aW9uIG9mIHtAbGluayBMdW1pbmFuY2VTb3VyY2V9IHdoaWNoIGludmVydHMgdGhlIGx1bWluYW5jZXMgaXQgcmV0dXJucyAtLSBibGFjayBiZWNvbWVzCgkgKiB3aGl0ZSBhbmQgdmljZSB2ZXJzYSwgYW5kIGVhY2ggdmFsdWUgYmVjb21lcyAoMjU1LXZhbHVlKS4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgSW52ZXJ0ZWRMdW1pbmFuY2VTb3VyY2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJGEoSW52ZXJ0ZWRMdW1pbmFuY2VTb3VyY2UsIF9zdXBlcik7CgkgICAgZnVuY3Rpb24gSW52ZXJ0ZWRMdW1pbmFuY2VTb3VyY2UoZGVsZWdhdGUpIHsKCSAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgZGVsZWdhdGUuZ2V0V2lkdGgoKSwgZGVsZWdhdGUuZ2V0SGVpZ2h0KCkpIHx8IHRoaXM7CgkgICAgICAgIF90aGlzLmRlbGVnYXRlID0gZGVsZWdhdGU7CgkgICAgICAgIHJldHVybiBfdGhpczsKCSAgICB9CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEludmVydGVkTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5nZXRSb3cgPSBmdW5jdGlvbiAoeSAvKmludCovLCByb3cpIHsKCSAgICAgICAgdmFyIHNvdXJjZVJvdyA9IHRoaXMuZGVsZWdhdGUuZ2V0Um93KHksIHJvdyk7CgkgICAgICAgIHZhciB3aWR0aCA9IHRoaXMuZ2V0V2lkdGgoKTsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB3aWR0aDsgaSsrKSB7CgkgICAgICAgICAgICBzb3VyY2VSb3dbaV0gPSAvKihieXRlKSovICgyNTUgLSAoc291cmNlUm93W2ldICYgMHhGRikpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBzb3VyY2VSb3c7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgSW52ZXJ0ZWRMdW1pbmFuY2VTb3VyY2UucHJvdG90eXBlLmdldE1hdHJpeCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIG1hdHJpeCA9IHRoaXMuZGVsZWdhdGUuZ2V0TWF0cml4KCk7CgkgICAgICAgIHZhciBsZW5ndGggPSB0aGlzLmdldFdpZHRoKCkgKiB0aGlzLmdldEhlaWdodCgpOwoJICAgICAgICB2YXIgaW52ZXJ0ZWRNYXRyaXggPSBuZXcgVWludDhDbGFtcGVkQXJyYXkobGVuZ3RoKTsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgewoJICAgICAgICAgICAgaW52ZXJ0ZWRNYXRyaXhbaV0gPSAvKihieXRlKSovICgyNTUgLSAobWF0cml4W2ldICYgMHhGRikpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBpbnZlcnRlZE1hdHJpeDsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBJbnZlcnRlZEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuaXNDcm9wU3VwcG9ydGVkID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5kZWxlZ2F0ZS5pc0Nyb3BTdXBwb3J0ZWQoKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBJbnZlcnRlZEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuY3JvcCA9IGZ1bmN0aW9uIChsZWZ0IC8qaW50Ki8sIHRvcCAvKmludCovLCB3aWR0aCAvKmludCovLCBoZWlnaHQgLyppbnQqLykgewoJICAgICAgICByZXR1cm4gbmV3IEludmVydGVkTHVtaW5hbmNlU291cmNlKHRoaXMuZGVsZWdhdGUuY3JvcChsZWZ0LCB0b3AsIHdpZHRoLCBoZWlnaHQpKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBJbnZlcnRlZEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuaXNSb3RhdGVTdXBwb3J0ZWQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmRlbGVnYXRlLmlzUm90YXRlU3VwcG9ydGVkKCk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIG9yaWdpbmFsIGRlbGVnYXRlIHtAbGluayBMdW1pbmFuY2VTb3VyY2V9IHNpbmNlIGludmVydCB1bmRvZXMgaXRzZWxmCgkgICAgICovCgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEludmVydGVkTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5pbnZlcnQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmRlbGVnYXRlOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEludmVydGVkTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5yb3RhdGVDb3VudGVyQ2xvY2t3aXNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gbmV3IEludmVydGVkTHVtaW5hbmNlU291cmNlKHRoaXMuZGVsZWdhdGUucm90YXRlQ291bnRlckNsb2Nrd2lzZSgpKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBJbnZlcnRlZEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUucm90YXRlQ291bnRlckNsb2Nrd2lzZTQ1ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gbmV3IEludmVydGVkTHVtaW5hbmNlU291cmNlKHRoaXMuZGVsZWdhdGUucm90YXRlQ291bnRlckNsb2Nrd2lzZTQ1KCkpOwoJICAgIH07CgkgICAgcmV0dXJuIEludmVydGVkTHVtaW5hbmNlU291cmNlOwoJfShMdW1pbmFuY2VTb3VyY2VfMSQxLmRlZmF1bHQpKTsKCUludmVydGVkTHVtaW5hbmNlU291cmNlJDEuZGVmYXVsdCA9IEludmVydGVkTHVtaW5hbmNlU291cmNlOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwOSBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCgl2YXIgX19leHRlbmRzJDkgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoUkdCTHVtaW5hbmNlU291cmNlJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcgeyovCgkgLy8gcmVxdWlyZWQgYmVjYXVzZSBvZiBjaXJjdWxhciBkZXBlbmRlbmNpZXMgYmV0d2VlbiBMdW1pbmFuY2VTb3VyY2UgYW5kIEludmVydGVkTHVtaW5hbmNlU291cmNlCgl2YXIgSW52ZXJ0ZWRMdW1pbmFuY2VTb3VyY2VfMSA9IEludmVydGVkTHVtaW5hbmNlU291cmNlJDE7Cgl2YXIgTHVtaW5hbmNlU291cmNlXzEgPSBMdW1pbmFuY2VTb3VyY2UkMTsKCXZhciBTeXN0ZW1fMSQyID0gU3lzdGVtJDE7Cgl2YXIgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNiA9IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBUaGlzIGNsYXNzIGlzIHVzZWQgdG8gaGVscCBkZWNvZGUgaW1hZ2VzIGZyb20gZmlsZXMgd2hpY2ggYXJyaXZlIGFzIFJHQiBkYXRhIGZyb20KCSAqIGFuIEFSR0IgcGl4ZWwgYXJyYXkuIEl0IGRvZXMgbm90IHN1cHBvcnQgcm90YXRpb24uCgkgKgoJICogQGF1dGhvciBkc3dpdGtpbkBnb29nbGUuY29tIChEYW5pZWwgU3dpdGtpbikKCSAqIEBhdXRob3IgQmV0YW1pbm9zCgkgKi8KCXZhciBSR0JMdW1pbmFuY2VTb3VyY2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJDkoUkdCTHVtaW5hbmNlU291cmNlLCBfc3VwZXIpOwoJICAgIGZ1bmN0aW9uIFJHQkx1bWluYW5jZVNvdXJjZShsdW1pbmFuY2VzLCB3aWR0aCAvKmludCovLCBoZWlnaHQgLyppbnQqLywgZGF0YVdpZHRoIC8qaW50Ki8sIGRhdGFIZWlnaHQgLyppbnQqLywgbGVmdCAvKmludCovLCB0b3AgLyppbnQqLykgewoJICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCB3aWR0aCwgaGVpZ2h0KSB8fCB0aGlzOwoJICAgICAgICBfdGhpcy5kYXRhV2lkdGggPSBkYXRhV2lkdGg7CgkgICAgICAgIF90aGlzLmRhdGFIZWlnaHQgPSBkYXRhSGVpZ2h0OwoJICAgICAgICBfdGhpcy5sZWZ0ID0gbGVmdDsKCSAgICAgICAgX3RoaXMudG9wID0gdG9wOwoJICAgICAgICBpZiAobHVtaW5hbmNlcy5CWVRFU19QRVJfRUxFTUVOVCA9PT0gNCkgeyAvLyBJbnQzMkFycmF5CgkgICAgICAgICAgICB2YXIgc2l6ZSA9IHdpZHRoICogaGVpZ2h0OwoJICAgICAgICAgICAgdmFyIGx1bWluYW5jZXNVaW50OEFycmF5ID0gbmV3IFVpbnQ4Q2xhbXBlZEFycmF5KHNpemUpOwoJICAgICAgICAgICAgZm9yICh2YXIgb2Zmc2V0ID0gMDsgb2Zmc2V0IDwgc2l6ZTsgb2Zmc2V0KyspIHsKCSAgICAgICAgICAgICAgICB2YXIgcGl4ZWwgPSBsdW1pbmFuY2VzW29mZnNldF07CgkgICAgICAgICAgICAgICAgdmFyIHIgPSAocGl4ZWwgPj4gMTYpICYgMHhmZjsgLy8gcmVkCgkgICAgICAgICAgICAgICAgdmFyIGcyID0gKHBpeGVsID4+IDcpICYgMHgxZmU7IC8vIDIgKiBncmVlbgoJICAgICAgICAgICAgICAgIHZhciBiID0gcGl4ZWwgJiAweGZmOyAvLyBibHVlCgkgICAgICAgICAgICAgICAgLy8gQ2FsY3VsYXRlIGdyZWVuLWZhdm91cmluZyBhdmVyYWdlIGNoZWFwbHkKCSAgICAgICAgICAgICAgICBsdW1pbmFuY2VzVWludDhBcnJheVtvZmZzZXRdID0gLyooYnl0ZSkgKi8gKChyICsgZzIgKyBiKSAvIDQpICYgMHhGRjsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIF90aGlzLmx1bWluYW5jZXMgPSBsdW1pbmFuY2VzVWludDhBcnJheTsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgIF90aGlzLmx1bWluYW5jZXMgPSBsdW1pbmFuY2VzOwoJICAgICAgICB9CgkgICAgICAgIGlmICh1bmRlZmluZWQgPT09IGRhdGFXaWR0aCkgewoJICAgICAgICAgICAgX3RoaXMuZGF0YVdpZHRoID0gd2lkdGg7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gZGF0YUhlaWdodCkgewoJICAgICAgICAgICAgX3RoaXMuZGF0YUhlaWdodCA9IGhlaWdodDsKCSAgICAgICAgfQoJICAgICAgICBpZiAodW5kZWZpbmVkID09PSBsZWZ0KSB7CgkgICAgICAgICAgICBfdGhpcy5sZWZ0ID0gMDsKCSAgICAgICAgfQoJICAgICAgICBpZiAodW5kZWZpbmVkID09PSB0b3ApIHsKCSAgICAgICAgICAgIF90aGlzLnRvcCA9IDA7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKF90aGlzLmxlZnQgKyB3aWR0aCA+IF90aGlzLmRhdGFXaWR0aCB8fCBfdGhpcy50b3AgKyBoZWlnaHQgPiBfdGhpcy5kYXRhSGVpZ2h0KSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNi5kZWZhdWx0KCdDcm9wIHJlY3RhbmdsZSBkb2VzIG5vdCBmaXQgd2l0aGluIGltYWdlIGRhdGEuJyk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIF90aGlzOwoJICAgIH0KCSAgICAvKkBPdmVycmlkZSovCgkgICAgUkdCTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5nZXRSb3cgPSBmdW5jdGlvbiAoeSAvKmludCovLCByb3cpIHsKCSAgICAgICAgaWYgKHkgPCAwIHx8IHkgPj0gdGhpcy5nZXRIZWlnaHQoKSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDYuZGVmYXVsdCgnUmVxdWVzdGVkIHJvdyBpcyBvdXRzaWRlIHRoZSBpbWFnZTogJyArIHkpOwoJICAgICAgICB9CgkgICAgICAgIHZhciB3aWR0aCA9IHRoaXMuZ2V0V2lkdGgoKTsKCSAgICAgICAgaWYgKHJvdyA9PT0gbnVsbCB8fCByb3cgPT09IHVuZGVmaW5lZCB8fCByb3cubGVuZ3RoIDwgd2lkdGgpIHsKCSAgICAgICAgICAgIHJvdyA9IG5ldyBVaW50OENsYW1wZWRBcnJheSh3aWR0aCk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIG9mZnNldCA9ICh5ICsgdGhpcy50b3ApICogdGhpcy5kYXRhV2lkdGggKyB0aGlzLmxlZnQ7CgkgICAgICAgIFN5c3RlbV8xJDIuZGVmYXVsdC5hcnJheWNvcHkodGhpcy5sdW1pbmFuY2VzLCBvZmZzZXQsIHJvdywgMCwgd2lkdGgpOwoJICAgICAgICByZXR1cm4gcm93OwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIFJHQkx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuZ2V0TWF0cml4ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgd2lkdGggPSB0aGlzLmdldFdpZHRoKCk7CgkgICAgICAgIHZhciBoZWlnaHQgPSB0aGlzLmdldEhlaWdodCgpOwoJICAgICAgICAvLyBJZiB0aGUgY2FsbGVyIGFza3MgZm9yIHRoZSBlbnRpcmUgdW5kZXJseWluZyBpbWFnZSwgc2F2ZSB0aGUgY29weSBhbmQgZ2l2ZSB0aGVtIHRoZQoJICAgICAgICAvLyBvcmlnaW5hbCBkYXRhLiBUaGUgZG9jcyBzcGVjaWZpY2FsbHkgd2FybiB0aGF0IHJlc3VsdC5sZW5ndGggbXVzdCBiZSBpZ25vcmVkLgoJICAgICAgICBpZiAod2lkdGggPT09IHRoaXMuZGF0YVdpZHRoICYmIGhlaWdodCA9PT0gdGhpcy5kYXRhSGVpZ2h0KSB7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy5sdW1pbmFuY2VzOwoJICAgICAgICB9CgkgICAgICAgIHZhciBhcmVhID0gd2lkdGggKiBoZWlnaHQ7CgkgICAgICAgIHZhciBtYXRyaXggPSBuZXcgVWludDhDbGFtcGVkQXJyYXkoYXJlYSk7CgkgICAgICAgIHZhciBpbnB1dE9mZnNldCA9IHRoaXMudG9wICogdGhpcy5kYXRhV2lkdGggKyB0aGlzLmxlZnQ7CgkgICAgICAgIC8vIElmIHRoZSB3aWR0aCBtYXRjaGVzIHRoZSBmdWxsIHdpZHRoIG9mIHRoZSB1bmRlcmx5aW5nIGRhdGEsIHBlcmZvcm0gYSBzaW5nbGUgY29weS4KCSAgICAgICAgaWYgKHdpZHRoID09PSB0aGlzLmRhdGFXaWR0aCkgewoJICAgICAgICAgICAgU3lzdGVtXzEkMi5kZWZhdWx0LmFycmF5Y29weSh0aGlzLmx1bWluYW5jZXMsIGlucHV0T2Zmc2V0LCBtYXRyaXgsIDAsIGFyZWEpOwoJICAgICAgICAgICAgcmV0dXJuIG1hdHJpeDsKCSAgICAgICAgfQoJICAgICAgICAvLyBPdGhlcndpc2UgY29weSBvbmUgY3JvcHBlZCByb3cgYXQgYSB0aW1lLgoJICAgICAgICBmb3IgKHZhciB5ID0gMDsgeSA8IGhlaWdodDsgeSsrKSB7CgkgICAgICAgICAgICB2YXIgb3V0cHV0T2Zmc2V0ID0geSAqIHdpZHRoOwoJICAgICAgICAgICAgU3lzdGVtXzEkMi5kZWZhdWx0LmFycmF5Y29weSh0aGlzLmx1bWluYW5jZXMsIGlucHV0T2Zmc2V0LCBtYXRyaXgsIG91dHB1dE9mZnNldCwgd2lkdGgpOwoJICAgICAgICAgICAgaW5wdXRPZmZzZXQgKz0gdGhpcy5kYXRhV2lkdGg7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIG1hdHJpeDsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBSR0JMdW1pbmFuY2VTb3VyY2UucHJvdG90eXBlLmlzQ3JvcFN1cHBvcnRlZCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRydWU7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgUkdCTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5jcm9wID0gZnVuY3Rpb24gKGxlZnQgLyppbnQqLywgdG9wIC8qaW50Ki8sIHdpZHRoIC8qaW50Ki8sIGhlaWdodCAvKmludCovKSB7CgkgICAgICAgIHJldHVybiBuZXcgUkdCTHVtaW5hbmNlU291cmNlKHRoaXMubHVtaW5hbmNlcywgd2lkdGgsIGhlaWdodCwgdGhpcy5kYXRhV2lkdGgsIHRoaXMuZGF0YUhlaWdodCwgdGhpcy5sZWZ0ICsgbGVmdCwgdGhpcy50b3AgKyB0b3ApOwoJICAgIH07CgkgICAgUkdCTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5pbnZlcnQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiBuZXcgSW52ZXJ0ZWRMdW1pbmFuY2VTb3VyY2VfMS5kZWZhdWx0KHRoaXMpOwoJICAgIH07CgkgICAgcmV0dXJuIFJHQkx1bWluYW5jZVNvdXJjZTsKCX0oTHVtaW5hbmNlU291cmNlXzEuZGVmYXVsdCkpOwoJdmFyIF9kZWZhdWx0JDEgPSBSR0JMdW1pbmFuY2VTb3VyY2UkMS5kZWZhdWx0ID0gUkdCTHVtaW5hbmNlU291cmNlOwoKCXZhciBRUkNvZGVSZWFkZXIkMSA9IHt9OwoKCXZhciBCYXJjb2RlRm9ybWF0JDEgPSB7fTsKCgkvKgoJICogRGlyZWN0IHBvcnQgdG8gVHlwZVNjcmlwdCBvZiBaWGluZyBieSBBZHJpYW4gVG/ImWPEgwoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoQmFyY29kZUZvcm1hdCQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKgoJICogQ29weXJpZ2h0IDIwMDkgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZyB7Ki8KCS8qKgoJICogRW51bWVyYXRlcyBiYXJjb2RlIGZvcm1hdHMga25vd24gdG8gdGhpcyBwYWNrYWdlLiBQbGVhc2Uga2VlcCBhbHBoYWJldGl6ZWQuCgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEJhcmNvZGVGb3JtYXQ7CgkoZnVuY3Rpb24gKEJhcmNvZGVGb3JtYXQpIHsKCSAgICAvKiogQXp0ZWMgMkQgYmFyY29kZSBmb3JtYXQuICovCgkgICAgQmFyY29kZUZvcm1hdFtCYXJjb2RlRm9ybWF0WyJBWlRFQyJdID0gMF0gPSAiQVpURUMiOwoJICAgIC8qKiBDT0RBQkFSIDFEIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIkNPREFCQVIiXSA9IDFdID0gIkNPREFCQVIiOwoJICAgIC8qKiBDb2RlIDM5IDFEIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIkNPREVfMzkiXSA9IDJdID0gIkNPREVfMzkiOwoJICAgIC8qKiBDb2RlIDkzIDFEIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIkNPREVfOTMiXSA9IDNdID0gIkNPREVfOTMiOwoJICAgIC8qKiBDb2RlIDEyOCAxRCBmb3JtYXQuICovCgkgICAgQmFyY29kZUZvcm1hdFtCYXJjb2RlRm9ybWF0WyJDT0RFXzEyOCJdID0gNF0gPSAiQ09ERV8xMjgiOwoJICAgIC8qKiBEYXRhIE1hdHJpeCAyRCBiYXJjb2RlIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIkRBVEFfTUFUUklYIl0gPSA1XSA9ICJEQVRBX01BVFJJWCI7CgkgICAgLyoqIEVBTi04IDFEIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIkVBTl84Il0gPSA2XSA9ICJFQU5fOCI7CgkgICAgLyoqIEVBTi0xMyAxRCBmb3JtYXQuICovCgkgICAgQmFyY29kZUZvcm1hdFtCYXJjb2RlRm9ybWF0WyJFQU5fMTMiXSA9IDddID0gIkVBTl8xMyI7CgkgICAgLyoqIElURiAoSW50ZXJsZWF2ZWQgVHdvIG9mIEZpdmUpIDFEIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIklURiJdID0gOF0gPSAiSVRGIjsKCSAgICAvKiogTWF4aUNvZGUgMkQgYmFyY29kZSBmb3JtYXQuICovCgkgICAgQmFyY29kZUZvcm1hdFtCYXJjb2RlRm9ybWF0WyJNQVhJQ09ERSJdID0gOV0gPSAiTUFYSUNPREUiOwoJICAgIC8qKiBQREY0MTcgZm9ybWF0LiAqLwoJICAgIEJhcmNvZGVGb3JtYXRbQmFyY29kZUZvcm1hdFsiUERGXzQxNyJdID0gMTBdID0gIlBERl80MTciOwoJICAgIC8qKiBRUiBDb2RlIDJEIGJhcmNvZGUgZm9ybWF0LiAqLwoJICAgIEJhcmNvZGVGb3JtYXRbQmFyY29kZUZvcm1hdFsiUVJfQ09ERSJdID0gMTFdID0gIlFSX0NPREUiOwoJICAgIC8qKiBSU1MgMTQgKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIlJTU18xNCJdID0gMTJdID0gIlJTU18xNCI7CgkgICAgLyoqIFJTUyBFWFBBTkRFRCAqLwoJICAgIEJhcmNvZGVGb3JtYXRbQmFyY29kZUZvcm1hdFsiUlNTX0VYUEFOREVEIl0gPSAxM10gPSAiUlNTX0VYUEFOREVEIjsKCSAgICAvKiogVVBDLUEgMUQgZm9ybWF0LiAqLwoJICAgIEJhcmNvZGVGb3JtYXRbQmFyY29kZUZvcm1hdFsiVVBDX0EiXSA9IDE0XSA9ICJVUENfQSI7CgkgICAgLyoqIFVQQy1FIDFEIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIlVQQ19FIl0gPSAxNV0gPSAiVVBDX0UiOwoJICAgIC8qKiBVUEMvRUFOIGV4dGVuc2lvbiBmb3JtYXQuIE5vdCBhIHN0YW5kLWFsb25lIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIlVQQ19FQU5fRVhURU5TSU9OIl0gPSAxNl0gPSAiVVBDX0VBTl9FWFRFTlNJT04iOwoJfSkoQmFyY29kZUZvcm1hdCB8fCAoQmFyY29kZUZvcm1hdCA9IHt9KSk7CglCYXJjb2RlRm9ybWF0JDEuZGVmYXVsdCA9IEJhcmNvZGVGb3JtYXQ7CgoJdmFyIFJlc3VsdCQxID0ge307CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShSZXN1bHQkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIFN5c3RlbV8xJDEgPSBTeXN0ZW0kMTsKCS8qKgoJICogPHA+RW5jYXBzdWxhdGVzIHRoZSByZXN1bHQgb2YgZGVjb2RpbmcgYSBiYXJjb2RlIHdpdGhpbiBhbiBpbWFnZS48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIFJlc3VsdCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICAvLyBwdWJsaWMgY29uc3RydWN0b3IocHJpdmF0ZSB0ZXh0OiBzdHJpbmcsCgkgICAgLy8gICAgICAgICAgICAgICBVaW50OEFycmF5IHJhd0J5dGVzLAoJICAgIC8vICAgICAgICAgICAgICAgUmVzdWx0UG9jb25zdCByZXN1bHRQb2ludHM6IEludDMyQXJyYXksCgkgICAgLy8gICAgICAgICAgICAgICBCYXJjb2RlRm9ybWF0IGZvcm1hdCkgewoJICAgIC8vICAgdGhpcyh0ZXh0LCByYXdCeXRlcywgcmVzdWx0UG9pbnRzLCBmb3JtYXQsIFN5c3RlbS5jdXJyZW50VGltZU1pbGxpcygpKQoJICAgIC8vIH0KCSAgICAvLyBwdWJsaWMgY29uc3RydWN0b3IodGV4dDogc3RyaW5nLAoJICAgIC8vICAgICAgICAgICAgICAgVWludDhBcnJheSByYXdCeXRlcywKCSAgICAvLyAgICAgICAgICAgICAgIFJlc3VsdFBvY29uc3QgcmVzdWx0UG9pbnRzOiBJbnQzMkFycmF5LAoJICAgIC8vICAgICAgICAgICAgICAgQmFyY29kZUZvcm1hdCBmb3JtYXQsCgkgICAgLy8gICAgICAgICAgICAgICBsb25nIHRpbWVzdGFtcCkgewoJICAgIC8vICAgdGhpcyh0ZXh0LCByYXdCeXRlcywgcmF3Qnl0ZXMgPT0gbnVsbCA/IDAgOiA4ICogcmF3Qnl0ZXMubGVuZ3RoLAoJICAgIC8vICAgICAgICByZXN1bHRQb2ludHMsIGZvcm1hdCwgdGltZXN0YW1wKQoJICAgIC8vIH0KCSAgICBmdW5jdGlvbiBSZXN1bHQodGV4dCwgcmF3Qnl0ZXMsIG51bUJpdHMsIHJlc3VsdFBvaW50cywgZm9ybWF0LCB0aW1lc3RhbXApIHsKCSAgICAgICAgaWYgKG51bUJpdHMgPT09IHZvaWQgMCkgeyBudW1CaXRzID0gcmF3Qnl0ZXMgPT0gbnVsbCA/IDAgOiA4ICogcmF3Qnl0ZXMubGVuZ3RoOyB9CgkgICAgICAgIGlmICh0aW1lc3RhbXAgPT09IHZvaWQgMCkgeyB0aW1lc3RhbXAgPSBTeXN0ZW1fMSQxLmRlZmF1bHQuY3VycmVudFRpbWVNaWxsaXMoKTsgfQoJICAgICAgICB0aGlzLnRleHQgPSB0ZXh0OwoJICAgICAgICB0aGlzLnJhd0J5dGVzID0gcmF3Qnl0ZXM7CgkgICAgICAgIHRoaXMubnVtQml0cyA9IG51bUJpdHM7CgkgICAgICAgIHRoaXMucmVzdWx0UG9pbnRzID0gcmVzdWx0UG9pbnRzOwoJICAgICAgICB0aGlzLmZvcm1hdCA9IGZvcm1hdDsKCSAgICAgICAgdGhpcy50aW1lc3RhbXAgPSB0aW1lc3RhbXA7CgkgICAgICAgIHRoaXMudGV4dCA9IHRleHQ7CgkgICAgICAgIHRoaXMucmF3Qnl0ZXMgPSByYXdCeXRlczsKCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gbnVtQml0cyB8fCBudWxsID09PSBudW1CaXRzKSB7CgkgICAgICAgICAgICB0aGlzLm51bUJpdHMgPSAocmF3Qnl0ZXMgPT09IG51bGwgfHwgcmF3Qnl0ZXMgPT09IHVuZGVmaW5lZCkgPyAwIDogOCAqIHJhd0J5dGVzLmxlbmd0aDsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgIHRoaXMubnVtQml0cyA9IG51bUJpdHM7CgkgICAgICAgIH0KCSAgICAgICAgdGhpcy5yZXN1bHRQb2ludHMgPSByZXN1bHRQb2ludHM7CgkgICAgICAgIHRoaXMuZm9ybWF0ID0gZm9ybWF0OwoJICAgICAgICB0aGlzLnJlc3VsdE1ldGFkYXRhID0gbnVsbDsKCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gdGltZXN0YW1wIHx8IG51bGwgPT09IHRpbWVzdGFtcCkgewoJICAgICAgICAgICAgdGhpcy50aW1lc3RhbXAgPSBTeXN0ZW1fMSQxLmRlZmF1bHQuY3VycmVudFRpbWVNaWxsaXMoKTsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgIHRoaXMudGltZXN0YW1wID0gdGltZXN0YW1wOwoJICAgICAgICB9CgkgICAgfQoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gcmF3IHRleHQgZW5jb2RlZCBieSB0aGUgYmFyY29kZQoJICAgICAqLwoJICAgIFJlc3VsdC5wcm90b3R5cGUuZ2V0VGV4dCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMudGV4dDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gcmF3IGJ5dGVzIGVuY29kZWQgYnkgdGhlIGJhcmNvZGUsIGlmIGFwcGxpY2FibGUsIG90aGVyd2lzZSB7QGNvZGUgbnVsbH0KCSAgICAgKi8KCSAgICBSZXN1bHQucHJvdG90eXBlLmdldFJhd0J5dGVzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5yYXdCeXRlczsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gaG93IG1hbnkgYml0cyBvZiB7QGxpbmsgI2dldFJhd0J5dGVzKCl9IGFyZSB2YWxpZDsgdHlwaWNhbGx5IDggdGltZXMgaXRzIGxlbmd0aAoJICAgICAqIEBzaW5jZSAzLjMuMAoJICAgICAqLwoJICAgIFJlc3VsdC5wcm90b3R5cGUuZ2V0TnVtQml0cyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMubnVtQml0czsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gcG9pbnRzIHJlbGF0ZWQgdG8gdGhlIGJhcmNvZGUgaW4gdGhlIGltYWdlLiBUaGVzZSBhcmUgdHlwaWNhbGx5IHBvaW50cwoJICAgICAqICAgICAgICAgaWRlbnRpZnlpbmcgZmluZGVyIHBhdHRlcm5zIG9yIHRoZSBjb3JuZXJzIG9mIHRoZSBiYXJjb2RlLiBUaGUgZXhhY3QgbWVhbmluZyBpcwoJICAgICAqICAgICAgICAgc3BlY2lmaWMgdG8gdGhlIHR5cGUgb2YgYmFyY29kZSB0aGF0IHdhcyBkZWNvZGVkLgoJICAgICAqLwoJICAgIFJlc3VsdC5wcm90b3R5cGUuZ2V0UmVzdWx0UG9pbnRzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5yZXN1bHRQb2ludHM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIHtAbGluayBCYXJjb2RlRm9ybWF0fSByZXByZXNlbnRpbmcgdGhlIGZvcm1hdCBvZiB0aGUgYmFyY29kZSB0aGF0IHdhcyBkZWNvZGVkCgkgICAgICovCgkgICAgUmVzdWx0LnByb3RvdHlwZS5nZXRCYXJjb2RlRm9ybWF0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5mb3JtYXQ7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIHtAbGluayBNYXB9IG1hcHBpbmcge0BsaW5rIFJlc3VsdE1ldGFkYXRhVHlwZX0ga2V5cyB0byB2YWx1ZXMuIE1heSBiZQoJICAgICAqICAge0Bjb2RlIG51bGx9LiBUaGlzIGNvbnRhaW5zIG9wdGlvbmFsIG1ldGFkYXRhIGFib3V0IHdoYXQgd2FzIGRldGVjdGVkIGFib3V0IHRoZSBiYXJjb2RlLAoJICAgICAqICAgbGlrZSBvcmllbnRhdGlvbi4KCSAgICAgKi8KCSAgICBSZXN1bHQucHJvdG90eXBlLmdldFJlc3VsdE1ldGFkYXRhID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5yZXN1bHRNZXRhZGF0YTsKCSAgICB9OwoJICAgIFJlc3VsdC5wcm90b3R5cGUucHV0TWV0YWRhdGEgPSBmdW5jdGlvbiAodHlwZSwgdmFsdWUpIHsKCSAgICAgICAgaWYgKHRoaXMucmVzdWx0TWV0YWRhdGEgPT09IG51bGwpIHsKCSAgICAgICAgICAgIHRoaXMucmVzdWx0TWV0YWRhdGEgPSBuZXcgTWFwKCk7CgkgICAgICAgIH0KCSAgICAgICAgdGhpcy5yZXN1bHRNZXRhZGF0YS5zZXQodHlwZSwgdmFsdWUpOwoJICAgIH07CgkgICAgUmVzdWx0LnByb3RvdHlwZS5wdXRBbGxNZXRhZGF0YSA9IGZ1bmN0aW9uIChtZXRhZGF0YSkgewoJICAgICAgICBpZiAobWV0YWRhdGEgIT09IG51bGwpIHsKCSAgICAgICAgICAgIGlmICh0aGlzLnJlc3VsdE1ldGFkYXRhID09PSBudWxsKSB7CgkgICAgICAgICAgICAgICAgdGhpcy5yZXN1bHRNZXRhZGF0YSA9IG1ldGFkYXRhOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgdGhpcy5yZXN1bHRNZXRhZGF0YSA9IG5ldyBNYXAobWV0YWRhdGEpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfTsKCSAgICBSZXN1bHQucHJvdG90eXBlLmFkZFJlc3VsdFBvaW50cyA9IGZ1bmN0aW9uIChuZXdQb2ludHMpIHsKCSAgICAgICAgdmFyIG9sZFBvaW50cyA9IHRoaXMucmVzdWx0UG9pbnRzOwoJICAgICAgICBpZiAob2xkUG9pbnRzID09PSBudWxsKSB7CgkgICAgICAgICAgICB0aGlzLnJlc3VsdFBvaW50cyA9IG5ld1BvaW50czsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIGlmIChuZXdQb2ludHMgIT09IG51bGwgJiYgbmV3UG9pbnRzLmxlbmd0aCA+IDApIHsKCSAgICAgICAgICAgIHZhciBhbGxQb2ludHMgPSBuZXcgQXJyYXkob2xkUG9pbnRzLmxlbmd0aCArIG5ld1BvaW50cy5sZW5ndGgpOwoJICAgICAgICAgICAgU3lzdGVtXzEkMS5kZWZhdWx0LmFycmF5Y29weShvbGRQb2ludHMsIDAsIGFsbFBvaW50cywgMCwgb2xkUG9pbnRzLmxlbmd0aCk7CgkgICAgICAgICAgICBTeXN0ZW1fMSQxLmRlZmF1bHQuYXJyYXljb3B5KG5ld1BvaW50cywgMCwgYWxsUG9pbnRzLCBvbGRQb2ludHMubGVuZ3RoLCBuZXdQb2ludHMubGVuZ3RoKTsKCSAgICAgICAgICAgIHRoaXMucmVzdWx0UG9pbnRzID0gYWxsUG9pbnRzOwoJICAgICAgICB9CgkgICAgfTsKCSAgICBSZXN1bHQucHJvdG90eXBlLmdldFRpbWVzdGFtcCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMudGltZXN0YW1wOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIFJlc3VsdC5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnRleHQ7CgkgICAgfTsKCSAgICByZXR1cm4gUmVzdWx0OwoJfSgpKTsKCVJlc3VsdCQxLmRlZmF1bHQgPSBSZXN1bHQ7CgoJdmFyIFJlc3VsdE1ldGFkYXRhVHlwZSQxID0ge307CgoJLyoKCSAqIENvcHlyaWdodCAyMDA4IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShSZXN1bHRNZXRhZGF0YVR5cGUkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZyB7Ki8KCS8qKgoJICogUmVwcmVzZW50cyBzb21lIHR5cGUgb2YgbWV0YWRhdGEgYWJvdXQgdGhlIHJlc3VsdCBvZiB0aGUgZGVjb2RpbmcgdGhhdCB0aGUgZGVjb2RlcgoJICogd2lzaGVzIHRvIGNvbW11bmljYXRlIGJhY2sgdG8gdGhlIGNhbGxlci4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgUmVzdWx0TWV0YWRhdGFUeXBlOwoJKGZ1bmN0aW9uIChSZXN1bHRNZXRhZGF0YVR5cGUpIHsKCSAgICAvKioKCSAgICAgKiBVbnNwZWNpZmllZCwgYXBwbGljYXRpb24tc3BlY2lmaWMgbWV0YWRhdGEuIE1hcHMgdG8gYW4gdW5zcGVjaWZpZWQge0BsaW5rIE9iamVjdH0uCgkgICAgICovCgkgICAgUmVzdWx0TWV0YWRhdGFUeXBlW1Jlc3VsdE1ldGFkYXRhVHlwZVsiT1RIRVIiXSA9IDBdID0gIk9USEVSIjsKCSAgICAvKioKCSAgICAgKiBEZW5vdGVzIHRoZSBsaWtlbHkgYXBwcm94aW1hdGUgb3JpZW50YXRpb24gb2YgdGhlIGJhcmNvZGUgaW4gdGhlIGltYWdlLiBUaGlzIHZhbHVlCgkgICAgICogaXMgZ2l2ZW4gYXMgZGVncmVlcyByb3RhdGVkIGNsb2Nrd2lzZSBmcm9tIHRoZSBub3JtYWwsIHVwcmlnaHQgb3JpZW50YXRpb24uCgkgICAgICogRm9yIGV4YW1wbGUgYSAxRCBiYXJjb2RlIHdoaWNoIHdhcyBmb3VuZCBieSByZWFkaW5nIHRvcC10by1ib3R0b20gd291bGQgYmUKCSAgICAgKiBzYWlkIHRvIGhhdmUgb3JpZW50YXRpb24gIjkwIi4gVGhpcyBrZXkgbWFwcyB0byBhbiB7QGxpbmsgSW50ZWdlcn0gd2hvc2UKCSAgICAgKiB2YWx1ZSBpcyBpbiB0aGUgcmFuZ2UgWzAsMzYwKS4KCSAgICAgKi8KCSAgICBSZXN1bHRNZXRhZGF0YVR5cGVbUmVzdWx0TWV0YWRhdGFUeXBlWyJPUklFTlRBVElPTiJdID0gMV0gPSAiT1JJRU5UQVRJT04iOwoJICAgIC8qKgoJICAgICAqIDxwPjJEIGJhcmNvZGUgZm9ybWF0cyB0eXBpY2FsbHkgZW5jb2RlIHRleHQsIGJ1dCBhbGxvdyBmb3IgYSBzb3J0IG9mICdieXRlIG1vZGUnCgkgICAgICogd2hpY2ggaXMgc29tZXRpbWVzIHVzZWQgdG8gZW5jb2RlIGJpbmFyeSBkYXRhLiBXaGlsZSB7QGxpbmsgUmVzdWx0fSBtYWtlcyBhdmFpbGFibGUKCSAgICAgKiB0aGUgY29tcGxldGUgcmF3IGJ5dGVzIGluIHRoZSBiYXJjb2RlIGZvciB0aGVzZSBmb3JtYXRzLCBpdCBkb2VzIG5vdCBvZmZlciB0aGUgYnl0ZXMKCSAgICAgKiBmcm9tIHRoZSBieXRlIHNlZ21lbnRzIGFsb25lLjwvcD4KCSAgICAgKgoJICAgICAqIDxwPlRoaXMgbWFwcyB0byBhIHtAbGluayBqYXZhLnV0aWwuTGlzdH0gb2YgYnl0ZSBhcnJheXMgY29ycmVzcG9uZGluZyB0byB0aGUKCSAgICAgKiByYXcgYnl0ZXMgaW4gdGhlIGJ5dGUgc2VnbWVudHMgaW4gdGhlIGJhcmNvZGUsIGluIG9yZGVyLjwvcD4KCSAgICAgKi8KCSAgICBSZXN1bHRNZXRhZGF0YVR5cGVbUmVzdWx0TWV0YWRhdGFUeXBlWyJCWVRFX1NFR01FTlRTIl0gPSAyXSA9ICJCWVRFX1NFR01FTlRTIjsKCSAgICAvKioKCSAgICAgKiBFcnJvciBjb3JyZWN0aW9uIGxldmVsIHVzZWQsIGlmIGFwcGxpY2FibGUuIFRoZSB2YWx1ZSB0eXBlIGRlcGVuZHMgb24gdGhlCgkgICAgICogZm9ybWF0LCBidXQgaXMgdHlwaWNhbGx5IGEgU3RyaW5nLgoJICAgICAqLwoJICAgIFJlc3VsdE1ldGFkYXRhVHlwZVtSZXN1bHRNZXRhZGF0YVR5cGVbIkVSUk9SX0NPUlJFQ1RJT05fTEVWRUwiXSA9IDNdID0gIkVSUk9SX0NPUlJFQ1RJT05fTEVWRUwiOwoJICAgIC8qKgoJICAgICAqIEZvciBzb21lIHBlcmlvZGljYWxzLCBpbmRpY2F0ZXMgdGhlIGlzc3VlIG51bWJlciBhcyBhbiB7QGxpbmsgSW50ZWdlcn0uCgkgICAgICovCgkgICAgUmVzdWx0TWV0YWRhdGFUeXBlW1Jlc3VsdE1ldGFkYXRhVHlwZVsiSVNTVUVfTlVNQkVSIl0gPSA0XSA9ICJJU1NVRV9OVU1CRVIiOwoJICAgIC8qKgoJICAgICAqIEZvciBzb21lIHByb2R1Y3RzLCBpbmRpY2F0ZXMgdGhlIHN1Z2dlc3RlZCByZXRhaWwgcHJpY2UgaW4gdGhlIGJhcmNvZGUgYXMgYQoJICAgICAqIGZvcm1hdHRlZCB7QGxpbmsgU3RyaW5nfS4KCSAgICAgKi8KCSAgICBSZXN1bHRNZXRhZGF0YVR5cGVbUmVzdWx0TWV0YWRhdGFUeXBlWyJTVUdHRVNURURfUFJJQ0UiXSA9IDVdID0gIlNVR0dFU1RFRF9QUklDRSI7CgkgICAgLyoqCgkgICAgICogRm9yIHNvbWUgcHJvZHVjdHMsIHRoZSBwb3NzaWJsZSBjb3VudHJ5IG9mIG1hbnVmYWN0dXJlIGFzIGEge0BsaW5rIFN0cmluZ30gZGVub3RpbmcgdGhlCgkgICAgICogSVNPIGNvdW50cnkgY29kZS4gU29tZSBtYXAgdG8gbXVsdGlwbGUgcG9zc2libGUgY291bnRyaWVzLCBsaWtlICJVUy9DQSIuCgkgICAgICovCgkgICAgUmVzdWx0TWV0YWRhdGFUeXBlW1Jlc3VsdE1ldGFkYXRhVHlwZVsiUE9TU0lCTEVfQ09VTlRSWSJdID0gNl0gPSAiUE9TU0lCTEVfQ09VTlRSWSI7CgkgICAgLyoqCgkgICAgICogRm9yIHNvbWUgcHJvZHVjdHMsIHRoZSBleHRlbnNpb24gdGV4dAoJICAgICAqLwoJICAgIFJlc3VsdE1ldGFkYXRhVHlwZVtSZXN1bHRNZXRhZGF0YVR5cGVbIlVQQ19FQU5fRVhURU5TSU9OIl0gPSA3XSA9ICJVUENfRUFOX0VYVEVOU0lPTiI7CgkgICAgLyoqCgkgICAgICogUERGNDE3LXNwZWNpZmljIG1ldGFkYXRhCgkgICAgICovCgkgICAgUmVzdWx0TWV0YWRhdGFUeXBlW1Jlc3VsdE1ldGFkYXRhVHlwZVsiUERGNDE3X0VYVFJBX01FVEFEQVRBIl0gPSA4XSA9ICJQREY0MTdfRVhUUkFfTUVUQURBVEEiOwoJICAgIC8qKgoJICAgICAqIElmIHRoZSBjb2RlIGZvcm1hdCBzdXBwb3J0cyBzdHJ1Y3R1cmVkIGFwcGVuZCBhbmQgdGhlIGN1cnJlbnQgc2Nhbm5lZCBjb2RlIGlzIHBhcnQgb2Ygb25lIHRoZW4gdGhlCgkgICAgICogc2VxdWVuY2UgbnVtYmVyIGlzIGdpdmVuIHdpdGggaXQuCgkgICAgICovCgkgICAgUmVzdWx0TWV0YWRhdGFUeXBlW1Jlc3VsdE1ldGFkYXRhVHlwZVsiU1RSVUNUVVJFRF9BUFBFTkRfU0VRVUVOQ0UiXSA9IDldID0gIlNUUlVDVFVSRURfQVBQRU5EX1NFUVVFTkNFIjsKCSAgICAvKioKCSAgICAgKiBJZiB0aGUgY29kZSBmb3JtYXQgc3VwcG9ydHMgc3RydWN0dXJlZCBhcHBlbmQgYW5kIHRoZSBjdXJyZW50IHNjYW5uZWQgY29kZSBpcyBwYXJ0IG9mIG9uZSB0aGVuIHRoZQoJICAgICAqIHBhcml0eSBpcyBnaXZlbiB3aXRoIGl0LgoJICAgICAqLwoJICAgIFJlc3VsdE1ldGFkYXRhVHlwZVtSZXN1bHRNZXRhZGF0YVR5cGVbIlNUUlVDVFVSRURfQVBQRU5EX1BBUklUWSJdID0gMTBdID0gIlNUUlVDVFVSRURfQVBQRU5EX1BBUklUWSI7Cgl9KShSZXN1bHRNZXRhZGF0YVR5cGUgfHwgKFJlc3VsdE1ldGFkYXRhVHlwZSA9IHt9KSk7CglSZXN1bHRNZXRhZGF0YVR5cGUkMS5kZWZhdWx0ID0gUmVzdWx0TWV0YWRhdGFUeXBlOwoKCXZhciBEZWNvZGVyJDEgPSB7fTsKCgl2YXIgQ2hlY2tzdW1FeGNlcHRpb24kMSA9IHt9OwoKCXZhciBfX2V4dGVuZHMkOCA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShDaGVja3N1bUV4Y2VwdGlvbiQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgRXhjZXB0aW9uXzEkNCA9IEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBDdXN0b20gRXJyb3IgY2xhc3Mgb2YgdHlwZSBFeGNlcHRpb24uCgkgKi8KCXZhciBDaGVja3N1bUV4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkOChDaGVja3N1bUV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBDaGVja3N1bUV4Y2VwdGlvbigpIHsKCSAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwoJICAgIH0KCSAgICBDaGVja3N1bUV4Y2VwdGlvbi5nZXRDaGVja3N1bUluc3RhbmNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gbmV3IENoZWNrc3VtRXhjZXB0aW9uKCk7CgkgICAgfTsKCSAgICBDaGVja3N1bUV4Y2VwdGlvbi5raW5kID0gJ0NoZWNrc3VtRXhjZXB0aW9uJzsKCSAgICByZXR1cm4gQ2hlY2tzdW1FeGNlcHRpb247Cgl9KEV4Y2VwdGlvbl8xJDQuZGVmYXVsdCkpOwoJQ2hlY2tzdW1FeGNlcHRpb24kMS5kZWZhdWx0ID0gQ2hlY2tzdW1FeGNlcHRpb247CgoJdmFyIEdlbmVyaWNHRiQxID0ge307CgoJdmFyIEdlbmVyaWNHRlBvbHkkMSA9IHt9OwoKCXZhciBBYnN0cmFjdEdlbmVyaWNHRiQxID0ge307CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShBYnN0cmFjdEdlbmVyaWNHRiQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNSA9IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiA8cD5UaGlzIGNsYXNzIGNvbnRhaW5zIHV0aWxpdHkgbWV0aG9kcyBmb3IgcGVyZm9ybWluZyBtYXRoZW1hdGljYWwgb3BlcmF0aW9ucyBvdmVyCgkgKiB0aGUgR2Fsb2lzIEZpZWxkcy4gT3BlcmF0aW9ucyB1c2UgYSBnaXZlbiBwcmltaXRpdmUgcG9seW5vbWlhbCBpbiBjYWxjdWxhdGlvbnMuPC9wPgoJICoKCSAqIDxwPlRocm91Z2hvdXQgdGhpcyBwYWNrYWdlLCBlbGVtZW50cyBvZiB0aGUgR0YgYXJlIHJlcHJlc2VudGVkIGFzIGFuIHtAY29kZSBpbnR9CgkgKiBmb3IgY29udmVuaWVuY2UgYW5kIHNwZWVkIChidXQgYXQgdGhlIGNvc3Qgb2YgbWVtb3J5KS4KCSAqIDwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICogQGF1dGhvciBEYXZpZCBPbGl2aWVyCgkgKi8KCXZhciBBYnN0cmFjdEdlbmVyaWNHRiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBBYnN0cmFjdEdlbmVyaWNHRigpIHsKCSAgICB9CgkgICAgLyoqCgkgICAgICogQHJldHVybiAyIHRvIHRoZSBwb3dlciBvZiBhIGluIEdGKHNpemUpCgkgICAgICovCgkgICAgQWJzdHJhY3RHZW5lcmljR0YucHJvdG90eXBlLmV4cCA9IGZ1bmN0aW9uIChhKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmV4cFRhYmxlW2FdOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBiYXNlIDIgbG9nIG9mIGEgaW4gR0Yoc2l6ZSkKCSAgICAgKi8KCSAgICBBYnN0cmFjdEdlbmVyaWNHRi5wcm90b3R5cGUubG9nID0gZnVuY3Rpb24gKGEgLyppbnQqLykgewoJICAgICAgICBpZiAoYSA9PT0gMCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDUuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiB0aGlzLmxvZ1RhYmxlW2FdOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogSW1wbGVtZW50cyBib3RoIGFkZGl0aW9uIGFuZCBzdWJ0cmFjdGlvbiAtLSB0aGV5IGFyZSB0aGUgc2FtZSBpbiBHRihzaXplKS4KCSAgICAgKgoJICAgICAqIEByZXR1cm4gc3VtL2RpZmZlcmVuY2Ugb2YgYSBhbmQgYgoJICAgICAqLwoJICAgIEFic3RyYWN0R2VuZXJpY0dGLmFkZE9yU3VidHJhY3QgPSBmdW5jdGlvbiAoYSAvKmludCovLCBiIC8qaW50Ki8pIHsKCSAgICAgICAgcmV0dXJuIGEgXiBiOwoJICAgIH07CgkgICAgcmV0dXJuIEFic3RyYWN0R2VuZXJpY0dGOwoJfSgpKTsKCUFic3RyYWN0R2VuZXJpY0dGJDEuZGVmYXVsdCA9IEFic3RyYWN0R2VuZXJpY0dGOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoR2VuZXJpY0dGUG9seSQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKm5hbWVzcGFjZSBjb20uZ29vZ2xlLnp4aW5nLmNvbW1vbi5yZWVkc29sb21vbiB7Ki8KCXZhciBBYnN0cmFjdEdlbmVyaWNHRl8xJDEgPSBBYnN0cmFjdEdlbmVyaWNHRiQxOwoJdmFyIFN5c3RlbV8xID0gU3lzdGVtJDE7Cgl2YXIgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNCA9IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiA8cD5SZXByZXNlbnRzIGEgcG9seW5vbWlhbCB3aG9zZSBjb2VmZmljaWVudHMgYXJlIGVsZW1lbnRzIG9mIGEgR0YuCgkgKiBJbnN0YW5jZXMgb2YgdGhpcyBjbGFzcyBhcmUgaW1tdXRhYmxlLjwvcD4KCSAqCgkgKiA8cD5NdWNoIGNyZWRpdCBpcyBkdWUgdG8gV2lsbGlhbSBSdWNrbGlkZ2Ugc2luY2UgcG9ydGlvbnMgb2YgdGhpcyBjb2RlIGFyZSBhbiBpbmRpcmVjdAoJICogcG9ydCBvZiBoaXMgQysrIFJlZWQtU29sb21vbiBpbXBsZW1lbnRhdGlvbi48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEdlbmVyaWNHRlBvbHkgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgLyoqCgkgICAgICogQHBhcmFtIGZpZWxkIHRoZSB7QGxpbmsgR2VuZXJpY0dGfSBpbnN0YW5jZSByZXByZXNlbnRpbmcgdGhlIGZpZWxkIHRvIHVzZQoJICAgICAqIHRvIHBlcmZvcm0gY29tcHV0YXRpb25zCgkgICAgICogQHBhcmFtIGNvZWZmaWNpZW50cyBjb2VmZmljaWVudHMgYXMgaW50cyByZXByZXNlbnRpbmcgZWxlbWVudHMgb2YgR0Yoc2l6ZSksIGFycmFuZ2VkCgkgICAgICogZnJvbSBtb3N0IHNpZ25pZmljYW50IChoaWdoZXN0LXBvd2VyIHRlcm0pIGNvZWZmaWNpZW50IHRvIGxlYXN0IHNpZ25pZmljYW50CgkgICAgICogQHRocm93cyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24gaWYgYXJndW1lbnQgaXMgbnVsbCBvciBlbXB0eSwKCSAgICAgKiBvciBpZiBsZWFkaW5nIGNvZWZmaWNpZW50IGlzIDAgYW5kIHRoaXMgaXMgbm90IGEKCSAgICAgKiBjb25zdGFudCBwb2x5bm9taWFsICh0aGF0IGlzLCBpdCBpcyBub3QgdGhlIG1vbm9taWFsICIwIikKCSAgICAgKi8KCSAgICBmdW5jdGlvbiBHZW5lcmljR0ZQb2x5KGZpZWxkLCBjb2VmZmljaWVudHMpIHsKCSAgICAgICAgaWYgKGNvZWZmaWNpZW50cy5sZW5ndGggPT09IDApIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ0LmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICB0aGlzLmZpZWxkID0gZmllbGQ7CgkgICAgICAgIHZhciBjb2VmZmljaWVudHNMZW5ndGggPSBjb2VmZmljaWVudHMubGVuZ3RoOwoJICAgICAgICBpZiAoY29lZmZpY2llbnRzTGVuZ3RoID4gMSAmJiBjb2VmZmljaWVudHNbMF0gPT09IDApIHsKCSAgICAgICAgICAgIC8vIExlYWRpbmcgdGVybSBtdXN0IGJlIG5vbi16ZXJvIGZvciBhbnl0aGluZyBleGNlcHQgdGhlIGNvbnN0YW50IHBvbHlub21pYWwgIjAiCgkgICAgICAgICAgICB2YXIgZmlyc3ROb25aZXJvID0gMTsKCSAgICAgICAgICAgIHdoaWxlIChmaXJzdE5vblplcm8gPCBjb2VmZmljaWVudHNMZW5ndGggJiYgY29lZmZpY2llbnRzW2ZpcnN0Tm9uWmVyb10gPT09IDApIHsKCSAgICAgICAgICAgICAgICBmaXJzdE5vblplcm8rKzsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGlmIChmaXJzdE5vblplcm8gPT09IGNvZWZmaWNpZW50c0xlbmd0aCkgewoJICAgICAgICAgICAgICAgIHRoaXMuY29lZmZpY2llbnRzID0gSW50MzJBcnJheS5mcm9tKFswXSk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICB0aGlzLmNvZWZmaWNpZW50cyA9IG5ldyBJbnQzMkFycmF5KGNvZWZmaWNpZW50c0xlbmd0aCAtIGZpcnN0Tm9uWmVybyk7CgkgICAgICAgICAgICAgICAgU3lzdGVtXzEuZGVmYXVsdC5hcnJheWNvcHkoY29lZmZpY2llbnRzLCBmaXJzdE5vblplcm8sIHRoaXMuY29lZmZpY2llbnRzLCAwLCB0aGlzLmNvZWZmaWNpZW50cy5sZW5ndGgpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgdGhpcy5jb2VmZmljaWVudHMgPSBjb2VmZmljaWVudHM7CgkgICAgICAgIH0KCSAgICB9CgkgICAgR2VuZXJpY0dGUG9seS5wcm90b3R5cGUuZ2V0Q29lZmZpY2llbnRzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5jb2VmZmljaWVudHM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIGRlZ3JlZSBvZiB0aGlzIHBvbHlub21pYWwKCSAgICAgKi8KCSAgICBHZW5lcmljR0ZQb2x5LnByb3RvdHlwZS5nZXREZWdyZWUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmNvZWZmaWNpZW50cy5sZW5ndGggLSAxOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiB0cnVlIGlmZiB0aGlzIHBvbHlub21pYWwgaXMgdGhlIG1vbm9taWFsICIwIgoJICAgICAqLwoJICAgIEdlbmVyaWNHRlBvbHkucHJvdG90eXBlLmlzWmVybyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuY29lZmZpY2llbnRzWzBdID09PSAwOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBjb2VmZmljaWVudCBvZiB4XmRlZ3JlZSB0ZXJtIGluIHRoaXMgcG9seW5vbWlhbAoJICAgICAqLwoJICAgIEdlbmVyaWNHRlBvbHkucHJvdG90eXBlLmdldENvZWZmaWNpZW50ID0gZnVuY3Rpb24gKGRlZ3JlZSAvKmludCovKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmNvZWZmaWNpZW50c1t0aGlzLmNvZWZmaWNpZW50cy5sZW5ndGggLSAxIC0gZGVncmVlXTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gZXZhbHVhdGlvbiBvZiB0aGlzIHBvbHlub21pYWwgYXQgYSBnaXZlbiBwb2ludAoJICAgICAqLwoJICAgIEdlbmVyaWNHRlBvbHkucHJvdG90eXBlLmV2YWx1YXRlQXQgPSBmdW5jdGlvbiAoYSAvKmludCovKSB7CgkgICAgICAgIGlmIChhID09PSAwKSB7CgkgICAgICAgICAgICAvLyBKdXN0IHJldHVybiB0aGUgeF4wIGNvZWZmaWNpZW50CgkgICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRDb2VmZmljaWVudCgwKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgY29lZmZpY2llbnRzID0gdGhpcy5jb2VmZmljaWVudHM7CgkgICAgICAgIHZhciByZXN1bHQ7CgkgICAgICAgIGlmIChhID09PSAxKSB7CgkgICAgICAgICAgICAvLyBKdXN0IHRoZSBzdW0gb2YgdGhlIGNvZWZmaWNpZW50cwoJICAgICAgICAgICAgcmVzdWx0ID0gMDsKCSAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGhfMSA9IGNvZWZmaWNpZW50cy5sZW5ndGg7IGkgIT09IGxlbmd0aF8xOyBpKyspIHsKCSAgICAgICAgICAgICAgICB2YXIgY29lZmZpY2llbnQgPSBjb2VmZmljaWVudHNbaV07CgkgICAgICAgICAgICAgICAgcmVzdWx0ID0gQWJzdHJhY3RHZW5lcmljR0ZfMSQxLmRlZmF1bHQuYWRkT3JTdWJ0cmFjdChyZXN1bHQsIGNvZWZmaWNpZW50KTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHJldHVybiByZXN1bHQ7CgkgICAgICAgIH0KCSAgICAgICAgcmVzdWx0ID0gY29lZmZpY2llbnRzWzBdOwoJICAgICAgICB2YXIgc2l6ZSA9IGNvZWZmaWNpZW50cy5sZW5ndGg7CgkgICAgICAgIHZhciBmaWVsZCA9IHRoaXMuZmllbGQ7CgkgICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgc2l6ZTsgaSsrKSB7CgkgICAgICAgICAgICByZXN1bHQgPSBBYnN0cmFjdEdlbmVyaWNHRl8xJDEuZGVmYXVsdC5hZGRPclN1YnRyYWN0KGZpZWxkLm11bHRpcGx5KGEsIHJlc3VsdCksIGNvZWZmaWNpZW50c1tpXSk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICB9OwoJICAgIEdlbmVyaWNHRlBvbHkucHJvdG90eXBlLmFkZE9yU3VidHJhY3QgPSBmdW5jdGlvbiAob3RoZXIpIHsKCSAgICAgICAgaWYgKCF0aGlzLmZpZWxkLmVxdWFscyhvdGhlci5maWVsZCkpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ0LmRlZmF1bHQoJ0dlbmVyaWNHRlBvbHlzIGRvIG5vdCBoYXZlIHNhbWUgR2VuZXJpY0dGIGZpZWxkJyk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHRoaXMuaXNaZXJvKCkpIHsKCSAgICAgICAgICAgIHJldHVybiBvdGhlcjsKCSAgICAgICAgfQoJICAgICAgICBpZiAob3RoZXIuaXNaZXJvKCkpIHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzOwoJICAgICAgICB9CgkgICAgICAgIHZhciBzbWFsbGVyQ29lZmZpY2llbnRzID0gdGhpcy5jb2VmZmljaWVudHM7CgkgICAgICAgIHZhciBsYXJnZXJDb2VmZmljaWVudHMgPSBvdGhlci5jb2VmZmljaWVudHM7CgkgICAgICAgIGlmIChzbWFsbGVyQ29lZmZpY2llbnRzLmxlbmd0aCA+IGxhcmdlckNvZWZmaWNpZW50cy5sZW5ndGgpIHsKCSAgICAgICAgICAgIHZhciB0ZW1wID0gc21hbGxlckNvZWZmaWNpZW50czsKCSAgICAgICAgICAgIHNtYWxsZXJDb2VmZmljaWVudHMgPSBsYXJnZXJDb2VmZmljaWVudHM7CgkgICAgICAgICAgICBsYXJnZXJDb2VmZmljaWVudHMgPSB0ZW1wOwoJICAgICAgICB9CgkgICAgICAgIHZhciBzdW1EaWZmID0gbmV3IEludDMyQXJyYXkobGFyZ2VyQ29lZmZpY2llbnRzLmxlbmd0aCk7CgkgICAgICAgIHZhciBsZW5ndGhEaWZmID0gbGFyZ2VyQ29lZmZpY2llbnRzLmxlbmd0aCAtIHNtYWxsZXJDb2VmZmljaWVudHMubGVuZ3RoOwoJICAgICAgICAvLyBDb3B5IGhpZ2gtb3JkZXIgdGVybXMgb25seSBmb3VuZCBpbiBoaWdoZXItZGVncmVlIHBvbHlub21pYWwncyBjb2VmZmljaWVudHMKCSAgICAgICAgU3lzdGVtXzEuZGVmYXVsdC5hcnJheWNvcHkobGFyZ2VyQ29lZmZpY2llbnRzLCAwLCBzdW1EaWZmLCAwLCBsZW5ndGhEaWZmKTsKCSAgICAgICAgZm9yICh2YXIgaSA9IGxlbmd0aERpZmY7IGkgPCBsYXJnZXJDb2VmZmljaWVudHMubGVuZ3RoOyBpKyspIHsKCSAgICAgICAgICAgIHN1bURpZmZbaV0gPSBBYnN0cmFjdEdlbmVyaWNHRl8xJDEuZGVmYXVsdC5hZGRPclN1YnRyYWN0KHNtYWxsZXJDb2VmZmljaWVudHNbaSAtIGxlbmd0aERpZmZdLCBsYXJnZXJDb2VmZmljaWVudHNbaV0pOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBuZXcgR2VuZXJpY0dGUG9seSh0aGlzLmZpZWxkLCBzdW1EaWZmKTsKCSAgICB9OwoJICAgIEdlbmVyaWNHRlBvbHkucHJvdG90eXBlLm11bHRpcGx5ID0gZnVuY3Rpb24gKG90aGVyKSB7CgkgICAgICAgIGlmICghdGhpcy5maWVsZC5lcXVhbHMob3RoZXIuZmllbGQpKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNC5kZWZhdWx0KCdHZW5lcmljR0ZQb2x5cyBkbyBub3QgaGF2ZSBzYW1lIEdlbmVyaWNHRiBmaWVsZCcpOwoJICAgICAgICB9CgkgICAgICAgIGlmICh0aGlzLmlzWmVybygpIHx8IG90aGVyLmlzWmVybygpKSB7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy5maWVsZC5nZXRaZXJvKCk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGFDb2VmZmljaWVudHMgPSB0aGlzLmNvZWZmaWNpZW50czsKCSAgICAgICAgdmFyIGFMZW5ndGggPSBhQ29lZmZpY2llbnRzLmxlbmd0aDsKCSAgICAgICAgdmFyIGJDb2VmZmljaWVudHMgPSBvdGhlci5jb2VmZmljaWVudHM7CgkgICAgICAgIHZhciBiTGVuZ3RoID0gYkNvZWZmaWNpZW50cy5sZW5ndGg7CgkgICAgICAgIHZhciBwcm9kdWN0ID0gbmV3IEludDMyQXJyYXkoYUxlbmd0aCArIGJMZW5ndGggLSAxKTsKCSAgICAgICAgdmFyIGZpZWxkID0gdGhpcy5maWVsZDsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhTGVuZ3RoOyBpKyspIHsKCSAgICAgICAgICAgIHZhciBhQ29lZmYgPSBhQ29lZmZpY2llbnRzW2ldOwoJICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBiTGVuZ3RoOyBqKyspIHsKCSAgICAgICAgICAgICAgICBwcm9kdWN0W2kgKyBqXSA9IEFic3RyYWN0R2VuZXJpY0dGXzEkMS5kZWZhdWx0LmFkZE9yU3VidHJhY3QocHJvZHVjdFtpICsgal0sIGZpZWxkLm11bHRpcGx5KGFDb2VmZiwgYkNvZWZmaWNpZW50c1tqXSkpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBuZXcgR2VuZXJpY0dGUG9seShmaWVsZCwgcHJvZHVjdCk7CgkgICAgfTsKCSAgICBHZW5lcmljR0ZQb2x5LnByb3RvdHlwZS5tdWx0aXBseVNjYWxhciA9IGZ1bmN0aW9uIChzY2FsYXIgLyppbnQqLykgewoJICAgICAgICBpZiAoc2NhbGFyID09PSAwKSB7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy5maWVsZC5nZXRaZXJvKCk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHNjYWxhciA9PT0gMSkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXM7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHNpemUgPSB0aGlzLmNvZWZmaWNpZW50cy5sZW5ndGg7CgkgICAgICAgIHZhciBmaWVsZCA9IHRoaXMuZmllbGQ7CgkgICAgICAgIHZhciBwcm9kdWN0ID0gbmV3IEludDMyQXJyYXkoc2l6ZSk7CgkgICAgICAgIHZhciBjb2VmZmljaWVudHMgPSB0aGlzLmNvZWZmaWNpZW50czsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzaXplOyBpKyspIHsKCSAgICAgICAgICAgIHByb2R1Y3RbaV0gPSBmaWVsZC5tdWx0aXBseShjb2VmZmljaWVudHNbaV0sIHNjYWxhcik7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIG5ldyBHZW5lcmljR0ZQb2x5KGZpZWxkLCBwcm9kdWN0KTsKCSAgICB9OwoJICAgIEdlbmVyaWNHRlBvbHkucHJvdG90eXBlLm11bHRpcGx5QnlNb25vbWlhbCA9IGZ1bmN0aW9uIChkZWdyZWUgLyppbnQqLywgY29lZmZpY2llbnQgLyppbnQqLykgewoJICAgICAgICBpZiAoZGVncmVlIDwgMCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDQuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIGlmIChjb2VmZmljaWVudCA9PT0gMCkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMuZmllbGQuZ2V0WmVybygpOwoJICAgICAgICB9CgkgICAgICAgIHZhciBjb2VmZmljaWVudHMgPSB0aGlzLmNvZWZmaWNpZW50czsKCSAgICAgICAgdmFyIHNpemUgPSBjb2VmZmljaWVudHMubGVuZ3RoOwoJICAgICAgICB2YXIgcHJvZHVjdCA9IG5ldyBJbnQzMkFycmF5KHNpemUgKyBkZWdyZWUpOwoJICAgICAgICB2YXIgZmllbGQgPSB0aGlzLmZpZWxkOwoJICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNpemU7IGkrKykgewoJICAgICAgICAgICAgcHJvZHVjdFtpXSA9IGZpZWxkLm11bHRpcGx5KGNvZWZmaWNpZW50c1tpXSwgY29lZmZpY2llbnQpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBuZXcgR2VuZXJpY0dGUG9seShmaWVsZCwgcHJvZHVjdCk7CgkgICAgfTsKCSAgICBHZW5lcmljR0ZQb2x5LnByb3RvdHlwZS5kaXZpZGUgPSBmdW5jdGlvbiAob3RoZXIpIHsKCSAgICAgICAgaWYgKCF0aGlzLmZpZWxkLmVxdWFscyhvdGhlci5maWVsZCkpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ0LmRlZmF1bHQoJ0dlbmVyaWNHRlBvbHlzIGRvIG5vdCBoYXZlIHNhbWUgR2VuZXJpY0dGIGZpZWxkJyk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKG90aGVyLmlzWmVybygpKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNC5kZWZhdWx0KCdEaXZpZGUgYnkgMCcpOwoJICAgICAgICB9CgkgICAgICAgIHZhciBmaWVsZCA9IHRoaXMuZmllbGQ7CgkgICAgICAgIHZhciBxdW90aWVudCA9IGZpZWxkLmdldFplcm8oKTsKCSAgICAgICAgdmFyIHJlbWFpbmRlciA9IHRoaXM7CgkgICAgICAgIHZhciBkZW5vbWluYXRvckxlYWRpbmdUZXJtID0gb3RoZXIuZ2V0Q29lZmZpY2llbnQob3RoZXIuZ2V0RGVncmVlKCkpOwoJICAgICAgICB2YXIgaW52ZXJzZURlbm9taW5hdG9yTGVhZGluZ1Rlcm0gPSBmaWVsZC5pbnZlcnNlKGRlbm9taW5hdG9yTGVhZGluZ1Rlcm0pOwoJICAgICAgICB3aGlsZSAocmVtYWluZGVyLmdldERlZ3JlZSgpID49IG90aGVyLmdldERlZ3JlZSgpICYmICFyZW1haW5kZXIuaXNaZXJvKCkpIHsKCSAgICAgICAgICAgIHZhciBkZWdyZWVEaWZmZXJlbmNlID0gcmVtYWluZGVyLmdldERlZ3JlZSgpIC0gb3RoZXIuZ2V0RGVncmVlKCk7CgkgICAgICAgICAgICB2YXIgc2NhbGUgPSBmaWVsZC5tdWx0aXBseShyZW1haW5kZXIuZ2V0Q29lZmZpY2llbnQocmVtYWluZGVyLmdldERlZ3JlZSgpKSwgaW52ZXJzZURlbm9taW5hdG9yTGVhZGluZ1Rlcm0pOwoJICAgICAgICAgICAgdmFyIHRlcm0gPSBvdGhlci5tdWx0aXBseUJ5TW9ub21pYWwoZGVncmVlRGlmZmVyZW5jZSwgc2NhbGUpOwoJICAgICAgICAgICAgdmFyIGl0ZXJhdGlvblF1b3RpZW50ID0gZmllbGQuYnVpbGRNb25vbWlhbChkZWdyZWVEaWZmZXJlbmNlLCBzY2FsZSk7CgkgICAgICAgICAgICBxdW90aWVudCA9IHF1b3RpZW50LmFkZE9yU3VidHJhY3QoaXRlcmF0aW9uUXVvdGllbnQpOwoJICAgICAgICAgICAgcmVtYWluZGVyID0gcmVtYWluZGVyLmFkZE9yU3VidHJhY3QodGVybSk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIFtxdW90aWVudCwgcmVtYWluZGVyXTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBHZW5lcmljR0ZQb2x5LnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIHJlc3VsdCA9ICcnOwoJICAgICAgICBmb3IgKHZhciBkZWdyZWUgPSB0aGlzLmdldERlZ3JlZSgpOyBkZWdyZWUgPj0gMDsgZGVncmVlLS0pIHsKCSAgICAgICAgICAgIHZhciBjb2VmZmljaWVudCA9IHRoaXMuZ2V0Q29lZmZpY2llbnQoZGVncmVlKTsKCSAgICAgICAgICAgIGlmIChjb2VmZmljaWVudCAhPT0gMCkgewoJICAgICAgICAgICAgICAgIGlmIChjb2VmZmljaWVudCA8IDApIHsKCSAgICAgICAgICAgICAgICAgICAgcmVzdWx0ICs9ICcgLSAnOwoJICAgICAgICAgICAgICAgICAgICBjb2VmZmljaWVudCA9IC1jb2VmZmljaWVudDsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQubGVuZ3RoID4gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ICs9ICcgKyAnOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGlmIChkZWdyZWUgPT09IDAgfHwgY29lZmZpY2llbnQgIT09IDEpIHsKCSAgICAgICAgICAgICAgICAgICAgdmFyIGFscGhhUG93ZXIgPSB0aGlzLmZpZWxkLmxvZyhjb2VmZmljaWVudCk7CgkgICAgICAgICAgICAgICAgICAgIGlmIChhbHBoYVBvd2VyID09PSAwKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgKz0gJzEnOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGFscGhhUG93ZXIgPT09IDEpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCArPSAnYSc7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgKz0gJ2FeJzsKCSAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCArPSBhbHBoYVBvd2VyOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGlmIChkZWdyZWUgIT09IDApIHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKGRlZ3JlZSA9PT0gMSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ICs9ICd4JzsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCArPSAneF4nOwoJICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ICs9IGRlZ3JlZTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gcmVzdWx0OwoJICAgIH07CgkgICAgcmV0dXJuIEdlbmVyaWNHRlBvbHk7Cgl9KCkpOwoJR2VuZXJpY0dGUG9seSQxLmRlZmF1bHQgPSBHZW5lcmljR0ZQb2x5OwoKCXZhciBBcml0aG1ldGljRXhjZXB0aW9uJDEgPSB7fTsKCgl2YXIgX19leHRlbmRzJDcgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoQXJpdGhtZXRpY0V4Y2VwdGlvbiQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgRXhjZXB0aW9uXzEkMyA9IEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBDdXN0b20gRXJyb3IgY2xhc3Mgb2YgdHlwZSBFeGNlcHRpb24uCgkgKi8KCXZhciBBcml0aG1ldGljRXhjZXB0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikgewoJICAgIF9fZXh0ZW5kcyQ3KEFyaXRobWV0aWNFeGNlcHRpb24sIF9zdXBlcik7CgkgICAgZnVuY3Rpb24gQXJpdGhtZXRpY0V4Y2VwdGlvbigpIHsKCSAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwoJICAgIH0KCSAgICBBcml0aG1ldGljRXhjZXB0aW9uLmtpbmQgPSAnQXJpdGhtZXRpY0V4Y2VwdGlvbic7CgkgICAgcmV0dXJuIEFyaXRobWV0aWNFeGNlcHRpb247Cgl9KEV4Y2VwdGlvbl8xJDMuZGVmYXVsdCkpOwoJQXJpdGhtZXRpY0V4Y2VwdGlvbiQxLmRlZmF1bHQgPSBBcml0aG1ldGljRXhjZXB0aW9uOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCgl2YXIgX19leHRlbmRzJDYgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoR2VuZXJpY0dGJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uLnJlZWRzb2xvbW9uIHsqLwoJdmFyIEdlbmVyaWNHRlBvbHlfMSQxID0gR2VuZXJpY0dGUG9seSQxOwoJdmFyIEFic3RyYWN0R2VuZXJpY0dGXzEgPSBBYnN0cmFjdEdlbmVyaWNHRiQxOwoJdmFyIEludGVnZXJfMSQxID0gSW50ZWdlciQxOwoJdmFyIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDMgPSBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24kMTsKCXZhciBBcml0aG1ldGljRXhjZXB0aW9uXzEgPSBBcml0aG1ldGljRXhjZXB0aW9uJDE7CgkvKioKCSAqIDxwPlRoaXMgY2xhc3MgY29udGFpbnMgdXRpbGl0eSBtZXRob2RzIGZvciBwZXJmb3JtaW5nIG1hdGhlbWF0aWNhbCBvcGVyYXRpb25zIG92ZXIKCSAqIHRoZSBHYWxvaXMgRmllbGRzLiBPcGVyYXRpb25zIHVzZSBhIGdpdmVuIHByaW1pdGl2ZSBwb2x5bm9taWFsIGluIGNhbGN1bGF0aW9ucy48L3A+CgkgKgoJICogPHA+VGhyb3VnaG91dCB0aGlzIHBhY2thZ2UsIGVsZW1lbnRzIG9mIHRoZSBHRiBhcmUgcmVwcmVzZW50ZWQgYXMgYW4ge0Bjb2RlIGludH0KCSAqIGZvciBjb252ZW5pZW5jZSBhbmQgc3BlZWQgKGJ1dCBhdCB0aGUgY29zdCBvZiBtZW1vcnkpLgoJICogPC9wPgoJICoKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKiBAYXV0aG9yIERhdmlkIE9saXZpZXIKCSAqLwoJdmFyIEdlbmVyaWNHRiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkNihHZW5lcmljR0YsIF9zdXBlcik7CgkgICAgLyoqCgkgICAgICogQ3JlYXRlIGEgcmVwcmVzZW50YXRpb24gb2YgR0Yoc2l6ZSkgdXNpbmcgdGhlIGdpdmVuIHByaW1pdGl2ZSBwb2x5bm9taWFsLgoJICAgICAqCgkgICAgICogQHBhcmFtIHByaW1pdGl2ZSBpcnJlZHVjaWJsZSBwb2x5bm9taWFsIHdob3NlIGNvZWZmaWNpZW50cyBhcmUgcmVwcmVzZW50ZWQgYnkKCSAgICAgKiAgdGhlIGJpdHMgb2YgYW4gaW50LCB3aGVyZSB0aGUgbGVhc3Qtc2lnbmlmaWNhbnQgYml0IHJlcHJlc2VudHMgdGhlIGNvbnN0YW50CgkgICAgICogIGNvZWZmaWNpZW50CgkgICAgICogQHBhcmFtIHNpemUgdGhlIHNpemUgb2YgdGhlIGZpZWxkCgkgICAgICogQHBhcmFtIGIgdGhlIGZhY3RvciBiIGluIHRoZSBnZW5lcmF0b3IgcG9seW5vbWlhbCBjYW4gYmUgMC0gb3IgMS1iYXNlZAoJICAgICAqICAoZyh4KSA9ICh4K2FeYikoeCthXihiKzEpKS4uLih4K2FeKGIrMnQtMSkpKS4KCSAgICAgKiAgSW4gbW9zdCBjYXNlcyBpdCBzaG91bGQgYmUgMSwgYnV0IGZvciBRUiBjb2RlIGl0IGlzIDAuCgkgICAgICovCgkgICAgZnVuY3Rpb24gR2VuZXJpY0dGKHByaW1pdGl2ZSAvKmludCovLCBzaXplIC8qaW50Ki8sIGdlbmVyYXRvckJhc2UgLyppbnQqLykgewoJICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzOwoJICAgICAgICBfdGhpcy5wcmltaXRpdmUgPSBwcmltaXRpdmU7CgkgICAgICAgIF90aGlzLnNpemUgPSBzaXplOwoJICAgICAgICBfdGhpcy5nZW5lcmF0b3JCYXNlID0gZ2VuZXJhdG9yQmFzZTsKCSAgICAgICAgdmFyIGV4cFRhYmxlID0gbmV3IEludDMyQXJyYXkoc2l6ZSk7CgkgICAgICAgIHZhciB4ID0gMTsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzaXplOyBpKyspIHsKCSAgICAgICAgICAgIGV4cFRhYmxlW2ldID0geDsKCSAgICAgICAgICAgIHggKj0gMjsgLy8gd2UncmUgYXNzdW1pbmcgdGhlIGdlbmVyYXRvciBhbHBoYSBpcyAyCgkgICAgICAgICAgICBpZiAoeCA+PSBzaXplKSB7CgkgICAgICAgICAgICAgICAgeCBePSBwcmltaXRpdmU7CgkgICAgICAgICAgICAgICAgeCAmPSBzaXplIC0gMTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBfdGhpcy5leHBUYWJsZSA9IGV4cFRhYmxlOwoJICAgICAgICB2YXIgbG9nVGFibGUgPSBuZXcgSW50MzJBcnJheShzaXplKTsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzaXplIC0gMTsgaSsrKSB7CgkgICAgICAgICAgICBsb2dUYWJsZVtleHBUYWJsZVtpXV0gPSBpOwoJICAgICAgICB9CgkgICAgICAgIF90aGlzLmxvZ1RhYmxlID0gbG9nVGFibGU7CgkgICAgICAgIC8vIGxvZ1RhYmxlWzBdID09IDAgYnV0IHRoaXMgc2hvdWxkIG5ldmVyIGJlIHVzZWQKCSAgICAgICAgX3RoaXMuemVybyA9IG5ldyBHZW5lcmljR0ZQb2x5XzEkMS5kZWZhdWx0KF90aGlzLCBJbnQzMkFycmF5LmZyb20oWzBdKSk7CgkgICAgICAgIF90aGlzLm9uZSA9IG5ldyBHZW5lcmljR0ZQb2x5XzEkMS5kZWZhdWx0KF90aGlzLCBJbnQzMkFycmF5LmZyb20oWzFdKSk7CgkgICAgICAgIHJldHVybiBfdGhpczsKCSAgICB9CgkgICAgR2VuZXJpY0dGLnByb3RvdHlwZS5nZXRaZXJvID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy56ZXJvOwoJICAgIH07CgkgICAgR2VuZXJpY0dGLnByb3RvdHlwZS5nZXRPbmUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLm9uZTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gdGhlIG1vbm9taWFsIHJlcHJlc2VudGluZyBjb2VmZmljaWVudCAqIHheZGVncmVlCgkgICAgICovCgkgICAgR2VuZXJpY0dGLnByb3RvdHlwZS5idWlsZE1vbm9taWFsID0gZnVuY3Rpb24gKGRlZ3JlZSAvKmludCovLCBjb2VmZmljaWVudCAvKmludCovKSB7CgkgICAgICAgIGlmIChkZWdyZWUgPCAwKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkMy5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGNvZWZmaWNpZW50ID09PSAwKSB7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy56ZXJvOwoJICAgICAgICB9CgkgICAgICAgIHZhciBjb2VmZmljaWVudHMgPSBuZXcgSW50MzJBcnJheShkZWdyZWUgKyAxKTsKCSAgICAgICAgY29lZmZpY2llbnRzWzBdID0gY29lZmZpY2llbnQ7CgkgICAgICAgIHJldHVybiBuZXcgR2VuZXJpY0dGUG9seV8xJDEuZGVmYXVsdCh0aGlzLCBjb2VmZmljaWVudHMpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBtdWx0aXBsaWNhdGl2ZSBpbnZlcnNlIG9mIGEKCSAgICAgKi8KCSAgICBHZW5lcmljR0YucHJvdG90eXBlLmludmVyc2UgPSBmdW5jdGlvbiAoYSAvKmludCovKSB7CgkgICAgICAgIGlmIChhID09PSAwKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgQXJpdGhtZXRpY0V4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gdGhpcy5leHBUYWJsZVt0aGlzLnNpemUgLSB0aGlzLmxvZ1RhYmxlW2FdIC0gMV07CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIHByb2R1Y3Qgb2YgYSBhbmQgYiBpbiBHRihzaXplKQoJICAgICAqLwoJICAgIEdlbmVyaWNHRi5wcm90b3R5cGUubXVsdGlwbHkgPSBmdW5jdGlvbiAoYSAvKmludCovLCBiIC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKGEgPT09IDAgfHwgYiA9PT0gMCkgewoJICAgICAgICAgICAgcmV0dXJuIDA7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRoaXMuZXhwVGFibGVbKHRoaXMubG9nVGFibGVbYV0gKyB0aGlzLmxvZ1RhYmxlW2JdKSAlICh0aGlzLnNpemUgLSAxKV07CgkgICAgfTsKCSAgICBHZW5lcmljR0YucHJvdG90eXBlLmdldFNpemUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnNpemU7CgkgICAgfTsKCSAgICBHZW5lcmljR0YucHJvdG90eXBlLmdldEdlbmVyYXRvckJhc2UgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmdlbmVyYXRvckJhc2U7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgR2VuZXJpY0dGLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuICgnR0YoMHgnICsgSW50ZWdlcl8xJDEuZGVmYXVsdC50b0hleFN0cmluZyh0aGlzLnByaW1pdGl2ZSkgKyAnLCcgKyB0aGlzLnNpemUgKyAnKScpOwoJICAgIH07CgkgICAgR2VuZXJpY0dGLnByb3RvdHlwZS5lcXVhbHMgPSBmdW5jdGlvbiAobykgewoJICAgICAgICByZXR1cm4gbyA9PT0gdGhpczsKCSAgICB9OwoJICAgIEdlbmVyaWNHRi5BWlRFQ19EQVRBXzEyID0gbmV3IEdlbmVyaWNHRigweDEwNjksIDQwOTYsIDEpOyAvLyB4XjEyICsgeF42ICsgeF41ICsgeF4zICsgMQoJICAgIEdlbmVyaWNHRi5BWlRFQ19EQVRBXzEwID0gbmV3IEdlbmVyaWNHRigweDQwOSwgMTAyNCwgMSk7IC8vIHheMTAgKyB4XjMgKyAxCgkgICAgR2VuZXJpY0dGLkFaVEVDX0RBVEFfNiA9IG5ldyBHZW5lcmljR0YoMHg0MywgNjQsIDEpOyAvLyB4XjYgKyB4ICsgMQoJICAgIEdlbmVyaWNHRi5BWlRFQ19QQVJBTSA9IG5ldyBHZW5lcmljR0YoMHgxMywgMTYsIDEpOyAvLyB4XjQgKyB4ICsgMQoJICAgIEdlbmVyaWNHRi5RUl9DT0RFX0ZJRUxEXzI1NiA9IG5ldyBHZW5lcmljR0YoMHgwMTFkLCAyNTYsIDApOyAvLyB4XjggKyB4XjQgKyB4XjMgKyB4XjIgKyAxCgkgICAgR2VuZXJpY0dGLkRBVEFfTUFUUklYX0ZJRUxEXzI1NiA9IG5ldyBHZW5lcmljR0YoMHgwMTJkLCAyNTYsIDEpOyAvLyB4XjggKyB4XjUgKyB4XjMgKyB4XjIgKyAxCgkgICAgR2VuZXJpY0dGLkFaVEVDX0RBVEFfOCA9IEdlbmVyaWNHRi5EQVRBX01BVFJJWF9GSUVMRF8yNTY7CgkgICAgR2VuZXJpY0dGLk1BWElDT0RFX0ZJRUxEXzY0ID0gR2VuZXJpY0dGLkFaVEVDX0RBVEFfNjsKCSAgICByZXR1cm4gR2VuZXJpY0dGOwoJfShBYnN0cmFjdEdlbmVyaWNHRl8xLmRlZmF1bHQpKTsKCUdlbmVyaWNHRiQxLmRlZmF1bHQgPSBHZW5lcmljR0Y7CgoJdmFyIFJlZWRTb2xvbW9uRGVjb2RlciQxID0ge307CgoJdmFyIFJlZWRTb2xvbW9uRXhjZXB0aW9uJDEgPSB7fTsKCgl2YXIgX19leHRlbmRzJDUgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoUmVlZFNvbG9tb25FeGNlcHRpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIEV4Y2VwdGlvbl8xJDIgPSBFeGNlcHRpb24kMTsKCS8qKgoJICogQ3VzdG9tIEVycm9yIGNsYXNzIG9mIHR5cGUgRXhjZXB0aW9uLgoJICovCgl2YXIgUmVlZFNvbG9tb25FeGNlcHRpb24gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJDUoUmVlZFNvbG9tb25FeGNlcHRpb24sIF9zdXBlcik7CgkgICAgZnVuY3Rpb24gUmVlZFNvbG9tb25FeGNlcHRpb24oKSB7CgkgICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpczsKCSAgICB9CgkgICAgUmVlZFNvbG9tb25FeGNlcHRpb24ua2luZCA9ICdSZWVkU29sb21vbkV4Y2VwdGlvbic7CgkgICAgcmV0dXJuIFJlZWRTb2xvbW9uRXhjZXB0aW9uOwoJfShFeGNlcHRpb25fMSQyLmRlZmF1bHQpKTsKCVJlZWRTb2xvbW9uRXhjZXB0aW9uJDEuZGVmYXVsdCA9IFJlZWRTb2xvbW9uRXhjZXB0aW9uOwoKCXZhciBJbGxlZ2FsU3RhdGVFeGNlcHRpb24kMSA9IHt9OwoKCXZhciBfX2V4dGVuZHMkNCA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShJbGxlZ2FsU3RhdGVFeGNlcHRpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIEV4Y2VwdGlvbl8xJDEgPSBFeGNlcHRpb24kMTsKCS8qKgoJICogQ3VzdG9tIEVycm9yIGNsYXNzIG9mIHR5cGUgRXhjZXB0aW9uLgoJICovCgl2YXIgSWxsZWdhbFN0YXRlRXhjZXB0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikgewoJICAgIF9fZXh0ZW5kcyQ0KElsbGVnYWxTdGF0ZUV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBJbGxlZ2FsU3RhdGVFeGNlcHRpb24oKSB7CgkgICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpczsKCSAgICB9CgkgICAgSWxsZWdhbFN0YXRlRXhjZXB0aW9uLmtpbmQgPSAnSWxsZWdhbFN0YXRlRXhjZXB0aW9uJzsKCSAgICByZXR1cm4gSWxsZWdhbFN0YXRlRXhjZXB0aW9uOwoJfShFeGNlcHRpb25fMSQxLmRlZmF1bHQpKTsKCUlsbGVnYWxTdGF0ZUV4Y2VwdGlvbiQxLmRlZmF1bHQgPSBJbGxlZ2FsU3RhdGVFeGNlcHRpb247CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShSZWVkU29sb21vbkRlY29kZXIkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5jb21tb24ucmVlZHNvbG9tb24geyovCgl2YXIgR2VuZXJpY0dGXzEkMSA9IEdlbmVyaWNHRiQxOwoJdmFyIEdlbmVyaWNHRlBvbHlfMSA9IEdlbmVyaWNHRlBvbHkkMTsKCXZhciBSZWVkU29sb21vbkV4Y2VwdGlvbl8xID0gUmVlZFNvbG9tb25FeGNlcHRpb24kMTsKCXZhciBJbGxlZ2FsU3RhdGVFeGNlcHRpb25fMSA9IElsbGVnYWxTdGF0ZUV4Y2VwdGlvbiQxOwoJLyoqCgkgKiA8cD5JbXBsZW1lbnRzIFJlZWQtU29sb21vbiBkZWNvZGluZywgYXMgdGhlIG5hbWUgaW1wbGllcy48L3A+CgkgKgoJICogPHA+VGhlIGFsZ29yaXRobSB3aWxsIG5vdCBiZSBleHBsYWluZWQgaGVyZSwgYnV0IHRoZSBmb2xsb3dpbmcgcmVmZXJlbmNlcyB3ZXJlIGhlbHBmdWwKCSAqIGluIGNyZWF0aW5nIHRoaXMgaW1wbGVtZW50YXRpb246PC9wPgoJICoKCSAqIDx1bD4KCSAqIDxsaT5CcnVjZSBNYWdncy4KCSAqIDxhIGhyZWY9Imh0dHA6Ly93d3cuY3MuY211LmVkdS9hZnMvY3MuY211LmVkdS9wcm9qZWN0L3BzY2ljby1ndXliL3JlYWx3b3JsZC93d3cvcnNfZGVjb2RlLnBzIj4KCSAqICJEZWNvZGluZyBSZWVkLVNvbG9tb24gQ29kZXMiPC9hPiAoc2VlIGRpc2N1c3Npb24gb2YgRm9ybmV5J3MgRm9ybXVsYSk8L2xpPgoJICogPGxpPkouSS4gSGFsbC4gPGEgaHJlZj0id3d3Lm10aC5tc3UuZWR1L35qaGFsbC9jbGFzc2VzL2NvZGVub3Rlcy9HUlMucGRmIj4KCSAqICJDaGFwdGVyIDUuIEdlbmVyYWxpemVkIFJlZWQtU29sb21vbiBDb2RlcyI8L2E+CgkgKiAoc2VlIGRpc2N1c3Npb24gb2YgRXVjbGlkZWFuIGFsZ29yaXRobSk8L2xpPgoJICogPC91bD4KCSAqCgkgKiA8cD5NdWNoIGNyZWRpdCBpcyBkdWUgdG8gV2lsbGlhbSBSdWNrbGlkZ2Ugc2luY2UgcG9ydGlvbnMgb2YgdGhpcyBjb2RlIGFyZSBhbiBpbmRpcmVjdAoJICogcG9ydCBvZiBoaXMgQysrIFJlZWQtU29sb21vbiBpbXBsZW1lbnRhdGlvbi48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqIEBhdXRob3IgV2lsbGlhbSBSdWNrbGlkZ2UKCSAqIEBhdXRob3Igc2FuZm9yZHNxdWlyZXMKCSAqLwoJdmFyIFJlZWRTb2xvbW9uRGVjb2RlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBSZWVkU29sb21vbkRlY29kZXIoZmllbGQpIHsKCSAgICAgICAgdGhpcy5maWVsZCA9IGZpZWxkOwoJICAgIH0KCSAgICAvKioKCSAgICAgKiA8cD5EZWNvZGVzIGdpdmVuIHNldCBvZiByZWNlaXZlZCBjb2Rld29yZHMsIHdoaWNoIGluY2x1ZGUgYm90aCBkYXRhIGFuZCBlcnJvci1jb3JyZWN0aW9uCgkgICAgICogY29kZXdvcmRzLiBSZWFsbHksIHRoaXMgbWVhbnMgaXQgdXNlcyBSZWVkLVNvbG9tb24gdG8gZGV0ZWN0IGFuZCBjb3JyZWN0IGVycm9ycywgaW4tcGxhY2UsCgkgICAgICogaW4gdGhlIGlucHV0LjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSByZWNlaXZlZCBkYXRhIGFuZCBlcnJvci1jb3JyZWN0aW9uIGNvZGV3b3JkcwoJICAgICAqIEBwYXJhbSB0d29TIG51bWJlciBvZiBlcnJvci1jb3JyZWN0aW9uIGNvZGV3b3JkcyBhdmFpbGFibGUKCSAgICAgKiBAdGhyb3dzIFJlZWRTb2xvbW9uRXhjZXB0aW9uIGlmIGRlY29kaW5nIGZhaWxzIGZvciBhbnkgcmVhc29uCgkgICAgICovCgkgICAgUmVlZFNvbG9tb25EZWNvZGVyLnByb3RvdHlwZS5kZWNvZGUgPSBmdW5jdGlvbiAocmVjZWl2ZWQsIHR3b1MgLyppbnQqLykgewoJICAgICAgICB2YXIgZmllbGQgPSB0aGlzLmZpZWxkOwoJICAgICAgICB2YXIgcG9seSA9IG5ldyBHZW5lcmljR0ZQb2x5XzEuZGVmYXVsdChmaWVsZCwgcmVjZWl2ZWQpOwoJICAgICAgICB2YXIgc3luZHJvbWVDb2VmZmljaWVudHMgPSBuZXcgSW50MzJBcnJheSh0d29TKTsKCSAgICAgICAgdmFyIG5vRXJyb3IgPSB0cnVlOwoJICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHR3b1M7IGkrKykgewoJICAgICAgICAgICAgdmFyIGV2YWxSZXN1bHQgPSBwb2x5LmV2YWx1YXRlQXQoZmllbGQuZXhwKGkgKyBmaWVsZC5nZXRHZW5lcmF0b3JCYXNlKCkpKTsKCSAgICAgICAgICAgIHN5bmRyb21lQ29lZmZpY2llbnRzW3N5bmRyb21lQ29lZmZpY2llbnRzLmxlbmd0aCAtIDEgLSBpXSA9IGV2YWxSZXN1bHQ7CgkgICAgICAgICAgICBpZiAoZXZhbFJlc3VsdCAhPT0gMCkgewoJICAgICAgICAgICAgICAgIG5vRXJyb3IgPSBmYWxzZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBpZiAobm9FcnJvcikgewoJICAgICAgICAgICAgcmV0dXJuOwoJICAgICAgICB9CgkgICAgICAgIHZhciBzeW5kcm9tZSA9IG5ldyBHZW5lcmljR0ZQb2x5XzEuZGVmYXVsdChmaWVsZCwgc3luZHJvbWVDb2VmZmljaWVudHMpOwoJICAgICAgICB2YXIgc2lnbWFPbWVnYSA9IHRoaXMucnVuRXVjbGlkZWFuQWxnb3JpdGhtKGZpZWxkLmJ1aWxkTW9ub21pYWwodHdvUywgMSksIHN5bmRyb21lLCB0d29TKTsKCSAgICAgICAgdmFyIHNpZ21hID0gc2lnbWFPbWVnYVswXTsKCSAgICAgICAgdmFyIG9tZWdhID0gc2lnbWFPbWVnYVsxXTsKCSAgICAgICAgdmFyIGVycm9yTG9jYXRpb25zID0gdGhpcy5maW5kRXJyb3JMb2NhdGlvbnMoc2lnbWEpOwoJICAgICAgICB2YXIgZXJyb3JNYWduaXR1ZGVzID0gdGhpcy5maW5kRXJyb3JNYWduaXR1ZGVzKG9tZWdhLCBlcnJvckxvY2F0aW9ucyk7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZXJyb3JMb2NhdGlvbnMubGVuZ3RoOyBpKyspIHsKCSAgICAgICAgICAgIHZhciBwb3NpdGlvbiA9IHJlY2VpdmVkLmxlbmd0aCAtIDEgLSBmaWVsZC5sb2coZXJyb3JMb2NhdGlvbnNbaV0pOwoJICAgICAgICAgICAgaWYgKHBvc2l0aW9uIDwgMCkgewoJICAgICAgICAgICAgICAgIHRocm93IG5ldyBSZWVkU29sb21vbkV4Y2VwdGlvbl8xLmRlZmF1bHQoJ0JhZCBlcnJvciBsb2NhdGlvbicpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmVjZWl2ZWRbcG9zaXRpb25dID0gR2VuZXJpY0dGXzEkMS5kZWZhdWx0LmFkZE9yU3VidHJhY3QocmVjZWl2ZWRbcG9zaXRpb25dLCBlcnJvck1hZ25pdHVkZXNbaV0pOwoJICAgICAgICB9CgkgICAgfTsKCSAgICBSZWVkU29sb21vbkRlY29kZXIucHJvdG90eXBlLnJ1bkV1Y2xpZGVhbkFsZ29yaXRobSA9IGZ1bmN0aW9uIChhLCBiLCBSIC8qaW50Ki8pIHsKCSAgICAgICAgLy8gQXNzdW1lIGEncyBkZWdyZWUgaXMgPj0gYidzCgkgICAgICAgIGlmIChhLmdldERlZ3JlZSgpIDwgYi5nZXREZWdyZWUoKSkgewoJICAgICAgICAgICAgdmFyIHRlbXAgPSBhOwoJICAgICAgICAgICAgYSA9IGI7CgkgICAgICAgICAgICBiID0gdGVtcDsKCSAgICAgICAgfQoJICAgICAgICB2YXIgZmllbGQgPSB0aGlzLmZpZWxkOwoJICAgICAgICB2YXIgckxhc3QgPSBhOwoJICAgICAgICB2YXIgciA9IGI7CgkgICAgICAgIHZhciB0TGFzdCA9IGZpZWxkLmdldFplcm8oKTsKCSAgICAgICAgdmFyIHQgPSBmaWVsZC5nZXRPbmUoKTsKCSAgICAgICAgLy8gUnVuIEV1Y2xpZGVhbiBhbGdvcml0aG0gdW50aWwgcidzIGRlZ3JlZSBpcyBsZXNzIHRoYW4gUi8yCgkgICAgICAgIHdoaWxlIChyLmdldERlZ3JlZSgpID49IChSIC8gMiB8IDApKSB7CgkgICAgICAgICAgICB2YXIgckxhc3RMYXN0ID0gckxhc3Q7CgkgICAgICAgICAgICB2YXIgdExhc3RMYXN0ID0gdExhc3Q7CgkgICAgICAgICAgICByTGFzdCA9IHI7CgkgICAgICAgICAgICB0TGFzdCA9IHQ7CgkgICAgICAgICAgICAvLyBEaXZpZGUgckxhc3RMYXN0IGJ5IHJMYXN0LCB3aXRoIHF1b3RpZW50IGluIHEgYW5kIHJlbWFpbmRlciBpbiByCgkgICAgICAgICAgICBpZiAockxhc3QuaXNaZXJvKCkpIHsKCSAgICAgICAgICAgICAgICAvLyBPb3BzLCBFdWNsaWRlYW4gYWxnb3JpdGhtIGFscmVhZHkgdGVybWluYXRlZD8KCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgUmVlZFNvbG9tb25FeGNlcHRpb25fMS5kZWZhdWx0KCdyX3tpLTF9IHdhcyB6ZXJvJyk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICByID0gckxhc3RMYXN0OwoJICAgICAgICAgICAgdmFyIHEgPSBmaWVsZC5nZXRaZXJvKCk7CgkgICAgICAgICAgICB2YXIgZGVub21pbmF0b3JMZWFkaW5nVGVybSA9IHJMYXN0LmdldENvZWZmaWNpZW50KHJMYXN0LmdldERlZ3JlZSgpKTsKCSAgICAgICAgICAgIHZhciBkbHRJbnZlcnNlID0gZmllbGQuaW52ZXJzZShkZW5vbWluYXRvckxlYWRpbmdUZXJtKTsKCSAgICAgICAgICAgIHdoaWxlIChyLmdldERlZ3JlZSgpID49IHJMYXN0LmdldERlZ3JlZSgpICYmICFyLmlzWmVybygpKSB7CgkgICAgICAgICAgICAgICAgdmFyIGRlZ3JlZURpZmYgPSByLmdldERlZ3JlZSgpIC0gckxhc3QuZ2V0RGVncmVlKCk7CgkgICAgICAgICAgICAgICAgdmFyIHNjYWxlID0gZmllbGQubXVsdGlwbHkoci5nZXRDb2VmZmljaWVudChyLmdldERlZ3JlZSgpKSwgZGx0SW52ZXJzZSk7CgkgICAgICAgICAgICAgICAgcSA9IHEuYWRkT3JTdWJ0cmFjdChmaWVsZC5idWlsZE1vbm9taWFsKGRlZ3JlZURpZmYsIHNjYWxlKSk7CgkgICAgICAgICAgICAgICAgciA9IHIuYWRkT3JTdWJ0cmFjdChyTGFzdC5tdWx0aXBseUJ5TW9ub21pYWwoZGVncmVlRGlmZiwgc2NhbGUpKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHQgPSBxLm11bHRpcGx5KHRMYXN0KS5hZGRPclN1YnRyYWN0KHRMYXN0TGFzdCk7CgkgICAgICAgICAgICBpZiAoci5nZXREZWdyZWUoKSA+PSByTGFzdC5nZXREZWdyZWUoKSkgewoJICAgICAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsU3RhdGVFeGNlcHRpb25fMS5kZWZhdWx0KCdEaXZpc2lvbiBhbGdvcml0aG0gZmFpbGVkIHRvIHJlZHVjZSBwb2x5bm9taWFsPycpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHZhciBzaWdtYVRpbGRlQXRaZXJvID0gdC5nZXRDb2VmZmljaWVudCgwKTsKCSAgICAgICAgaWYgKHNpZ21hVGlsZGVBdFplcm8gPT09IDApIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBSZWVkU29sb21vbkV4Y2VwdGlvbl8xLmRlZmF1bHQoJ3NpZ21hVGlsZGUoMCkgd2FzIHplcm8nKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgaW52ZXJzZSA9IGZpZWxkLmludmVyc2Uoc2lnbWFUaWxkZUF0WmVybyk7CgkgICAgICAgIHZhciBzaWdtYSA9IHQubXVsdGlwbHlTY2FsYXIoaW52ZXJzZSk7CgkgICAgICAgIHZhciBvbWVnYSA9IHIubXVsdGlwbHlTY2FsYXIoaW52ZXJzZSk7CgkgICAgICAgIHJldHVybiBbc2lnbWEsIG9tZWdhXTsKCSAgICB9OwoJICAgIFJlZWRTb2xvbW9uRGVjb2Rlci5wcm90b3R5cGUuZmluZEVycm9yTG9jYXRpb25zID0gZnVuY3Rpb24gKGVycm9yTG9jYXRvcikgewoJICAgICAgICAvLyBUaGlzIGlzIGEgZGlyZWN0IGFwcGxpY2F0aW9uIG9mIENoaWVuJ3Mgc2VhcmNoCgkgICAgICAgIHZhciBudW1FcnJvcnMgPSBlcnJvckxvY2F0b3IuZ2V0RGVncmVlKCk7CgkgICAgICAgIGlmIChudW1FcnJvcnMgPT09IDEpIHsgLy8gc2hvcnRjdXQKCSAgICAgICAgICAgIHJldHVybiBJbnQzMkFycmF5LmZyb20oW2Vycm9yTG9jYXRvci5nZXRDb2VmZmljaWVudCgxKV0pOwoJICAgICAgICB9CgkgICAgICAgIHZhciByZXN1bHQgPSBuZXcgSW50MzJBcnJheShudW1FcnJvcnMpOwoJICAgICAgICB2YXIgZSA9IDA7CgkgICAgICAgIHZhciBmaWVsZCA9IHRoaXMuZmllbGQ7CgkgICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgZmllbGQuZ2V0U2l6ZSgpICYmIGUgPCBudW1FcnJvcnM7IGkrKykgewoJICAgICAgICAgICAgaWYgKGVycm9yTG9jYXRvci5ldmFsdWF0ZUF0KGkpID09PSAwKSB7CgkgICAgICAgICAgICAgICAgcmVzdWx0W2VdID0gZmllbGQuaW52ZXJzZShpKTsKCSAgICAgICAgICAgICAgICBlKys7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGUgIT09IG51bUVycm9ycykgewoJICAgICAgICAgICAgdGhyb3cgbmV3IFJlZWRTb2xvbW9uRXhjZXB0aW9uXzEuZGVmYXVsdCgnRXJyb3IgbG9jYXRvciBkZWdyZWUgZG9lcyBub3QgbWF0Y2ggbnVtYmVyIG9mIHJvb3RzJyk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICB9OwoJICAgIFJlZWRTb2xvbW9uRGVjb2Rlci5wcm90b3R5cGUuZmluZEVycm9yTWFnbml0dWRlcyA9IGZ1bmN0aW9uIChlcnJvckV2YWx1YXRvciwgZXJyb3JMb2NhdGlvbnMpIHsKCSAgICAgICAgLy8gVGhpcyBpcyBkaXJlY3RseSBhcHBseWluZyBGb3JuZXkncyBGb3JtdWxhCgkgICAgICAgIHZhciBzID0gZXJyb3JMb2NhdGlvbnMubGVuZ3RoOwoJICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IEludDMyQXJyYXkocyk7CgkgICAgICAgIHZhciBmaWVsZCA9IHRoaXMuZmllbGQ7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgczsgaSsrKSB7CgkgICAgICAgICAgICB2YXIgeGlJbnZlcnNlID0gZmllbGQuaW52ZXJzZShlcnJvckxvY2F0aW9uc1tpXSk7CgkgICAgICAgICAgICB2YXIgZGVub21pbmF0b3IgPSAxOwoJICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBzOyBqKyspIHsKCSAgICAgICAgICAgICAgICBpZiAoaSAhPT0gaikgewoJICAgICAgICAgICAgICAgICAgICAvLyBkZW5vbWluYXRvciA9IGZpZWxkLm11bHRpcGx5KGRlbm9taW5hdG9yLAoJICAgICAgICAgICAgICAgICAgICAvLyAgICBHZW5lcmljR0YuYWRkT3JTdWJ0cmFjdCgxLCBmaWVsZC5tdWx0aXBseShlcnJvckxvY2F0aW9uc1tqXSwgeGlJbnZlcnNlKSkpCgkgICAgICAgICAgICAgICAgICAgIC8vIEFib3ZlIHNob3VsZCB3b3JrIGJ1dCBmYWlscyBvbiBzb21lIEFwcGxlIGFuZCBMaW51eCBKREtzIGR1ZSB0byBhIEhvdHNwb3QgYnVnLgoJICAgICAgICAgICAgICAgICAgICAvLyBCZWxvdyBpcyBhIGZ1bm55LWxvb2tpbmcgd29ya2Fyb3VuZCBmcm9tIFN0ZXZlbiBQYXJrZXMKCSAgICAgICAgICAgICAgICAgICAgdmFyIHRlcm0gPSBmaWVsZC5tdWx0aXBseShlcnJvckxvY2F0aW9uc1tqXSwgeGlJbnZlcnNlKTsKCSAgICAgICAgICAgICAgICAgICAgdmFyIHRlcm1QbHVzMSA9ICh0ZXJtICYgMHgxKSA9PT0gMCA/IHRlcm0gfCAxIDogdGVybSAmIH4xOwoJICAgICAgICAgICAgICAgICAgICBkZW5vbWluYXRvciA9IGZpZWxkLm11bHRpcGx5KGRlbm9taW5hdG9yLCB0ZXJtUGx1czEpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHJlc3VsdFtpXSA9IGZpZWxkLm11bHRpcGx5KGVycm9yRXZhbHVhdG9yLmV2YWx1YXRlQXQoeGlJbnZlcnNlKSwgZmllbGQuaW52ZXJzZShkZW5vbWluYXRvcikpOwoJICAgICAgICAgICAgaWYgKGZpZWxkLmdldEdlbmVyYXRvckJhc2UoKSAhPT0gMCkgewoJICAgICAgICAgICAgICAgIHJlc3VsdFtpXSA9IGZpZWxkLm11bHRpcGx5KHJlc3VsdFtpXSwgeGlJbnZlcnNlKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gcmVzdWx0OwoJICAgIH07CgkgICAgcmV0dXJuIFJlZWRTb2xvbW9uRGVjb2RlcjsKCX0oKSk7CglSZWVkU29sb21vbkRlY29kZXIkMS5kZWZhdWx0ID0gUmVlZFNvbG9tb25EZWNvZGVyOwoKCXZhciBCaXRNYXRyaXhQYXJzZXIkMSA9IHt9OwoKCXZhciBWZXJzaW9uJDEgPSB7fTsKCgl2YXIgRm9ybWF0SW5mb3JtYXRpb24kMSA9IHt9OwoKCXZhciBFcnJvckNvcnJlY3Rpb25MZXZlbCA9IHt9OwoKCXZhciBBcmd1bWVudEV4Y2VwdGlvbiQxID0ge307CgoJdmFyIF9fZXh0ZW5kcyQzID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHsKCSAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwKCSAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHwKCSAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9OwoJICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICB9OwoJICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH0KCSAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpOwoJICAgIH07Cgl9KSgpOwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEFyZ3VtZW50RXhjZXB0aW9uJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBFeGNlcHRpb25fMSA9IEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBDdXN0b20gRXJyb3IgY2xhc3Mgb2YgdHlwZSBFeGNlcHRpb24uCgkgKi8KCXZhciBBcmd1bWVudEV4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkMyhBcmd1bWVudEV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBBcmd1bWVudEV4Y2VwdGlvbigpIHsKCSAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwoJICAgIH0KCSAgICBBcmd1bWVudEV4Y2VwdGlvbi5raW5kID0gJ0FyZ3VtZW50RXhjZXB0aW9uJzsKCSAgICByZXR1cm4gQXJndW1lbnRFeGNlcHRpb247Cgl9KEV4Y2VwdGlvbl8xLmRlZmF1bHQpKTsKCUFyZ3VtZW50RXhjZXB0aW9uJDEuZGVmYXVsdCA9IEFyZ3VtZW50RXhjZXB0aW9uOwoKCShmdW5jdGlvbiAoZXhwb3J0cykgewoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CglleHBvcnRzLkVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzID0gdm9pZCAwOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5xcmNvZGUuZGVjb2RlciB7Ki8KCXZhciBBcmd1bWVudEV4Y2VwdGlvbl8xID0gQXJndW1lbnRFeGNlcHRpb24kMTsKCXZhciBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSA9IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiQxOwoJdmFyIEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzOwoJKGZ1bmN0aW9uIChFcnJvckNvcnJlY3Rpb25MZXZlbFZhbHVlcykgewoJICAgIEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzW0Vycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzWyJMIl0gPSAwXSA9ICJMIjsKCSAgICBFcnJvckNvcnJlY3Rpb25MZXZlbFZhbHVlc1tFcnJvckNvcnJlY3Rpb25MZXZlbFZhbHVlc1siTSJdID0gMV0gPSAiTSI7CgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWxWYWx1ZXNbRXJyb3JDb3JyZWN0aW9uTGV2ZWxWYWx1ZXNbIlEiXSA9IDJdID0gIlEiOwoJICAgIEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzW0Vycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzWyJIIl0gPSAzXSA9ICJIIjsKCX0pKEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzID0gZXhwb3J0cy5FcnJvckNvcnJlY3Rpb25MZXZlbFZhbHVlcyB8fCAoZXhwb3J0cy5FcnJvckNvcnJlY3Rpb25MZXZlbFZhbHVlcyA9IHt9KSk7CgkvKioKCSAqIDxwPlNlZSBJU08gMTgwMDQ6MjAwNiwgNi41LjEuIFRoaXMgZW51bSBlbmNhcHN1bGF0ZXMgdGhlIGZvdXIgZXJyb3IgY29ycmVjdGlvbiBsZXZlbHMKCSAqIGRlZmluZWQgYnkgdGhlIFFSIGNvZGUgc3RhbmRhcmQuPC9wPgoJICoKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBFcnJvckNvcnJlY3Rpb25MZXZlbCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBFcnJvckNvcnJlY3Rpb25MZXZlbCh2YWx1ZSwgc3RyaW5nVmFsdWUsIGJpdHMgLyppbnQqLykgewoJICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7CgkgICAgICAgIHRoaXMuc3RyaW5nVmFsdWUgPSBzdHJpbmdWYWx1ZTsKCSAgICAgICAgdGhpcy5iaXRzID0gYml0czsKCSAgICAgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwuRk9SX0JJVFMuc2V0KGJpdHMsIHRoaXMpOwoJICAgICAgICBFcnJvckNvcnJlY3Rpb25MZXZlbC5GT1JfVkFMVUUuc2V0KHZhbHVlLCB0aGlzKTsKCSAgICB9CgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwucHJvdG90eXBlLmdldFZhbHVlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy52YWx1ZTsKCSAgICB9OwoJICAgIEVycm9yQ29ycmVjdGlvbkxldmVsLnByb3RvdHlwZS5nZXRCaXRzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5iaXRzOwoJICAgIH07CgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwuZnJvbVN0cmluZyA9IGZ1bmN0aW9uIChzKSB7CgkgICAgICAgIHN3aXRjaCAocykgewoJICAgICAgICAgICAgY2FzZSAnTCc6IHJldHVybiBFcnJvckNvcnJlY3Rpb25MZXZlbC5MOwoJICAgICAgICAgICAgY2FzZSAnTSc6IHJldHVybiBFcnJvckNvcnJlY3Rpb25MZXZlbC5NOwoJICAgICAgICAgICAgY2FzZSAnUSc6IHJldHVybiBFcnJvckNvcnJlY3Rpb25MZXZlbC5ROwoJICAgICAgICAgICAgY2FzZSAnSCc6IHJldHVybiBFcnJvckNvcnJlY3Rpb25MZXZlbC5IOwoJICAgICAgICAgICAgZGVmYXVsdDogdGhyb3cgbmV3IEFyZ3VtZW50RXhjZXB0aW9uXzEuZGVmYXVsdChzICsgJ25vdCBhdmFpbGFibGUnKTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5zdHJpbmdWYWx1ZTsKCSAgICB9OwoJICAgIEVycm9yQ29ycmVjdGlvbkxldmVsLnByb3RvdHlwZS5lcXVhbHMgPSBmdW5jdGlvbiAobykgewoJICAgICAgICBpZiAoIShvIGluc3RhbmNlb2YgRXJyb3JDb3JyZWN0aW9uTGV2ZWwpKSB7CgkgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIG90aGVyID0gbzsKCSAgICAgICAgcmV0dXJuIHRoaXMudmFsdWUgPT09IG90aGVyLnZhbHVlOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHBhcmFtIGJpdHMgaW50IGNvbnRhaW5pbmcgdGhlIHR3byBiaXRzIGVuY29kaW5nIGEgUVIgQ29kZSdzIGVycm9yIGNvcnJlY3Rpb24gbGV2ZWwKCSAgICAgKiBAcmV0dXJuIEVycm9yQ29ycmVjdGlvbkxldmVsIHJlcHJlc2VudGluZyB0aGUgZW5jb2RlZCBlcnJvciBjb3JyZWN0aW9uIGxldmVsCgkgICAgICovCgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwuZm9yQml0cyA9IGZ1bmN0aW9uIChiaXRzIC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKGJpdHMgPCAwIHx8IGJpdHMgPj0gRXJyb3JDb3JyZWN0aW9uTGV2ZWwuRk9SX0JJVFMuc2l6ZSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gRXJyb3JDb3JyZWN0aW9uTGV2ZWwuRk9SX0JJVFMuZ2V0KGJpdHMpOwoJICAgIH07CgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwuRk9SX0JJVFMgPSBuZXcgTWFwKCk7CgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwuRk9SX1ZBTFVFID0gbmV3IE1hcCgpOwoJICAgIC8qKiBMID0gfjclIGNvcnJlY3Rpb24gKi8KCSAgICBFcnJvckNvcnJlY3Rpb25MZXZlbC5MID0gbmV3IEVycm9yQ29ycmVjdGlvbkxldmVsKEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzLkwsICdMJywgMHgwMSk7CgkgICAgLyoqIE0gPSB+MTUlIGNvcnJlY3Rpb24gKi8KCSAgICBFcnJvckNvcnJlY3Rpb25MZXZlbC5NID0gbmV3IEVycm9yQ29ycmVjdGlvbkxldmVsKEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzLk0sICdNJywgMHgwMCk7CgkgICAgLyoqIFEgPSB+MjUlIGNvcnJlY3Rpb24gKi8KCSAgICBFcnJvckNvcnJlY3Rpb25MZXZlbC5RID0gbmV3IEVycm9yQ29ycmVjdGlvbkxldmVsKEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzLlEsICdRJywgMHgwMyk7CgkgICAgLyoqIEggPSB+MzAlIGNvcnJlY3Rpb24gKi8KCSAgICBFcnJvckNvcnJlY3Rpb25MZXZlbC5IID0gbmV3IEVycm9yQ29ycmVjdGlvbkxldmVsKEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzLkgsICdIJywgMHgwMik7CgkgICAgcmV0dXJuIEVycm9yQ29ycmVjdGlvbkxldmVsOwoJfSgpKTsKCWV4cG9ydHMuZGVmYXVsdCA9IEVycm9yQ29ycmVjdGlvbkxldmVsOwoKCX0oRXJyb3JDb3JyZWN0aW9uTGV2ZWwpKTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fdmFsdWVzJDYgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX192YWx1ZXMpIHx8IGZ1bmN0aW9uKG8pIHsKCSAgICB2YXIgcyA9IHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgU3ltYm9sLml0ZXJhdG9yLCBtID0gcyAmJiBvW3NdLCBpID0gMDsKCSAgICBpZiAobSkgcmV0dXJuIG0uY2FsbChvKTsKCSAgICBpZiAobyAmJiB0eXBlb2Ygby5sZW5ndGggPT09ICJudW1iZXIiKSByZXR1cm4gewoJICAgICAgICBuZXh0OiBmdW5jdGlvbiAoKSB7CgkgICAgICAgICAgICBpZiAobyAmJiBpID49IG8ubGVuZ3RoKSBvID0gdm9pZCAwOwoJICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6IG8gJiYgb1tpKytdLCBkb25lOiAhbyB9OwoJICAgICAgICB9CgkgICAgfTsKCSAgICB0aHJvdyBuZXcgVHlwZUVycm9yKHMgPyAiT2JqZWN0IGlzIG5vdCBpdGVyYWJsZS4iIDogIlN5bWJvbC5pdGVyYXRvciBpcyBub3QgZGVmaW5lZC4iKTsKCX07CglPYmplY3QuZGVmaW5lUHJvcGVydHkoRm9ybWF0SW5mb3JtYXRpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5xcmNvZGUuZGVjb2RlciB7Ki8KCXZhciBFcnJvckNvcnJlY3Rpb25MZXZlbF8xID0gRXJyb3JDb3JyZWN0aW9uTGV2ZWw7Cgl2YXIgSW50ZWdlcl8xID0gSW50ZWdlciQxOwoJLyoqCgkgKiA8cD5FbmNhcHN1bGF0ZXMgYSBRUiBDb2RlJ3MgZm9ybWF0IGluZm9ybWF0aW9uLCBpbmNsdWRpbmcgdGhlIGRhdGEgbWFzayB1c2VkIGFuZAoJICogZXJyb3IgY29ycmVjdGlvbiBsZXZlbC48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqIEBzZWUgRGF0YU1hc2sKCSAqIEBzZWUgRXJyb3JDb3JyZWN0aW9uTGV2ZWwKCSAqLwoJdmFyIEZvcm1hdEluZm9ybWF0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIEZvcm1hdEluZm9ybWF0aW9uKGZvcm1hdEluZm8gLyppbnQqLykgewoJICAgICAgICAvLyBCaXRzIDMsNAoJICAgICAgICB0aGlzLmVycm9yQ29ycmVjdGlvbkxldmVsID0gRXJyb3JDb3JyZWN0aW9uTGV2ZWxfMS5kZWZhdWx0LmZvckJpdHMoKGZvcm1hdEluZm8gPj4gMykgJiAweDAzKTsKCSAgICAgICAgLy8gQm90dG9tIDMgYml0cwoJICAgICAgICB0aGlzLmRhdGFNYXNrID0gLyooYnl0ZSkgKi8gKGZvcm1hdEluZm8gJiAweDA3KTsKCSAgICB9CgkgICAgRm9ybWF0SW5mb3JtYXRpb24ubnVtQml0c0RpZmZlcmluZyA9IGZ1bmN0aW9uIChhIC8qaW50Ki8sIGIgLyppbnQqLykgewoJICAgICAgICByZXR1cm4gSW50ZWdlcl8xLmRlZmF1bHQuYml0Q291bnQoYSBeIGIpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHBhcmFtIG1hc2tlZEZvcm1hdEluZm8xIGZvcm1hdCBpbmZvIGluZGljYXRvciwgd2l0aCBtYXNrIHN0aWxsIGFwcGxpZWQKCSAgICAgKiBAcGFyYW0gbWFza2VkRm9ybWF0SW5mbzIgc2Vjb25kIGNvcHkgb2Ygc2FtZSBpbmZvOyBib3RoIGFyZSBjaGVja2VkIGF0IHRoZSBzYW1lIHRpbWUKCSAgICAgKiAgdG8gZXN0YWJsaXNoIGJlc3QgbWF0Y2gKCSAgICAgKiBAcmV0dXJuIGluZm9ybWF0aW9uIGFib3V0IHRoZSBmb3JtYXQgaXQgc3BlY2lmaWVzLCBvciB7QGNvZGUgbnVsbH0KCSAgICAgKiAgaWYgZG9lc24ndCBzZWVtIHRvIG1hdGNoIGFueSBrbm93biBwYXR0ZXJuCgkgICAgICovCgkgICAgRm9ybWF0SW5mb3JtYXRpb24uZGVjb2RlRm9ybWF0SW5mb3JtYXRpb24gPSBmdW5jdGlvbiAobWFza2VkRm9ybWF0SW5mbzEgLyppbnQqLywgbWFza2VkRm9ybWF0SW5mbzIgLyppbnQqLykgewoJICAgICAgICB2YXIgZm9ybWF0SW5mbyA9IEZvcm1hdEluZm9ybWF0aW9uLmRvRGVjb2RlRm9ybWF0SW5mb3JtYXRpb24obWFza2VkRm9ybWF0SW5mbzEsIG1hc2tlZEZvcm1hdEluZm8yKTsKCSAgICAgICAgaWYgKGZvcm1hdEluZm8gIT09IG51bGwpIHsKCSAgICAgICAgICAgIHJldHVybiBmb3JtYXRJbmZvOwoJICAgICAgICB9CgkgICAgICAgIC8vIFNob3VsZCByZXR1cm4gbnVsbCwgYnV0LCBzb21lIFFSIGNvZGVzIGFwcGFyZW50bHkKCSAgICAgICAgLy8gZG8gbm90IG1hc2sgdGhpcyBpbmZvLiBUcnkgYWdhaW4gYnkgYWN0dWFsbHkgbWFza2luZyB0aGUgcGF0dGVybgoJICAgICAgICAvLyBmaXJzdAoJICAgICAgICByZXR1cm4gRm9ybWF0SW5mb3JtYXRpb24uZG9EZWNvZGVGb3JtYXRJbmZvcm1hdGlvbihtYXNrZWRGb3JtYXRJbmZvMSBeIEZvcm1hdEluZm9ybWF0aW9uLkZPUk1BVF9JTkZPX01BU0tfUVIsIG1hc2tlZEZvcm1hdEluZm8yIF4gRm9ybWF0SW5mb3JtYXRpb24uRk9STUFUX0lORk9fTUFTS19RUik7CgkgICAgfTsKCSAgICBGb3JtYXRJbmZvcm1hdGlvbi5kb0RlY29kZUZvcm1hdEluZm9ybWF0aW9uID0gZnVuY3Rpb24gKG1hc2tlZEZvcm1hdEluZm8xIC8qaW50Ki8sIG1hc2tlZEZvcm1hdEluZm8yIC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIGVfMSwgX2E7CgkgICAgICAgIC8vIEZpbmQgdGhlIGludCBpbiBGT1JNQVRfSU5GT19ERUNPREVfTE9PS1VQIHdpdGggZmV3ZXN0IGJpdHMgZGlmZmVyaW5nCgkgICAgICAgIHZhciBiZXN0RGlmZmVyZW5jZSA9IE51bWJlci5NQVhfU0FGRV9JTlRFR0VSOwoJICAgICAgICB2YXIgYmVzdEZvcm1hdEluZm8gPSAwOwoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgZm9yICh2YXIgX2IgPSBfX3ZhbHVlcyQ2KEZvcm1hdEluZm9ybWF0aW9uLkZPUk1BVF9JTkZPX0RFQ09ERV9MT09LVVApLCBfYyA9IF9iLm5leHQoKTsgIV9jLmRvbmU7IF9jID0gX2IubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgdmFyIGRlY29kZUluZm8gPSBfYy52YWx1ZTsKCSAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0SW5mbyA9IGRlY29kZUluZm9bMF07CgkgICAgICAgICAgICAgICAgaWYgKHRhcmdldEluZm8gPT09IG1hc2tlZEZvcm1hdEluZm8xIHx8IHRhcmdldEluZm8gPT09IG1hc2tlZEZvcm1hdEluZm8yKSB7CgkgICAgICAgICAgICAgICAgICAgIC8vIEZvdW5kIGFuIGV4YWN0IG1hdGNoCgkgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRm9ybWF0SW5mb3JtYXRpb24oZGVjb2RlSW5mb1sxXSk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIHZhciBiaXRzRGlmZmVyZW5jZSA9IEZvcm1hdEluZm9ybWF0aW9uLm51bUJpdHNEaWZmZXJpbmcobWFza2VkRm9ybWF0SW5mbzEsIHRhcmdldEluZm8pOwoJICAgICAgICAgICAgICAgIGlmIChiaXRzRGlmZmVyZW5jZSA8IGJlc3REaWZmZXJlbmNlKSB7CgkgICAgICAgICAgICAgICAgICAgIGJlc3RGb3JtYXRJbmZvID0gZGVjb2RlSW5mb1sxXTsKCSAgICAgICAgICAgICAgICAgICAgYmVzdERpZmZlcmVuY2UgPSBiaXRzRGlmZmVyZW5jZTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgaWYgKG1hc2tlZEZvcm1hdEluZm8xICE9PSBtYXNrZWRGb3JtYXRJbmZvMikgewoJICAgICAgICAgICAgICAgICAgICAvLyBhbHNvIHRyeSB0aGUgb3RoZXIgb3B0aW9uCgkgICAgICAgICAgICAgICAgICAgIGJpdHNEaWZmZXJlbmNlID0gRm9ybWF0SW5mb3JtYXRpb24ubnVtQml0c0RpZmZlcmluZyhtYXNrZWRGb3JtYXRJbmZvMiwgdGFyZ2V0SW5mbyk7CgkgICAgICAgICAgICAgICAgICAgIGlmIChiaXRzRGlmZmVyZW5jZSA8IGJlc3REaWZmZXJlbmNlKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBiZXN0Rm9ybWF0SW5mbyA9IGRlY29kZUluZm9bMV07CgkgICAgICAgICAgICAgICAgICAgICAgICBiZXN0RGlmZmVyZW5jZSA9IGJpdHNEaWZmZXJlbmNlOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChlXzFfMSkgeyBlXzEgPSB7IGVycm9yOiBlXzFfMSB9OyB9CgkgICAgICAgIGZpbmFsbHkgewoJICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICBpZiAoX2MgJiYgIV9jLmRvbmUgJiYgKF9hID0gX2IucmV0dXJuKSkgX2EuY2FsbChfYik7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMSkgdGhyb3cgZV8xLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gSGFtbWluZyBkaXN0YW5jZSBvZiB0aGUgMzIgbWFza2VkIGNvZGVzIGlzIDcsIGJ5IGNvbnN0cnVjdGlvbiwgc28gPD0gMyBiaXRzCgkgICAgICAgIC8vIGRpZmZlcmluZyBtZWFucyB3ZSBmb3VuZCBhIG1hdGNoCgkgICAgICAgIGlmIChiZXN0RGlmZmVyZW5jZSA8PSAzKSB7CgkgICAgICAgICAgICByZXR1cm4gbmV3IEZvcm1hdEluZm9ybWF0aW9uKGJlc3RGb3JtYXRJbmZvKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gbnVsbDsKCSAgICB9OwoJICAgIEZvcm1hdEluZm9ybWF0aW9uLnByb3RvdHlwZS5nZXRFcnJvckNvcnJlY3Rpb25MZXZlbCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuZXJyb3JDb3JyZWN0aW9uTGV2ZWw7CgkgICAgfTsKCSAgICBGb3JtYXRJbmZvcm1hdGlvbi5wcm90b3R5cGUuZ2V0RGF0YU1hc2sgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmRhdGFNYXNrOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEZvcm1hdEluZm9ybWF0aW9uLnByb3RvdHlwZS5oYXNoQ29kZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuICh0aGlzLmVycm9yQ29ycmVjdGlvbkxldmVsLmdldEJpdHMoKSA8PCAzKSB8IHRoaXMuZGF0YU1hc2s7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgRm9ybWF0SW5mb3JtYXRpb24ucHJvdG90eXBlLmVxdWFscyA9IGZ1bmN0aW9uIChvKSB7CgkgICAgICAgIGlmICghKG8gaW5zdGFuY2VvZiBGb3JtYXRJbmZvcm1hdGlvbikpIHsKCSAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgb3RoZXIgPSBvOwoJICAgICAgICByZXR1cm4gdGhpcy5lcnJvckNvcnJlY3Rpb25MZXZlbCA9PT0gb3RoZXIuZXJyb3JDb3JyZWN0aW9uTGV2ZWwgJiYKCSAgICAgICAgICAgIHRoaXMuZGF0YU1hc2sgPT09IG90aGVyLmRhdGFNYXNrOwoJICAgIH07CgkgICAgRm9ybWF0SW5mb3JtYXRpb24uRk9STUFUX0lORk9fTUFTS19RUiA9IDB4NTQxMjsKCSAgICAvKioKCSAgICAgKiBTZWUgSVNPIDE4MDA0OjIwMDYsIEFubmV4IEMsIFRhYmxlIEMuMQoJICAgICAqLwoJICAgIEZvcm1hdEluZm9ybWF0aW9uLkZPUk1BVF9JTkZPX0RFQ09ERV9MT09LVVAgPSBbCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg1NDEyLCAweDAwXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg1MTI1LCAweDAxXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg1RTdDLCAweDAyXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg1QjRCLCAweDAzXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg0NUY5LCAweDA0XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg0MENFLCAweDA1XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg0Rjk3LCAweDA2XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg0QUEwLCAweDA3XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg3N0M0LCAweDA4XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg3MkYzLCAweDA5XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg3REFBLCAweDBBXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg3ODlELCAweDBCXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg2NjJGLCAweDBDXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg2MzE4LCAweDBEXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg2QzQxLCAweDBFXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg2OTc2LCAweDBGXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgxNjg5LCAweDEwXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgxM0JFLCAweDExXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgxQ0U3LCAweDEyXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgxOUQwLCAweDEzXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgwNzYyLCAweDE0XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgwMjU1LCAweDE1XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgwRDBDLCAweDE2XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgwODNCLCAweDE3XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgzNTVGLCAweDE4XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgzMDY4LCAweDE5XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgzRjMxLCAweDFBXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgzQTA2LCAweDFCXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgyNEI0LCAweDFDXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgyMTgzLCAweDFEXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgyRURBLCAweDFFXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgyQkVELCAweDFGXSksCgkgICAgXTsKCSAgICByZXR1cm4gRm9ybWF0SW5mb3JtYXRpb247Cgl9KCkpOwoJRm9ybWF0SW5mb3JtYXRpb24kMS5kZWZhdWx0ID0gRm9ybWF0SW5mb3JtYXRpb247CgoJdmFyIEVDQmxvY2tzJDEgPSB7fTsKCgl2YXIgX192YWx1ZXMkNSA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX3ZhbHVlcykgfHwgZnVuY3Rpb24obykgewoJICAgIHZhciBzID0gdHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiBTeW1ib2wuaXRlcmF0b3IsIG0gPSBzICYmIG9bc10sIGkgPSAwOwoJICAgIGlmIChtKSByZXR1cm4gbS5jYWxsKG8pOwoJICAgIGlmIChvICYmIHR5cGVvZiBvLmxlbmd0aCA9PT0gIm51bWJlciIpIHJldHVybiB7CgkgICAgICAgIG5leHQ6IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgICAgIGlmIChvICYmIGkgPj0gby5sZW5ndGgpIG8gPSB2b2lkIDA7CgkgICAgICAgICAgICByZXR1cm4geyB2YWx1ZTogbyAmJiBvW2krK10sIGRvbmU6ICFvIH07CgkgICAgICAgIH0KCSAgICB9OwoJICAgIHRocm93IG5ldyBUeXBlRXJyb3IocyA/ICJPYmplY3QgaXMgbm90IGl0ZXJhYmxlLiIgOiAiU3ltYm9sLml0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLiIpOwoJfTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShFQ0Jsb2NrcyQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKioKCSAqIDxwPkVuY2Fwc3VsYXRlcyBhIHNldCBvZiBlcnJvci1jb3JyZWN0aW9uIGJsb2NrcyBpbiBvbmUgc3ltYm9sIHZlcnNpb24uIE1vc3QgdmVyc2lvbnMgd2lsbAoJICogdXNlIGJsb2NrcyBvZiBkaWZmZXJpbmcgc2l6ZXMgd2l0aGluIG9uZSB2ZXJzaW9uLCBzbywgdGhpcyBlbmNhcHN1bGF0ZXMgdGhlIHBhcmFtZXRlcnMgZm9yCgkgKiBlYWNoIHNldCBvZiBibG9ja3MuIEl0IGFsc28gaG9sZHMgdGhlIG51bWJlciBvZiBlcnJvci1jb3JyZWN0aW9uIGNvZGV3b3JkcyBwZXIgYmxvY2sgc2luY2UgaXQKCSAqIHdpbGwgYmUgdGhlIHNhbWUgYWNyb3NzIGFsbCBibG9ja3Mgd2l0aGluIG9uZSB2ZXJzaW9uLjwvcD4KCSAqLwoJdmFyIEVDQmxvY2tzID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIEVDQmxvY2tzKGVjQ29kZXdvcmRzUGVyQmxvY2sgLyppbnQqLykgewoJICAgICAgICB2YXIgZWNCbG9ja3MgPSBbXTsKCSAgICAgICAgZm9yICh2YXIgX2kgPSAxOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHsKCSAgICAgICAgICAgIGVjQmxvY2tzW19pIC0gMV0gPSBhcmd1bWVudHNbX2ldOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMuZWNDb2Rld29yZHNQZXJCbG9jayA9IGVjQ29kZXdvcmRzUGVyQmxvY2s7CgkgICAgICAgIHRoaXMuZWNCbG9ja3MgPSBlY0Jsb2NrczsKCSAgICB9CgkgICAgRUNCbG9ja3MucHJvdG90eXBlLmdldEVDQ29kZXdvcmRzUGVyQmxvY2sgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmVjQ29kZXdvcmRzUGVyQmxvY2s7CgkgICAgfTsKCSAgICBFQ0Jsb2Nrcy5wcm90b3R5cGUuZ2V0TnVtQmxvY2tzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgZV8xLCBfYTsKCSAgICAgICAgdmFyIHRvdGFsID0gMDsKCSAgICAgICAgdmFyIGVjQmxvY2tzID0gdGhpcy5lY0Jsb2NrczsKCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIGZvciAodmFyIGVjQmxvY2tzXzEgPSBfX3ZhbHVlcyQ1KGVjQmxvY2tzKSwgZWNCbG9ja3NfMV8xID0gZWNCbG9ja3NfMS5uZXh0KCk7ICFlY0Jsb2Nrc18xXzEuZG9uZTsgZWNCbG9ja3NfMV8xID0gZWNCbG9ja3NfMS5uZXh0KCkpIHsKCSAgICAgICAgICAgICAgICB2YXIgZWNCbG9jayA9IGVjQmxvY2tzXzFfMS52YWx1ZTsKCSAgICAgICAgICAgICAgICB0b3RhbCArPSBlY0Jsb2NrLmdldENvdW50KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGVfMV8xKSB7IGVfMSA9IHsgZXJyb3I6IGVfMV8xIH07IH0KCSAgICAgICAgZmluYWxseSB7CgkgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgIGlmIChlY0Jsb2Nrc18xXzEgJiYgIWVjQmxvY2tzXzFfMS5kb25lICYmIChfYSA9IGVjQmxvY2tzXzEucmV0dXJuKSkgX2EuY2FsbChlY0Jsb2Nrc18xKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGZpbmFsbHkgeyBpZiAoZV8xKSB0aHJvdyBlXzEuZXJyb3I7IH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gdG90YWw7CgkgICAgfTsKCSAgICBFQ0Jsb2Nrcy5wcm90b3R5cGUuZ2V0VG90YWxFQ0NvZGV3b3JkcyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuZWNDb2Rld29yZHNQZXJCbG9jayAqIHRoaXMuZ2V0TnVtQmxvY2tzKCk7CgkgICAgfTsKCSAgICBFQ0Jsb2Nrcy5wcm90b3R5cGUuZ2V0RUNCbG9ja3MgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmVjQmxvY2tzOwoJICAgIH07CgkgICAgcmV0dXJuIEVDQmxvY2tzOwoJfSgpKTsKCUVDQmxvY2tzJDEuZGVmYXVsdCA9IEVDQmxvY2tzOwoKCXZhciBFQ0IkMSA9IHt9OwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShFQ0IkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLyoqCgkgKiA8cD5FbmNhcHN1bGF0ZXMgdGhlIHBhcmFtZXRlcnMgZm9yIG9uZSBlcnJvci1jb3JyZWN0aW9uIGJsb2NrIGluIG9uZSBzeW1ib2wgdmVyc2lvbi4KCSAqIFRoaXMgaW5jbHVkZXMgdGhlIG51bWJlciBvZiBkYXRhIGNvZGV3b3JkcywgYW5kIHRoZSBudW1iZXIgb2YgdGltZXMgYSBibG9jayB3aXRoIHRoZXNlCgkgKiBwYXJhbWV0ZXJzIGlzIHVzZWQgY29uc2VjdXRpdmVseSBpbiB0aGUgUVIgY29kZSB2ZXJzaW9uJ3MgZm9ybWF0LjwvcD4KCSAqLwoJdmFyIEVDQiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBFQ0IoY291bnQgLyppbnQqLywgZGF0YUNvZGV3b3JkcyAvKmludCovKSB7CgkgICAgICAgIHRoaXMuY291bnQgPSBjb3VudDsKCSAgICAgICAgdGhpcy5kYXRhQ29kZXdvcmRzID0gZGF0YUNvZGV3b3JkczsKCSAgICB9CgkgICAgRUNCLnByb3RvdHlwZS5nZXRDb3VudCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuY291bnQ7CgkgICAgfTsKCSAgICBFQ0IucHJvdG90eXBlLmdldERhdGFDb2Rld29yZHMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmRhdGFDb2Rld29yZHM7CgkgICAgfTsKCSAgICByZXR1cm4gRUNCOwoJfSgpKTsKCUVDQiQxLmRlZmF1bHQgPSBFQ0I7CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCXZhciBfX3ZhbHVlcyQ0ID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fdmFsdWVzKSB8fCBmdW5jdGlvbihvKSB7CgkgICAgdmFyIHMgPSB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIFN5bWJvbC5pdGVyYXRvciwgbSA9IHMgJiYgb1tzXSwgaSA9IDA7CgkgICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7CgkgICAgaWYgKG8gJiYgdHlwZW9mIG8ubGVuZ3RoID09PSAibnVtYmVyIikgcmV0dXJuIHsKCSAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkgewoJICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDsKCSAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihzID8gIk9iamVjdCBpcyBub3QgaXRlcmFibGUuIiA6ICJTeW1ib2wuaXRlcmF0b3IgaXMgbm90IGRlZmluZWQuIik7Cgl9OwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KFZlcnNpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5xcmNvZGUuZGVjb2RlciB7Ki8KCXZhciBCaXRNYXRyaXhfMSQzID0gQml0TWF0cml4JDE7Cgl2YXIgRm9ybWF0SW5mb3JtYXRpb25fMSQxID0gRm9ybWF0SW5mb3JtYXRpb24kMTsKCXZhciBFQ0Jsb2Nrc18xID0gRUNCbG9ja3MkMTsKCXZhciBFQ0JfMSA9IEVDQiQxOwoJdmFyIEZvcm1hdEV4Y2VwdGlvbl8xJDIgPSBGb3JtYXRFeGNlcHRpb24kMTsKCXZhciBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQyID0gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uJDE7CgkvKioKCSAqIFNlZSBJU08gMTgwMDQ6MjAwNiBBbm5leCBECgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIFZlcnNpb24gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gVmVyc2lvbih2ZXJzaW9uTnVtYmVyIC8qaW50Ki8sIGFsaWdubWVudFBhdHRlcm5DZW50ZXJzKSB7CgkgICAgICAgIHZhciBlXzEsIF9hOwoJICAgICAgICB2YXIgZWNCbG9ja3MgPSBbXTsKCSAgICAgICAgZm9yICh2YXIgX2kgPSAyOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHsKCSAgICAgICAgICAgIGVjQmxvY2tzW19pIC0gMl0gPSBhcmd1bWVudHNbX2ldOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMudmVyc2lvbk51bWJlciA9IHZlcnNpb25OdW1iZXI7CgkgICAgICAgIHRoaXMuYWxpZ25tZW50UGF0dGVybkNlbnRlcnMgPSBhbGlnbm1lbnRQYXR0ZXJuQ2VudGVyczsKCSAgICAgICAgdGhpcy5lY0Jsb2NrcyA9IGVjQmxvY2tzOwoJICAgICAgICB2YXIgdG90YWwgPSAwOwoJICAgICAgICB2YXIgZWNDb2Rld29yZHMgPSBlY0Jsb2Nrc1swXS5nZXRFQ0NvZGV3b3Jkc1BlckJsb2NrKCk7CgkgICAgICAgIHZhciBlY2JBcnJheSA9IGVjQmxvY2tzWzBdLmdldEVDQmxvY2tzKCk7CgkgICAgICAgIHRyeSB7CgkgICAgICAgICAgICBmb3IgKHZhciBlY2JBcnJheV8xID0gX192YWx1ZXMkNChlY2JBcnJheSksIGVjYkFycmF5XzFfMSA9IGVjYkFycmF5XzEubmV4dCgpOyAhZWNiQXJyYXlfMV8xLmRvbmU7IGVjYkFycmF5XzFfMSA9IGVjYkFycmF5XzEubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgdmFyIGVjQmxvY2sgPSBlY2JBcnJheV8xXzEudmFsdWU7CgkgICAgICAgICAgICAgICAgdG90YWwgKz0gZWNCbG9jay5nZXRDb3VudCgpICogKGVjQmxvY2suZ2V0RGF0YUNvZGV3b3JkcygpICsgZWNDb2Rld29yZHMpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChlXzFfMSkgeyBlXzEgPSB7IGVycm9yOiBlXzFfMSB9OyB9CgkgICAgICAgIGZpbmFsbHkgewoJICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICBpZiAoZWNiQXJyYXlfMV8xICYmICFlY2JBcnJheV8xXzEuZG9uZSAmJiAoX2EgPSBlY2JBcnJheV8xLnJldHVybikpIF9hLmNhbGwoZWNiQXJyYXlfMSk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMSkgdGhyb3cgZV8xLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgdGhpcy50b3RhbENvZGV3b3JkcyA9IHRvdGFsOwoJICAgIH0KCSAgICBWZXJzaW9uLnByb3RvdHlwZS5nZXRWZXJzaW9uTnVtYmVyID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy52ZXJzaW9uTnVtYmVyOwoJICAgIH07CgkgICAgVmVyc2lvbi5wcm90b3R5cGUuZ2V0QWxpZ25tZW50UGF0dGVybkNlbnRlcnMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmFsaWdubWVudFBhdHRlcm5DZW50ZXJzOwoJICAgIH07CgkgICAgVmVyc2lvbi5wcm90b3R5cGUuZ2V0VG90YWxDb2Rld29yZHMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnRvdGFsQ29kZXdvcmRzOwoJICAgIH07CgkgICAgVmVyc2lvbi5wcm90b3R5cGUuZ2V0RGltZW5zaW9uRm9yVmVyc2lvbiA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIDE3ICsgNCAqIHRoaXMudmVyc2lvbk51bWJlcjsKCSAgICB9OwoJICAgIFZlcnNpb24ucHJvdG90eXBlLmdldEVDQmxvY2tzRm9yTGV2ZWwgPSBmdW5jdGlvbiAoZWNMZXZlbCkgewoJICAgICAgICByZXR1cm4gdGhpcy5lY0Jsb2Nrc1tlY0xldmVsLmdldFZhbHVlKCldOwoJICAgICAgICAvLyBUWVBFU0NSSVBUUE9SVDogb3JpZ2luYWwgd2FzIHVzaW5nIG9yZGluYWwsIGFuZCB1c2luZyB0aGUgb3JkZXIgb2YgbGV2ZWxzIGFzIGRlZmluZWQgaW4gRXJyb3JDb3JyZWN0aW9uTGV2ZWwgZW51bSAoTE1RSCkKCSAgICAgICAgLy8gSSB3aWxsIHVzZSB0aGUgZGlyZWN0IHZhbHVlIGZyb20gRXJyb3JDb3JyZWN0aW9uTGV2ZWxWYWx1ZXMgZW51bSB3aGljaCBpbiB0eXBlc2NyaXB0IGdvZXMgdG8gYSBudW1iZXIKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPkRlZHVjZXMgdmVyc2lvbiBpbmZvcm1hdGlvbiBwdXJlbHkgZnJvbSBRUiBDb2RlIGRpbWVuc2lvbnMuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGRpbWVuc2lvbiBkaW1lbnNpb24gaW4gbW9kdWxlcwoJICAgICAqIEByZXR1cm4gVmVyc2lvbiBmb3IgYSBRUiBDb2RlIG9mIHRoYXQgZGltZW5zaW9uCgkgICAgICogQHRocm93cyBGb3JtYXRFeGNlcHRpb24gaWYgZGltZW5zaW9uIGlzIG5vdCAxIG1vZCA0CgkgICAgICovCgkgICAgVmVyc2lvbi5nZXRQcm92aXNpb25hbFZlcnNpb25Gb3JEaW1lbnNpb24gPSBmdW5jdGlvbiAoZGltZW5zaW9uIC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKGRpbWVuc2lvbiAlIDQgIT09IDEpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBGb3JtYXRFeGNlcHRpb25fMSQyLmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0VmVyc2lvbkZvck51bWJlcigoZGltZW5zaW9uIC0gMTcpIC8gNCk7CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGlnbm9yZWQgLyo6IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiovKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEkMi5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIFZlcnNpb24uZ2V0VmVyc2lvbkZvck51bWJlciA9IGZ1bmN0aW9uICh2ZXJzaW9uTnVtYmVyIC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKHZlcnNpb25OdW1iZXIgPCAxIHx8IHZlcnNpb25OdW1iZXIgPiA0MCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDIuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBWZXJzaW9uLlZFUlNJT05TW3ZlcnNpb25OdW1iZXIgLSAxXTsKCSAgICB9OwoJICAgIFZlcnNpb24uZGVjb2RlVmVyc2lvbkluZm9ybWF0aW9uID0gZnVuY3Rpb24gKHZlcnNpb25CaXRzIC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIGJlc3REaWZmZXJlbmNlID0gTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVI7CgkgICAgICAgIHZhciBiZXN0VmVyc2lvbiA9IDA7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgVmVyc2lvbi5WRVJTSU9OX0RFQ09ERV9JTkZPLmxlbmd0aDsgaSsrKSB7CgkgICAgICAgICAgICB2YXIgdGFyZ2V0VmVyc2lvbiA9IFZlcnNpb24uVkVSU0lPTl9ERUNPREVfSU5GT1tpXTsKCSAgICAgICAgICAgIC8vIERvIHRoZSB2ZXJzaW9uIGluZm8gYml0cyBtYXRjaCBleGFjdGx5PyBkb25lLgoJICAgICAgICAgICAgaWYgKHRhcmdldFZlcnNpb24gPT09IHZlcnNpb25CaXRzKSB7CgkgICAgICAgICAgICAgICAgcmV0dXJuIFZlcnNpb24uZ2V0VmVyc2lvbkZvck51bWJlcihpICsgNyk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICAvLyBPdGhlcndpc2Ugc2VlIGlmIHRoaXMgaXMgdGhlIGNsb3Nlc3QgdG8gYSByZWFsIHZlcnNpb24gaW5mbyBiaXQgc3RyaW5nCgkgICAgICAgICAgICAvLyB3ZSBoYXZlIHNlZW4gc28gZmFyCgkgICAgICAgICAgICB2YXIgYml0c0RpZmZlcmVuY2UgPSBGb3JtYXRJbmZvcm1hdGlvbl8xJDEuZGVmYXVsdC5udW1CaXRzRGlmZmVyaW5nKHZlcnNpb25CaXRzLCB0YXJnZXRWZXJzaW9uKTsKCSAgICAgICAgICAgIGlmIChiaXRzRGlmZmVyZW5jZSA8IGJlc3REaWZmZXJlbmNlKSB7CgkgICAgICAgICAgICAgICAgYmVzdFZlcnNpb24gPSBpICsgNzsKCSAgICAgICAgICAgICAgICBiZXN0RGlmZmVyZW5jZSA9IGJpdHNEaWZmZXJlbmNlOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIC8vIFdlIGNhbiB0b2xlcmF0ZSB1cCB0byAzIGJpdHMgb2YgZXJyb3Igc2luY2Ugbm8gdHdvIHZlcnNpb24gaW5mbyBjb2Rld29yZHMgd2lsbAoJICAgICAgICAvLyBkaWZmZXIgaW4gbGVzcyB0aGFuIDggYml0cy4KCSAgICAgICAgaWYgKGJlc3REaWZmZXJlbmNlIDw9IDMpIHsKCSAgICAgICAgICAgIHJldHVybiBWZXJzaW9uLmdldFZlcnNpb25Gb3JOdW1iZXIoYmVzdFZlcnNpb24pOwoJICAgICAgICB9CgkgICAgICAgIC8vIElmIHdlIGRpZG4ndCBmaW5kIGEgY2xvc2UgZW5vdWdoIG1hdGNoLCBmYWlsCgkgICAgICAgIHJldHVybiBudWxsOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogU2VlIElTTyAxODAwNDoyMDA2IEFubmV4IEUKCSAgICAgKi8KCSAgICBWZXJzaW9uLnByb3RvdHlwZS5idWlsZEZ1bmN0aW9uUGF0dGVybiA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIGRpbWVuc2lvbiA9IHRoaXMuZ2V0RGltZW5zaW9uRm9yVmVyc2lvbigpOwoJICAgICAgICB2YXIgYml0TWF0cml4ID0gbmV3IEJpdE1hdHJpeF8xJDMuZGVmYXVsdChkaW1lbnNpb24pOwoJICAgICAgICAvLyBUb3AgbGVmdCBmaW5kZXIgcGF0dGVybiArIHNlcGFyYXRvciArIGZvcm1hdAoJICAgICAgICBiaXRNYXRyaXguc2V0UmVnaW9uKDAsIDAsIDksIDkpOwoJICAgICAgICAvLyBUb3AgcmlnaHQgZmluZGVyIHBhdHRlcm4gKyBzZXBhcmF0b3IgKyBmb3JtYXQKCSAgICAgICAgYml0TWF0cml4LnNldFJlZ2lvbihkaW1lbnNpb24gLSA4LCAwLCA4LCA5KTsKCSAgICAgICAgLy8gQm90dG9tIGxlZnQgZmluZGVyIHBhdHRlcm4gKyBzZXBhcmF0b3IgKyBmb3JtYXQKCSAgICAgICAgYml0TWF0cml4LnNldFJlZ2lvbigwLCBkaW1lbnNpb24gLSA4LCA5LCA4KTsKCSAgICAgICAgLy8gQWxpZ25tZW50IHBhdHRlcm5zCgkgICAgICAgIHZhciBtYXggPSB0aGlzLmFsaWdubWVudFBhdHRlcm5DZW50ZXJzLmxlbmd0aDsKCSAgICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCBtYXg7IHgrKykgewoJICAgICAgICAgICAgdmFyIGkgPSB0aGlzLmFsaWdubWVudFBhdHRlcm5DZW50ZXJzW3hdIC0gMjsKCSAgICAgICAgICAgIGZvciAodmFyIHkgPSAwOyB5IDwgbWF4OyB5KyspIHsKCSAgICAgICAgICAgICAgICBpZiAoKHggPT09IDAgJiYgKHkgPT09IDAgfHwgeSA9PT0gbWF4IC0gMSkpIHx8ICh4ID09PSBtYXggLSAxICYmIHkgPT09IDApKSB7CgkgICAgICAgICAgICAgICAgICAgIC8vIE5vIGFsaWdubWVudCBwYXR0ZXJucyBuZWFyIHRoZSB0aHJlZSBmaW5kZXIgcGF0dGVybnMKCSAgICAgICAgICAgICAgICAgICAgY29udGludWU7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGJpdE1hdHJpeC5zZXRSZWdpb24odGhpcy5hbGlnbm1lbnRQYXR0ZXJuQ2VudGVyc1t5XSAtIDIsIGksIDUsIDUpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIC8vIFZlcnRpY2FsIHRpbWluZyBwYXR0ZXJuCgkgICAgICAgIGJpdE1hdHJpeC5zZXRSZWdpb24oNiwgOSwgMSwgZGltZW5zaW9uIC0gMTcpOwoJICAgICAgICAvLyBIb3Jpem9udGFsIHRpbWluZyBwYXR0ZXJuCgkgICAgICAgIGJpdE1hdHJpeC5zZXRSZWdpb24oOSwgNiwgZGltZW5zaW9uIC0gMTcsIDEpOwoJICAgICAgICBpZiAodGhpcy52ZXJzaW9uTnVtYmVyID4gNikgewoJICAgICAgICAgICAgLy8gVmVyc2lvbiBpbmZvLCB0b3AgcmlnaHQKCSAgICAgICAgICAgIGJpdE1hdHJpeC5zZXRSZWdpb24oZGltZW5zaW9uIC0gMTEsIDAsIDMsIDYpOwoJICAgICAgICAgICAgLy8gVmVyc2lvbiBpbmZvLCBib3R0b20gbGVmdAoJICAgICAgICAgICAgYml0TWF0cml4LnNldFJlZ2lvbigwLCBkaW1lbnNpb24gLSAxMSwgNiwgMyk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGJpdE1hdHJpeDsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBWZXJzaW9uLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuICcnICsgdGhpcy52ZXJzaW9uTnVtYmVyOwoJICAgIH07CgkgICAgLyoqCgkgICAgICAgKiBTZWUgSVNPIDE4MDA0OjIwMDYgQW5uZXggRC4KCSAgICAgICAqIEVsZW1lbnQgaSByZXByZXNlbnRzIHRoZSByYXcgdmVyc2lvbiBiaXRzIHRoYXQgc3BlY2lmeSB2ZXJzaW9uIGkgKyA3CgkgICAgICAgKi8KCSAgICBWZXJzaW9uLlZFUlNJT05fREVDT0RFX0lORk8gPSBJbnQzMkFycmF5LmZyb20oWwoJICAgICAgICAweDA3Qzk0LCAweDA4NUJDLCAweDA5QTk5LCAweDBBNEQzLCAweDBCQkY2LAoJICAgICAgICAweDBDNzYyLCAweDBEODQ3LCAweDBFNjBELCAweDBGOTI4LCAweDEwQjc4LAoJICAgICAgICAweDExNDVELCAweDEyQTE3LCAweDEzNTMyLCAweDE0OUE2LCAweDE1NjgzLAoJICAgICAgICAweDE2OEM5LCAweDE3N0VDLCAweDE4RUM0LCAweDE5MUUxLCAweDFBRkFCLAoJICAgICAgICAweDFCMDhFLCAweDFDQzFBLCAweDFEMzNGLCAweDFFRDc1LCAweDFGMjUwLAoJICAgICAgICAweDIwOUQ1LCAweDIxNkYwLCAweDIyOEJBLCAweDIzNzlGLCAweDI0QjBCLAoJICAgICAgICAweDI1NDJFLCAweDI2QTY0LCAweDI3NTQxLCAweDI4QzY5CgkgICAgXSk7CgkgICAgLyoqCgkgICAgICAgKiBTZWUgSVNPIDE4MDA0OjIwMDYgNi41LjEgVGFibGUgOQoJICAgICAgICovCgkgICAgVmVyc2lvbi5WRVJTSU9OUyA9IFsKCSAgICAgICAgbmV3IFZlcnNpb24oMSwgbmV3IEludDMyQXJyYXkoMCksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoNywgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMTkpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgxMCwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMTYpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgxMywgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMTMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgxNywgbmV3IEVDQl8xLmRlZmF1bHQoMSwgOSkpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMiwgSW50MzJBcnJheS5mcm9tKFs2LCAxOF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDEwLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAzNCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDE2LCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAyOCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDIyLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAyMikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMywgSW50MzJBcnJheS5mcm9tKFs2LCAyMl0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDE1LCBuZXcgRUNCXzEuZGVmYXVsdCgxLCA1NSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI2LCBuZXcgRUNCXzEuZGVmYXVsdCgxLCA0NCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDE4LCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAxNykpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDIyLCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAxMykpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oNCwgSW50MzJBcnJheS5mcm9tKFs2LCAyNl0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDIwLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCA4MCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDE4LCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAzMikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI2LCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAyNCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDE2LCBuZXcgRUNCXzEuZGVmYXVsdCg0LCA5KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbig1LCBJbnQzMkFycmF5LmZyb20oWzYsIDMwXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjYsIG5ldyBFQ0JfMS5kZWZhdWx0KDEsIDEwOCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI0LCBuZXcgRUNCXzEuZGVmYXVsdCgyLCA0MykpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDE4LCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDE2KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjIsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDExKSwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgMTIpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDYsIEludDMyQXJyYXkuZnJvbShbNiwgMzRdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgxOCwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgNjgpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgxNiwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMjcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNCwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTkpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTUpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDcsIEludDMyQXJyYXkuZnJvbShbNiwgMjIsIDM4XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjAsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDc4KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMTgsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDMxKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMTgsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDE0KSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNiwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTMpLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAxNCkpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oOCwgSW50MzJBcnJheS5mcm9tKFs2LCAyNCwgNDJdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNCwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgOTcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyMiwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgMzgpLCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAzOSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDIyLCBuZXcgRUNCXzEuZGVmYXVsdCg0LCAxOCksIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDE5KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjYsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDE0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgMTUpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDksIEludDMyQXJyYXkuZnJvbShbNiwgMjYsIDQ2XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDExNikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDIyLCBuZXcgRUNCXzEuZGVmYXVsdCgzLCAzNiksIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDM3KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjAsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDE2KSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNCwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTIpLCBuZXcgRUNCXzEuZGVmYXVsdCg0LCAxMykpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMTAsIEludDMyQXJyYXkuZnJvbShbNiwgMjgsIDUwXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMTgsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDY4KSwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgNjkpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNiwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgNDMpLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCA0NCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI0LCBuZXcgRUNCXzEuZGVmYXVsdCg2LCAxOSksIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDIwKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDYsIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgMTYpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDExLCBJbnQzMkFycmF5LmZyb20oWzYsIDMwLCA1NF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDIwLCBuZXcgRUNCXzEuZGVmYXVsdCg0LCA4MSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCA1MCksIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDUxKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDIyKSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNCwgbmV3IEVDQl8xLmRlZmF1bHQoMywgMTIpLCBuZXcgRUNCXzEuZGVmYXVsdCg4LCAxMykpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMTIsIEludDMyQXJyYXkuZnJvbShbNiwgMzIsIDU4XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjQsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDkyKSwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgOTMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyMiwgbmV3IEVDQl8xLmRlZmF1bHQoNiwgMzYpLCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAzNykpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI2LCBuZXcgRUNCXzEuZGVmYXVsdCg0LCAyMCksIG5ldyBFQ0JfMS5kZWZhdWx0KDYsIDIxKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDcsIDE0KSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTUpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDEzLCBJbnQzMkFycmF5LmZyb20oWzYsIDM0LCA2Ml0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI2LCBuZXcgRUNCXzEuZGVmYXVsdCg0LCAxMDcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyMiwgbmV3IEVDQl8xLmRlZmF1bHQoOCwgMzcpLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAzOCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI0LCBuZXcgRUNCXzEuZGVmYXVsdCg4LCAyMCksIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDIxKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjIsIG5ldyBFQ0JfMS5kZWZhdWx0KDEyLCAxMSksIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDEyKSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigxNCwgSW50MzJBcnJheS5mcm9tKFs2LCAyNiwgNDYsIDY2XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDMsIDExNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDEsIDExNikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI0LCBuZXcgRUNCXzEuZGVmYXVsdCg0LCA0MCksIG5ldyBFQ0JfMS5kZWZhdWx0KDUsIDQxKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjAsIG5ldyBFQ0JfMS5kZWZhdWx0KDExLCAxNiksIG5ldyBFQ0JfMS5kZWZhdWx0KDUsIDE3KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjQsIG5ldyBFQ0JfMS5kZWZhdWx0KDExLCAxMiksIG5ldyBFQ0JfMS5kZWZhdWx0KDUsIDEzKSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigxNSwgSW50MzJBcnJheS5mcm9tKFs2LCAyNiwgNDgsIDcwXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjIsIG5ldyBFQ0JfMS5kZWZhdWx0KDUsIDg3KSwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgODgpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNCwgbmV3IEVDQl8xLmRlZmF1bHQoNSwgNDEpLCBuZXcgRUNCXzEuZGVmYXVsdCg1LCA0MikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg1LCAyNCksIG5ldyBFQ0JfMS5kZWZhdWx0KDcsIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjQsIG5ldyBFQ0JfMS5kZWZhdWx0KDExLCAxMiksIG5ldyBFQ0JfMS5kZWZhdWx0KDcsIDEzKSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigxNiwgSW50MzJBcnJheS5mcm9tKFs2LCAyNiwgNTAsIDc0XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjQsIG5ldyBFQ0JfMS5kZWZhdWx0KDUsIDk4KSwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgOTkpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoNywgNDUpLCBuZXcgRUNCXzEuZGVmYXVsdCgzLCA0NikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI0LCBuZXcgRUNCXzEuZGVmYXVsdCgxNSwgMTkpLCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAyMCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgzLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDEzLCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMTcsIEludDMyQXJyYXkuZnJvbShbNiwgMzAsIDU0LCA3OF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAxMDcpLCBuZXcgRUNCXzEuZGVmYXVsdCg1LCAxMDgpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMTAsIDQ2KSwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgNDcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMjIpLCBuZXcgRUNCXzEuZGVmYXVsdCgxNSwgMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgMTQpLCBuZXcgRUNCXzEuZGVmYXVsdCgxNywgMTUpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDE4LCBJbnQzMkFycmF5LmZyb20oWzYsIDMwLCA1NiwgODJdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoNSwgMTIwKSwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMTIxKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjYsIG5ldyBFQ0JfMS5kZWZhdWx0KDksIDQzKSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgNDQpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMTcsIDIyKSwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgMTQpLCBuZXcgRUNCXzEuZGVmYXVsdCgxOSwgMTUpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDE5LCBJbnQzMkFycmF5LmZyb20oWzYsIDMwLCA1OCwgODZdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMywgMTEzKSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTE0KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjYsIG5ldyBFQ0JfMS5kZWZhdWx0KDMsIDQ0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMTEsIDQ1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjYsIG5ldyBFQ0JfMS5kZWZhdWx0KDE3LCAyMSksIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDIyKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjYsIG5ldyBFQ0JfMS5kZWZhdWx0KDksIDEzKSwgbmV3IEVDQl8xLmRlZmF1bHQoMTYsIDE0KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigyMCwgSW50MzJBcnJheS5mcm9tKFs2LCAzNCwgNjIsIDkwXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDMsIDEwNyksIG5ldyBFQ0JfMS5kZWZhdWx0KDUsIDEwOCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI2LCBuZXcgRUNCXzEuZGVmYXVsdCgzLCA0MSksIG5ldyBFQ0JfMS5kZWZhdWx0KDEzLCA0MikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgxNSwgMjQpLCBuZXcgRUNCXzEuZGVmYXVsdCg1LCAyNSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxNSwgMTUpLCBuZXcgRUNCXzEuZGVmYXVsdCgxMCwgMTYpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDIxLCBJbnQzMkFycmF5LmZyb20oWzYsIDI4LCA1MCwgNzIsIDk0XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDExNiksIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDExNykpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI2LCBuZXcgRUNCXzEuZGVmYXVsdCgxNywgNDIpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMTcsIDIyKSwgbmV3IEVDQl8xLmRlZmF1bHQoNiwgMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTksIDE2KSwgbmV3IEVDQl8xLmRlZmF1bHQoNiwgMTcpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDIyLCBJbnQzMkFycmF5LmZyb20oWzYsIDI2LCA1MCwgNzQsIDk4XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDExMSksIG5ldyBFQ0JfMS5kZWZhdWx0KDcsIDExMikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxNywgNDYpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoNywgMjQpLCBuZXcgRUNCXzEuZGVmYXVsdCgxNiwgMjUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNCwgbmV3IEVDQl8xLmRlZmF1bHQoMzQsIDEzKSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigyMywgSW50MzJBcnJheS5mcm9tKFs2LCAzMCwgNTQsIDc4LCAxMDJdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTIxKSwgbmV3IEVDQl8xLmRlZmF1bHQoNSwgMTIyKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDQ3KSwgbmV3IEVDQl8xLmRlZmF1bHQoMTQsIDQ4KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDExLCAyNCksIG5ldyBFQ0JfMS5kZWZhdWx0KDE0LCAyNSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgxNiwgMTUpLCBuZXcgRUNCXzEuZGVmYXVsdCgxNCwgMTYpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDI0LCBJbnQzMkFycmF5LmZyb20oWzYsIDI4LCA1NCwgODAsIDEwNl0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg2LCAxMTcpLCBuZXcgRUNCXzEuZGVmYXVsdCg0LCAxMTgpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoNiwgNDUpLCBuZXcgRUNCXzEuZGVmYXVsdCgxNCwgNDYpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTEsIDI0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMTYsIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDMwLCAxNiksIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDE3KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigyNSwgSW50MzJBcnJheS5mcm9tKFs2LCAzMiwgNTgsIDg0LCAxMTBdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNiwgbmV3IEVDQl8xLmRlZmF1bHQoOCwgMTA2KSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTA3KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDgsIDQ3KSwgbmV3IEVDQl8xLmRlZmF1bHQoMTMsIDQ4KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDcsIDI0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMjIsIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDIyLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDEzLCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMjYsIEludDMyQXJyYXkuZnJvbShbNiwgMzAsIDU4LCA4NiwgMTE0XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDEwLCAxMTQpLCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAxMTUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMTksIDQ2KSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgNDcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMjgsIDIyKSwgbmV3IEVDQl8xLmRlZmF1bHQoNiwgMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMzMsIDE2KSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTcpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDI3LCBJbnQzMkFycmF5LmZyb20oWzYsIDM0LCA2MiwgOTAsIDExOF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg4LCAxMjIpLCBuZXcgRUNCXzEuZGVmYXVsdCg0LCAxMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMjIsIDQ1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMywgNDYpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoOCwgMjMpLCBuZXcgRUNCXzEuZGVmYXVsdCgyNiwgMjQpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTIsIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMjgsIDE2KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigyOCwgSW50MzJBcnJheS5mcm9tKFs2LCAyNiwgNTAsIDc0LCA5OCwgMTIyXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDMsIDExNyksIG5ldyBFQ0JfMS5kZWZhdWx0KDEwLCAxMTgpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMywgNDUpLCBuZXcgRUNCXzEuZGVmYXVsdCgyMywgNDYpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMjQpLCBuZXcgRUNCXzEuZGVmYXVsdCgzMSwgMjUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTEsIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMzEsIDE2KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigyOSwgSW50MzJBcnJheS5mcm9tKFs2LCAzMCwgNTQsIDc4LCAxMDIsIDEyNl0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg3LCAxMTYpLCBuZXcgRUNCXzEuZGVmYXVsdCg3LCAxMTcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMjEsIDQ1KSwgbmV3IEVDQl8xLmRlZmF1bHQoNywgNDYpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMjMpLCBuZXcgRUNCXzEuZGVmYXVsdCgzNywgMjQpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTksIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMjYsIDE2KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigzMCwgSW50MzJBcnJheS5mcm9tKFs2LCAyNiwgNTIsIDc4LCAxMDQsIDEzMF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg1LCAxMTUpLCBuZXcgRUNCXzEuZGVmYXVsdCgxMCwgMTE2KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDE5LCA0NyksIG5ldyBFQ0JfMS5kZWZhdWx0KDEwLCA0OCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgxNSwgMjQpLCBuZXcgRUNCXzEuZGVmYXVsdCgyNSwgMjUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMjMsIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMjUsIDE2KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigzMSwgSW50MzJBcnJheS5mcm9tKFs2LCAzMCwgNTYsIDgyLCAxMDgsIDEzNF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgxMywgMTE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMywgMTE2KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDQ2KSwgbmV3IEVDQl8xLmRlZmF1bHQoMjksIDQ3KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDQyLCAyNCksIG5ldyBFQ0JfMS5kZWZhdWx0KDEsIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDIzLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDI4LCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMzIsIEludDMyQXJyYXkuZnJvbShbNiwgMzQsIDYwLCA4NiwgMTEyLCAxMzhdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTcsIDExNSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxMCwgNDYpLCBuZXcgRUNCXzEuZGVmYXVsdCgyMywgNDcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTAsIDI0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMzUsIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDE5LCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDM1LCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMzMsIEludDMyQXJyYXkuZnJvbShbNiwgMzAsIDU4LCA4NiwgMTE0LCAxNDJdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTcsIDExNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDEsIDExNikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxNCwgNDYpLCBuZXcgRUNCXzEuZGVmYXVsdCgyMSwgNDcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMjksIDI0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMTksIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDExLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDQ2LCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMzQsIEludDMyQXJyYXkuZnJvbShbNiwgMzQsIDYyLCA5MCwgMTE4LCAxNDZdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTMsIDExNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDYsIDExNikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxNCwgNDYpLCBuZXcgRUNCXzEuZGVmYXVsdCgyMywgNDcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoNDQsIDI0KSwgbmV3IEVDQl8xLmRlZmF1bHQoNywgMjUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoNTksIDE2KSwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMTcpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDM1LCBJbnQzMkFycmF5LmZyb20oWzYsIDMwLCA1NCwgNzgsIDEwMiwgMTI2LCAxNTBdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTIsIDEyMSksIG5ldyBFQ0JfMS5kZWZhdWx0KDcsIDEyMikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxMiwgNDcpLCBuZXcgRUNCXzEuZGVmYXVsdCgyNiwgNDgpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMzksIDI0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMTQsIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDIyLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDQxLCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMzYsIEludDMyQXJyYXkuZnJvbShbNiwgMjQsIDUwLCA3NiwgMTAyLCAxMjgsIDE1NF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg2LCAxMjEpLCBuZXcgRUNCXzEuZGVmYXVsdCgxNCwgMTIyKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDYsIDQ3KSwgbmV3IEVDQl8xLmRlZmF1bHQoMzQsIDQ4KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDQ2LCAyNCksIG5ldyBFQ0JfMS5kZWZhdWx0KDEwLCAyNSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDY0LCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMzcsIEludDMyQXJyYXkuZnJvbShbNiwgMjgsIDU0LCA4MCwgMTA2LCAxMzIsIDE1OF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgxNywgMTIyKSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTIzKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDI5LCA0NiksIG5ldyBFQ0JfMS5kZWZhdWx0KDE0LCA0NykpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg0OSwgMjQpLCBuZXcgRUNCXzEuZGVmYXVsdCgxMCwgMjUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMjQsIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoNDYsIDE2KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigzOCwgSW50MzJBcnJheS5mcm9tKFs2LCAzMiwgNTgsIDg0LCAxMTAsIDEzNiwgMTYyXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDEyMiksIG5ldyBFQ0JfMS5kZWZhdWx0KDE4LCAxMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMTMsIDQ2KSwgbmV3IEVDQl8xLmRlZmF1bHQoMzIsIDQ3KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDQ4LCAyNCksIG5ldyBFQ0JfMS5kZWZhdWx0KDE0LCAyNSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg0MiwgMTUpLCBuZXcgRUNCXzEuZGVmYXVsdCgzMiwgMTYpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDM5LCBJbnQzMkFycmF5LmZyb20oWzYsIDI2LCA1NCwgODIsIDExMCwgMTM4LCAxNjZdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMjAsIDExNyksIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDExOCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCg0MCwgNDcpLCBuZXcgRUNCXzEuZGVmYXVsdCg3LCA0OCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg0MywgMjQpLCBuZXcgRUNCXzEuZGVmYXVsdCgyMiwgMjUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTAsIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoNjcsIDE2KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbig0MCwgSW50MzJBcnJheS5mcm9tKFs2LCAzMCwgNTgsIDg2LCAxMTQsIDE0MiwgMTcwXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDE5LCAxMTgpLCBuZXcgRUNCXzEuZGVmYXVsdCg2LCAxMTkpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMTgsIDQ3KSwgbmV3IEVDQl8xLmRlZmF1bHQoMzEsIDQ4KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDM0LCAyNCksIG5ldyBFQ0JfMS5kZWZhdWx0KDM0LCAyNSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgyMCwgMTUpLCBuZXcgRUNCXzEuZGVmYXVsdCg2MSwgMTYpKSkKCSAgICBdOwoJICAgIHJldHVybiBWZXJzaW9uOwoJfSgpKTsKCVZlcnNpb24kMS5kZWZhdWx0ID0gVmVyc2lvbjsKCgl2YXIgRGF0YU1hc2sgPSB7fTsKCgkoZnVuY3Rpb24gKGV4cG9ydHMpIHsKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJZXhwb3J0cy5EYXRhTWFza1ZhbHVlcyA9IHZvaWQgMDsKCXZhciBEYXRhTWFza1ZhbHVlczsKCShmdW5jdGlvbiAoRGF0YU1hc2tWYWx1ZXMpIHsKCSAgICBEYXRhTWFza1ZhbHVlc1tEYXRhTWFza1ZhbHVlc1siREFUQV9NQVNLXzAwMCJdID0gMF0gPSAiREFUQV9NQVNLXzAwMCI7CgkgICAgRGF0YU1hc2tWYWx1ZXNbRGF0YU1hc2tWYWx1ZXNbIkRBVEFfTUFTS18wMDEiXSA9IDFdID0gIkRBVEFfTUFTS18wMDEiOwoJICAgIERhdGFNYXNrVmFsdWVzW0RhdGFNYXNrVmFsdWVzWyJEQVRBX01BU0tfMDEwIl0gPSAyXSA9ICJEQVRBX01BU0tfMDEwIjsKCSAgICBEYXRhTWFza1ZhbHVlc1tEYXRhTWFza1ZhbHVlc1siREFUQV9NQVNLXzAxMSJdID0gM10gPSAiREFUQV9NQVNLXzAxMSI7CgkgICAgRGF0YU1hc2tWYWx1ZXNbRGF0YU1hc2tWYWx1ZXNbIkRBVEFfTUFTS18xMDAiXSA9IDRdID0gIkRBVEFfTUFTS18xMDAiOwoJICAgIERhdGFNYXNrVmFsdWVzW0RhdGFNYXNrVmFsdWVzWyJEQVRBX01BU0tfMTAxIl0gPSA1XSA9ICJEQVRBX01BU0tfMTAxIjsKCSAgICBEYXRhTWFza1ZhbHVlc1tEYXRhTWFza1ZhbHVlc1siREFUQV9NQVNLXzExMCJdID0gNl0gPSAiREFUQV9NQVNLXzExMCI7CgkgICAgRGF0YU1hc2tWYWx1ZXNbRGF0YU1hc2tWYWx1ZXNbIkRBVEFfTUFTS18xMTEiXSA9IDddID0gIkRBVEFfTUFTS18xMTEiOwoJfSkoRGF0YU1hc2tWYWx1ZXMgPSBleHBvcnRzLkRhdGFNYXNrVmFsdWVzIHx8IChleHBvcnRzLkRhdGFNYXNrVmFsdWVzID0ge30pKTsKCS8qKgoJICogPHA+RW5jYXBzdWxhdGVzIGRhdGEgbWFza3MgZm9yIHRoZSBkYXRhIGJpdHMgaW4gYSBRUiBjb2RlLCBwZXIgSVNPIDE4MDA0OjIwMDYgNi44LiBJbXBsZW1lbnRhdGlvbnMKCSAqIG9mIHRoaXMgY2xhc3MgY2FuIHVuLW1hc2sgYSByYXcgQml0TWF0cml4LiBGb3Igc2ltcGxpY2l0eSwgdGhleSB3aWxsIHVubWFzayB0aGUgZW50aXJlIEJpdE1hdHJpeCwKCSAqIGluY2x1ZGluZyBhcmVhcyB1c2VkIGZvciBmaW5kZXIgcGF0dGVybnMsIHRpbWluZyBwYXR0ZXJucywgZXRjLiBUaGVzZSBhcmVhcyBzaG91bGQgYmUgdW51c2VkCgkgKiBhZnRlciB0aGUgcG9pbnQgdGhleSBhcmUgdW5tYXNrZWQgYW55d2F5LjwvcD4KCSAqCgkgKiA8cD5Ob3RlIHRoYXQgdGhlIGRpYWdyYW0gaW4gc2VjdGlvbiA2LjguMSBpcyBtaXNsZWFkaW5nIHNpbmNlIGl0IGluZGljYXRlcyB0aGF0IGkgaXMgY29sdW1uIHBvc2l0aW9uCgkgKiBhbmQgaiBpcyByb3cgcG9zaXRpb24uIEluIGZhY3QsIGFzIHRoZSB0ZXh0IHNheXMsIGkgaXMgcm93IHBvc2l0aW9uIGFuZCBqIGlzIGNvbHVtbiBwb3NpdGlvbi48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIERhdGFNYXNrID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIC8vIFNlZSBJU08gMTgwMDQ6MjAwNiA2LjguMQoJICAgIGZ1bmN0aW9uIERhdGFNYXNrKHZhbHVlLCBpc01hc2tlZCkgewoJICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7CgkgICAgICAgIHRoaXMuaXNNYXNrZWQgPSBpc01hc2tlZDsKCSAgICB9CgkgICAgLy8gRW5kIG9mIGVudW0gY29uc3RhbnRzLgoJICAgIC8qKgoJICAgICAqIDxwPkltcGxlbWVudGF0aW9ucyBvZiB0aGlzIG1ldGhvZCByZXZlcnNlIHRoZSBkYXRhIG1hc2tpbmcgcHJvY2VzcyBhcHBsaWVkIHRvIGEgUVIgQ29kZSBhbmQKCSAgICAgKiBtYWtlIGl0cyBiaXRzIHJlYWR5IHRvIHJlYWQuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGJpdHMgcmVwcmVzZW50YXRpb24gb2YgUVIgQ29kZSBiaXRzCgkgICAgICogQHBhcmFtIGRpbWVuc2lvbiBkaW1lbnNpb24gb2YgUVIgQ29kZSwgcmVwcmVzZW50ZWQgYnkgYml0cywgYmVpbmcgdW5tYXNrZWQKCSAgICAgKi8KCSAgICBEYXRhTWFzay5wcm90b3R5cGUudW5tYXNrQml0TWF0cml4ID0gZnVuY3Rpb24gKGJpdHMsIGRpbWVuc2lvbiAvKmludCovKSB7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZGltZW5zaW9uOyBpKyspIHsKCSAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgZGltZW5zaW9uOyBqKyspIHsKCSAgICAgICAgICAgICAgICBpZiAodGhpcy5pc01hc2tlZChpLCBqKSkgewoJICAgICAgICAgICAgICAgICAgICBiaXRzLmZsaXAoaiwgaSk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfTsKCSAgICBEYXRhTWFzay52YWx1ZXMgPSBuZXcgTWFwKFsKCSAgICAgICAgLyoqCgkgICAgICAgICAqIDAwMDogbWFzayBiaXRzIGZvciB3aGljaCAoeCArIHkpIG1vZCAyID09IDAKCSAgICAgICAgICovCgkgICAgICAgIFtEYXRhTWFza1ZhbHVlcy5EQVRBX01BU0tfMDAwLCBuZXcgRGF0YU1hc2soRGF0YU1hc2tWYWx1ZXMuREFUQV9NQVNLXzAwMCwgZnVuY3Rpb24gKGkgLyppbnQqLywgaiAvKmludCovKSB7IHJldHVybiAoKGkgKyBqKSAmIDB4MDEpID09PSAwOyB9KV0sCgkgICAgICAgIC8qKgoJICAgICAgICAgKiAwMDE6IG1hc2sgYml0cyBmb3Igd2hpY2ggeCBtb2QgMiA9PSAwCgkgICAgICAgICAqLwoJICAgICAgICBbRGF0YU1hc2tWYWx1ZXMuREFUQV9NQVNLXzAwMSwgbmV3IERhdGFNYXNrKERhdGFNYXNrVmFsdWVzLkRBVEFfTUFTS18wMDEsIGZ1bmN0aW9uIChpIC8qaW50Ki8sIGogLyppbnQqLykgeyByZXR1cm4gKGkgJiAweDAxKSA9PT0gMDsgfSldLAoJICAgICAgICAvKioKCSAgICAgICAgICogMDEwOiBtYXNrIGJpdHMgZm9yIHdoaWNoIHkgbW9kIDMgPT0gMAoJICAgICAgICAgKi8KCSAgICAgICAgW0RhdGFNYXNrVmFsdWVzLkRBVEFfTUFTS18wMTAsIG5ldyBEYXRhTWFzayhEYXRhTWFza1ZhbHVlcy5EQVRBX01BU0tfMDEwLCBmdW5jdGlvbiAoaSAvKmludCovLCBqIC8qaW50Ki8pIHsgcmV0dXJuIGogJSAzID09PSAwOyB9KV0sCgkgICAgICAgIC8qKgoJICAgICAgICAgKiAwMTE6IG1hc2sgYml0cyBmb3Igd2hpY2ggKHggKyB5KSBtb2QgMyA9PSAwCgkgICAgICAgICAqLwoJICAgICAgICBbRGF0YU1hc2tWYWx1ZXMuREFUQV9NQVNLXzAxMSwgbmV3IERhdGFNYXNrKERhdGFNYXNrVmFsdWVzLkRBVEFfTUFTS18wMTEsIGZ1bmN0aW9uIChpIC8qaW50Ki8sIGogLyppbnQqLykgeyByZXR1cm4gKGkgKyBqKSAlIDMgPT09IDA7IH0pXSwKCSAgICAgICAgLyoqCgkgICAgICAgICAqIDEwMDogbWFzayBiaXRzIGZvciB3aGljaCAoeC8yICsgeS8zKSBtb2QgMiA9PSAwCgkgICAgICAgICAqLwoJICAgICAgICBbRGF0YU1hc2tWYWx1ZXMuREFUQV9NQVNLXzEwMCwgbmV3IERhdGFNYXNrKERhdGFNYXNrVmFsdWVzLkRBVEFfTUFTS18xMDAsIGZ1bmN0aW9uIChpIC8qaW50Ki8sIGogLyppbnQqLykgeyByZXR1cm4gKChNYXRoLmZsb29yKGkgLyAyKSArIE1hdGguZmxvb3IoaiAvIDMpKSAmIDB4MDEpID09PSAwOyB9KV0sCgkgICAgICAgIC8qKgoJICAgICAgICAgKiAxMDE6IG1hc2sgYml0cyBmb3Igd2hpY2ggeHkgbW9kIDIgKyB4eSBtb2QgMyA9PSAwCgkgICAgICAgICAqIGVxdWl2YWxlbnRseSwgc3VjaCB0aGF0IHh5IG1vZCA2ID09IDAKCSAgICAgICAgICovCgkgICAgICAgIFtEYXRhTWFza1ZhbHVlcy5EQVRBX01BU0tfMTAxLCBuZXcgRGF0YU1hc2soRGF0YU1hc2tWYWx1ZXMuREFUQV9NQVNLXzEwMSwgZnVuY3Rpb24gKGkgLyppbnQqLywgaiAvKmludCovKSB7IHJldHVybiAoaSAqIGopICUgNiA9PT0gMDsgfSldLAoJICAgICAgICAvKioKCSAgICAgICAgICogMTEwOiBtYXNrIGJpdHMgZm9yIHdoaWNoICh4eSBtb2QgMiArIHh5IG1vZCAzKSBtb2QgMiA9PSAwCgkgICAgICAgICAqIGVxdWl2YWxlbnRseSwgc3VjaCB0aGF0IHh5IG1vZCA2IDwgMwoJICAgICAgICAgKi8KCSAgICAgICAgW0RhdGFNYXNrVmFsdWVzLkRBVEFfTUFTS18xMTAsIG5ldyBEYXRhTWFzayhEYXRhTWFza1ZhbHVlcy5EQVRBX01BU0tfMTEwLCBmdW5jdGlvbiAoaSAvKmludCovLCBqIC8qaW50Ki8pIHsgcmV0dXJuICgoaSAqIGopICUgNikgPCAzOyB9KV0sCgkgICAgICAgIC8qKgoJICAgICAgICAgKiAxMTE6IG1hc2sgYml0cyBmb3Igd2hpY2ggKCh4K3kpbW9kIDIgKyB4eSBtb2QgMykgbW9kIDIgPT0gMAoJICAgICAgICAgKiBlcXVpdmFsZW50bHksIHN1Y2ggdGhhdCAoeCArIHkgKyB4eSBtb2QgMykgbW9kIDIgPT0gMAoJICAgICAgICAgKi8KCSAgICAgICAgW0RhdGFNYXNrVmFsdWVzLkRBVEFfTUFTS18xMTEsIG5ldyBEYXRhTWFzayhEYXRhTWFza1ZhbHVlcy5EQVRBX01BU0tfMTExLCBmdW5jdGlvbiAoaSAvKmludCovLCBqIC8qaW50Ki8pIHsgcmV0dXJuICgoaSArIGogKyAoKGkgKiBqKSAlIDMpKSAmIDB4MDEpID09PSAwOyB9KV0sCgkgICAgXSk7CgkgICAgcmV0dXJuIERhdGFNYXNrOwoJfSgpKTsKCWV4cG9ydHMuZGVmYXVsdCA9IERhdGFNYXNrOwoKCX0oRGF0YU1hc2spKTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEJpdE1hdHJpeFBhcnNlciQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgVmVyc2lvbl8xJDEgPSBWZXJzaW9uJDE7Cgl2YXIgRm9ybWF0SW5mb3JtYXRpb25fMSA9IEZvcm1hdEluZm9ybWF0aW9uJDE7Cgl2YXIgRGF0YU1hc2tfMSA9IERhdGFNYXNrOwoJdmFyIEZvcm1hdEV4Y2VwdGlvbl8xJDEgPSBGb3JtYXRFeGNlcHRpb24kMTsKCS8qKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEJpdE1hdHJpeFBhcnNlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gYml0TWF0cml4IHtAbGluayBCaXRNYXRyaXh9IHRvIHBhcnNlCgkgICAgICogQHRocm93cyBGb3JtYXRFeGNlcHRpb24gaWYgZGltZW5zaW9uIGlzIG5vdCA+PSAyMSBhbmQgMSBtb2QgNAoJICAgICAqLwoJICAgIGZ1bmN0aW9uIEJpdE1hdHJpeFBhcnNlcihiaXRNYXRyaXgpIHsKCSAgICAgICAgdmFyIGRpbWVuc2lvbiA9IGJpdE1hdHJpeC5nZXRIZWlnaHQoKTsKCSAgICAgICAgaWYgKGRpbWVuc2lvbiA8IDIxIHx8IChkaW1lbnNpb24gJiAweDAzKSAhPT0gMSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xJDEuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMuYml0TWF0cml4ID0gYml0TWF0cml4OwoJICAgIH0KCSAgICAvKioKCSAgICAgKiA8cD5SZWFkcyBmb3JtYXQgaW5mb3JtYXRpb24gZnJvbSBvbmUgb2YgaXRzIHR3byBsb2NhdGlvbnMgd2l0aGluIHRoZSBRUiBDb2RlLjwvcD4KCSAgICAgKgoJICAgICAqIEByZXR1cm4ge0BsaW5rIEZvcm1hdEluZm9ybWF0aW9ufSBlbmNhcHN1bGF0aW5nIHRoZSBRUiBDb2RlJ3MgZm9ybWF0IGluZm8KCSAgICAgKiBAdGhyb3dzIEZvcm1hdEV4Y2VwdGlvbiBpZiBib3RoIGZvcm1hdCBpbmZvcm1hdGlvbiBsb2NhdGlvbnMgY2Fubm90IGJlIHBhcnNlZCBhcwoJICAgICAqIHRoZSB2YWxpZCBlbmNvZGluZyBvZiBmb3JtYXQgaW5mb3JtYXRpb24KCSAgICAgKi8KCSAgICBCaXRNYXRyaXhQYXJzZXIucHJvdG90eXBlLnJlYWRGb3JtYXRJbmZvcm1hdGlvbiA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgaWYgKHRoaXMucGFyc2VkRm9ybWF0SW5mbyAhPT0gbnVsbCAmJiB0aGlzLnBhcnNlZEZvcm1hdEluZm8gIT09IHVuZGVmaW5lZCkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMucGFyc2VkRm9ybWF0SW5mbzsKCSAgICAgICAgfQoJICAgICAgICAvLyBSZWFkIHRvcC1sZWZ0IGZvcm1hdCBpbmZvIGJpdHMKCSAgICAgICAgdmFyIGZvcm1hdEluZm9CaXRzMSA9IDA7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgNjsgaSsrKSB7CgkgICAgICAgICAgICBmb3JtYXRJbmZvQml0czEgPSB0aGlzLmNvcHlCaXQoaSwgOCwgZm9ybWF0SW5mb0JpdHMxKTsKCSAgICAgICAgfQoJICAgICAgICAvLyAuLiBhbmQgc2tpcCBhIGJpdCBpbiB0aGUgdGltaW5nIHBhdHRlcm4gLi4uCgkgICAgICAgIGZvcm1hdEluZm9CaXRzMSA9IHRoaXMuY29weUJpdCg3LCA4LCBmb3JtYXRJbmZvQml0czEpOwoJICAgICAgICBmb3JtYXRJbmZvQml0czEgPSB0aGlzLmNvcHlCaXQoOCwgOCwgZm9ybWF0SW5mb0JpdHMxKTsKCSAgICAgICAgZm9ybWF0SW5mb0JpdHMxID0gdGhpcy5jb3B5Qml0KDgsIDcsIGZvcm1hdEluZm9CaXRzMSk7CgkgICAgICAgIC8vIC4uIGFuZCBza2lwIGEgYml0IGluIHRoZSB0aW1pbmcgcGF0dGVybiAuLi4KCSAgICAgICAgZm9yICh2YXIgaiA9IDU7IGogPj0gMDsgai0tKSB7CgkgICAgICAgICAgICBmb3JtYXRJbmZvQml0czEgPSB0aGlzLmNvcHlCaXQoOCwgaiwgZm9ybWF0SW5mb0JpdHMxKTsKCSAgICAgICAgfQoJICAgICAgICAvLyBSZWFkIHRoZSB0b3AtcmlnaHQvYm90dG9tLWxlZnQgcGF0dGVybiB0b28KCSAgICAgICAgdmFyIGRpbWVuc2lvbiA9IHRoaXMuYml0TWF0cml4LmdldEhlaWdodCgpOwoJICAgICAgICB2YXIgZm9ybWF0SW5mb0JpdHMyID0gMDsKCSAgICAgICAgdmFyIGpNaW4gPSBkaW1lbnNpb24gLSA3OwoJICAgICAgICBmb3IgKHZhciBqID0gZGltZW5zaW9uIC0gMTsgaiA+PSBqTWluOyBqLS0pIHsKCSAgICAgICAgICAgIGZvcm1hdEluZm9CaXRzMiA9IHRoaXMuY29weUJpdCg4LCBqLCBmb3JtYXRJbmZvQml0czIpOwoJICAgICAgICB9CgkgICAgICAgIGZvciAodmFyIGkgPSBkaW1lbnNpb24gLSA4OyBpIDwgZGltZW5zaW9uOyBpKyspIHsKCSAgICAgICAgICAgIGZvcm1hdEluZm9CaXRzMiA9IHRoaXMuY29weUJpdChpLCA4LCBmb3JtYXRJbmZvQml0czIpOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMucGFyc2VkRm9ybWF0SW5mbyA9IEZvcm1hdEluZm9ybWF0aW9uXzEuZGVmYXVsdC5kZWNvZGVGb3JtYXRJbmZvcm1hdGlvbihmb3JtYXRJbmZvQml0czEsIGZvcm1hdEluZm9CaXRzMik7CgkgICAgICAgIGlmICh0aGlzLnBhcnNlZEZvcm1hdEluZm8gIT09IG51bGwpIHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzLnBhcnNlZEZvcm1hdEluZm87CgkgICAgICAgIH0KCSAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xJDEuZGVmYXVsdCgpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogPHA+UmVhZHMgdmVyc2lvbiBpbmZvcm1hdGlvbiBmcm9tIG9uZSBvZiBpdHMgdHdvIGxvY2F0aW9ucyB3aXRoaW4gdGhlIFFSIENvZGUuPC9wPgoJICAgICAqCgkgICAgICogQHJldHVybiB7QGxpbmsgVmVyc2lvbn0gZW5jYXBzdWxhdGluZyB0aGUgUVIgQ29kZSdzIHZlcnNpb24KCSAgICAgKiBAdGhyb3dzIEZvcm1hdEV4Y2VwdGlvbiBpZiBib3RoIHZlcnNpb24gaW5mb3JtYXRpb24gbG9jYXRpb25zIGNhbm5vdCBiZSBwYXJzZWQgYXMKCSAgICAgKiB0aGUgdmFsaWQgZW5jb2Rpbmcgb2YgdmVyc2lvbiBpbmZvcm1hdGlvbgoJICAgICAqLwoJICAgIEJpdE1hdHJpeFBhcnNlci5wcm90b3R5cGUucmVhZFZlcnNpb24gPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIGlmICh0aGlzLnBhcnNlZFZlcnNpb24gIT09IG51bGwgJiYgdGhpcy5wYXJzZWRWZXJzaW9uICE9PSB1bmRlZmluZWQpIHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzLnBhcnNlZFZlcnNpb247CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGRpbWVuc2lvbiA9IHRoaXMuYml0TWF0cml4LmdldEhlaWdodCgpOwoJICAgICAgICB2YXIgcHJvdmlzaW9uYWxWZXJzaW9uID0gTWF0aC5mbG9vcigoZGltZW5zaW9uIC0gMTcpIC8gNCk7CgkgICAgICAgIGlmIChwcm92aXNpb25hbFZlcnNpb24gPD0gNikgewoJICAgICAgICAgICAgcmV0dXJuIFZlcnNpb25fMSQxLmRlZmF1bHQuZ2V0VmVyc2lvbkZvck51bWJlcihwcm92aXNpb25hbFZlcnNpb24pOwoJICAgICAgICB9CgkgICAgICAgIC8vIFJlYWQgdG9wLXJpZ2h0IHZlcnNpb24gaW5mbzogMyB3aWRlIGJ5IDYgdGFsbAoJICAgICAgICB2YXIgdmVyc2lvbkJpdHMgPSAwOwoJICAgICAgICB2YXIgaWpNaW4gPSBkaW1lbnNpb24gLSAxMTsKCSAgICAgICAgZm9yICh2YXIgaiA9IDU7IGogPj0gMDsgai0tKSB7CgkgICAgICAgICAgICBmb3IgKHZhciBpID0gZGltZW5zaW9uIC0gOTsgaSA+PSBpak1pbjsgaS0tKSB7CgkgICAgICAgICAgICAgICAgdmVyc2lvbkJpdHMgPSB0aGlzLmNvcHlCaXQoaSwgaiwgdmVyc2lvbkJpdHMpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHZhciB0aGVQYXJzZWRWZXJzaW9uID0gVmVyc2lvbl8xJDEuZGVmYXVsdC5kZWNvZGVWZXJzaW9uSW5mb3JtYXRpb24odmVyc2lvbkJpdHMpOwoJICAgICAgICBpZiAodGhlUGFyc2VkVmVyc2lvbiAhPT0gbnVsbCAmJiB0aGVQYXJzZWRWZXJzaW9uLmdldERpbWVuc2lvbkZvclZlcnNpb24oKSA9PT0gZGltZW5zaW9uKSB7CgkgICAgICAgICAgICB0aGlzLnBhcnNlZFZlcnNpb24gPSB0aGVQYXJzZWRWZXJzaW9uOwoJICAgICAgICAgICAgcmV0dXJuIHRoZVBhcnNlZFZlcnNpb247CgkgICAgICAgIH0KCSAgICAgICAgLy8gSG1tLCBmYWlsZWQuIFRyeSBib3R0b20gbGVmdDogNiB3aWRlIGJ5IDMgdGFsbAoJICAgICAgICB2ZXJzaW9uQml0cyA9IDA7CgkgICAgICAgIGZvciAodmFyIGkgPSA1OyBpID49IDA7IGktLSkgewoJICAgICAgICAgICAgZm9yICh2YXIgaiA9IGRpbWVuc2lvbiAtIDk7IGogPj0gaWpNaW47IGotLSkgewoJICAgICAgICAgICAgICAgIHZlcnNpb25CaXRzID0gdGhpcy5jb3B5Qml0KGksIGosIHZlcnNpb25CaXRzKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICB0aGVQYXJzZWRWZXJzaW9uID0gVmVyc2lvbl8xJDEuZGVmYXVsdC5kZWNvZGVWZXJzaW9uSW5mb3JtYXRpb24odmVyc2lvbkJpdHMpOwoJICAgICAgICBpZiAodGhlUGFyc2VkVmVyc2lvbiAhPT0gbnVsbCAmJiB0aGVQYXJzZWRWZXJzaW9uLmdldERpbWVuc2lvbkZvclZlcnNpb24oKSA9PT0gZGltZW5zaW9uKSB7CgkgICAgICAgICAgICB0aGlzLnBhcnNlZFZlcnNpb24gPSB0aGVQYXJzZWRWZXJzaW9uOwoJICAgICAgICAgICAgcmV0dXJuIHRoZVBhcnNlZFZlcnNpb247CgkgICAgICAgIH0KCSAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xJDEuZGVmYXVsdCgpOwoJICAgIH07CgkgICAgQml0TWF0cml4UGFyc2VyLnByb3RvdHlwZS5jb3B5Qml0ID0gZnVuY3Rpb24gKGkgLyppbnQqLywgaiAvKmludCovLCB2ZXJzaW9uQml0cyAvKmludCovKSB7CgkgICAgICAgIHZhciBiaXQgPSB0aGlzLmlzTWlycm9yID8gdGhpcy5iaXRNYXRyaXguZ2V0KGosIGkpIDogdGhpcy5iaXRNYXRyaXguZ2V0KGksIGopOwoJICAgICAgICByZXR1cm4gYml0ID8gKHZlcnNpb25CaXRzIDw8IDEpIHwgMHgxIDogdmVyc2lvbkJpdHMgPDwgMTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPlJlYWRzIHRoZSBiaXRzIGluIHRoZSB7QGxpbmsgQml0TWF0cml4fSByZXByZXNlbnRpbmcgdGhlIGZpbmRlciBwYXR0ZXJuIGluIHRoZQoJICAgICAqIGNvcnJlY3Qgb3JkZXIgaW4gb3JkZXIgdG8gcmVjb25zdHJ1Y3QgdGhlIGNvZGV3b3JkcyBieXRlcyBjb250YWluZWQgd2l0aGluIHRoZQoJICAgICAqIFFSIENvZGUuPC9wPgoJICAgICAqCgkgICAgICogQHJldHVybiBieXRlcyBlbmNvZGVkIHdpdGhpbiB0aGUgUVIgQ29kZQoJICAgICAqIEB0aHJvd3MgRm9ybWF0RXhjZXB0aW9uIGlmIHRoZSBleGFjdCBudW1iZXIgb2YgYnl0ZXMgZXhwZWN0ZWQgaXMgbm90IHJlYWQKCSAgICAgKi8KCSAgICBCaXRNYXRyaXhQYXJzZXIucHJvdG90eXBlLnJlYWRDb2Rld29yZHMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHZhciBmb3JtYXRJbmZvID0gdGhpcy5yZWFkRm9ybWF0SW5mb3JtYXRpb24oKTsKCSAgICAgICAgdmFyIHZlcnNpb24gPSB0aGlzLnJlYWRWZXJzaW9uKCk7CgkgICAgICAgIC8vIEdldCB0aGUgZGF0YSBtYXNrIGZvciB0aGUgZm9ybWF0IHVzZWQgaW4gdGhpcyBRUiBDb2RlLiBUaGlzIHdpbGwgZXhjbHVkZQoJICAgICAgICAvLyBzb21lIGJpdHMgZnJvbSByZWFkaW5nIGFzIHdlIHdpbmQgdGhyb3VnaCB0aGUgYml0IG1hdHJpeC4KCSAgICAgICAgdmFyIGRhdGFNYXNrID0gRGF0YU1hc2tfMS5kZWZhdWx0LnZhbHVlcy5nZXQoZm9ybWF0SW5mby5nZXREYXRhTWFzaygpKTsKCSAgICAgICAgdmFyIGRpbWVuc2lvbiA9IHRoaXMuYml0TWF0cml4LmdldEhlaWdodCgpOwoJICAgICAgICBkYXRhTWFzay51bm1hc2tCaXRNYXRyaXgodGhpcy5iaXRNYXRyaXgsIGRpbWVuc2lvbik7CgkgICAgICAgIHZhciBmdW5jdGlvblBhdHRlcm4gPSB2ZXJzaW9uLmJ1aWxkRnVuY3Rpb25QYXR0ZXJuKCk7CgkgICAgICAgIHZhciByZWFkaW5nVXAgPSB0cnVlOwoJICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IFVpbnQ4QXJyYXkodmVyc2lvbi5nZXRUb3RhbENvZGV3b3JkcygpKTsKCSAgICAgICAgdmFyIHJlc3VsdE9mZnNldCA9IDA7CgkgICAgICAgIHZhciBjdXJyZW50Qnl0ZSA9IDA7CgkgICAgICAgIHZhciBiaXRzUmVhZCA9IDA7CgkgICAgICAgIC8vIFJlYWQgY29sdW1ucyBpbiBwYWlycywgZnJvbSByaWdodCB0byBsZWZ0CgkgICAgICAgIGZvciAodmFyIGogPSBkaW1lbnNpb24gLSAxOyBqID4gMDsgaiAtPSAyKSB7CgkgICAgICAgICAgICBpZiAoaiA9PT0gNikgewoJICAgICAgICAgICAgICAgIC8vIFNraXAgd2hvbGUgY29sdW1uIHdpdGggdmVydGljYWwgYWxpZ25tZW50IHBhdHRlcm4KCSAgICAgICAgICAgICAgICAvLyBzYXZlcyB0aW1lIGFuZCBtYWtlcyB0aGUgb3RoZXIgY29kZSBwcm9jZWVkIG1vcmUgY2xlYW5seQoJICAgICAgICAgICAgICAgIGotLTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIC8vIFJlYWQgYWx0ZXJuYXRpbmdseSBmcm9tIGJvdHRvbSB0byB0b3AgdGhlbiB0b3AgdG8gYm90dG9tCgkgICAgICAgICAgICBmb3IgKHZhciBjb3VudCA9IDA7IGNvdW50IDwgZGltZW5zaW9uOyBjb3VudCsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIGkgPSByZWFkaW5nVXAgPyBkaW1lbnNpb24gLSAxIC0gY291bnQgOiBjb3VudDsKCSAgICAgICAgICAgICAgICBmb3IgKHZhciBjb2wgPSAwOyBjb2wgPCAyOyBjb2wrKykgewoJICAgICAgICAgICAgICAgICAgICAvLyBJZ25vcmUgYml0cyBjb3ZlcmVkIGJ5IHRoZSBmdW5jdGlvbiBwYXR0ZXJuCgkgICAgICAgICAgICAgICAgICAgIGlmICghZnVuY3Rpb25QYXR0ZXJuLmdldChqIC0gY29sLCBpKSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gUmVhZCBhIGJpdAoJICAgICAgICAgICAgICAgICAgICAgICAgYml0c1JlYWQrKzsKCSAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRCeXRlIDw8PSAxOwoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuYml0TWF0cml4LmdldChqIC0gY29sLCBpKSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRCeXRlIHw9IDE7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiB3ZSd2ZSBtYWRlIGEgd2hvbGUgYnl0ZSwgc2F2ZSBpdCBvZmYKCSAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiaXRzUmVhZCA9PT0gOCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdFtyZXN1bHRPZmZzZXQrK10gPSAvKihieXRlKSAqLyBjdXJyZW50Qnl0ZTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBiaXRzUmVhZCA9IDA7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudEJ5dGUgPSAwOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmVhZGluZ1VwID0gIXJlYWRpbmdVcDsgLy8gcmVhZGluZ1VwIF49IHRydWU7IC8vIHJlYWRpbmdVcCA9ICFyZWFkaW5nVXA7IC8vIHN3aXRjaCBkaXJlY3Rpb25zCgkgICAgICAgIH0KCSAgICAgICAgaWYgKHJlc3VsdE9mZnNldCAhPT0gdmVyc2lvbi5nZXRUb3RhbENvZGV3b3JkcygpKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEkMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldmVydCB0aGUgbWFzayByZW1vdmFsIGRvbmUgd2hpbGUgcmVhZGluZyB0aGUgY29kZSB3b3Jkcy4gVGhlIGJpdCBtYXRyaXggc2hvdWxkIHJldmVydCB0byBpdHMgb3JpZ2luYWwgc3RhdGUuCgkgICAgICovCgkgICAgQml0TWF0cml4UGFyc2VyLnByb3RvdHlwZS5yZW1hc2sgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIGlmICh0aGlzLnBhcnNlZEZvcm1hdEluZm8gPT09IG51bGwpIHsKCSAgICAgICAgICAgIHJldHVybjsgLy8gV2UgaGF2ZSBubyBmb3JtYXQgaW5mb3JtYXRpb24sIGFuZCBoYXZlIG5vIGRhdGEgbWFzawoJICAgICAgICB9CgkgICAgICAgIHZhciBkYXRhTWFzayA9IERhdGFNYXNrXzEuZGVmYXVsdC52YWx1ZXNbdGhpcy5wYXJzZWRGb3JtYXRJbmZvLmdldERhdGFNYXNrKCldOwoJICAgICAgICB2YXIgZGltZW5zaW9uID0gdGhpcy5iaXRNYXRyaXguZ2V0SGVpZ2h0KCk7CgkgICAgICAgIGRhdGFNYXNrLnVubWFza0JpdE1hdHJpeCh0aGlzLmJpdE1hdHJpeCwgZGltZW5zaW9uKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFByZXBhcmUgdGhlIHBhcnNlciBmb3IgYSBtaXJyb3JlZCBvcGVyYXRpb24uCgkgICAgICogVGhpcyBmbGFnIGhhcyBlZmZlY3Qgb25seSBvbiB0aGUge0BsaW5rICNyZWFkRm9ybWF0SW5mb3JtYXRpb24oKX0gYW5kIHRoZQoJICAgICAqIHtAbGluayAjcmVhZFZlcnNpb24oKX0uIEJlZm9yZSBwcm9jZWVkaW5nIHdpdGgge0BsaW5rICNyZWFkQ29kZXdvcmRzKCl9IHRoZQoJICAgICAqIHtAbGluayAjbWlycm9yKCl9IG1ldGhvZCBzaG91bGQgYmUgY2FsbGVkLgoJICAgICAqCgkgICAgICogQHBhcmFtIG1pcnJvciBXaGV0aGVyIHRvIHJlYWQgdmVyc2lvbiBhbmQgZm9ybWF0IGluZm9ybWF0aW9uIG1pcnJvcmVkLgoJICAgICAqLwoJICAgIEJpdE1hdHJpeFBhcnNlci5wcm90b3R5cGUuc2V0TWlycm9yID0gZnVuY3Rpb24gKGlzTWlycm9yKSB7CgkgICAgICAgIHRoaXMucGFyc2VkVmVyc2lvbiA9IG51bGw7CgkgICAgICAgIHRoaXMucGFyc2VkRm9ybWF0SW5mbyA9IG51bGw7CgkgICAgICAgIHRoaXMuaXNNaXJyb3IgPSBpc01pcnJvcjsKCSAgICB9OwoJICAgIC8qKiBNaXJyb3IgdGhlIGJpdCBtYXRyaXggaW4gb3JkZXIgdG8gYXR0ZW1wdCBhIHNlY29uZCByZWFkaW5nLiAqLwoJICAgIEJpdE1hdHJpeFBhcnNlci5wcm90b3R5cGUubWlycm9yID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgYml0TWF0cml4ID0gdGhpcy5iaXRNYXRyaXg7CgkgICAgICAgIGZvciAodmFyIHggPSAwLCB3aWR0aCA9IGJpdE1hdHJpeC5nZXRXaWR0aCgpOyB4IDwgd2lkdGg7IHgrKykgewoJICAgICAgICAgICAgZm9yICh2YXIgeSA9IHggKyAxLCBoZWlnaHQgPSBiaXRNYXRyaXguZ2V0SGVpZ2h0KCk7IHkgPCBoZWlnaHQ7IHkrKykgewoJICAgICAgICAgICAgICAgIGlmIChiaXRNYXRyaXguZ2V0KHgsIHkpICE9PSBiaXRNYXRyaXguZ2V0KHksIHgpKSB7CgkgICAgICAgICAgICAgICAgICAgIGJpdE1hdHJpeC5mbGlwKHksIHgpOwoJICAgICAgICAgICAgICAgICAgICBiaXRNYXRyaXguZmxpcCh4LCB5KTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICB9OwoJICAgIHJldHVybiBCaXRNYXRyaXhQYXJzZXI7Cgl9KCkpOwoJQml0TWF0cml4UGFyc2VyJDEuZGVmYXVsdCA9IEJpdE1hdHJpeFBhcnNlcjsKCgl2YXIgRGF0YUJsb2NrJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fdmFsdWVzJDMgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX192YWx1ZXMpIHx8IGZ1bmN0aW9uKG8pIHsKCSAgICB2YXIgcyA9IHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgU3ltYm9sLml0ZXJhdG9yLCBtID0gcyAmJiBvW3NdLCBpID0gMDsKCSAgICBpZiAobSkgcmV0dXJuIG0uY2FsbChvKTsKCSAgICBpZiAobyAmJiB0eXBlb2Ygby5sZW5ndGggPT09ICJudW1iZXIiKSByZXR1cm4gewoJICAgICAgICBuZXh0OiBmdW5jdGlvbiAoKSB7CgkgICAgICAgICAgICBpZiAobyAmJiBpID49IG8ubGVuZ3RoKSBvID0gdm9pZCAwOwoJICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6IG8gJiYgb1tpKytdLCBkb25lOiAhbyB9OwoJICAgICAgICB9CgkgICAgfTsKCSAgICB0aHJvdyBuZXcgVHlwZUVycm9yKHMgPyAiT2JqZWN0IGlzIG5vdCBpdGVyYWJsZS4iIDogIlN5bWJvbC5pdGVyYXRvciBpcyBub3QgZGVmaW5lZC4iKTsKCX07CglPYmplY3QuZGVmaW5lUHJvcGVydHkoRGF0YUJsb2NrJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQxID0gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uJDE7CgkvKioKCSAqIDxwPkVuY2Fwc3VsYXRlcyBhIGJsb2NrIG9mIGRhdGEgd2l0aGluIGEgUVIgQ29kZS4gUVIgQ29kZXMgbWF5IHNwbGl0IHRoZWlyIGRhdGEgaW50bwoJICogbXVsdGlwbGUgYmxvY2tzLCBlYWNoIG9mIHdoaWNoIGlzIGEgdW5pdCBvZiBkYXRhIGFuZCBlcnJvci1jb3JyZWN0aW9uIGNvZGV3b3Jkcy4gRWFjaAoJICogaXMgcmVwcmVzZW50ZWQgYnkgYW4gaW5zdGFuY2Ugb2YgdGhpcyBjbGFzcy48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIERhdGFCbG9jayA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBEYXRhQmxvY2sobnVtRGF0YUNvZGV3b3JkcyAvKmludCovLCBjb2Rld29yZHMpIHsKCSAgICAgICAgdGhpcy5udW1EYXRhQ29kZXdvcmRzID0gbnVtRGF0YUNvZGV3b3JkczsKCSAgICAgICAgdGhpcy5jb2Rld29yZHMgPSBjb2Rld29yZHM7CgkgICAgfQoJICAgIC8qKgoJICAgICAqIDxwPldoZW4gUVIgQ29kZXMgdXNlIG11bHRpcGxlIGRhdGEgYmxvY2tzLCB0aGV5IGFyZSBhY3R1YWxseSBpbnRlcmxlYXZlZC4KCSAgICAgKiBUaGF0IGlzLCB0aGUgZmlyc3QgYnl0ZSBvZiBkYXRhIGJsb2NrIDEgdG8gbiBpcyB3cml0dGVuLCB0aGVuIHRoZSBzZWNvbmQgYnl0ZXMsIGFuZCBzbyBvbi4gVGhpcwoJICAgICAqIG1ldGhvZCB3aWxsIHNlcGFyYXRlIHRoZSBkYXRhIGludG8gb3JpZ2luYWwgYmxvY2tzLjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSByYXdDb2Rld29yZHMgYnl0ZXMgYXMgcmVhZCBkaXJlY3RseSBmcm9tIHRoZSBRUiBDb2RlCgkgICAgICogQHBhcmFtIHZlcnNpb24gdmVyc2lvbiBvZiB0aGUgUVIgQ29kZQoJICAgICAqIEBwYXJhbSBlY0xldmVsIGVycm9yLWNvcnJlY3Rpb24gbGV2ZWwgb2YgdGhlIFFSIENvZGUKCSAgICAgKiBAcmV0dXJuIERhdGFCbG9ja3MgY29udGFpbmluZyBvcmlnaW5hbCBieXRlcywgImRlLWludGVybGVhdmVkIiBmcm9tIHJlcHJlc2VudGF0aW9uIGluIHRoZQoJICAgICAqICAgICAgICAgUVIgQ29kZQoJICAgICAqLwoJICAgIERhdGFCbG9jay5nZXREYXRhQmxvY2tzID0gZnVuY3Rpb24gKHJhd0NvZGV3b3JkcywgdmVyc2lvbiwgZWNMZXZlbCkgewoJICAgICAgICB2YXIgZV8xLCBfYSwgZV8yLCBfYjsKCSAgICAgICAgaWYgKHJhd0NvZGV3b3Jkcy5sZW5ndGggIT09IHZlcnNpb24uZ2V0VG90YWxDb2Rld29yZHMoKSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDEuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIC8vIEZpZ3VyZSBvdXQgdGhlIG51bWJlciBhbmQgc2l6ZSBvZiBkYXRhIGJsb2NrcyB1c2VkIGJ5IHRoaXMgdmVyc2lvbiBhbmQKCSAgICAgICAgLy8gZXJyb3IgY29ycmVjdGlvbiBsZXZlbAoJICAgICAgICB2YXIgZWNCbG9ja3MgPSB2ZXJzaW9uLmdldEVDQmxvY2tzRm9yTGV2ZWwoZWNMZXZlbCk7CgkgICAgICAgIC8vIEZpcnN0IGNvdW50IHRoZSB0b3RhbCBudW1iZXIgb2YgZGF0YSBibG9ja3MKCSAgICAgICAgdmFyIHRvdGFsQmxvY2tzID0gMDsKCSAgICAgICAgdmFyIGVjQmxvY2tBcnJheSA9IGVjQmxvY2tzLmdldEVDQmxvY2tzKCk7CgkgICAgICAgIHRyeSB7CgkgICAgICAgICAgICBmb3IgKHZhciBlY0Jsb2NrQXJyYXlfMSA9IF9fdmFsdWVzJDMoZWNCbG9ja0FycmF5KSwgZWNCbG9ja0FycmF5XzFfMSA9IGVjQmxvY2tBcnJheV8xLm5leHQoKTsgIWVjQmxvY2tBcnJheV8xXzEuZG9uZTsgZWNCbG9ja0FycmF5XzFfMSA9IGVjQmxvY2tBcnJheV8xLm5leHQoKSkgewoJICAgICAgICAgICAgICAgIHZhciBlY0Jsb2NrID0gZWNCbG9ja0FycmF5XzFfMS52YWx1ZTsKCSAgICAgICAgICAgICAgICB0b3RhbEJsb2NrcyArPSBlY0Jsb2NrLmdldENvdW50KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGVfMV8xKSB7IGVfMSA9IHsgZXJyb3I6IGVfMV8xIH07IH0KCSAgICAgICAgZmluYWxseSB7CgkgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgIGlmIChlY0Jsb2NrQXJyYXlfMV8xICYmICFlY0Jsb2NrQXJyYXlfMV8xLmRvbmUgJiYgKF9hID0gZWNCbG9ja0FycmF5XzEucmV0dXJuKSkgX2EuY2FsbChlY0Jsb2NrQXJyYXlfMSk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMSkgdGhyb3cgZV8xLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gTm93IGVzdGFibGlzaCBEYXRhQmxvY2tzIG9mIHRoZSBhcHByb3ByaWF0ZSBzaXplIGFuZCBudW1iZXIgb2YgZGF0YSBjb2Rld29yZHMKCSAgICAgICAgdmFyIHJlc3VsdCA9IG5ldyBBcnJheSh0b3RhbEJsb2Nrcyk7CgkgICAgICAgIHZhciBudW1SZXN1bHRCbG9ja3MgPSAwOwoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgZm9yICh2YXIgZWNCbG9ja0FycmF5XzIgPSBfX3ZhbHVlcyQzKGVjQmxvY2tBcnJheSksIGVjQmxvY2tBcnJheV8yXzEgPSBlY0Jsb2NrQXJyYXlfMi5uZXh0KCk7ICFlY0Jsb2NrQXJyYXlfMl8xLmRvbmU7IGVjQmxvY2tBcnJheV8yXzEgPSBlY0Jsb2NrQXJyYXlfMi5uZXh0KCkpIHsKCSAgICAgICAgICAgICAgICB2YXIgZWNCbG9jayA9IGVjQmxvY2tBcnJheV8yXzEudmFsdWU7CgkgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBlY0Jsb2NrLmdldENvdW50KCk7IGkrKykgewoJICAgICAgICAgICAgICAgICAgICB2YXIgbnVtRGF0YUNvZGV3b3JkcyA9IGVjQmxvY2suZ2V0RGF0YUNvZGV3b3JkcygpOwoJICAgICAgICAgICAgICAgICAgICB2YXIgbnVtQmxvY2tDb2Rld29yZHMgPSBlY0Jsb2Nrcy5nZXRFQ0NvZGV3b3Jkc1BlckJsb2NrKCkgKyBudW1EYXRhQ29kZXdvcmRzOwoJICAgICAgICAgICAgICAgICAgICByZXN1bHRbbnVtUmVzdWx0QmxvY2tzKytdID0gbmV3IERhdGFCbG9jayhudW1EYXRhQ29kZXdvcmRzLCBuZXcgVWludDhBcnJheShudW1CbG9ja0NvZGV3b3JkcykpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoZV8yXzEpIHsgZV8yID0geyBlcnJvcjogZV8yXzEgfTsgfQoJICAgICAgICBmaW5hbGx5IHsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgaWYgKGVjQmxvY2tBcnJheV8yXzEgJiYgIWVjQmxvY2tBcnJheV8yXzEuZG9uZSAmJiAoX2IgPSBlY0Jsb2NrQXJyYXlfMi5yZXR1cm4pKSBfYi5jYWxsKGVjQmxvY2tBcnJheV8yKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGZpbmFsbHkgeyBpZiAoZV8yKSB0aHJvdyBlXzIuZXJyb3I7IH0KCSAgICAgICAgfQoJICAgICAgICAvLyBBbGwgYmxvY2tzIGhhdmUgdGhlIHNhbWUgYW1vdW50IG9mIGRhdGEsIGV4Y2VwdCB0aGF0IHRoZSBsYXN0IG4KCSAgICAgICAgLy8gKHdoZXJlIG4gbWF5IGJlIDApIGhhdmUgMSBtb3JlIGJ5dGUuIEZpZ3VyZSBvdXQgd2hlcmUgdGhlc2Ugc3RhcnQuCgkgICAgICAgIHZhciBzaG9ydGVyQmxvY2tzVG90YWxDb2Rld29yZHMgPSByZXN1bHRbMF0uY29kZXdvcmRzLmxlbmd0aDsKCSAgICAgICAgdmFyIGxvbmdlckJsb2Nrc1N0YXJ0QXQgPSByZXN1bHQubGVuZ3RoIC0gMTsKCSAgICAgICAgLy8gVFlQRVNDUklQVFBPUlQ6IGNoZWNrIGxlbmd0aCBpcyBjb3JyZWN0IGhlcmUKCSAgICAgICAgd2hpbGUgKGxvbmdlckJsb2Nrc1N0YXJ0QXQgPj0gMCkgewoJICAgICAgICAgICAgdmFyIG51bUNvZGV3b3JkcyA9IHJlc3VsdFtsb25nZXJCbG9ja3NTdGFydEF0XS5jb2Rld29yZHMubGVuZ3RoOwoJICAgICAgICAgICAgaWYgKG51bUNvZGV3b3JkcyA9PT0gc2hvcnRlckJsb2Nrc1RvdGFsQ29kZXdvcmRzKSB7CgkgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBsb25nZXJCbG9ja3NTdGFydEF0LS07CgkgICAgICAgIH0KCSAgICAgICAgbG9uZ2VyQmxvY2tzU3RhcnRBdCsrOwoJICAgICAgICB2YXIgc2hvcnRlckJsb2Nrc051bURhdGFDb2Rld29yZHMgPSBzaG9ydGVyQmxvY2tzVG90YWxDb2Rld29yZHMgLSBlY0Jsb2Nrcy5nZXRFQ0NvZGV3b3Jkc1BlckJsb2NrKCk7CgkgICAgICAgIC8vIFRoZSBsYXN0IGVsZW1lbnRzIG9mIHJlc3VsdCBtYXkgYmUgMSBlbGVtZW50IGxvbmdlcgoJICAgICAgICAvLyBmaXJzdCBmaWxsIG91dCBhcyBtYW55IGVsZW1lbnRzIGFzIGFsbCBvZiB0aGVtIGhhdmUKCSAgICAgICAgdmFyIHJhd0NvZGV3b3Jkc09mZnNldCA9IDA7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2hvcnRlckJsb2Nrc051bURhdGFDb2Rld29yZHM7IGkrKykgewoJICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBudW1SZXN1bHRCbG9ja3M7IGorKykgewoJICAgICAgICAgICAgICAgIHJlc3VsdFtqXS5jb2Rld29yZHNbaV0gPSByYXdDb2Rld29yZHNbcmF3Q29kZXdvcmRzT2Zmc2V0KytdOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIC8vIEZpbGwgb3V0IHRoZSBsYXN0IGRhdGEgYmxvY2sgaW4gdGhlIGxvbmdlciBvbmVzCgkgICAgICAgIGZvciAodmFyIGogPSBsb25nZXJCbG9ja3NTdGFydEF0OyBqIDwgbnVtUmVzdWx0QmxvY2tzOyBqKyspIHsKCSAgICAgICAgICAgIHJlc3VsdFtqXS5jb2Rld29yZHNbc2hvcnRlckJsb2Nrc051bURhdGFDb2Rld29yZHNdID0gcmF3Q29kZXdvcmRzW3Jhd0NvZGV3b3Jkc09mZnNldCsrXTsKCSAgICAgICAgfQoJICAgICAgICAvLyBOb3cgYWRkIGluIGVycm9yIGNvcnJlY3Rpb24gYmxvY2tzCgkgICAgICAgIHZhciBtYXggPSByZXN1bHRbMF0uY29kZXdvcmRzLmxlbmd0aDsKCSAgICAgICAgZm9yICh2YXIgaSA9IHNob3J0ZXJCbG9ja3NOdW1EYXRhQ29kZXdvcmRzOyBpIDwgbWF4OyBpKyspIHsKCSAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgbnVtUmVzdWx0QmxvY2tzOyBqKyspIHsKCSAgICAgICAgICAgICAgICB2YXIgaU9mZnNldCA9IGogPCBsb25nZXJCbG9ja3NTdGFydEF0ID8gaSA6IGkgKyAxOwoJICAgICAgICAgICAgICAgIHJlc3VsdFtqXS5jb2Rld29yZHNbaU9mZnNldF0gPSByYXdDb2Rld29yZHNbcmF3Q29kZXdvcmRzT2Zmc2V0KytdOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiByZXN1bHQ7CgkgICAgfTsKCSAgICBEYXRhQmxvY2sucHJvdG90eXBlLmdldE51bURhdGFDb2Rld29yZHMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLm51bURhdGFDb2Rld29yZHM7CgkgICAgfTsKCSAgICBEYXRhQmxvY2sucHJvdG90eXBlLmdldENvZGV3b3JkcyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuY29kZXdvcmRzOwoJICAgIH07CgkgICAgcmV0dXJuIERhdGFCbG9jazsKCX0oKSk7CglEYXRhQmxvY2skMS5kZWZhdWx0ID0gRGF0YUJsb2NrOwoKCXZhciBEZWNvZGVkQml0U3RyZWFtUGFyc2VyJDEgPSB7fTsKCgl2YXIgQml0U291cmNlJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEJpdFNvdXJjZSQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKm5hbWVzcGFjZSBjb20uZ29vZ2xlLnp4aW5nLmNvbW1vbiB7Ki8KCXZhciBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSA9IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiA8cD5UaGlzIHByb3ZpZGVzIGFuIGVhc3kgYWJzdHJhY3Rpb24gdG8gcmVhZCBiaXRzIGF0IGEgdGltZSBmcm9tIGEgc2VxdWVuY2Ugb2YgYnl0ZXMsIHdoZXJlIHRoZQoJICogbnVtYmVyIG9mIGJpdHMgcmVhZCBpcyBub3Qgb2Z0ZW4gYSBtdWx0aXBsZSBvZiA4LjwvcD4KCSAqCgkgKiA8cD5UaGlzIGNsYXNzIGlzIHRocmVhZC1zYWZlIGJ1dCBub3QgcmVlbnRyYW50IC0tIHVubGVzcyB0aGUgY2FsbGVyIG1vZGlmaWVzIHRoZSBieXRlcyBhcnJheQoJICogaXQgcGFzc2VkIGluLCBpbiB3aGljaCBjYXNlIGFsbCBiZXRzIGFyZSBvZmYuPC9wPgoJICoKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBCaXRTb3VyY2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgLyoqCgkgICAgICogQHBhcmFtIGJ5dGVzIGJ5dGVzIGZyb20gd2hpY2ggdGhpcyB3aWxsIHJlYWQgYml0cy4gQml0cyB3aWxsIGJlIHJlYWQgZnJvbSB0aGUgZmlyc3QgYnl0ZSBmaXJzdC4KCSAgICAgKiBCaXRzIGFyZSByZWFkIHdpdGhpbiBhIGJ5dGUgZnJvbSBtb3N0LXNpZ25pZmljYW50IHRvIGxlYXN0LXNpZ25pZmljYW50IGJpdC4KCSAgICAgKi8KCSAgICBmdW5jdGlvbiBCaXRTb3VyY2UoYnl0ZXMpIHsKCSAgICAgICAgdGhpcy5ieXRlcyA9IGJ5dGVzOwoJICAgICAgICB0aGlzLmJ5dGVPZmZzZXQgPSAwOwoJICAgICAgICB0aGlzLmJpdE9mZnNldCA9IDA7CgkgICAgfQoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gaW5kZXggb2YgbmV4dCBiaXQgaW4gY3VycmVudCBieXRlIHdoaWNoIHdvdWxkIGJlIHJlYWQgYnkgdGhlIG5leHQgY2FsbCB0byB7QGxpbmsgI3JlYWRCaXRzKGludCl9LgoJICAgICAqLwoJICAgIEJpdFNvdXJjZS5wcm90b3R5cGUuZ2V0Qml0T2Zmc2V0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5iaXRPZmZzZXQ7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIGluZGV4IG9mIG5leHQgYnl0ZSBpbiBpbnB1dCBieXRlIGFycmF5IHdoaWNoIHdvdWxkIGJlIHJlYWQgYnkgdGhlIG5leHQgY2FsbCB0byB7QGxpbmsgI3JlYWRCaXRzKGludCl9LgoJICAgICAqLwoJICAgIEJpdFNvdXJjZS5wcm90b3R5cGUuZ2V0Qnl0ZU9mZnNldCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYnl0ZU9mZnNldDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBudW1CaXRzIG51bWJlciBvZiBiaXRzIHRvIHJlYWQKCSAgICAgKiBAcmV0dXJuIGludCByZXByZXNlbnRpbmcgdGhlIGJpdHMgcmVhZC4gVGhlIGJpdHMgd2lsbCBhcHBlYXIgYXMgdGhlIGxlYXN0LXNpZ25pZmljYW50CgkgICAgICogICAgICAgICBiaXRzIG9mIHRoZSBpbnQKCSAgICAgKiBAdGhyb3dzIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiBpZiBudW1CaXRzIGlzbid0IGluIFsxLDMyXSBvciBtb3JlIHRoYW4gaXMgYXZhaWxhYmxlCgkgICAgICovCgkgICAgQml0U291cmNlLnByb3RvdHlwZS5yZWFkQml0cyA9IGZ1bmN0aW9uIChudW1CaXRzIC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKG51bUJpdHMgPCAxIHx8IG51bUJpdHMgPiAzMiB8fCBudW1CaXRzID4gdGhpcy5hdmFpbGFibGUoKSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xLmRlZmF1bHQoJycgKyBudW1CaXRzKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgcmVzdWx0ID0gMDsKCSAgICAgICAgdmFyIGJpdE9mZnNldCA9IHRoaXMuYml0T2Zmc2V0OwoJICAgICAgICB2YXIgYnl0ZU9mZnNldCA9IHRoaXMuYnl0ZU9mZnNldDsKCSAgICAgICAgdmFyIGJ5dGVzID0gdGhpcy5ieXRlczsKCSAgICAgICAgLy8gRmlyc3QsIHJlYWQgcmVtYWluZGVyIGZyb20gY3VycmVudCBieXRlCgkgICAgICAgIGlmIChiaXRPZmZzZXQgPiAwKSB7CgkgICAgICAgICAgICB2YXIgYml0c0xlZnQgPSA4IC0gYml0T2Zmc2V0OwoJICAgICAgICAgICAgdmFyIHRvUmVhZCA9IG51bUJpdHMgPCBiaXRzTGVmdCA/IG51bUJpdHMgOiBiaXRzTGVmdDsKCSAgICAgICAgICAgIHZhciBiaXRzVG9Ob3RSZWFkID0gYml0c0xlZnQgLSB0b1JlYWQ7CgkgICAgICAgICAgICB2YXIgbWFzayA9ICgweEZGID4+ICg4IC0gdG9SZWFkKSkgPDwgYml0c1RvTm90UmVhZDsKCSAgICAgICAgICAgIHJlc3VsdCA9IChieXRlc1tieXRlT2Zmc2V0XSAmIG1hc2spID4+IGJpdHNUb05vdFJlYWQ7CgkgICAgICAgICAgICBudW1CaXRzIC09IHRvUmVhZDsKCSAgICAgICAgICAgIGJpdE9mZnNldCArPSB0b1JlYWQ7CgkgICAgICAgICAgICBpZiAoYml0T2Zmc2V0ID09PSA4KSB7CgkgICAgICAgICAgICAgICAgYml0T2Zmc2V0ID0gMDsKCSAgICAgICAgICAgICAgICBieXRlT2Zmc2V0Kys7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gTmV4dCByZWFkIHdob2xlIGJ5dGVzCgkgICAgICAgIGlmIChudW1CaXRzID4gMCkgewoJICAgICAgICAgICAgd2hpbGUgKG51bUJpdHMgPj0gOCkgewoJICAgICAgICAgICAgICAgIHJlc3VsdCA9IChyZXN1bHQgPDwgOCkgfCAoYnl0ZXNbYnl0ZU9mZnNldF0gJiAweEZGKTsKCSAgICAgICAgICAgICAgICBieXRlT2Zmc2V0Kys7CgkgICAgICAgICAgICAgICAgbnVtQml0cyAtPSA4OwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgLy8gRmluYWxseSByZWFkIGEgcGFydGlhbCBieXRlCgkgICAgICAgICAgICBpZiAobnVtQml0cyA+IDApIHsKCSAgICAgICAgICAgICAgICB2YXIgYml0c1RvTm90UmVhZCA9IDggLSBudW1CaXRzOwoJICAgICAgICAgICAgICAgIHZhciBtYXNrID0gKDB4RkYgPj4gYml0c1RvTm90UmVhZCkgPDwgYml0c1RvTm90UmVhZDsKCSAgICAgICAgICAgICAgICByZXN1bHQgPSAocmVzdWx0IDw8IG51bUJpdHMpIHwgKChieXRlc1tieXRlT2Zmc2V0XSAmIG1hc2spID4+IGJpdHNUb05vdFJlYWQpOwoJICAgICAgICAgICAgICAgIGJpdE9mZnNldCArPSBudW1CaXRzOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHRoaXMuYml0T2Zmc2V0ID0gYml0T2Zmc2V0OwoJICAgICAgICB0aGlzLmJ5dGVPZmZzZXQgPSBieXRlT2Zmc2V0OwoJICAgICAgICByZXR1cm4gcmVzdWx0OwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBudW1iZXIgb2YgYml0cyB0aGF0IGNhbiBiZSByZWFkIHN1Y2Nlc3NmdWxseQoJICAgICAqLwoJICAgIEJpdFNvdXJjZS5wcm90b3R5cGUuYXZhaWxhYmxlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gOCAqICh0aGlzLmJ5dGVzLmxlbmd0aCAtIHRoaXMuYnl0ZU9mZnNldCkgLSB0aGlzLmJpdE9mZnNldDsKCSAgICB9OwoJICAgIHJldHVybiBCaXRTb3VyY2U7Cgl9KCkpOwoJQml0U291cmNlJDEuZGVmYXVsdCA9IEJpdFNvdXJjZTsKCgl2YXIgRGVjb2RlclJlc3VsdCQxID0ge307CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShEZWNvZGVyUmVzdWx0JDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJLyppbXBvcnQgamF2YS51dGlsLkxpc3Q7Ki8KCS8qKgoJICogPHA+RW5jYXBzdWxhdGVzIHRoZSByZXN1bHQgb2YgZGVjb2RpbmcgYSBtYXRyaXggb2YgYml0cy4gVGhpcyB0eXBpY2FsbHkKCSAqIGFwcGxpZXMgdG8gMkQgYmFyY29kZSBmb3JtYXRzLiBGb3Igbm93IGl0IGNvbnRhaW5zIHRoZSByYXcgYnl0ZXMgb2J0YWluZWQsCgkgKiBhcyB3ZWxsIGFzIGEgU3RyaW5nIGludGVycHJldGF0aW9uIG9mIHRob3NlIGJ5dGVzLCBpZiBhcHBsaWNhYmxlLjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgRGVjb2RlclJlc3VsdCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICAvLyBwdWJsaWMgY29uc3RydWN0b3IocmF3Qnl0ZXM6IFVpbnQ4QXJyYXksCgkgICAgLy8gICAgICAgICAgICAgICAgICAgICAgdGV4dDogc3RyaW5nLAoJICAgIC8vICAgICAgICAgICAgICAgICAgICAgIExpc3Q8VWludDhBcnJheT4gYnl0ZVNlZ21lbnRzLAoJICAgIC8vICAgICAgICAgICAgICAgICAgICAgIFN0cmluZyBlY0xldmVsKSB7CgkgICAgLy8gICB0aGlzKHJhd0J5dGVzLCB0ZXh0LCBieXRlU2VnbWVudHMsIGVjTGV2ZWwsIC0xLCAtMSkKCSAgICAvLyB9CgkgICAgZnVuY3Rpb24gRGVjb2RlclJlc3VsdChyYXdCeXRlcywgdGV4dCwgYnl0ZVNlZ21lbnRzLCBlY0xldmVsLCBzdHJ1Y3R1cmVkQXBwZW5kU2VxdWVuY2VOdW1iZXIsIHN0cnVjdHVyZWRBcHBlbmRQYXJpdHkpIHsKCSAgICAgICAgaWYgKHN0cnVjdHVyZWRBcHBlbmRTZXF1ZW5jZU51bWJlciA9PT0gdm9pZCAwKSB7IHN0cnVjdHVyZWRBcHBlbmRTZXF1ZW5jZU51bWJlciA9IC0xOyB9CgkgICAgICAgIGlmIChzdHJ1Y3R1cmVkQXBwZW5kUGFyaXR5ID09PSB2b2lkIDApIHsgc3RydWN0dXJlZEFwcGVuZFBhcml0eSA9IC0xOyB9CgkgICAgICAgIHRoaXMucmF3Qnl0ZXMgPSByYXdCeXRlczsKCSAgICAgICAgdGhpcy50ZXh0ID0gdGV4dDsKCSAgICAgICAgdGhpcy5ieXRlU2VnbWVudHMgPSBieXRlU2VnbWVudHM7CgkgICAgICAgIHRoaXMuZWNMZXZlbCA9IGVjTGV2ZWw7CgkgICAgICAgIHRoaXMuc3RydWN0dXJlZEFwcGVuZFNlcXVlbmNlTnVtYmVyID0gc3RydWN0dXJlZEFwcGVuZFNlcXVlbmNlTnVtYmVyOwoJICAgICAgICB0aGlzLnN0cnVjdHVyZWRBcHBlbmRQYXJpdHkgPSBzdHJ1Y3R1cmVkQXBwZW5kUGFyaXR5OwoJICAgICAgICB0aGlzLm51bUJpdHMgPSAocmF3Qnl0ZXMgPT09IHVuZGVmaW5lZCB8fCByYXdCeXRlcyA9PT0gbnVsbCkgPyAwIDogOCAqIHJhd0J5dGVzLmxlbmd0aDsKCSAgICB9CgkgICAgLyoqCgkgICAgICogQHJldHVybiByYXcgYnl0ZXMgcmVwcmVzZW50aW5nIHRoZSByZXN1bHQsIG9yIHtAY29kZSBudWxsfSBpZiBub3QgYXBwbGljYWJsZQoJICAgICAqLwoJICAgIERlY29kZXJSZXN1bHQucHJvdG90eXBlLmdldFJhd0J5dGVzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5yYXdCeXRlczsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gaG93IG1hbnkgYml0cyBvZiB7QGxpbmsgI2dldFJhd0J5dGVzKCl9IGFyZSB2YWxpZDsgdHlwaWNhbGx5IDggdGltZXMgaXRzIGxlbmd0aAoJICAgICAqIEBzaW5jZSAzLjMuMAoJICAgICAqLwoJICAgIERlY29kZXJSZXN1bHQucHJvdG90eXBlLmdldE51bUJpdHMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLm51bUJpdHM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gbnVtQml0cyBvdmVycmlkZXMgdGhlIG51bWJlciBvZiBiaXRzIHRoYXQgYXJlIHZhbGlkIGluIHtAbGluayAjZ2V0UmF3Qnl0ZXMoKX0KCSAgICAgKiBAc2luY2UgMy4zLjAKCSAgICAgKi8KCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5zZXROdW1CaXRzID0gZnVuY3Rpb24gKG51bUJpdHMgLyppbnQqLykgewoJICAgICAgICB0aGlzLm51bUJpdHMgPSBudW1CaXRzOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiB0ZXh0IHJlcHJlc2VudGF0aW9uIG9mIHRoZSByZXN1bHQKCSAgICAgKi8KCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5nZXRUZXh0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy50ZXh0OwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBsaXN0IG9mIGJ5dGUgc2VnbWVudHMgaW4gdGhlIHJlc3VsdCwgb3Ige0Bjb2RlIG51bGx9IGlmIG5vdCBhcHBsaWNhYmxlCgkgICAgICovCgkgICAgRGVjb2RlclJlc3VsdC5wcm90b3R5cGUuZ2V0Qnl0ZVNlZ21lbnRzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5ieXRlU2VnbWVudHM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIG5hbWUgb2YgZXJyb3IgY29ycmVjdGlvbiBsZXZlbCB1c2VkLCBvciB7QGNvZGUgbnVsbH0gaWYgbm90IGFwcGxpY2FibGUKCSAgICAgKi8KCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5nZXRFQ0xldmVsID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5lY0xldmVsOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBudW1iZXIgb2YgZXJyb3JzIGNvcnJlY3RlZCwgb3Ige0Bjb2RlIG51bGx9IGlmIG5vdCBhcHBsaWNhYmxlCgkgICAgICovCgkgICAgRGVjb2RlclJlc3VsdC5wcm90b3R5cGUuZ2V0RXJyb3JzQ29ycmVjdGVkID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5lcnJvcnNDb3JyZWN0ZWQ7CgkgICAgfTsKCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5zZXRFcnJvcnNDb3JyZWN0ZWQgPSBmdW5jdGlvbiAoZXJyb3JzQ29ycmVjdGVkIC8qSW50ZWdlciovKSB7CgkgICAgICAgIHRoaXMuZXJyb3JzQ29ycmVjdGVkID0gZXJyb3JzQ29ycmVjdGVkOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBudW1iZXIgb2YgZXJhc3VyZXMgY29ycmVjdGVkLCBvciB7QGNvZGUgbnVsbH0gaWYgbm90IGFwcGxpY2FibGUKCSAgICAgKi8KCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5nZXRFcmFzdXJlcyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuZXJhc3VyZXM7CgkgICAgfTsKCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5zZXRFcmFzdXJlcyA9IGZ1bmN0aW9uIChlcmFzdXJlcyAvKkludGVnZXIqLykgewoJICAgICAgICB0aGlzLmVyYXN1cmVzID0gZXJhc3VyZXM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIGFyYml0cmFyeSBhZGRpdGlvbmFsIG1ldGFkYXRhCgkgICAgICovCgkgICAgRGVjb2RlclJlc3VsdC5wcm90b3R5cGUuZ2V0T3RoZXIgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLm90aGVyOwoJICAgIH07CgkgICAgRGVjb2RlclJlc3VsdC5wcm90b3R5cGUuc2V0T3RoZXIgPSBmdW5jdGlvbiAob3RoZXIpIHsKCSAgICAgICAgdGhpcy5vdGhlciA9IG90aGVyOwoJICAgIH07CgkgICAgRGVjb2RlclJlc3VsdC5wcm90b3R5cGUuaGFzU3RydWN0dXJlZEFwcGVuZCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuc3RydWN0dXJlZEFwcGVuZFBhcml0eSA+PSAwICYmIHRoaXMuc3RydWN0dXJlZEFwcGVuZFNlcXVlbmNlTnVtYmVyID49IDA7CgkgICAgfTsKCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5nZXRTdHJ1Y3R1cmVkQXBwZW5kUGFyaXR5ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5zdHJ1Y3R1cmVkQXBwZW5kUGFyaXR5OwoJICAgIH07CgkgICAgRGVjb2RlclJlc3VsdC5wcm90b3R5cGUuZ2V0U3RydWN0dXJlZEFwcGVuZFNlcXVlbmNlTnVtYmVyID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5zdHJ1Y3R1cmVkQXBwZW5kU2VxdWVuY2VOdW1iZXI7CgkgICAgfTsKCSAgICByZXR1cm4gRGVjb2RlclJlc3VsdDsKCX0oKSk7CglEZWNvZGVyUmVzdWx0JDEuZGVmYXVsdCA9IERlY29kZXJSZXN1bHQ7CgoJdmFyIE1vZGUgPSB7fTsKCgkoZnVuY3Rpb24gKGV4cG9ydHMpIHsKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJZXhwb3J0cy5Nb2RlVmFsdWVzID0gdm9pZCAwOwoJdmFyIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xID0gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uJDE7Cgl2YXIgTW9kZVZhbHVlczsKCShmdW5jdGlvbiAoTW9kZVZhbHVlcykgewoJICAgIE1vZGVWYWx1ZXNbTW9kZVZhbHVlc1siVEVSTUlOQVRPUiJdID0gMF0gPSAiVEVSTUlOQVRPUiI7CgkgICAgTW9kZVZhbHVlc1tNb2RlVmFsdWVzWyJOVU1FUklDIl0gPSAxXSA9ICJOVU1FUklDIjsKCSAgICBNb2RlVmFsdWVzW01vZGVWYWx1ZXNbIkFMUEhBTlVNRVJJQyJdID0gMl0gPSAiQUxQSEFOVU1FUklDIjsKCSAgICBNb2RlVmFsdWVzW01vZGVWYWx1ZXNbIlNUUlVDVFVSRURfQVBQRU5EIl0gPSAzXSA9ICJTVFJVQ1RVUkVEX0FQUEVORCI7CgkgICAgTW9kZVZhbHVlc1tNb2RlVmFsdWVzWyJCWVRFIl0gPSA0XSA9ICJCWVRFIjsKCSAgICBNb2RlVmFsdWVzW01vZGVWYWx1ZXNbIkVDSSJdID0gNV0gPSAiRUNJIjsKCSAgICBNb2RlVmFsdWVzW01vZGVWYWx1ZXNbIktBTkpJIl0gPSA2XSA9ICJLQU5KSSI7CgkgICAgTW9kZVZhbHVlc1tNb2RlVmFsdWVzWyJGTkMxX0ZJUlNUX1BPU0lUSU9OIl0gPSA3XSA9ICJGTkMxX0ZJUlNUX1BPU0lUSU9OIjsKCSAgICBNb2RlVmFsdWVzW01vZGVWYWx1ZXNbIkZOQzFfU0VDT05EX1BPU0lUSU9OIl0gPSA4XSA9ICJGTkMxX1NFQ09ORF9QT1NJVElPTiI7CgkgICAgLyoqIFNlZSBHQlQgMTgyODQtMjAwMDsgIkhhbnppIiBpcyBhIHRyYW5zbGl0ZXJhdGlvbiBvZiB0aGlzIG1vZGUgbmFtZS4gKi8KCSAgICBNb2RlVmFsdWVzW01vZGVWYWx1ZXNbIkhBTlpJIl0gPSA5XSA9ICJIQU5aSSI7Cgl9KShNb2RlVmFsdWVzID0gZXhwb3J0cy5Nb2RlVmFsdWVzIHx8IChleHBvcnRzLk1vZGVWYWx1ZXMgPSB7fSkpOwoJLyoqCgkgKiA8cD5TZWUgSVNPIDE4MDA0OjIwMDYsIDYuNC4xLCBUYWJsZXMgMiBhbmQgMy4gVGhpcyBlbnVtIGVuY2Fwc3VsYXRlcyB0aGUgdmFyaW91cyBtb2RlcyBpbiB3aGljaAoJICogZGF0YSBjYW4gYmUgZW5jb2RlZCB0byBiaXRzIGluIHRoZSBRUiBjb2RlIHN0YW5kYXJkLjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgTW9kZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBNb2RlKHZhbHVlLCBzdHJpbmdWYWx1ZSwgY2hhcmFjdGVyQ291bnRCaXRzRm9yVmVyc2lvbnMsIGJpdHMgLyppbnQqLykgewoJICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7CgkgICAgICAgIHRoaXMuc3RyaW5nVmFsdWUgPSBzdHJpbmdWYWx1ZTsKCSAgICAgICAgdGhpcy5jaGFyYWN0ZXJDb3VudEJpdHNGb3JWZXJzaW9ucyA9IGNoYXJhY3RlckNvdW50Qml0c0ZvclZlcnNpb25zOwoJICAgICAgICB0aGlzLmJpdHMgPSBiaXRzOwoJICAgICAgICBNb2RlLkZPUl9CSVRTLnNldChiaXRzLCB0aGlzKTsKCSAgICAgICAgTW9kZS5GT1JfVkFMVUUuc2V0KHZhbHVlLCB0aGlzKTsKCSAgICB9CgkgICAgLyoqCgkgICAgICogQHBhcmFtIGJpdHMgZm91ciBiaXRzIGVuY29kaW5nIGEgUVIgQ29kZSBkYXRhIG1vZGUKCSAgICAgKiBAcmV0dXJuIE1vZGUgZW5jb2RlZCBieSB0aGVzZSBiaXRzCgkgICAgICogQHRocm93cyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24gaWYgYml0cyBkbyBub3QgY29ycmVzcG9uZCB0byBhIGtub3duIG1vZGUKCSAgICAgKi8KCSAgICBNb2RlLmZvckJpdHMgPSBmdW5jdGlvbiAoYml0cyAvKmludCovKSB7CgkgICAgICAgIHZhciBtb2RlID0gTW9kZS5GT1JfQklUUy5nZXQoYml0cyk7CgkgICAgICAgIGlmICh1bmRlZmluZWQgPT09IG1vZGUpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIG1vZGU7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gdmVyc2lvbiB2ZXJzaW9uIGluIHF1ZXN0aW9uCgkgICAgICogQHJldHVybiBudW1iZXIgb2YgYml0cyB1c2VkLCBpbiB0aGlzIFFSIENvZGUgc3ltYm9sIHtAbGluayBWZXJzaW9ufSwgdG8gZW5jb2RlIHRoZQoJICAgICAqICAgICAgICAgY291bnQgb2YgY2hhcmFjdGVycyB0aGF0IHdpbGwgZm9sbG93IGVuY29kZWQgaW4gdGhpcyBNb2RlCgkgICAgICovCgkgICAgTW9kZS5wcm90b3R5cGUuZ2V0Q2hhcmFjdGVyQ291bnRCaXRzID0gZnVuY3Rpb24gKHZlcnNpb24pIHsKCSAgICAgICAgdmFyIHZlcnNpb25OdW1iZXIgPSB2ZXJzaW9uLmdldFZlcnNpb25OdW1iZXIoKTsKCSAgICAgICAgdmFyIG9mZnNldDsKCSAgICAgICAgaWYgKHZlcnNpb25OdW1iZXIgPD0gOSkgewoJICAgICAgICAgICAgb2Zmc2V0ID0gMDsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIGlmICh2ZXJzaW9uTnVtYmVyIDw9IDI2KSB7CgkgICAgICAgICAgICBvZmZzZXQgPSAxOwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgb2Zmc2V0ID0gMjsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gdGhpcy5jaGFyYWN0ZXJDb3VudEJpdHNGb3JWZXJzaW9uc1tvZmZzZXRdOwoJICAgIH07CgkgICAgTW9kZS5wcm90b3R5cGUuZ2V0VmFsdWUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnZhbHVlOwoJICAgIH07CgkgICAgTW9kZS5wcm90b3R5cGUuZ2V0Qml0cyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYml0czsKCSAgICB9OwoJICAgIE1vZGUucHJvdG90eXBlLmVxdWFscyA9IGZ1bmN0aW9uIChvKSB7CgkgICAgICAgIGlmICghKG8gaW5zdGFuY2VvZiBNb2RlKSkgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIHZhciBvdGhlciA9IG87CgkgICAgICAgIHJldHVybiB0aGlzLnZhbHVlID09PSBvdGhlci52YWx1ZTsKCSAgICB9OwoJICAgIE1vZGUucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5zdHJpbmdWYWx1ZTsKCSAgICB9OwoJICAgIE1vZGUuRk9SX0JJVFMgPSBuZXcgTWFwKCk7CgkgICAgTW9kZS5GT1JfVkFMVUUgPSBuZXcgTWFwKCk7CgkgICAgTW9kZS5URVJNSU5BVE9SID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5URVJNSU5BVE9SLCAnVEVSTUlOQVRPUicsIEludDMyQXJyYXkuZnJvbShbMCwgMCwgMF0pLCAweDAwKTsgLy8gTm90IHJlYWxseSBhIG1vZGUuLi4KCSAgICBNb2RlLk5VTUVSSUMgPSBuZXcgTW9kZShNb2RlVmFsdWVzLk5VTUVSSUMsICdOVU1FUklDJywgSW50MzJBcnJheS5mcm9tKFsxMCwgMTIsIDE0XSksIDB4MDEpOwoJICAgIE1vZGUuQUxQSEFOVU1FUklDID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5BTFBIQU5VTUVSSUMsICdBTFBIQU5VTUVSSUMnLCBJbnQzMkFycmF5LmZyb20oWzksIDExLCAxM10pLCAweDAyKTsKCSAgICBNb2RlLlNUUlVDVFVSRURfQVBQRU5EID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5TVFJVQ1RVUkVEX0FQUEVORCwgJ1NUUlVDVFVSRURfQVBQRU5EJywgSW50MzJBcnJheS5mcm9tKFswLCAwLCAwXSksIDB4MDMpOyAvLyBOb3Qgc3VwcG9ydGVkCgkgICAgTW9kZS5CWVRFID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5CWVRFLCAnQllURScsIEludDMyQXJyYXkuZnJvbShbOCwgMTYsIDE2XSksIDB4MDQpOwoJICAgIE1vZGUuRUNJID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5FQ0ksICdFQ0knLCBJbnQzMkFycmF5LmZyb20oWzAsIDAsIDBdKSwgMHgwNyk7IC8vIGNoYXJhY3RlciBjb3VudHMgZG9uJ3QgYXBwbHkKCSAgICBNb2RlLktBTkpJID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5LQU5KSSwgJ0tBTkpJJywgSW50MzJBcnJheS5mcm9tKFs4LCAxMCwgMTJdKSwgMHgwOCk7CgkgICAgTW9kZS5GTkMxX0ZJUlNUX1BPU0lUSU9OID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5GTkMxX0ZJUlNUX1BPU0lUSU9OLCAnRk5DMV9GSVJTVF9QT1NJVElPTicsIEludDMyQXJyYXkuZnJvbShbMCwgMCwgMF0pLCAweDA1KTsKCSAgICBNb2RlLkZOQzFfU0VDT05EX1BPU0lUSU9OID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5GTkMxX1NFQ09ORF9QT1NJVElPTiwgJ0ZOQzFfU0VDT05EX1BPU0lUSU9OJywgSW50MzJBcnJheS5mcm9tKFswLCAwLCAwXSksIDB4MDkpOwoJICAgIC8qKiBTZWUgR0JUIDE4Mjg0LTIwMDA7ICJIYW56aSIgaXMgYSB0cmFuc2xpdGVyYXRpb24gb2YgdGhpcyBtb2RlIG5hbWUuICovCgkgICAgTW9kZS5IQU5aSSA9IG5ldyBNb2RlKE1vZGVWYWx1ZXMuSEFOWkksICdIQU5aSScsIEludDMyQXJyYXkuZnJvbShbOCwgMTAsIDEyXSksIDB4MEQpOwoJICAgIHJldHVybiBNb2RlOwoJfSgpKTsKCWV4cG9ydHMuZGVmYXVsdCA9IE1vZGU7CgoJfShNb2RlKSk7CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShEZWNvZGVkQml0U3RyZWFtUGFyc2VyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcucXJjb2RlLmRlY29kZXIgeyovCgl2YXIgQml0U291cmNlXzEgPSBCaXRTb3VyY2UkMTsKCXZhciBDaGFyYWN0ZXJTZXRFQ0lfMSA9IENoYXJhY3RlclNldEVDSTsKCXZhciBEZWNvZGVyUmVzdWx0XzEgPSBEZWNvZGVyUmVzdWx0JDE7Cgl2YXIgU3RyaW5nVXRpbHNfMSA9IFN0cmluZ1V0aWxzJDE7Cgl2YXIgRm9ybWF0RXhjZXB0aW9uXzEgPSBGb3JtYXRFeGNlcHRpb24kMTsKCXZhciBTdHJpbmdCdWlsZGVyXzEgPSBTdHJpbmdCdWlsZGVyJDE7Cgl2YXIgU3RyaW5nRW5jb2RpbmdfMSA9IFN0cmluZ0VuY29kaW5nJDE7Cgl2YXIgTW9kZV8xID0gTW9kZTsKCS8qaW1wb3J0IGphdmEuaW8uVW5zdXBwb3J0ZWRFbmNvZGluZ0V4Y2VwdGlvbjsqLwoJLyppbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDsqLwoJLyppbXBvcnQgamF2YS51dGlsLkNvbGxlY3Rpb247Ki8KCS8qaW1wb3J0IGphdmEudXRpbC5MaXN0OyovCgkvKmltcG9ydCBqYXZhLnV0aWwuTWFwOyovCgkvKioKCSAqIDxwPlFSIENvZGVzIGNhbiBlbmNvZGUgdGV4dCBhcyBiaXRzIGluIG9uZSBvZiBzZXZlcmFsIG1vZGVzLCBhbmQgY2FuIHVzZSBtdWx0aXBsZSBtb2RlcwoJICogaW4gb25lIFFSIENvZGUuIFRoaXMgY2xhc3MgZGVjb2RlcyB0aGUgYml0cyBiYWNrIGludG8gdGV4dC48L3A+CgkgKgoJICogPHA+U2VlIElTTyAxODAwNDoyMDA2LCA2LjQuMyAtIDYuNC43PC9wPgoJICoKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBEZWNvZGVkQml0U3RyZWFtUGFyc2VyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIERlY29kZWRCaXRTdHJlYW1QYXJzZXIoKSB7CgkgICAgfQoJICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuZGVjb2RlID0gZnVuY3Rpb24gKGJ5dGVzLCB2ZXJzaW9uLCBlY0xldmVsLCBoaW50cykgewoJICAgICAgICB2YXIgYml0cyA9IG5ldyBCaXRTb3VyY2VfMS5kZWZhdWx0KGJ5dGVzKTsKCSAgICAgICAgdmFyIHJlc3VsdCA9IG5ldyBTdHJpbmdCdWlsZGVyXzEuZGVmYXVsdCgpOwoJICAgICAgICB2YXIgYnl0ZVNlZ21lbnRzID0gbmV3IEFycmF5KCk7IC8vIDEKCSAgICAgICAgLy8gVFlQRVNDUklQVFBPUlQ6IEkgZG8gbm90IHVzZSBjb25zdHJ1Y3RvciB3aXRoIHNpemUgMSBhcyBpbiBvcmlnaW5hbCBKYXZhIG1lYW5zIGNhcGFjaXR5IGFuZCB0aGUgYXJyYXkgbGVuZ3RoIGlzIGNoZWNrZWQgYmVsb3cKCSAgICAgICAgdmFyIHN5bWJvbFNlcXVlbmNlID0gLTE7CgkgICAgICAgIHZhciBwYXJpdHlEYXRhID0gLTE7CgkgICAgICAgIHRyeSB7CgkgICAgICAgICAgICB2YXIgY3VycmVudENoYXJhY3RlclNldEVDSSA9IG51bGw7CgkgICAgICAgICAgICB2YXIgZmMxSW5FZmZlY3QgPSBmYWxzZTsKCSAgICAgICAgICAgIHZhciBtb2RlID0gdm9pZCAwOwoJICAgICAgICAgICAgZG8gewoJICAgICAgICAgICAgICAgIC8vIFdoaWxlIHN0aWxsIGFub3RoZXIgc2VnbWVudCB0byByZWFkLi4uCgkgICAgICAgICAgICAgICAgaWYgKGJpdHMuYXZhaWxhYmxlKCkgPCA0KSB7CgkgICAgICAgICAgICAgICAgICAgIC8vIE9LLCBhc3N1bWUgd2UncmUgZG9uZS4gUmVhbGx5LCBhIFRFUk1JTkFUT1IgbW9kZSBzaG91bGQgaGF2ZSBiZWVuIHJlY29yZGVkIGhlcmUKCSAgICAgICAgICAgICAgICAgICAgbW9kZSA9IE1vZGVfMS5kZWZhdWx0LlRFUk1JTkFUT1I7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgICAgICAgICB2YXIgbW9kZUJpdHMgPSBiaXRzLnJlYWRCaXRzKDQpOwoJICAgICAgICAgICAgICAgICAgICBtb2RlID0gTW9kZV8xLmRlZmF1bHQuZm9yQml0cyhtb2RlQml0cyk7IC8vIG1vZGUgaXMgZW5jb2RlZCBieSA0IGJpdHMKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgc3dpdGNoIChtb2RlKSB7CgkgICAgICAgICAgICAgICAgICAgIGNhc2UgTW9kZV8xLmRlZmF1bHQuVEVSTUlOQVRPUjoKCSAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgICAgICBjYXNlIE1vZGVfMS5kZWZhdWx0LkZOQzFfRklSU1RfUE9TSVRJT046CgkgICAgICAgICAgICAgICAgICAgIGNhc2UgTW9kZV8xLmRlZmF1bHQuRk5DMV9TRUNPTkRfUE9TSVRJT046CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBXZSBkbyBsaXR0bGUgd2l0aCBGTkMxIGV4Y2VwdCBhbHRlciB0aGUgcGFyc2VkIHJlc3VsdCBhIGJpdCBhY2NvcmRpbmcgdG8gdGhlIHNwZWMKCSAgICAgICAgICAgICAgICAgICAgICAgIGZjMUluRWZmZWN0ID0gdHJ1ZTsKCSAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgICAgICBjYXNlIE1vZGVfMS5kZWZhdWx0LlNUUlVDVFVSRURfQVBQRU5EOgoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJpdHMuYXZhaWxhYmxlKCkgPCAxNikgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBGb3JtYXRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBzZXF1ZW5jZSBudW1iZXIgYW5kIHBhcml0eSBpcyBhZGRlZCBsYXRlciB0byB0aGUgcmVzdWx0IG1ldGFkYXRhCgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBSZWFkIG5leHQgOCBiaXRzIChzeW1ib2wgc2VxdWVuY2UgIykgYW5kIDggYml0cyAoZGF0YTogcGFyaXR5KSwgdGhlbiBjb250aW51ZQoJICAgICAgICAgICAgICAgICAgICAgICAgc3ltYm9sU2VxdWVuY2UgPSBiaXRzLnJlYWRCaXRzKDgpOwoJICAgICAgICAgICAgICAgICAgICAgICAgcGFyaXR5RGF0YSA9IGJpdHMucmVhZEJpdHMoOCk7CgkgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICAgICAgY2FzZSBNb2RlXzEuZGVmYXVsdC5FQ0k6CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBDb3VudCBkb2Vzbid0IGFwcGx5IHRvIEVDSQoJICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5wYXJzZUVDSVZhbHVlKGJpdHMpOwoJICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudENoYXJhY3RlclNldEVDSSA9IENoYXJhY3RlclNldEVDSV8xLmRlZmF1bHQuZ2V0Q2hhcmFjdGVyU2V0RUNJQnlWYWx1ZSh2YWx1ZSk7CgkgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudENoYXJhY3RlclNldEVDSSA9PT0gbnVsbCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBGb3JtYXRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICAgICAgY2FzZSBNb2RlXzEuZGVmYXVsdC5IQU5aSToKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZpcnN0IGhhbmRsZSBIYW56aSBtb2RlIHdoaWNoIGRvZXMgbm90IHN0YXJ0IHdpdGggY2hhcmFjdGVyIGNvdW50CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBDaGluZXNlIG1vZGUgY29udGFpbnMgYSBzdWIgc2V0IGluZGljYXRvciByaWdodCBhZnRlciBtb2RlIGluZGljYXRvcgoJICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1YnNldCA9IGJpdHMucmVhZEJpdHMoNCk7CgkgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY291bnRIYW56aSA9IGJpdHMucmVhZEJpdHMobW9kZS5nZXRDaGFyYWN0ZXJDb3VudEJpdHModmVyc2lvbikpOwoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN1YnNldCA9PT0gRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5HQjIzMTJfU1VCU0VUKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5kZWNvZGVIYW56aVNlZ21lbnQoYml0cywgcmVzdWx0LCBjb3VudEhhbnppKTsKCSAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OgoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gIk5vcm1hbCIgUVIgY29kZSBtb2RlczoKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIEhvdyBtYW55IGNoYXJhY3RlcnMgd2lsbCBmb2xsb3csIGVuY29kZWQgaW4gdGhpcyBtb2RlPwoJICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvdW50ID0gYml0cy5yZWFkQml0cyhtb2RlLmdldENoYXJhY3RlckNvdW50Qml0cyh2ZXJzaW9uKSk7CgkgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKG1vZGUpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIE1vZGVfMS5kZWZhdWx0Lk5VTUVSSUM6CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuZGVjb2RlTnVtZXJpY1NlZ21lbnQoYml0cywgcmVzdWx0LCBjb3VudCk7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgTW9kZV8xLmRlZmF1bHQuQUxQSEFOVU1FUklDOgoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBEZWNvZGVkQml0U3RyZWFtUGFyc2VyLmRlY29kZUFscGhhbnVtZXJpY1NlZ21lbnQoYml0cywgcmVzdWx0LCBjb3VudCwgZmMxSW5FZmZlY3QpOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIE1vZGVfMS5kZWZhdWx0LkJZVEU6CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuZGVjb2RlQnl0ZVNlZ21lbnQoYml0cywgcmVzdWx0LCBjb3VudCwgY3VycmVudENoYXJhY3RlclNldEVDSSwgYnl0ZVNlZ21lbnRzLCBoaW50cyk7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgTW9kZV8xLmRlZmF1bHQuS0FOSkk6CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuZGVjb2RlS2FuamlTZWdtZW50KGJpdHMsIHJlc3VsdCwgY291bnQpOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OgoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfSB3aGlsZSAobW9kZSAhPT0gTW9kZV8xLmRlZmF1bHQuVEVSTUlOQVRPUik7CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGlhZSAvKjogSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uKi8pIHsKCSAgICAgICAgICAgIC8vIGZyb20gcmVhZEJpdHMoKSBjYWxscwoJICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gbmV3IERlY29kZXJSZXN1bHRfMS5kZWZhdWx0KGJ5dGVzLCByZXN1bHQudG9TdHJpbmcoKSwgYnl0ZVNlZ21lbnRzLmxlbmd0aCA9PT0gMCA/IG51bGwgOiBieXRlU2VnbWVudHMsIGVjTGV2ZWwgPT09IG51bGwgPyBudWxsIDogZWNMZXZlbC50b1N0cmluZygpLCBzeW1ib2xTZXF1ZW5jZSwgcGFyaXR5RGF0YSk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBTZWUgc3BlY2lmaWNhdGlvbiBHQlQgMTgyODQtMjAwMAoJICAgICAqLwoJICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuZGVjb2RlSGFuemlTZWdtZW50ID0gZnVuY3Rpb24gKGJpdHMsIHJlc3VsdCwgY291bnQgLyppbnQqLykgewoJICAgICAgICAvLyBEb24ndCBjcmFzaCB0cnlpbmcgdG8gcmVhZCBtb3JlIGJpdHMgdGhhbiB3ZSBoYXZlIGF2YWlsYWJsZS4KCSAgICAgICAgaWYgKGNvdW50ICogMTMgPiBiaXRzLmF2YWlsYWJsZSgpKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIC8vIEVhY2ggY2hhcmFjdGVyIHdpbGwgcmVxdWlyZSAyIGJ5dGVzLiBSZWFkIHRoZSBjaGFyYWN0ZXJzIGFzIDItYnl0ZSBwYWlycwoJICAgICAgICAvLyBhbmQgZGVjb2RlIGFzIEdCMjMxMiBhZnRlcndhcmRzCgkgICAgICAgIHZhciBidWZmZXIgPSBuZXcgVWludDhBcnJheSgyICogY291bnQpOwoJICAgICAgICB2YXIgb2Zmc2V0ID0gMDsKCSAgICAgICAgd2hpbGUgKGNvdW50ID4gMCkgewoJICAgICAgICAgICAgLy8gRWFjaCAxMyBiaXRzIGVuY29kZXMgYSAyLWJ5dGUgY2hhcmFjdGVyCgkgICAgICAgICAgICB2YXIgdHdvQnl0ZXMgPSBiaXRzLnJlYWRCaXRzKDEzKTsKCSAgICAgICAgICAgIHZhciBhc3NlbWJsZWRUd29CeXRlcyA9ICgoKHR3b0J5dGVzIC8gMHgwNjApIDw8IDgpICYgMHhGRkZGRkZGRikgfCAodHdvQnl0ZXMgJSAweDA2MCk7CgkgICAgICAgICAgICBpZiAoYXNzZW1ibGVkVHdvQnl0ZXMgPCAweDAwM0JGKSB7CgkgICAgICAgICAgICAgICAgLy8gSW4gdGhlIDB4QTFBMSB0byAweEFBRkUgcmFuZ2UKCSAgICAgICAgICAgICAgICBhc3NlbWJsZWRUd29CeXRlcyArPSAweDBBMUExOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgLy8gSW4gdGhlIDB4QjBBMSB0byAweEZBRkUgcmFuZ2UKCSAgICAgICAgICAgICAgICBhc3NlbWJsZWRUd29CeXRlcyArPSAweDBBNkExOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgYnVmZmVyW29mZnNldF0gPSAvKihieXRlKSAqLyAoKGFzc2VtYmxlZFR3b0J5dGVzID4+IDgpICYgMHhGRik7CgkgICAgICAgICAgICBidWZmZXJbb2Zmc2V0ICsgMV0gPSAvKihieXRlKSAqLyAoYXNzZW1ibGVkVHdvQnl0ZXMgJiAweEZGKTsKCSAgICAgICAgICAgIG9mZnNldCArPSAyOwoJICAgICAgICAgICAgY291bnQtLTsKCSAgICAgICAgfQoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgcmVzdWx0LmFwcGVuZChTdHJpbmdFbmNvZGluZ18xLmRlZmF1bHQuZGVjb2RlKGJ1ZmZlciwgU3RyaW5nVXRpbHNfMS5kZWZhdWx0LkdCMjMxMikpOwoJICAgICAgICAgICAgLy8gVFlQRVNDUklQVFBPUlQ6IFRPRE86IGltcGxlbWVudCBHQjIzMTIgZGVjb2RlLiBTdHJpbmdWaWV3IGZyb20gTUROIGNvdWxkIGJlIGEgc3RhcnRpbmcgcG9pbnQKCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoaWdub3JlZCAvKjogVW5zdXBwb3J0ZWRFbmNvZGluZ0V4Y2VwdGlvbiovKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdChpZ25vcmVkKTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5kZWNvZGVLYW5qaVNlZ21lbnQgPSBmdW5jdGlvbiAoYml0cywgcmVzdWx0LCBjb3VudCAvKmludCovKSB7CgkgICAgICAgIC8vIERvbid0IGNyYXNoIHRyeWluZyB0byByZWFkIG1vcmUgYml0cyB0aGFuIHdlIGhhdmUgYXZhaWxhYmxlLgoJICAgICAgICBpZiAoY291bnQgKiAxMyA+IGJpdHMuYXZhaWxhYmxlKCkpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBGb3JtYXRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gRWFjaCBjaGFyYWN0ZXIgd2lsbCByZXF1aXJlIDIgYnl0ZXMuIFJlYWQgdGhlIGNoYXJhY3RlcnMgYXMgMi1ieXRlIHBhaXJzCgkgICAgICAgIC8vIGFuZCBkZWNvZGUgYXMgU2hpZnRfSklTIGFmdGVyd2FyZHMKCSAgICAgICAgdmFyIGJ1ZmZlciA9IG5ldyBVaW50OEFycmF5KDIgKiBjb3VudCk7CgkgICAgICAgIHZhciBvZmZzZXQgPSAwOwoJICAgICAgICB3aGlsZSAoY291bnQgPiAwKSB7CgkgICAgICAgICAgICAvLyBFYWNoIDEzIGJpdHMgZW5jb2RlcyBhIDItYnl0ZSBjaGFyYWN0ZXIKCSAgICAgICAgICAgIHZhciB0d29CeXRlcyA9IGJpdHMucmVhZEJpdHMoMTMpOwoJICAgICAgICAgICAgdmFyIGFzc2VtYmxlZFR3b0J5dGVzID0gKCgodHdvQnl0ZXMgLyAweDBDMCkgPDwgOCkgJiAweEZGRkZGRkZGKSB8ICh0d29CeXRlcyAlIDB4MEMwKTsKCSAgICAgICAgICAgIGlmIChhc3NlbWJsZWRUd29CeXRlcyA8IDB4MDFGMDApIHsKCSAgICAgICAgICAgICAgICAvLyBJbiB0aGUgMHg4MTQwIHRvIDB4OUZGQyByYW5nZQoJICAgICAgICAgICAgICAgIGFzc2VtYmxlZFR3b0J5dGVzICs9IDB4MDgxNDA7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAvLyBJbiB0aGUgMHhFMDQwIHRvIDB4RUJCRiByYW5nZQoJICAgICAgICAgICAgICAgIGFzc2VtYmxlZFR3b0J5dGVzICs9IDB4MEMxNDA7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBidWZmZXJbb2Zmc2V0XSA9IC8qKGJ5dGUpICovIChhc3NlbWJsZWRUd29CeXRlcyA+PiA4KTsKCSAgICAgICAgICAgIGJ1ZmZlcltvZmZzZXQgKyAxXSA9IC8qKGJ5dGUpICovIGFzc2VtYmxlZFR3b0J5dGVzOwoJICAgICAgICAgICAgb2Zmc2V0ICs9IDI7CgkgICAgICAgICAgICBjb3VudC0tOwoJICAgICAgICB9CgkgICAgICAgIC8vIFNoaWZ0X0pJUyBtYXkgbm90IGJlIHN1cHBvcnRlZCBpbiBzb21lIGVudmlyb25tZW50czoKCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQoU3RyaW5nRW5jb2RpbmdfMS5kZWZhdWx0LmRlY29kZShidWZmZXIsIFN0cmluZ1V0aWxzXzEuZGVmYXVsdC5TSElGVF9KSVMpKTsKCSAgICAgICAgICAgIC8vIFRZUEVTQ1JJUFRQT1JUOiBUT0RPOiBpbXBsZW1lbnQgU0hJRlRfSklTIGRlY29kZS4gU3RyaW5nVmlldyBmcm9tIE1ETiBjb3VsZCBiZSBhIHN0YXJ0aW5nIHBvaW50CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGlnbm9yZWQgLyo6IFVuc3VwcG9ydGVkRW5jb2RpbmdFeGNlcHRpb24qLykgewoJICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoaWdub3JlZCk7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuZGVjb2RlQnl0ZVNlZ21lbnQgPSBmdW5jdGlvbiAoYml0cywgcmVzdWx0LCBjb3VudCAvKmludCovLCBjdXJyZW50Q2hhcmFjdGVyU2V0RUNJLCBieXRlU2VnbWVudHMsIGhpbnRzKSB7CgkgICAgICAgIC8vIERvbid0IGNyYXNoIHRyeWluZyB0byByZWFkIG1vcmUgYml0cyB0aGFuIHdlIGhhdmUgYXZhaWxhYmxlLgoJICAgICAgICBpZiAoOCAqIGNvdW50ID4gYml0cy5hdmFpbGFibGUoKSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgcmVhZEJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkoY291bnQpOwoJICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvdW50OyBpKyspIHsKCSAgICAgICAgICAgIHJlYWRCeXRlc1tpXSA9IC8qKGJ5dGUpICovIGJpdHMucmVhZEJpdHMoOCk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGVuY29kaW5nOwoJICAgICAgICBpZiAoY3VycmVudENoYXJhY3RlclNldEVDSSA9PT0gbnVsbCkgewoJICAgICAgICAgICAgLy8gVGhlIHNwZWMgaXNuJ3QgY2xlYXIgb24gdGhpcyBtb2RlOyBzZWUKCSAgICAgICAgICAgIC8vIHNlY3Rpb24gNi40LjU6IHQgZG9lcyBub3Qgc2F5IHdoaWNoIGVuY29kaW5nIHRvIGFzc3VtaW5nCgkgICAgICAgICAgICAvLyB1cG9uIGRlY29kaW5nLiBJIGhhdmUgc2VlbiBJU08tODg1OS0xIHVzZWQgYXMgd2VsbCBhcwoJICAgICAgICAgICAgLy8gU2hpZnRfSklTIC0tIHdpdGhvdXQgYW55dGhpbmcgbGlrZSBhbiBFQ0kgZGVzaWduYXRvciB0bwoJICAgICAgICAgICAgLy8gZ2l2ZSBhIGhpbnQuCgkgICAgICAgICAgICBlbmNvZGluZyA9IFN0cmluZ1V0aWxzXzEuZGVmYXVsdC5ndWVzc0VuY29kaW5nKHJlYWRCeXRlcywgaGludHMpOwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgZW5jb2RpbmcgPSBjdXJyZW50Q2hhcmFjdGVyU2V0RUNJLmdldE5hbWUoKTsKCSAgICAgICAgfQoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgcmVzdWx0LmFwcGVuZChTdHJpbmdFbmNvZGluZ18xLmRlZmF1bHQuZGVjb2RlKHJlYWRCeXRlcywgZW5jb2RpbmcpKTsKCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoaWdub3JlZCAvKjogVW5zdXBwb3J0ZWRFbmNvZGluZ0V4Y2VwdGlvbiovKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdChpZ25vcmVkKTsKCSAgICAgICAgfQoJICAgICAgICBieXRlU2VnbWVudHMucHVzaChyZWFkQnl0ZXMpOwoJICAgIH07CgkgICAgRGVjb2RlZEJpdFN0cmVhbVBhcnNlci50b0FscGhhTnVtZXJpY0NoYXIgPSBmdW5jdGlvbiAodmFsdWUgLyppbnQqLykgewoJICAgICAgICBpZiAodmFsdWUgPj0gRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5BTFBIQU5VTUVSSUNfQ0hBUlMubGVuZ3RoKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBEZWNvZGVkQml0U3RyZWFtUGFyc2VyLkFMUEhBTlVNRVJJQ19DSEFSU1t2YWx1ZV07CgkgICAgfTsKCSAgICBEZWNvZGVkQml0U3RyZWFtUGFyc2VyLmRlY29kZUFscGhhbnVtZXJpY1NlZ21lbnQgPSBmdW5jdGlvbiAoYml0cywgcmVzdWx0LCBjb3VudCAvKmludCovLCBmYzFJbkVmZmVjdCkgewoJICAgICAgICAvLyBSZWFkIHR3byBjaGFyYWN0ZXJzIGF0IGEgdGltZQoJICAgICAgICB2YXIgc3RhcnQgPSByZXN1bHQubGVuZ3RoKCk7CgkgICAgICAgIHdoaWxlIChjb3VudCA+IDEpIHsKCSAgICAgICAgICAgIGlmIChiaXRzLmF2YWlsYWJsZSgpIDwgMTEpIHsKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgdmFyIG5leHRUd29DaGFyc0JpdHMgPSBiaXRzLnJlYWRCaXRzKDExKTsKCSAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQoRGVjb2RlZEJpdFN0cmVhbVBhcnNlci50b0FscGhhTnVtZXJpY0NoYXIoTWF0aC5mbG9vcihuZXh0VHdvQ2hhcnNCaXRzIC8gNDUpKSk7CgkgICAgICAgICAgICByZXN1bHQuYXBwZW5kKERlY29kZWRCaXRTdHJlYW1QYXJzZXIudG9BbHBoYU51bWVyaWNDaGFyKG5leHRUd29DaGFyc0JpdHMgJSA0NSkpOwoJICAgICAgICAgICAgY291bnQgLT0gMjsKCSAgICAgICAgfQoJICAgICAgICBpZiAoY291bnQgPT09IDEpIHsKCSAgICAgICAgICAgIC8vIHNwZWNpYWwgY2FzZTogb25lIGNoYXJhY3RlciBsZWZ0CgkgICAgICAgICAgICBpZiAoYml0cy5hdmFpbGFibGUoKSA8IDYpIHsKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmVzdWx0LmFwcGVuZChEZWNvZGVkQml0U3RyZWFtUGFyc2VyLnRvQWxwaGFOdW1lcmljQ2hhcihiaXRzLnJlYWRCaXRzKDYpKSk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gU2VlIHNlY3Rpb24gNi40LjguMSwgNi40LjguMgoJICAgICAgICBpZiAoZmMxSW5FZmZlY3QpIHsKCSAgICAgICAgICAgIC8vIFdlIG5lZWQgdG8gbWFzc2FnZSB0aGUgcmVzdWx0IGEgYml0IGlmIGluIGFuIEZOQzEgbW9kZToKCSAgICAgICAgICAgIGZvciAodmFyIGkgPSBzdGFydDsgaSA8IHJlc3VsdC5sZW5ndGgoKTsgaSsrKSB7CgkgICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5jaGFyQXQoaSkgPT09ICclJykgewoJICAgICAgICAgICAgICAgICAgICBpZiAoaSA8IHJlc3VsdC5sZW5ndGgoKSAtIDEgJiYgcmVzdWx0LmNoYXJBdChpICsgMSkgPT09ICclJykgewoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gJSUgaXMgcmVuZGVyZWQgYXMgJQoJICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmRlbGV0ZUNoYXJBdChpICsgMSk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBJbiBhbHBoYSBtb2RlLCAlIHNob3VsZCBiZSBjb252ZXJ0ZWQgdG8gRk5DMSBzZXBhcmF0b3IgMHgxRAoJICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnNldENoYXJBdChpLCBTdHJpbmcuZnJvbUNoYXJDb2RlKDB4MUQpKTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgIH07CgkgICAgRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5kZWNvZGVOdW1lcmljU2VnbWVudCA9IGZ1bmN0aW9uIChiaXRzLCByZXN1bHQsIGNvdW50IC8qaW50Ki8pIHsKCSAgICAgICAgLy8gUmVhZCB0aHJlZSBkaWdpdHMgYXQgYSB0aW1lCgkgICAgICAgIHdoaWxlIChjb3VudCA+PSAzKSB7CgkgICAgICAgICAgICAvLyBFYWNoIDEwIGJpdHMgZW5jb2RlcyB0aHJlZSBkaWdpdHMKCSAgICAgICAgICAgIGlmIChiaXRzLmF2YWlsYWJsZSgpIDwgMTApIHsKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgdmFyIHRocmVlRGlnaXRzQml0cyA9IGJpdHMucmVhZEJpdHMoMTApOwoJICAgICAgICAgICAgaWYgKHRocmVlRGlnaXRzQml0cyA+PSAxMDAwKSB7CgkgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQoRGVjb2RlZEJpdFN0cmVhbVBhcnNlci50b0FscGhhTnVtZXJpY0NoYXIoTWF0aC5mbG9vcih0aHJlZURpZ2l0c0JpdHMgLyAxMDApKSk7CgkgICAgICAgICAgICByZXN1bHQuYXBwZW5kKERlY29kZWRCaXRTdHJlYW1QYXJzZXIudG9BbHBoYU51bWVyaWNDaGFyKE1hdGguZmxvb3IodGhyZWVEaWdpdHNCaXRzIC8gMTApICUgMTApKTsKCSAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQoRGVjb2RlZEJpdFN0cmVhbVBhcnNlci50b0FscGhhTnVtZXJpY0NoYXIodGhyZWVEaWdpdHNCaXRzICUgMTApKTsKCSAgICAgICAgICAgIGNvdW50IC09IDM7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGNvdW50ID09PSAyKSB7CgkgICAgICAgICAgICAvLyBUd28gZGlnaXRzIGxlZnQgb3ZlciB0byByZWFkLCBlbmNvZGVkIGluIDcgYml0cwoJICAgICAgICAgICAgaWYgKGJpdHMuYXZhaWxhYmxlKCkgPCA3KSB7CgkgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHZhciB0d29EaWdpdHNCaXRzID0gYml0cy5yZWFkQml0cyg3KTsKCSAgICAgICAgICAgIGlmICh0d29EaWdpdHNCaXRzID49IDEwMCkgewoJICAgICAgICAgICAgICAgIHRocm93IG5ldyBGb3JtYXRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICByZXN1bHQuYXBwZW5kKERlY29kZWRCaXRTdHJlYW1QYXJzZXIudG9BbHBoYU51bWVyaWNDaGFyKE1hdGguZmxvb3IodHdvRGlnaXRzQml0cyAvIDEwKSkpOwoJICAgICAgICAgICAgcmVzdWx0LmFwcGVuZChEZWNvZGVkQml0U3RyZWFtUGFyc2VyLnRvQWxwaGFOdW1lcmljQ2hhcih0d29EaWdpdHNCaXRzICUgMTApKTsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIGlmIChjb3VudCA9PT0gMSkgewoJICAgICAgICAgICAgLy8gT25lIGRpZ2l0IGxlZnQgb3ZlciB0byByZWFkCgkgICAgICAgICAgICBpZiAoYml0cy5hdmFpbGFibGUoKSA8IDQpIHsKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgdmFyIGRpZ2l0Qml0cyA9IGJpdHMucmVhZEJpdHMoNCk7CgkgICAgICAgICAgICBpZiAoZGlnaXRCaXRzID49IDEwKSB7CgkgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQoRGVjb2RlZEJpdFN0cmVhbVBhcnNlci50b0FscGhhTnVtZXJpY0NoYXIoZGlnaXRCaXRzKSk7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIucGFyc2VFQ0lWYWx1ZSA9IGZ1bmN0aW9uIChiaXRzKSB7CgkgICAgICAgIHZhciBmaXJzdEJ5dGUgPSBiaXRzLnJlYWRCaXRzKDgpOwoJICAgICAgICBpZiAoKGZpcnN0Qnl0ZSAmIDB4ODApID09PSAwKSB7CgkgICAgICAgICAgICAvLyBqdXN0IG9uZSBieXRlCgkgICAgICAgICAgICByZXR1cm4gZmlyc3RCeXRlICYgMHg3RjsKCSAgICAgICAgfQoJICAgICAgICBpZiAoKGZpcnN0Qnl0ZSAmIDB4QzApID09PSAweDgwKSB7CgkgICAgICAgICAgICAvLyB0d28gYnl0ZXMKCSAgICAgICAgICAgIHZhciBzZWNvbmRCeXRlID0gYml0cy5yZWFkQml0cyg4KTsKCSAgICAgICAgICAgIHJldHVybiAoKChmaXJzdEJ5dGUgJiAweDNGKSA8PCA4KSAmIDB4RkZGRkZGRkYpIHwgc2Vjb25kQnl0ZTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoKGZpcnN0Qnl0ZSAmIDB4RTApID09PSAweEMwKSB7CgkgICAgICAgICAgICAvLyB0aHJlZSBieXRlcwoJICAgICAgICAgICAgdmFyIHNlY29uZFRoaXJkQnl0ZXMgPSBiaXRzLnJlYWRCaXRzKDE2KTsKCSAgICAgICAgICAgIHJldHVybiAoKChmaXJzdEJ5dGUgJiAweDFGKSA8PCAxNikgJiAweEZGRkZGRkZGKSB8IHNlY29uZFRoaXJkQnl0ZXM7CgkgICAgICAgIH0KCSAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFNlZSBJU08gMTgwMDQ6MjAwNiwgNi40LjQgVGFibGUgNQoJICAgICAqLwoJICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuQUxQSEFOVU1FUklDX0NIQVJTID0gJzAxMjM0NTY3ODlBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWiAkJSorLS4vOic7CgkgICAgRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5HQjIzMTJfU1VCU0VUID0gMTsKCSAgICByZXR1cm4gRGVjb2RlZEJpdFN0cmVhbVBhcnNlcjsKCX0oKSk7CglEZWNvZGVkQml0U3RyZWFtUGFyc2VyJDEuZGVmYXVsdCA9IERlY29kZWRCaXRTdHJlYW1QYXJzZXI7CgoJdmFyIFFSQ29kZURlY29kZXJNZXRhRGF0YSQxID0ge307CgoJLyoKCSAqIENvcHlyaWdodCAyMDEzIFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShRUkNvZGVEZWNvZGVyTWV0YURhdGEkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLyoqCgkgKiBNZXRhLWRhdGEgY29udGFpbmVyIGZvciBRUiBDb2RlIGRlY29kaW5nLiBJbnN0YW5jZXMgb2YgdGhpcyBjbGFzcyBtYXkgYmUgdXNlZCB0byBjb252ZXkgaW5mb3JtYXRpb24gYmFjayB0byB0aGUKCSAqIGRlY29kaW5nIGNhbGxlci4gQ2FsbGVycyBhcmUgZXhwZWN0ZWQgdG8gcHJvY2VzcyB0aGlzLgoJICoKCSAqIEBzZWUgY29tLmdvb2dsZS56eGluZy5jb21tb24uRGVjb2RlclJlc3VsdCNnZXRPdGhlcigpCgkgKi8KCXZhciBRUkNvZGVEZWNvZGVyTWV0YURhdGEgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gUVJDb2RlRGVjb2Rlck1ldGFEYXRhKG1pcnJvcmVkKSB7CgkgICAgICAgIHRoaXMubWlycm9yZWQgPSBtaXJyb3JlZDsKCSAgICB9CgkgICAgLyoqCgkgICAgICogQHJldHVybiB0cnVlIGlmIHRoZSBRUiBDb2RlIHdhcyBtaXJyb3JlZC4KCSAgICAgKi8KCSAgICBRUkNvZGVEZWNvZGVyTWV0YURhdGEucHJvdG90eXBlLmlzTWlycm9yZWQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLm1pcnJvcmVkOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQXBwbHkgdGhlIHJlc3VsdCBwb2ludHMnIG9yZGVyIGNvcnJlY3Rpb24gZHVlIHRvIG1pcnJvcmluZy4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBwb2ludHMgQXJyYXkgb2YgcG9pbnRzIHRvIGFwcGx5IG1pcnJvciBjb3JyZWN0aW9uIHRvLgoJICAgICAqLwoJICAgIFFSQ29kZURlY29kZXJNZXRhRGF0YS5wcm90b3R5cGUuYXBwbHlNaXJyb3JlZENvcnJlY3Rpb24gPSBmdW5jdGlvbiAocG9pbnRzKSB7CgkgICAgICAgIGlmICghdGhpcy5taXJyb3JlZCB8fCBwb2ludHMgPT09IG51bGwgfHwgcG9pbnRzLmxlbmd0aCA8IDMpIHsKCSAgICAgICAgICAgIHJldHVybjsKCSAgICAgICAgfQoJICAgICAgICB2YXIgYm90dG9tTGVmdCA9IHBvaW50c1swXTsKCSAgICAgICAgcG9pbnRzWzBdID0gcG9pbnRzWzJdOwoJICAgICAgICBwb2ludHNbMl0gPSBib3R0b21MZWZ0OwoJICAgICAgICAvLyBObyBuZWVkIHRvICdmaXgnIHRvcC1sZWZ0IGFuZCBhbGlnbm1lbnQgcGF0dGVybi4KCSAgICB9OwoJICAgIHJldHVybiBRUkNvZGVEZWNvZGVyTWV0YURhdGE7Cgl9KCkpOwoJUVJDb2RlRGVjb2Rlck1ldGFEYXRhJDEuZGVmYXVsdCA9IFFSQ29kZURlY29kZXJNZXRhRGF0YTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fdmFsdWVzJDIgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX192YWx1ZXMpIHx8IGZ1bmN0aW9uKG8pIHsKCSAgICB2YXIgcyA9IHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgU3ltYm9sLml0ZXJhdG9yLCBtID0gcyAmJiBvW3NdLCBpID0gMDsKCSAgICBpZiAobSkgcmV0dXJuIG0uY2FsbChvKTsKCSAgICBpZiAobyAmJiB0eXBlb2Ygby5sZW5ndGggPT09ICJudW1iZXIiKSByZXR1cm4gewoJICAgICAgICBuZXh0OiBmdW5jdGlvbiAoKSB7CgkgICAgICAgICAgICBpZiAobyAmJiBpID49IG8ubGVuZ3RoKSBvID0gdm9pZCAwOwoJICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6IG8gJiYgb1tpKytdLCBkb25lOiAhbyB9OwoJICAgICAgICB9CgkgICAgfTsKCSAgICB0aHJvdyBuZXcgVHlwZUVycm9yKHMgPyAiT2JqZWN0IGlzIG5vdCBpdGVyYWJsZS4iIDogIlN5bWJvbC5pdGVyYXRvciBpcyBub3QgZGVmaW5lZC4iKTsKCX07CglPYmplY3QuZGVmaW5lUHJvcGVydHkoRGVjb2RlciQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKm5hbWVzcGFjZSBjb20uZ29vZ2xlLnp4aW5nLnFyY29kZS5kZWNvZGVyIHsqLwoJdmFyIENoZWNrc3VtRXhjZXB0aW9uXzEgPSBDaGVja3N1bUV4Y2VwdGlvbiQxOwoJdmFyIEJpdE1hdHJpeF8xJDIgPSBCaXRNYXRyaXgkMTsKCXZhciBHZW5lcmljR0ZfMSA9IEdlbmVyaWNHRiQxOwoJdmFyIFJlZWRTb2xvbW9uRGVjb2Rlcl8xID0gUmVlZFNvbG9tb25EZWNvZGVyJDE7Cgl2YXIgQml0TWF0cml4UGFyc2VyXzEgPSBCaXRNYXRyaXhQYXJzZXIkMTsKCXZhciBEYXRhQmxvY2tfMSA9IERhdGFCbG9jayQxOwoJdmFyIERlY29kZWRCaXRTdHJlYW1QYXJzZXJfMSA9IERlY29kZWRCaXRTdHJlYW1QYXJzZXIkMTsKCXZhciBRUkNvZGVEZWNvZGVyTWV0YURhdGFfMSQxID0gUVJDb2RlRGVjb2Rlck1ldGFEYXRhJDE7CgkvKmltcG9ydCBqYXZhLnV0aWwuTWFwOyovCgkvKioKCSAqIDxwPlRoZSBtYWluIGNsYXNzIHdoaWNoIGltcGxlbWVudHMgUVIgQ29kZSBkZWNvZGluZyAtLSBhcyBvcHBvc2VkIHRvIGxvY2F0aW5nIGFuZCBleHRyYWN0aW5nCgkgKiB0aGUgUVIgQ29kZSBmcm9tIGFuIGltYWdlLjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgRGVjb2RlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBEZWNvZGVyKCkgewoJICAgICAgICB0aGlzLnJzRGVjb2RlciA9IG5ldyBSZWVkU29sb21vbkRlY29kZXJfMS5kZWZhdWx0KEdlbmVyaWNHRl8xLmRlZmF1bHQuUVJfQ09ERV9GSUVMRF8yNTYpOwoJICAgIH0KCSAgICAvLyBwdWJsaWMgZGVjb2RlKGltYWdlOiBib29sZWFuW11bXSk6IERlY29kZXJSZXN1bHQgLyp0aHJvd3MgQ2hlY2tzdW1FeGNlcHRpb24sIEZvcm1hdEV4Y2VwdGlvbiovIHsKCSAgICAvLyAgIHJldHVybiBkZWNvZGUoaW1hZ2UsIG51bGwpCgkgICAgLy8gfQoJICAgIC8qKgoJICAgICAqIDxwPkNvbnZlbmllbmNlIG1ldGhvZCB0aGF0IGNhbiBkZWNvZGUgYSBRUiBDb2RlIHJlcHJlc2VudGVkIGFzIGEgMkQgYXJyYXkgb2YgYm9vbGVhbnMuCgkgICAgICogInRydWUiIGlzIHRha2VuIHRvIG1lYW4gYSBibGFjayBtb2R1bGUuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGltYWdlIGJvb2xlYW5zIHJlcHJlc2VudGluZyB3aGl0ZS9ibGFjayBRUiBDb2RlIG1vZHVsZXMKCSAgICAgKiBAcGFyYW0gaGludHMgZGVjb2RpbmcgaGludHMgdGhhdCBzaG91bGQgYmUgdXNlZCB0byBpbmZsdWVuY2UgZGVjb2RpbmcKCSAgICAgKiBAcmV0dXJuIHRleHQgYW5kIGJ5dGVzIGVuY29kZWQgd2l0aGluIHRoZSBRUiBDb2RlCgkgICAgICogQHRocm93cyBGb3JtYXRFeGNlcHRpb24gaWYgdGhlIFFSIENvZGUgY2Fubm90IGJlIGRlY29kZWQKCSAgICAgKiBAdGhyb3dzIENoZWNrc3VtRXhjZXB0aW9uIGlmIGVycm9yIGNvcnJlY3Rpb24gZmFpbHMKCSAgICAgKi8KCSAgICBEZWNvZGVyLnByb3RvdHlwZS5kZWNvZGVCb29sZWFuQXJyYXkgPSBmdW5jdGlvbiAoaW1hZ2UsIGhpbnRzKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmRlY29kZUJpdE1hdHJpeChCaXRNYXRyaXhfMSQyLmRlZmF1bHQucGFyc2VGcm9tQm9vbGVhbkFycmF5KGltYWdlKSwgaGludHMpOwoJICAgIH07CgkgICAgLy8gcHVibGljIGRlY29kZUJpdE1hdHJpeChiaXRzOiBCaXRNYXRyaXgpOiBEZWNvZGVyUmVzdWx0IC8qdGhyb3dzIENoZWNrc3VtRXhjZXB0aW9uLCBGb3JtYXRFeGNlcHRpb24qLyB7CgkgICAgLy8gICByZXR1cm4gZGVjb2RlKGJpdHMsIG51bGwpCgkgICAgLy8gfQoJICAgIC8qKgoJICAgICAqIDxwPkRlY29kZXMgYSBRUiBDb2RlIHJlcHJlc2VudGVkIGFzIGEge0BsaW5rIEJpdE1hdHJpeH0uIEEgMSBvciAidHJ1ZSIgaXMgdGFrZW4gdG8gbWVhbiBhIGJsYWNrIG1vZHVsZS48L3A+CgkgICAgICoKCSAgICAgKiBAcGFyYW0gYml0cyBib29sZWFucyByZXByZXNlbnRpbmcgd2hpdGUvYmxhY2sgUVIgQ29kZSBtb2R1bGVzCgkgICAgICogQHBhcmFtIGhpbnRzIGRlY29kaW5nIGhpbnRzIHRoYXQgc2hvdWxkIGJlIHVzZWQgdG8gaW5mbHVlbmNlIGRlY29kaW5nCgkgICAgICogQHJldHVybiB0ZXh0IGFuZCBieXRlcyBlbmNvZGVkIHdpdGhpbiB0aGUgUVIgQ29kZQoJICAgICAqIEB0aHJvd3MgRm9ybWF0RXhjZXB0aW9uIGlmIHRoZSBRUiBDb2RlIGNhbm5vdCBiZSBkZWNvZGVkCgkgICAgICogQHRocm93cyBDaGVja3N1bUV4Y2VwdGlvbiBpZiBlcnJvciBjb3JyZWN0aW9uIGZhaWxzCgkgICAgICovCgkgICAgRGVjb2Rlci5wcm90b3R5cGUuZGVjb2RlQml0TWF0cml4ID0gZnVuY3Rpb24gKGJpdHMsIGhpbnRzKSB7CgkgICAgICAgIC8vIENvbnN0cnVjdCBhIHBhcnNlciBhbmQgcmVhZCB2ZXJzaW9uLCBlcnJvci1jb3JyZWN0aW9uIGxldmVsCgkgICAgICAgIHZhciBwYXJzZXIgPSBuZXcgQml0TWF0cml4UGFyc2VyXzEuZGVmYXVsdChiaXRzKTsKCSAgICAgICAgdmFyIGV4ID0gbnVsbDsKCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzLmRlY29kZUJpdE1hdHJpeFBhcnNlcihwYXJzZXIsIGhpbnRzKTsKCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoZSAvKjogRm9ybWF0RXhjZXB0aW9uLCBDaGVja3N1bUV4Y2VwdGlvbiovKSB7CgkgICAgICAgICAgICBleCA9IGU7CgkgICAgICAgIH0KCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIC8vIFJldmVydCB0aGUgYml0IG1hdHJpeAoJICAgICAgICAgICAgcGFyc2VyLnJlbWFzaygpOwoJICAgICAgICAgICAgLy8gV2lsbCBiZSBhdHRlbXB0aW5nIGEgbWlycm9yZWQgcmVhZGluZyBvZiB0aGUgdmVyc2lvbiBhbmQgZm9ybWF0IGluZm8uCgkgICAgICAgICAgICBwYXJzZXIuc2V0TWlycm9yKHRydWUpOwoJICAgICAgICAgICAgLy8gUHJlZW1wdGl2ZWx5IHJlYWQgdGhlIHZlcnNpb24uCgkgICAgICAgICAgICBwYXJzZXIucmVhZFZlcnNpb24oKTsKCSAgICAgICAgICAgIC8vIFByZWVtcHRpdmVseSByZWFkIHRoZSBmb3JtYXQgaW5mb3JtYXRpb24uCgkgICAgICAgICAgICBwYXJzZXIucmVhZEZvcm1hdEluZm9ybWF0aW9uKCk7CgkgICAgICAgICAgICAvKgoJICAgICAgICAgICAgICogU2luY2Ugd2UncmUgaGVyZSwgdGhpcyBtZWFucyB3ZSBoYXZlIHN1Y2Nlc3NmdWxseSBkZXRlY3RlZCBzb21lIGtpbmQKCSAgICAgICAgICAgICAqIG9mIHZlcnNpb24gYW5kIGZvcm1hdCBpbmZvcm1hdGlvbiB3aGVuIG1pcnJvcmVkLiBUaGlzIGlzIGEgZ29vZCBzaWduLAoJICAgICAgICAgICAgICogdGhhdCB0aGUgUVIgY29kZSBtYXkgYmUgbWlycm9yZWQsIGFuZCB3ZSBzaG91bGQgdHJ5IG9uY2UgbW9yZSB3aXRoIGEKCSAgICAgICAgICAgICAqIG1pcnJvcmVkIGNvbnRlbnQuCgkgICAgICAgICAgICAgKi8KCSAgICAgICAgICAgIC8vIFByZXBhcmUgZm9yIGEgbWlycm9yZWQgcmVhZGluZy4KCSAgICAgICAgICAgIHBhcnNlci5taXJyb3IoKTsKCSAgICAgICAgICAgIHZhciByZXN1bHQgPSB0aGlzLmRlY29kZUJpdE1hdHJpeFBhcnNlcihwYXJzZXIsIGhpbnRzKTsKCSAgICAgICAgICAgIC8vIFN1Y2Nlc3MhIE5vdGlmeSB0aGUgY2FsbGVyIHRoYXQgdGhlIGNvZGUgd2FzIG1pcnJvcmVkLgoJICAgICAgICAgICAgcmVzdWx0LnNldE90aGVyKG5ldyBRUkNvZGVEZWNvZGVyTWV0YURhdGFfMSQxLmRlZmF1bHQodHJ1ZSkpOwoJICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoZSAvKkZvcm1hdEV4Y2VwdGlvbiB8IENoZWNrc3VtRXhjZXB0aW9uKi8pIHsKCSAgICAgICAgICAgIC8vIFRocm93IHRoZSBleGNlcHRpb24gZnJvbSB0aGUgb3JpZ2luYWwgcmVhZGluZwoJICAgICAgICAgICAgaWYgKGV4ICE9PSBudWxsKSB7CgkgICAgICAgICAgICAgICAgdGhyb3cgZXg7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB0aHJvdyBlOwoJICAgICAgICB9CgkgICAgfTsKCSAgICBEZWNvZGVyLnByb3RvdHlwZS5kZWNvZGVCaXRNYXRyaXhQYXJzZXIgPSBmdW5jdGlvbiAocGFyc2VyLCBoaW50cykgewoJICAgICAgICB2YXIgZV8xLCBfYSwgZV8yLCBfYjsKCSAgICAgICAgdmFyIHZlcnNpb24gPSBwYXJzZXIucmVhZFZlcnNpb24oKTsKCSAgICAgICAgdmFyIGVjTGV2ZWwgPSBwYXJzZXIucmVhZEZvcm1hdEluZm9ybWF0aW9uKCkuZ2V0RXJyb3JDb3JyZWN0aW9uTGV2ZWwoKTsKCSAgICAgICAgLy8gUmVhZCBjb2Rld29yZHMKCSAgICAgICAgdmFyIGNvZGV3b3JkcyA9IHBhcnNlci5yZWFkQ29kZXdvcmRzKCk7CgkgICAgICAgIC8vIFNlcGFyYXRlIGludG8gZGF0YSBibG9ja3MKCSAgICAgICAgdmFyIGRhdGFCbG9ja3MgPSBEYXRhQmxvY2tfMS5kZWZhdWx0LmdldERhdGFCbG9ja3MoY29kZXdvcmRzLCB2ZXJzaW9uLCBlY0xldmVsKTsKCSAgICAgICAgLy8gQ291bnQgdG90YWwgbnVtYmVyIG9mIGRhdGEgYnl0ZXMKCSAgICAgICAgdmFyIHRvdGFsQnl0ZXMgPSAwOwoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgZm9yICh2YXIgZGF0YUJsb2Nrc18xID0gX192YWx1ZXMkMihkYXRhQmxvY2tzKSwgZGF0YUJsb2Nrc18xXzEgPSBkYXRhQmxvY2tzXzEubmV4dCgpOyAhZGF0YUJsb2Nrc18xXzEuZG9uZTsgZGF0YUJsb2Nrc18xXzEgPSBkYXRhQmxvY2tzXzEubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgdmFyIGRhdGFCbG9jayA9IGRhdGFCbG9ja3NfMV8xLnZhbHVlOwoJICAgICAgICAgICAgICAgIHRvdGFsQnl0ZXMgKz0gZGF0YUJsb2NrLmdldE51bURhdGFDb2Rld29yZHMoKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoZV8xXzEpIHsgZV8xID0geyBlcnJvcjogZV8xXzEgfTsgfQoJICAgICAgICBmaW5hbGx5IHsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgaWYgKGRhdGFCbG9ja3NfMV8xICYmICFkYXRhQmxvY2tzXzFfMS5kb25lICYmIChfYSA9IGRhdGFCbG9ja3NfMS5yZXR1cm4pKSBfYS5jYWxsKGRhdGFCbG9ja3NfMSk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMSkgdGhyb3cgZV8xLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHJlc3VsdEJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkodG90YWxCeXRlcyk7CgkgICAgICAgIHZhciByZXN1bHRPZmZzZXQgPSAwOwoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgLy8gRXJyb3ItY29ycmVjdCBhbmQgY29weSBkYXRhIGJsb2NrcyB0b2dldGhlciBpbnRvIGEgc3RyZWFtIG9mIGJ5dGVzCgkgICAgICAgICAgICBmb3IgKHZhciBkYXRhQmxvY2tzXzIgPSBfX3ZhbHVlcyQyKGRhdGFCbG9ja3MpLCBkYXRhQmxvY2tzXzJfMSA9IGRhdGFCbG9ja3NfMi5uZXh0KCk7ICFkYXRhQmxvY2tzXzJfMS5kb25lOyBkYXRhQmxvY2tzXzJfMSA9IGRhdGFCbG9ja3NfMi5uZXh0KCkpIHsKCSAgICAgICAgICAgICAgICB2YXIgZGF0YUJsb2NrID0gZGF0YUJsb2Nrc18yXzEudmFsdWU7CgkgICAgICAgICAgICAgICAgdmFyIGNvZGV3b3JkQnl0ZXMgPSBkYXRhQmxvY2suZ2V0Q29kZXdvcmRzKCk7CgkgICAgICAgICAgICAgICAgdmFyIG51bURhdGFDb2Rld29yZHMgPSBkYXRhQmxvY2suZ2V0TnVtRGF0YUNvZGV3b3JkcygpOwoJICAgICAgICAgICAgICAgIHRoaXMuY29ycmVjdEVycm9ycyhjb2Rld29yZEJ5dGVzLCBudW1EYXRhQ29kZXdvcmRzKTsKCSAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG51bURhdGFDb2Rld29yZHM7IGkrKykgewoJICAgICAgICAgICAgICAgICAgICByZXN1bHRCeXRlc1tyZXN1bHRPZmZzZXQrK10gPSBjb2Rld29yZEJ5dGVzW2ldOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoZV8yXzEpIHsgZV8yID0geyBlcnJvcjogZV8yXzEgfTsgfQoJICAgICAgICBmaW5hbGx5IHsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgaWYgKGRhdGFCbG9ja3NfMl8xICYmICFkYXRhQmxvY2tzXzJfMS5kb25lICYmIChfYiA9IGRhdGFCbG9ja3NfMi5yZXR1cm4pKSBfYi5jYWxsKGRhdGFCbG9ja3NfMik7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMikgdGhyb3cgZV8yLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gRGVjb2RlIHRoZSBjb250ZW50cyBvZiB0aGF0IHN0cmVhbSBvZiBieXRlcwoJICAgICAgICByZXR1cm4gRGVjb2RlZEJpdFN0cmVhbVBhcnNlcl8xLmRlZmF1bHQuZGVjb2RlKHJlc3VsdEJ5dGVzLCB2ZXJzaW9uLCBlY0xldmVsLCBoaW50cyk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiA8cD5HaXZlbiBkYXRhIGFuZCBlcnJvci1jb3JyZWN0aW9uIGNvZGV3b3JkcyByZWNlaXZlZCwgcG9zc2libHkgY29ycnVwdGVkIGJ5IGVycm9ycywgYXR0ZW1wdHMgdG8KCSAgICAgKiBjb3JyZWN0IHRoZSBlcnJvcnMgaW4tcGxhY2UgdXNpbmcgUmVlZC1Tb2xvbW9uIGVycm9yIGNvcnJlY3Rpb24uPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGNvZGV3b3JkQnl0ZXMgZGF0YSBhbmQgZXJyb3IgY29ycmVjdGlvbiBjb2Rld29yZHMKCSAgICAgKiBAcGFyYW0gbnVtRGF0YUNvZGV3b3JkcyBudW1iZXIgb2YgY29kZXdvcmRzIHRoYXQgYXJlIGRhdGEgYnl0ZXMKCSAgICAgKiBAdGhyb3dzIENoZWNrc3VtRXhjZXB0aW9uIGlmIGVycm9yIGNvcnJlY3Rpb24gZmFpbHMKCSAgICAgKi8KCSAgICBEZWNvZGVyLnByb3RvdHlwZS5jb3JyZWN0RXJyb3JzID0gZnVuY3Rpb24gKGNvZGV3b3JkQnl0ZXMsIG51bURhdGFDb2Rld29yZHMgLyppbnQqLykgewoJICAgICAgICAvLyBjb25zdCBudW1Db2Rld29yZHMgPSBjb2Rld29yZEJ5dGVzLmxlbmd0aDsKCSAgICAgICAgLy8gRmlyc3QgcmVhZCBpbnRvIGFuIGFycmF5IG9mIGludHMKCSAgICAgICAgdmFyIGNvZGV3b3Jkc0ludHMgPSBuZXcgSW50MzJBcnJheShjb2Rld29yZEJ5dGVzKTsKCSAgICAgICAgLy8gVFlQRVNDUklQVFBPUlQ6IG5vdCByZWFseSBuZWNlc3NhcnkgdG8gdHJhbnNmb3JtIHRvIGludHM/IGNvdWxkIHJlZGVzaWduIGV2ZXJ5dGhpbmcgdG8gd29yayB3aXRoIHVuc2lnbmVkIGJ5dGVzPwoJICAgICAgICAvLyBjb25zdCBjb2Rld29yZHNJbnRzID0gbmV3IEludDMyQXJyYXkobnVtQ29kZXdvcmRzKQoJICAgICAgICAvLyBmb3IgKGxldCBpID0gMDsgaSA8IG51bUNvZGV3b3JkczsgaSsrKSB7CgkgICAgICAgIC8vICAgY29kZXdvcmRzSW50c1tpXSA9IGNvZGV3b3JkQnl0ZXNbaV0gJiAweEZGCgkgICAgICAgIC8vIH0KCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIHRoaXMucnNEZWNvZGVyLmRlY29kZShjb2Rld29yZHNJbnRzLCBjb2Rld29yZEJ5dGVzLmxlbmd0aCAtIG51bURhdGFDb2Rld29yZHMpOwoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChpZ25vcmVkIC8qOiBSZWVkU29sb21vbkV4Y2VwdGlvbiovKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgQ2hlY2tzdW1FeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gQ29weSBiYWNrIGludG8gYXJyYXkgb2YgYnl0ZXMgLS0gb25seSBuZWVkIHRvIHdvcnJ5IGFib3V0IHRoZSBieXRlcyB0aGF0IHdlcmUgZGF0YQoJICAgICAgICAvLyBXZSBkb24ndCBjYXJlIGFib3V0IGVycm9ycyBpbiB0aGUgZXJyb3ItY29ycmVjdGlvbiBjb2Rld29yZHMKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBudW1EYXRhQ29kZXdvcmRzOyBpKyspIHsKCSAgICAgICAgICAgIGNvZGV3b3JkQnl0ZXNbaV0gPSAvKihieXRlKSAqLyBjb2Rld29yZHNJbnRzW2ldOwoJICAgICAgICB9CgkgICAgfTsKCSAgICByZXR1cm4gRGVjb2RlcjsKCX0oKSk7CglEZWNvZGVyJDEuZGVmYXVsdCA9IERlY29kZXI7CgoJdmFyIERldGVjdG9yJDEgPSB7fTsKCgl2YXIgTWF0aFV0aWxzJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMTIgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KE1hdGhVdGlscyQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKm5hbWVzcGFjZSBjb20uZ29vZ2xlLnp4aW5nLmNvbW1vbi5kZXRlY3RvciB7Ki8KCS8qKgoJICogR2VuZXJhbCBtYXRoLXJlbGF0ZWQgYW5kIG51bWVyaWMgdXRpbGl0eSBmdW5jdGlvbnMuCgkgKi8KCXZhciBNYXRoVXRpbHMgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gTWF0aFV0aWxzKCkgewoJICAgIH0KCSAgICAvKioKCSAgICAgKiBFbmRzIHVwIGJlaW5nIGEgYml0IGZhc3RlciB0aGFuIHtAbGluayBNYXRoI3JvdW5kKGZsb2F0KX0uIFRoaXMgbWVyZWx5IHJvdW5kcyBpdHMKCSAgICAgKiBhcmd1bWVudCB0byB0aGUgbmVhcmVzdCBpbnQsIHdoZXJlIHguNSByb3VuZHMgdXAgdG8geCsxLiBTZW1hbnRpY3Mgb2YgdGhpcyBzaG9ydGN1dAoJICAgICAqIGRpZmZlciBzbGlnaHRseSBmcm9tIHtAbGluayBNYXRoI3JvdW5kKGZsb2F0KX0gaW4gdGhhdCBoYWxmIHJvdW5kcyBkb3duIGZvciBuZWdhdGl2ZQoJICAgICAqIHZhbHVlcy4gLTIuNSByb3VuZHMgdG8gLTMsIG5vdCAtMi4gRm9yIHB1cnBvc2VzIGhlcmUgaXQgbWFrZXMgbm8gZGlmZmVyZW5jZS4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBkIHJlYWwgdmFsdWUgdG8gcm91bmQKCSAgICAgKiBAcmV0dXJuIG5lYXJlc3Qge0Bjb2RlIGludH0KCSAgICAgKi8KCSAgICBNYXRoVXRpbHMucm91bmQgPSBmdW5jdGlvbiAoZCAvKmZsb2F0Ki8pIHsKCSAgICAgICAgaWYgKE5hTiA9PT0gZCkKCSAgICAgICAgICAgIHJldHVybiAwOwoJICAgICAgICBpZiAoZCA8PSBOdW1iZXIuTUlOX1NBRkVfSU5URUdFUikKCSAgICAgICAgICAgIHJldHVybiBOdW1iZXIuTUlOX1NBRkVfSU5URUdFUjsKCSAgICAgICAgaWYgKGQgPj0gTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVIpCgkgICAgICAgICAgICByZXR1cm4gTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVI7CgkgICAgICAgIHJldHVybiAvKihpbnQpICovIChkICsgKGQgPCAwLjAgPyAtMC41IDogMC41KSkgfCAwOwoJICAgIH07CgkgICAgLy8gVFlQRVNDUklQVFBPUlQ6IG1heWJlIHJlbW92ZSByb3VuZCBtZXRob2QgYW5kIGNhbGwgZGlyZWN0bHkgTWF0aC5yb3VuZCwgaXQgbG9va3MgbGlrZSBpdCBkb2Vzbid0IG1ha2Ugc2Vuc2UgZm9yIGpzCgkgICAgLyoqCgkgICAgICogQHBhcmFtIGFYIHBvaW50IEEgeCBjb29yZGluYXRlCgkgICAgICogQHBhcmFtIGFZIHBvaW50IEEgeSBjb29yZGluYXRlCgkgICAgICogQHBhcmFtIGJYIHBvaW50IEIgeCBjb29yZGluYXRlCgkgICAgICogQHBhcmFtIGJZIHBvaW50IEIgeSBjb29yZGluYXRlCgkgICAgICogQHJldHVybiBFdWNsaWRlYW4gZGlzdGFuY2UgYmV0d2VlbiBwb2ludHMgQSBhbmQgQgoJICAgICAqLwoJICAgIE1hdGhVdGlscy5kaXN0YW5jZSA9IGZ1bmN0aW9uIChhWCAvKmZsb2F0fGludCovLCBhWSAvKmZsb2F0fGludCovLCBiWCAvKmZsb2F0fGludCovLCBiWSAvKmZsb2F0fGludCovKSB7CgkgICAgICAgIHZhciB4RGlmZiA9IGFYIC0gYlg7CgkgICAgICAgIHZhciB5RGlmZiA9IGFZIC0gYlk7CgkgICAgICAgIHJldHVybiAvKihmbG9hdCkgKi8gTWF0aC5zcXJ0KHhEaWZmICogeERpZmYgKyB5RGlmZiAqIHlEaWZmKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBhWCBwb2ludCBBIHggY29vcmRpbmF0ZQoJICAgICAqIEBwYXJhbSBhWSBwb2ludCBBIHkgY29vcmRpbmF0ZQoJICAgICAqIEBwYXJhbSBiWCBwb2ludCBCIHggY29vcmRpbmF0ZQoJICAgICAqIEBwYXJhbSBiWSBwb2ludCBCIHkgY29vcmRpbmF0ZQoJICAgICAqIEByZXR1cm4gRXVjbGlkZWFuIGRpc3RhbmNlIGJldHdlZW4gcG9pbnRzIEEgYW5kIEIKCSAgICAgKi8KCSAgICAvLyBwdWJsaWMgc3RhdGljIGRpc3RhbmNlKGFYOiBudW1iZXIgLyppbnQqLywgYVk6IG51bWJlciAvKmludCovLCBiWDogbnVtYmVyIC8qaW50Ki8sIGJZOiBudW1iZXIgLyppbnQqLyk6IGZsb2F0IHsKCSAgICAvLyAgIGNvbnN0IHhEaWZmID0gYVggLSBiWAoJICAgIC8vICAgY29uc3QgeURpZmYgPSBhWSAtIGJZCgkgICAgLy8gICByZXR1cm4gKGZsb2F0KSBNYXRoLnNxcnQoeERpZmYgKiB4RGlmZiArIHlEaWZmICogeURpZmYpOwoJICAgIC8vIH0KCSAgICAvKioKCSAgICAgKiBAcGFyYW0gYXJyYXkgdmFsdWVzIHRvIHN1bQoJICAgICAqIEByZXR1cm4gc3VtIG9mIHZhbHVlcyBpbiBhcnJheQoJICAgICAqLwoJICAgIE1hdGhVdGlscy5zdW0gPSBmdW5jdGlvbiAoYXJyYXkpIHsKCSAgICAgICAgdmFyIGNvdW50ID0gMDsKCSAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aF8xID0gYXJyYXkubGVuZ3RoOyBpICE9PSBsZW5ndGhfMTsgaSsrKSB7CgkgICAgICAgICAgICB2YXIgYSA9IGFycmF5W2ldOwoJICAgICAgICAgICAgY291bnQgKz0gYTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gY291bnQ7CgkgICAgfTsKCSAgICByZXR1cm4gTWF0aFV0aWxzOwoJfSgpKTsKCU1hdGhVdGlscyQxLmRlZmF1bHQgPSBNYXRoVXRpbHM7CgoJdmFyIERldGVjdG9yUmVzdWx0JDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KERldGVjdG9yUmVzdWx0JDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qKgoJICogPHA+RW5jYXBzdWxhdGVzIHRoZSByZXN1bHQgb2YgZGV0ZWN0aW5nIGEgYmFyY29kZSBpbiBhbiBpbWFnZS4gVGhpcyBpbmNsdWRlcyB0aGUgcmF3CgkgKiBtYXRyaXggb2YgYmxhY2svd2hpdGUgcGl4ZWxzIGNvcnJlc3BvbmRpbmcgdG8gdGhlIGJhcmNvZGUsIGFuZCBwb3NzaWJseSBwb2ludHMgb2YgaW50ZXJlc3QKCSAqIGluIHRoZSBpbWFnZSwgbGlrZSB0aGUgbG9jYXRpb24gb2YgZmluZGVyIHBhdHRlcm5zIG9yIGNvcm5lcnMgb2YgdGhlIGJhcmNvZGUgaW4gdGhlIGltYWdlLjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgRGV0ZWN0b3JSZXN1bHQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gRGV0ZWN0b3JSZXN1bHQoYml0cywgcG9pbnRzKSB7CgkgICAgICAgIHRoaXMuYml0cyA9IGJpdHM7CgkgICAgICAgIHRoaXMucG9pbnRzID0gcG9pbnRzOwoJICAgIH0KCSAgICBEZXRlY3RvclJlc3VsdC5wcm90b3R5cGUuZ2V0Qml0cyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYml0czsKCSAgICB9OwoJICAgIERldGVjdG9yUmVzdWx0LnByb3RvdHlwZS5nZXRQb2ludHMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnBvaW50czsKCSAgICB9OwoJICAgIHJldHVybiBEZXRlY3RvclJlc3VsdDsKCX0oKSk7CglEZXRlY3RvclJlc3VsdCQxLmRlZmF1bHQgPSBEZXRlY3RvclJlc3VsdDsKCgl2YXIgR3JpZFNhbXBsZXJJbnN0YW5jZSQxID0ge307CgoJdmFyIERlZmF1bHRHcmlkU2FtcGxlciQxID0ge307CgoJdmFyIEdyaWRTYW1wbGVyJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEdyaWRTYW1wbGVyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBOb3RGb3VuZEV4Y2VwdGlvbl8xJDUgPSBOb3RGb3VuZEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBJbXBsZW1lbnRhdGlvbnMgb2YgdGhpcyBjbGFzcyBjYW4sIGdpdmVuIGxvY2F0aW9ucyBvZiBmaW5kZXIgcGF0dGVybnMgZm9yIGEgUVIgY29kZSBpbiBhbgoJICogaW1hZ2UsIHNhbXBsZSB0aGUgcmlnaHQgcG9pbnRzIGluIHRoZSBpbWFnZSB0byByZWNvbnN0cnVjdCB0aGUgUVIgY29kZSwgYWNjb3VudGluZyBmb3IKCSAqIHBlcnNwZWN0aXZlIGRpc3RvcnRpb24uIEl0IGlzIGFic3RyYWN0ZWQgc2luY2UgaXQgaXMgcmVsYXRpdmVseSBleHBlbnNpdmUgYW5kIHNob3VsZCBiZSBhbGxvd2VkCgkgKiB0byB0YWtlIGFkdmFudGFnZSBvZiBwbGF0Zm9ybS1zcGVjaWZpYyBvcHRpbWl6ZWQgaW1wbGVtZW50YXRpb25zLCBsaWtlIFN1bidzIEphdmEgQWR2YW5jZWQKCSAqIEltYWdpbmcgbGlicmFyeSwgYnV0IHdoaWNoIG1heSBub3QgYmUgYXZhaWxhYmxlIGluIG90aGVyIGVudmlyb25tZW50cyBzdWNoIGFzIEoyTUUsIGFuZCB2aWNlCgkgKiB2ZXJzYS4KCSAqCgkgKiBUaGUgaW1wbGVtZW50YXRpb24gdXNlZCBjYW4gYmUgY29udHJvbGxlZCBieSBjYWxsaW5nIHtAbGluayAjc2V0R3JpZFNhbXBsZXIoR3JpZFNhbXBsZXIpfQoJICogd2l0aCBhbiBpbnN0YW5jZSBvZiBhIGNsYXNzIHdoaWNoIGltcGxlbWVudHMgdGhpcyBpbnRlcmZhY2UuCgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEdyaWRTYW1wbGVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIEdyaWRTYW1wbGVyKCkgewoJICAgIH0KCSAgICAvKioKCSAgICAgKiA8cD5DaGVja3MgYSBzZXQgb2YgcG9pbnRzIHRoYXQgaGF2ZSBiZWVuIHRyYW5zZm9ybWVkIHRvIHNhbXBsZSBwb2ludHMgb24gYW4gaW1hZ2UgYWdhaW5zdAoJICAgICAqIHRoZSBpbWFnZSdzIGRpbWVuc2lvbnMgdG8gc2VlIGlmIHRoZSBwb2ludCBhcmUgZXZlbiB3aXRoaW4gdGhlIGltYWdlLjwvcD4KCSAgICAgKgoJICAgICAqIDxwPlRoaXMgbWV0aG9kIHdpbGwgYWN0dWFsbHkgIm51ZGdlIiB0aGUgZW5kcG9pbnRzIGJhY2sgb250byB0aGUgaW1hZ2UgaWYgdGhleSBhcmUgZm91bmQgdG8gYmUKCSAgICAgKiBiYXJlbHkgKGxlc3MgdGhhbiAxIHBpeGVsKSBvZmYgdGhlIGltYWdlLiBUaGlzIGFjY291bnRzIGZvciBpbXBlcmZlY3QgZGV0ZWN0aW9uIG9mIGZpbmRlcgoJICAgICAqIHBhdHRlcm5zIGluIGFuIGltYWdlIHdoZXJlIHRoZSBRUiBDb2RlIHJ1bnMgYWxsIHRoZSB3YXkgdG8gdGhlIGltYWdlIGJvcmRlci48L3A+CgkgICAgICoKCSAgICAgKiA8cD5Gb3IgZWZmaWNpZW5jeSwgdGhlIG1ldGhvZCB3aWxsIGNoZWNrIHBvaW50cyBmcm9tIGVpdGhlciBlbmQgb2YgdGhlIGxpbmUgdW50aWwgb25lIGlzIGZvdW5kCgkgICAgICogdG8gYmUgd2l0aGluIHRoZSBpbWFnZS4gQmVjYXVzZSB0aGUgc2V0IG9mIHBvaW50cyBhcmUgYXNzdW1lZCB0byBiZSBsaW5lYXIsIHRoaXMgaXMgdmFsaWQuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGltYWdlIGltYWdlIGludG8gd2hpY2ggdGhlIHBvaW50cyBzaG91bGQgbWFwCgkgICAgICogQHBhcmFtIHBvaW50cyBhY3R1YWwgcG9pbnRzIGluIHgxLHkxLC4uLix4bix5biBmb3JtCgkgICAgICogQHRocm93cyBOb3RGb3VuZEV4Y2VwdGlvbiBpZiBhbiBlbmRwb2ludCBpcyBsaWVzIG91dHNpZGUgdGhlIGltYWdlIGJvdW5kYXJpZXMKCSAgICAgKi8KCSAgICBHcmlkU2FtcGxlci5jaGVja0FuZE51ZGdlUG9pbnRzID0gZnVuY3Rpb24gKGltYWdlLCBwb2ludHMpIHsKCSAgICAgICAgdmFyIHdpZHRoID0gaW1hZ2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgdmFyIGhlaWdodCA9IGltYWdlLmdldEhlaWdodCgpOwoJICAgICAgICAvLyBDaGVjayBhbmQgbnVkZ2UgcG9pbnRzIGZyb20gc3RhcnQgdW50aWwgd2Ugc2VlIHNvbWUgdGhhdCBhcmUgT0s6CgkgICAgICAgIHZhciBudWRnZWQgPSB0cnVlOwoJICAgICAgICBmb3IgKHZhciBvZmZzZXQgPSAwOyBvZmZzZXQgPCBwb2ludHMubGVuZ3RoICYmIG51ZGdlZDsgb2Zmc2V0ICs9IDIpIHsKCSAgICAgICAgICAgIHZhciB4ID0gTWF0aC5mbG9vcihwb2ludHNbb2Zmc2V0XSk7CgkgICAgICAgICAgICB2YXIgeSA9IE1hdGguZmxvb3IocG9pbnRzW29mZnNldCArIDFdKTsKCSAgICAgICAgICAgIGlmICh4IDwgLTEgfHwgeCA+IHdpZHRoIHx8IHkgPCAtMSB8fCB5ID4gaGVpZ2h0KSB7CgkgICAgICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uXzEkNS5kZWZhdWx0KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBudWRnZWQgPSBmYWxzZTsKCSAgICAgICAgICAgIGlmICh4ID09PSAtMSkgewoJICAgICAgICAgICAgICAgIHBvaW50c1tvZmZzZXRdID0gMC4wOwoJICAgICAgICAgICAgICAgIG51ZGdlZCA9IHRydWU7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBlbHNlIGlmICh4ID09PSB3aWR0aCkgewoJICAgICAgICAgICAgICAgIHBvaW50c1tvZmZzZXRdID0gd2lkdGggLSAxOwoJICAgICAgICAgICAgICAgIG51ZGdlZCA9IHRydWU7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBpZiAoeSA9PT0gLTEpIHsKCSAgICAgICAgICAgICAgICBwb2ludHNbb2Zmc2V0ICsgMV0gPSAwLjA7CgkgICAgICAgICAgICAgICAgbnVkZ2VkID0gdHJ1ZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGVsc2UgaWYgKHkgPT09IGhlaWdodCkgewoJICAgICAgICAgICAgICAgIHBvaW50c1tvZmZzZXQgKyAxXSA9IGhlaWdodCAtIDE7CgkgICAgICAgICAgICAgICAgbnVkZ2VkID0gdHJ1ZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICAvLyBDaGVjayBhbmQgbnVkZ2UgcG9pbnRzIGZyb20gZW5kOgoJICAgICAgICBudWRnZWQgPSB0cnVlOwoJICAgICAgICBmb3IgKHZhciBvZmZzZXQgPSBwb2ludHMubGVuZ3RoIC0gMjsgb2Zmc2V0ID49IDAgJiYgbnVkZ2VkOyBvZmZzZXQgLT0gMikgewoJICAgICAgICAgICAgdmFyIHggPSBNYXRoLmZsb29yKHBvaW50c1tvZmZzZXRdKTsKCSAgICAgICAgICAgIHZhciB5ID0gTWF0aC5mbG9vcihwb2ludHNbb2Zmc2V0ICsgMV0pOwoJICAgICAgICAgICAgaWYgKHggPCAtMSB8fCB4ID4gd2lkdGggfHwgeSA8IC0xIHx8IHkgPiBoZWlnaHQpIHsKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMSQ1LmRlZmF1bHQoKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIG51ZGdlZCA9IGZhbHNlOwoJICAgICAgICAgICAgaWYgKHggPT09IC0xKSB7CgkgICAgICAgICAgICAgICAgcG9pbnRzW29mZnNldF0gPSAwLjA7CgkgICAgICAgICAgICAgICAgbnVkZ2VkID0gdHJ1ZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGVsc2UgaWYgKHggPT09IHdpZHRoKSB7CgkgICAgICAgICAgICAgICAgcG9pbnRzW29mZnNldF0gPSB3aWR0aCAtIDE7CgkgICAgICAgICAgICAgICAgbnVkZ2VkID0gdHJ1ZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGlmICh5ID09PSAtMSkgewoJICAgICAgICAgICAgICAgIHBvaW50c1tvZmZzZXQgKyAxXSA9IDAuMDsKCSAgICAgICAgICAgICAgICBudWRnZWQgPSB0cnVlOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSBpZiAoeSA9PT0gaGVpZ2h0KSB7CgkgICAgICAgICAgICAgICAgcG9pbnRzW29mZnNldCArIDFdID0gaGVpZ2h0IC0gMTsKCSAgICAgICAgICAgICAgICBudWRnZWQgPSB0cnVlOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfTsKCSAgICByZXR1cm4gR3JpZFNhbXBsZXI7Cgl9KCkpOwoJR3JpZFNhbXBsZXIkMS5kZWZhdWx0ID0gR3JpZFNhbXBsZXI7CgoJdmFyIFBlcnNwZWN0aXZlVHJhbnNmb3JtJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KFBlcnNwZWN0aXZlVHJhbnNmb3JtJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJLyoqCgkgKiA8cD5UaGlzIGNsYXNzIGltcGxlbWVudHMgYSBwZXJzcGVjdGl2ZSB0cmFuc2Zvcm0gaW4gdHdvIGRpbWVuc2lvbnMuIEdpdmVuIGZvdXIgc291cmNlIGFuZCBmb3VyCgkgKiBkZXN0aW5hdGlvbiBwb2ludHMsIGl0IHdpbGwgY29tcHV0ZSB0aGUgdHJhbnNmb3JtYXRpb24gaW1wbGllZCBiZXR3ZWVuIHRoZW0uIFRoZSBjb2RlIGlzIGJhc2VkCgkgKiBkaXJlY3RseSB1cG9uIHNlY3Rpb24gMy40LjIgb2YgR2VvcmdlIFdvbGJlcmcncyAiRGlnaXRhbCBJbWFnZSBXYXJwaW5nIjsgc2VlIHBhZ2VzIDU0LTU2LjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgUGVyc3BlY3RpdmVUcmFuc2Zvcm0gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gUGVyc3BlY3RpdmVUcmFuc2Zvcm0oYTExIC8qZmxvYXQqLywgYTIxIC8qZmxvYXQqLywgYTMxIC8qZmxvYXQqLywgYTEyIC8qZmxvYXQqLywgYTIyIC8qZmxvYXQqLywgYTMyIC8qZmxvYXQqLywgYTEzIC8qZmxvYXQqLywgYTIzIC8qZmxvYXQqLywgYTMzIC8qZmxvYXQqLykgewoJICAgICAgICB0aGlzLmExMSA9IGExMTsKCSAgICAgICAgdGhpcy5hMjEgPSBhMjE7CgkgICAgICAgIHRoaXMuYTMxID0gYTMxOwoJICAgICAgICB0aGlzLmExMiA9IGExMjsKCSAgICAgICAgdGhpcy5hMjIgPSBhMjI7CgkgICAgICAgIHRoaXMuYTMyID0gYTMyOwoJICAgICAgICB0aGlzLmExMyA9IGExMzsKCSAgICAgICAgdGhpcy5hMjMgPSBhMjM7CgkgICAgICAgIHRoaXMuYTMzID0gYTMzOwoJICAgIH0KCSAgICBQZXJzcGVjdGl2ZVRyYW5zZm9ybS5xdWFkcmlsYXRlcmFsVG9RdWFkcmlsYXRlcmFsID0gZnVuY3Rpb24gKHgwIC8qZmxvYXQqLywgeTAgLypmbG9hdCovLCB4MSAvKmZsb2F0Ki8sIHkxIC8qZmxvYXQqLywgeDIgLypmbG9hdCovLCB5MiAvKmZsb2F0Ki8sIHgzIC8qZmxvYXQqLywgeTMgLypmbG9hdCovLCB4MHAgLypmbG9hdCovLCB5MHAgLypmbG9hdCovLCB4MXAgLypmbG9hdCovLCB5MXAgLypmbG9hdCovLCB4MnAgLypmbG9hdCovLCB5MnAgLypmbG9hdCovLCB4M3AgLypmbG9hdCovLCB5M3AgLypmbG9hdCovKSB7CgkgICAgICAgIHZhciBxVG9TID0gUGVyc3BlY3RpdmVUcmFuc2Zvcm0ucXVhZHJpbGF0ZXJhbFRvU3F1YXJlKHgwLCB5MCwgeDEsIHkxLCB4MiwgeTIsIHgzLCB5Myk7CgkgICAgICAgIHZhciBzVG9RID0gUGVyc3BlY3RpdmVUcmFuc2Zvcm0uc3F1YXJlVG9RdWFkcmlsYXRlcmFsKHgwcCwgeTBwLCB4MXAsIHkxcCwgeDJwLCB5MnAsIHgzcCwgeTNwKTsKCSAgICAgICAgcmV0dXJuIHNUb1EudGltZXMocVRvUyk7CgkgICAgfTsKCSAgICBQZXJzcGVjdGl2ZVRyYW5zZm9ybS5wcm90b3R5cGUudHJhbnNmb3JtUG9pbnRzID0gZnVuY3Rpb24gKHBvaW50cykgewoJICAgICAgICB2YXIgbWF4ID0gcG9pbnRzLmxlbmd0aDsKCSAgICAgICAgdmFyIGExMSA9IHRoaXMuYTExOwoJICAgICAgICB2YXIgYTEyID0gdGhpcy5hMTI7CgkgICAgICAgIHZhciBhMTMgPSB0aGlzLmExMzsKCSAgICAgICAgdmFyIGEyMSA9IHRoaXMuYTIxOwoJICAgICAgICB2YXIgYTIyID0gdGhpcy5hMjI7CgkgICAgICAgIHZhciBhMjMgPSB0aGlzLmEyMzsKCSAgICAgICAgdmFyIGEzMSA9IHRoaXMuYTMxOwoJICAgICAgICB2YXIgYTMyID0gdGhpcy5hMzI7CgkgICAgICAgIHZhciBhMzMgPSB0aGlzLmEzMzsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtYXg7IGkgKz0gMikgewoJICAgICAgICAgICAgdmFyIHggPSBwb2ludHNbaV07CgkgICAgICAgICAgICB2YXIgeSA9IHBvaW50c1tpICsgMV07CgkgICAgICAgICAgICB2YXIgZGVub21pbmF0b3IgPSBhMTMgKiB4ICsgYTIzICogeSArIGEzMzsKCSAgICAgICAgICAgIHBvaW50c1tpXSA9IChhMTEgKiB4ICsgYTIxICogeSArIGEzMSkgLyBkZW5vbWluYXRvcjsKCSAgICAgICAgICAgIHBvaW50c1tpICsgMV0gPSAoYTEyICogeCArIGEyMiAqIHkgKyBhMzIpIC8gZGVub21pbmF0b3I7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIFBlcnNwZWN0aXZlVHJhbnNmb3JtLnByb3RvdHlwZS50cmFuc2Zvcm1Qb2ludHNXaXRoVmFsdWVzID0gZnVuY3Rpb24gKHhWYWx1ZXMsIHlWYWx1ZXMpIHsKCSAgICAgICAgdmFyIGExMSA9IHRoaXMuYTExOwoJICAgICAgICB2YXIgYTEyID0gdGhpcy5hMTI7CgkgICAgICAgIHZhciBhMTMgPSB0aGlzLmExMzsKCSAgICAgICAgdmFyIGEyMSA9IHRoaXMuYTIxOwoJICAgICAgICB2YXIgYTIyID0gdGhpcy5hMjI7CgkgICAgICAgIHZhciBhMjMgPSB0aGlzLmEyMzsKCSAgICAgICAgdmFyIGEzMSA9IHRoaXMuYTMxOwoJICAgICAgICB2YXIgYTMyID0gdGhpcy5hMzI7CgkgICAgICAgIHZhciBhMzMgPSB0aGlzLmEzMzsKCSAgICAgICAgdmFyIG4gPSB4VmFsdWVzLmxlbmd0aDsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBuOyBpKyspIHsKCSAgICAgICAgICAgIHZhciB4ID0geFZhbHVlc1tpXTsKCSAgICAgICAgICAgIHZhciB5ID0geVZhbHVlc1tpXTsKCSAgICAgICAgICAgIHZhciBkZW5vbWluYXRvciA9IGExMyAqIHggKyBhMjMgKiB5ICsgYTMzOwoJICAgICAgICAgICAgeFZhbHVlc1tpXSA9IChhMTEgKiB4ICsgYTIxICogeSArIGEzMSkgLyBkZW5vbWluYXRvcjsKCSAgICAgICAgICAgIHlWYWx1ZXNbaV0gPSAoYTEyICogeCArIGEyMiAqIHkgKyBhMzIpIC8gZGVub21pbmF0b3I7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIFBlcnNwZWN0aXZlVHJhbnNmb3JtLnNxdWFyZVRvUXVhZHJpbGF0ZXJhbCA9IGZ1bmN0aW9uICh4MCAvKmZsb2F0Ki8sIHkwIC8qZmxvYXQqLywgeDEgLypmbG9hdCovLCB5MSAvKmZsb2F0Ki8sIHgyIC8qZmxvYXQqLywgeTIgLypmbG9hdCovLCB4MyAvKmZsb2F0Ki8sIHkzIC8qZmxvYXQqLykgewoJICAgICAgICB2YXIgZHgzID0geDAgLSB4MSArIHgyIC0geDM7CgkgICAgICAgIHZhciBkeTMgPSB5MCAtIHkxICsgeTIgLSB5MzsKCSAgICAgICAgaWYgKGR4MyA9PT0gMC4wICYmIGR5MyA9PT0gMC4wKSB7CgkgICAgICAgICAgICAvLyBBZmZpbmUKCSAgICAgICAgICAgIHJldHVybiBuZXcgUGVyc3BlY3RpdmVUcmFuc2Zvcm0oeDEgLSB4MCwgeDIgLSB4MSwgeDAsIHkxIC0geTAsIHkyIC0geTEsIHkwLCAwLjAsIDAuMCwgMS4wKTsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgIHZhciBkeDEgPSB4MSAtIHgyOwoJICAgICAgICAgICAgdmFyIGR4MiA9IHgzIC0geDI7CgkgICAgICAgICAgICB2YXIgZHkxID0geTEgLSB5MjsKCSAgICAgICAgICAgIHZhciBkeTIgPSB5MyAtIHkyOwoJICAgICAgICAgICAgdmFyIGRlbm9taW5hdG9yID0gZHgxICogZHkyIC0gZHgyICogZHkxOwoJICAgICAgICAgICAgdmFyIGExMyA9IChkeDMgKiBkeTIgLSBkeDIgKiBkeTMpIC8gZGVub21pbmF0b3I7CgkgICAgICAgICAgICB2YXIgYTIzID0gKGR4MSAqIGR5MyAtIGR4MyAqIGR5MSkgLyBkZW5vbWluYXRvcjsKCSAgICAgICAgICAgIHJldHVybiBuZXcgUGVyc3BlY3RpdmVUcmFuc2Zvcm0oeDEgLSB4MCArIGExMyAqIHgxLCB4MyAtIHgwICsgYTIzICogeDMsIHgwLCB5MSAtIHkwICsgYTEzICogeTEsIHkzIC0geTAgKyBhMjMgKiB5MywgeTAsIGExMywgYTIzLCAxLjApOwoJICAgICAgICB9CgkgICAgfTsKCSAgICBQZXJzcGVjdGl2ZVRyYW5zZm9ybS5xdWFkcmlsYXRlcmFsVG9TcXVhcmUgPSBmdW5jdGlvbiAoeDAgLypmbG9hdCovLCB5MCAvKmZsb2F0Ki8sIHgxIC8qZmxvYXQqLywgeTEgLypmbG9hdCovLCB4MiAvKmZsb2F0Ki8sIHkyIC8qZmxvYXQqLywgeDMgLypmbG9hdCovLCB5MyAvKmZsb2F0Ki8pIHsKCSAgICAgICAgLy8gSGVyZSwgdGhlIGFkam9pbnQgc2VydmVzIGFzIHRoZSBpbnZlcnNlOgoJICAgICAgICByZXR1cm4gUGVyc3BlY3RpdmVUcmFuc2Zvcm0uc3F1YXJlVG9RdWFkcmlsYXRlcmFsKHgwLCB5MCwgeDEsIHkxLCB4MiwgeTIsIHgzLCB5MykuYnVpbGRBZGpvaW50KCk7CgkgICAgfTsKCSAgICBQZXJzcGVjdGl2ZVRyYW5zZm9ybS5wcm90b3R5cGUuYnVpbGRBZGpvaW50ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICAvLyBBZGpvaW50IGlzIHRoZSB0cmFuc3Bvc2Ugb2YgdGhlIGNvZmFjdG9yIG1hdHJpeDoKCSAgICAgICAgcmV0dXJuIG5ldyBQZXJzcGVjdGl2ZVRyYW5zZm9ybSh0aGlzLmEyMiAqIHRoaXMuYTMzIC0gdGhpcy5hMjMgKiB0aGlzLmEzMiwgdGhpcy5hMjMgKiB0aGlzLmEzMSAtIHRoaXMuYTIxICogdGhpcy5hMzMsIHRoaXMuYTIxICogdGhpcy5hMzIgLSB0aGlzLmEyMiAqIHRoaXMuYTMxLCB0aGlzLmExMyAqIHRoaXMuYTMyIC0gdGhpcy5hMTIgKiB0aGlzLmEzMywgdGhpcy5hMTEgKiB0aGlzLmEzMyAtIHRoaXMuYTEzICogdGhpcy5hMzEsIHRoaXMuYTEyICogdGhpcy5hMzEgLSB0aGlzLmExMSAqIHRoaXMuYTMyLCB0aGlzLmExMiAqIHRoaXMuYTIzIC0gdGhpcy5hMTMgKiB0aGlzLmEyMiwgdGhpcy5hMTMgKiB0aGlzLmEyMSAtIHRoaXMuYTExICogdGhpcy5hMjMsIHRoaXMuYTExICogdGhpcy5hMjIgLSB0aGlzLmExMiAqIHRoaXMuYTIxKTsKCSAgICB9OwoJICAgIFBlcnNwZWN0aXZlVHJhbnNmb3JtLnByb3RvdHlwZS50aW1lcyA9IGZ1bmN0aW9uIChvdGhlcikgewoJICAgICAgICByZXR1cm4gbmV3IFBlcnNwZWN0aXZlVHJhbnNmb3JtKHRoaXMuYTExICogb3RoZXIuYTExICsgdGhpcy5hMjEgKiBvdGhlci5hMTIgKyB0aGlzLmEzMSAqIG90aGVyLmExMywgdGhpcy5hMTEgKiBvdGhlci5hMjEgKyB0aGlzLmEyMSAqIG90aGVyLmEyMiArIHRoaXMuYTMxICogb3RoZXIuYTIzLCB0aGlzLmExMSAqIG90aGVyLmEzMSArIHRoaXMuYTIxICogb3RoZXIuYTMyICsgdGhpcy5hMzEgKiBvdGhlci5hMzMsIHRoaXMuYTEyICogb3RoZXIuYTExICsgdGhpcy5hMjIgKiBvdGhlci5hMTIgKyB0aGlzLmEzMiAqIG90aGVyLmExMywgdGhpcy5hMTIgKiBvdGhlci5hMjEgKyB0aGlzLmEyMiAqIG90aGVyLmEyMiArIHRoaXMuYTMyICogb3RoZXIuYTIzLCB0aGlzLmExMiAqIG90aGVyLmEzMSArIHRoaXMuYTIyICogb3RoZXIuYTMyICsgdGhpcy5hMzIgKiBvdGhlci5hMzMsIHRoaXMuYTEzICogb3RoZXIuYTExICsgdGhpcy5hMjMgKiBvdGhlci5hMTIgKyB0aGlzLmEzMyAqIG90aGVyLmExMywgdGhpcy5hMTMgKiBvdGhlci5hMjEgKyB0aGlzLmEyMyAqIG90aGVyLmEyMiArIHRoaXMuYTMzICogb3RoZXIuYTIzLCB0aGlzLmExMyAqIG90aGVyLmEzMSArIHRoaXMuYTIzICogb3RoZXIuYTMyICsgdGhpcy5hMzMgKiBvdGhlci5hMzMpOwoJICAgIH07CgkgICAgcmV0dXJuIFBlcnNwZWN0aXZlVHJhbnNmb3JtOwoJfSgpKTsKCVBlcnNwZWN0aXZlVHJhbnNmb3JtJDEuZGVmYXVsdCA9IFBlcnNwZWN0aXZlVHJhbnNmb3JtOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCgl2YXIgX19leHRlbmRzJDIgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoRGVmYXVsdEdyaWRTYW1wbGVyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJdmFyIEdyaWRTYW1wbGVyXzEgPSBHcmlkU2FtcGxlciQxOwoJdmFyIEJpdE1hdHJpeF8xJDEgPSBCaXRNYXRyaXgkMTsKCXZhciBQZXJzcGVjdGl2ZVRyYW5zZm9ybV8xJDEgPSBQZXJzcGVjdGl2ZVRyYW5zZm9ybSQxOwoJdmFyIE5vdEZvdW5kRXhjZXB0aW9uXzEkNCA9IE5vdEZvdW5kRXhjZXB0aW9uJDE7CgkvKioKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBEZWZhdWx0R3JpZFNhbXBsZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJDIoRGVmYXVsdEdyaWRTYW1wbGVyLCBfc3VwZXIpOwoJICAgIGZ1bmN0aW9uIERlZmF1bHRHcmlkU2FtcGxlcigpIHsKCSAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwoJICAgIH0KCSAgICAvKkBPdmVycmlkZSovCgkgICAgRGVmYXVsdEdyaWRTYW1wbGVyLnByb3RvdHlwZS5zYW1wbGVHcmlkID0gZnVuY3Rpb24gKGltYWdlLCBkaW1lbnNpb25YIC8qaW50Ki8sIGRpbWVuc2lvblkgLyppbnQqLywgcDFUb1ggLypmbG9hdCovLCBwMVRvWSAvKmZsb2F0Ki8sIHAyVG9YIC8qZmxvYXQqLywgcDJUb1kgLypmbG9hdCovLCBwM1RvWCAvKmZsb2F0Ki8sIHAzVG9ZIC8qZmxvYXQqLywgcDRUb1ggLypmbG9hdCovLCBwNFRvWSAvKmZsb2F0Ki8sIHAxRnJvbVggLypmbG9hdCovLCBwMUZyb21ZIC8qZmxvYXQqLywgcDJGcm9tWCAvKmZsb2F0Ki8sIHAyRnJvbVkgLypmbG9hdCovLCBwM0Zyb21YIC8qZmxvYXQqLywgcDNGcm9tWSAvKmZsb2F0Ki8sIHA0RnJvbVggLypmbG9hdCovLCBwNEZyb21ZIC8qZmxvYXQqLykgewoJICAgICAgICB2YXIgdHJhbnNmb3JtID0gUGVyc3BlY3RpdmVUcmFuc2Zvcm1fMSQxLmRlZmF1bHQucXVhZHJpbGF0ZXJhbFRvUXVhZHJpbGF0ZXJhbChwMVRvWCwgcDFUb1ksIHAyVG9YLCBwMlRvWSwgcDNUb1gsIHAzVG9ZLCBwNFRvWCwgcDRUb1ksIHAxRnJvbVgsIHAxRnJvbVksIHAyRnJvbVgsIHAyRnJvbVksIHAzRnJvbVgsIHAzRnJvbVksIHA0RnJvbVgsIHA0RnJvbVkpOwoJICAgICAgICByZXR1cm4gdGhpcy5zYW1wbGVHcmlkV2l0aFRyYW5zZm9ybShpbWFnZSwgZGltZW5zaW9uWCwgZGltZW5zaW9uWSwgdHJhbnNmb3JtKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBEZWZhdWx0R3JpZFNhbXBsZXIucHJvdG90eXBlLnNhbXBsZUdyaWRXaXRoVHJhbnNmb3JtID0gZnVuY3Rpb24gKGltYWdlLCBkaW1lbnNpb25YIC8qaW50Ki8sIGRpbWVuc2lvblkgLyppbnQqLywgdHJhbnNmb3JtKSB7CgkgICAgICAgIGlmIChkaW1lbnNpb25YIDw9IDAgfHwgZGltZW5zaW9uWSA8PSAwKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMSQ0LmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgYml0cyA9IG5ldyBCaXRNYXRyaXhfMSQxLmRlZmF1bHQoZGltZW5zaW9uWCwgZGltZW5zaW9uWSk7CgkgICAgICAgIHZhciBwb2ludHMgPSBuZXcgRmxvYXQzMkFycmF5KDIgKiBkaW1lbnNpb25YKTsKCSAgICAgICAgZm9yICh2YXIgeSA9IDA7IHkgPCBkaW1lbnNpb25ZOyB5KyspIHsKCSAgICAgICAgICAgIHZhciBtYXggPSBwb2ludHMubGVuZ3RoOwoJICAgICAgICAgICAgdmFyIGlWYWx1ZSA9IHkgKyAwLjU7CgkgICAgICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IG1heDsgeCArPSAyKSB7CgkgICAgICAgICAgICAgICAgcG9pbnRzW3hdID0gKHggLyAyKSArIDAuNTsKCSAgICAgICAgICAgICAgICBwb2ludHNbeCArIDFdID0gaVZhbHVlOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgdHJhbnNmb3JtLnRyYW5zZm9ybVBvaW50cyhwb2ludHMpOwoJICAgICAgICAgICAgLy8gUXVpY2sgY2hlY2sgdG8gc2VlIGlmIHBvaW50cyB0cmFuc2Zvcm1lZCB0byBzb21ldGhpbmcgaW5zaWRlIHRoZSBpbWFnZQoJICAgICAgICAgICAgLy8gc3VmZmljaWVudCB0byBjaGVjayB0aGUgZW5kcG9pbnRzCgkgICAgICAgICAgICBHcmlkU2FtcGxlcl8xLmRlZmF1bHQuY2hlY2tBbmROdWRnZVBvaW50cyhpbWFnZSwgcG9pbnRzKTsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCBtYXg7IHggKz0gMikgewoJICAgICAgICAgICAgICAgICAgICBpZiAoaW1hZ2UuZ2V0KE1hdGguZmxvb3IocG9pbnRzW3hdKSwgTWF0aC5mbG9vcihwb2ludHNbeCArIDFdKSkpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIEJsYWNrKC1pc2gpIHBpeGVsCgkgICAgICAgICAgICAgICAgICAgICAgICBiaXRzLnNldCh4IC8gMiwgeSk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBjYXRjaCAoYWlvb2JlIC8qOiBBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24qLykgewoJICAgICAgICAgICAgICAgIC8vIFRoaXMgZmVlbHMgd3JvbmcsIGJ1dCwgc29tZXRpbWVzIGlmIHRoZSBmaW5kZXIgcGF0dGVybnMgYXJlIG1pc2lkZW50aWZpZWQsIHRoZSByZXN1bHRpbmcKCSAgICAgICAgICAgICAgICAvLyB0cmFuc2Zvcm0gZ2V0cyAidHdpc3RlZCIgc3VjaCB0aGF0IGl0IG1hcHMgYSBzdHJhaWdodCBsaW5lIG9mIHBvaW50cyB0byBhIHNldCBvZiBwb2ludHMKCSAgICAgICAgICAgICAgICAvLyB3aG9zZSBlbmRwb2ludHMgYXJlIGluIGJvdW5kcywgYnV0IG90aGVycyBhcmUgbm90LiBUaGVyZSBpcyBwcm9iYWJseSBzb21lIG1hdGhlbWF0aWNhbAoJICAgICAgICAgICAgICAgIC8vIHdheSB0byBkZXRlY3QgdGhpcyBhYm91dCB0aGUgdHJhbnNmb3JtYXRpb24gdGhhdCBJIGRvbid0IGtub3cgeWV0LgoJICAgICAgICAgICAgICAgIC8vIFRoaXMgcmVzdWx0cyBpbiBhbiB1Z2x5IHJ1bnRpbWUgZXhjZXB0aW9uIGRlc3BpdGUgb3VyIGNsZXZlciBjaGVja3MgYWJvdmUgLS0gY2FuJ3QgaGF2ZQoJICAgICAgICAgICAgICAgIC8vIHRoYXQuIFdlIGNvdWxkIGNoZWNrIGVhY2ggcG9pbnQncyBjb29yZGluYXRlcyBidXQgdGhhdCBmZWVscyBkdXBsaWNhdGl2ZS4gV2Ugc2V0dGxlIGZvcgoJICAgICAgICAgICAgICAgIC8vIGNhdGNoaW5nIGFuZCB3cmFwcGluZyBBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24uCgkgICAgICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uXzEkNC5kZWZhdWx0KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGJpdHM7CgkgICAgfTsKCSAgICByZXR1cm4gRGVmYXVsdEdyaWRTYW1wbGVyOwoJfShHcmlkU2FtcGxlcl8xLmRlZmF1bHQpKTsKCURlZmF1bHRHcmlkU2FtcGxlciQxLmRlZmF1bHQgPSBEZWZhdWx0R3JpZFNhbXBsZXI7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEdyaWRTYW1wbGVySW5zdGFuY2UkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIERlZmF1bHRHcmlkU2FtcGxlcl8xID0gRGVmYXVsdEdyaWRTYW1wbGVyJDE7Cgl2YXIgR3JpZFNhbXBsZXJJbnN0YW5jZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBHcmlkU2FtcGxlckluc3RhbmNlKCkgewoJICAgIH0KCSAgICAvKioKCSAgICAgKiBTZXRzIHRoZSBpbXBsZW1lbnRhdGlvbiBvZiBHcmlkU2FtcGxlciB1c2VkIGJ5IHRoZSBsaWJyYXJ5LiBPbmUgZ2xvYmFsCgkgICAgICogaW5zdGFuY2UgaXMgc3RvcmVkLCB3aGljaCBtYXkgc291bmQgcHJvYmxlbWF0aWMuIEJ1dCwgdGhlIGltcGxlbWVudGF0aW9uIHByb3ZpZGVkCgkgICAgICogb3VnaHQgdG8gYmUgYXBwcm9wcmlhdGUgZm9yIHRoZSBlbnRpcmUgcGxhdGZvcm0sIGFuZCBhbGwgdXNlcyBvZiB0aGlzIGxpYnJhcnkKCSAgICAgKiBpbiB0aGUgd2hvbGUgbGlmZXRpbWUgb2YgdGhlIEpWTS4gRm9yIGluc3RhbmNlLCBhbiBBbmRyb2lkIGFjdGl2aXR5IGNhbiBzd2FwIGluCgkgICAgICogYW4gaW1wbGVtZW50YXRpb24gdGhhdCB0YWtlcyBhZHZhbnRhZ2Ugb2YgbmF0aXZlIHBsYXRmb3JtIGxpYnJhcmllcy4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBuZXdHcmlkU2FtcGxlciBUaGUgcGxhdGZvcm0tc3BlY2lmaWMgb2JqZWN0IHRvIGluc3RhbGwuCgkgICAgICovCgkgICAgR3JpZFNhbXBsZXJJbnN0YW5jZS5zZXRHcmlkU2FtcGxlciA9IGZ1bmN0aW9uIChuZXdHcmlkU2FtcGxlcikgewoJICAgICAgICBHcmlkU2FtcGxlckluc3RhbmNlLmdyaWRTYW1wbGVyID0gbmV3R3JpZFNhbXBsZXI7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIHRoZSBjdXJyZW50IGltcGxlbWVudGF0aW9uIG9mIEdyaWRTYW1wbGVyCgkgICAgICovCgkgICAgR3JpZFNhbXBsZXJJbnN0YW5jZS5nZXRJbnN0YW5jZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIEdyaWRTYW1wbGVySW5zdGFuY2UuZ3JpZFNhbXBsZXI7CgkgICAgfTsKCSAgICBHcmlkU2FtcGxlckluc3RhbmNlLmdyaWRTYW1wbGVyID0gbmV3IERlZmF1bHRHcmlkU2FtcGxlcl8xLmRlZmF1bHQoKTsKCSAgICByZXR1cm4gR3JpZFNhbXBsZXJJbnN0YW5jZTsKCX0oKSk7CglHcmlkU2FtcGxlckluc3RhbmNlJDEuZGVmYXVsdCA9IEdyaWRTYW1wbGVySW5zdGFuY2U7CgoJdmFyIFJlc3VsdFBvaW50JDEgPSB7fTsKCgl2YXIgRmxvYXQkMSA9IHt9OwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShGbG9hdCQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKioKCSAqIFBvbnlmaWxsIGZvciBKYXZhJ3MgRmxvYXQgY2xhc3MuCgkgKi8KCXZhciBGbG9hdCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBGbG9hdCgpIHsKCSAgICB9CgkgICAgLyoqCgkgICAgICogU2luY1RTIGhhcyBubyBkaWZmZXJlbmNlIGJldHdlZW4gaW50IGFuZCBmbG9hdCwgdGhlcmUncyBhbGwgbnVtYmVycywKCSAgICAgKiB0aGlzIGlzIHVzZWQgb25seSB0byBwb2x5ZmlsbCBKYXZhIGNvZGUuCgkgICAgICovCgkgICAgRmxvYXQuZmxvYXRUb0ludEJpdHMgPSBmdW5jdGlvbiAoZikgewoJICAgICAgICByZXR1cm4gZjsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFRoZSBmbG9hdCBtYXggdmFsdWUgaW4gSlMgaXMgdGhlIG51bWJlciBtYXggdmFsdWUuCgkgICAgICovCgkgICAgRmxvYXQuTUFYX1ZBTFVFID0gTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVI7CgkgICAgcmV0dXJuIEZsb2F0OwoJfSgpKTsKCUZsb2F0JDEuZGVmYXVsdCA9IEZsb2F0OwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoUmVzdWx0UG9pbnQkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZyB7Ki8KCXZhciBNYXRoVXRpbHNfMSQxID0gTWF0aFV0aWxzJDE7Cgl2YXIgRmxvYXRfMSA9IEZsb2F0JDE7CgkvKioKCSAqIDxwPkVuY2Fwc3VsYXRlcyBhIHBvaW50IG9mIGludGVyZXN0IGluIGFuIGltYWdlIGNvbnRhaW5pbmcgYSBiYXJjb2RlLiBUeXBpY2FsbHksIHRoaXMKCSAqIHdvdWxkIGJlIHRoZSBsb2NhdGlvbiBvZiBhIGZpbmRlciBwYXR0ZXJuIG9yIHRoZSBjb3JuZXIgb2YgdGhlIGJhcmNvZGUsIGZvciBleGFtcGxlLjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgUmVzdWx0UG9pbnQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gUmVzdWx0UG9pbnQoeCwgeSkgewoJICAgICAgICB0aGlzLnggPSB4OwoJICAgICAgICB0aGlzLnkgPSB5OwoJICAgIH0KCSAgICBSZXN1bHRQb2ludC5wcm90b3R5cGUuZ2V0WCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMueDsKCSAgICB9OwoJICAgIFJlc3VsdFBvaW50LnByb3RvdHlwZS5nZXRZID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy55OwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIFJlc3VsdFBvaW50LnByb3RvdHlwZS5lcXVhbHMgPSBmdW5jdGlvbiAob3RoZXIpIHsKCSAgICAgICAgaWYgKG90aGVyIGluc3RhbmNlb2YgUmVzdWx0UG9pbnQpIHsKCSAgICAgICAgICAgIHZhciBvdGhlclBvaW50ID0gb3RoZXI7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy54ID09PSBvdGhlclBvaW50LnggJiYgdGhpcy55ID09PSBvdGhlclBvaW50Lnk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIFJlc3VsdFBvaW50LnByb3RvdHlwZS5oYXNoQ29kZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIDMxICogRmxvYXRfMS5kZWZhdWx0LmZsb2F0VG9JbnRCaXRzKHRoaXMueCkgKyBGbG9hdF8xLmRlZmF1bHQuZmxvYXRUb0ludEJpdHModGhpcy55KTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBSZXN1bHRQb2ludC5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiAnKCcgKyB0aGlzLnggKyAnLCcgKyB0aGlzLnkgKyAnKSc7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBPcmRlcnMgYW4gYXJyYXkgb2YgdGhyZWUgUmVzdWx0UG9pbnRzIGluIGFuIG9yZGVyIFtBLEIsQ10gc3VjaCB0aGF0IEFCIGlzIGxlc3MgdGhhbiBBQwoJICAgICAqIGFuZCBCQyBpcyBsZXNzIHRoYW4gQUMsIGFuZCB0aGUgYW5nbGUgYmV0d2VlbiBCQyBhbmQgQkEgaXMgbGVzcyB0aGFuIDE4MCBkZWdyZWVzLgoJICAgICAqCgkgICAgICogQHBhcmFtIHBhdHRlcm5zIGFycmF5IG9mIHRocmVlIHtAY29kZSBSZXN1bHRQb2ludH0gdG8gb3JkZXIKCSAgICAgKi8KCSAgICBSZXN1bHRQb2ludC5vcmRlckJlc3RQYXR0ZXJucyA9IGZ1bmN0aW9uIChwYXR0ZXJucykgewoJICAgICAgICAvLyBGaW5kIGRpc3RhbmNlcyBiZXR3ZWVuIHBhdHRlcm4gY2VudGVycwoJICAgICAgICB2YXIgemVyb09uZURpc3RhbmNlID0gdGhpcy5kaXN0YW5jZShwYXR0ZXJuc1swXSwgcGF0dGVybnNbMV0pOwoJICAgICAgICB2YXIgb25lVHdvRGlzdGFuY2UgPSB0aGlzLmRpc3RhbmNlKHBhdHRlcm5zWzFdLCBwYXR0ZXJuc1syXSk7CgkgICAgICAgIHZhciB6ZXJvVHdvRGlzdGFuY2UgPSB0aGlzLmRpc3RhbmNlKHBhdHRlcm5zWzBdLCBwYXR0ZXJuc1syXSk7CgkgICAgICAgIHZhciBwb2ludEE7CgkgICAgICAgIHZhciBwb2ludEI7CgkgICAgICAgIHZhciBwb2ludEM7CgkgICAgICAgIC8vIEFzc3VtZSBvbmUgY2xvc2VzdCB0byBvdGhlciB0d28gaXMgQjsgQSBhbmQgQyB3aWxsIGp1c3QgYmUgZ3Vlc3NlcyBhdCBmaXJzdAoJICAgICAgICBpZiAob25lVHdvRGlzdGFuY2UgPj0gemVyb09uZURpc3RhbmNlICYmIG9uZVR3b0Rpc3RhbmNlID49IHplcm9Ud29EaXN0YW5jZSkgewoJICAgICAgICAgICAgcG9pbnRCID0gcGF0dGVybnNbMF07CgkgICAgICAgICAgICBwb2ludEEgPSBwYXR0ZXJuc1sxXTsKCSAgICAgICAgICAgIHBvaW50QyA9IHBhdHRlcm5zWzJdOwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgaWYgKHplcm9Ud29EaXN0YW5jZSA+PSBvbmVUd29EaXN0YW5jZSAmJiB6ZXJvVHdvRGlzdGFuY2UgPj0gemVyb09uZURpc3RhbmNlKSB7CgkgICAgICAgICAgICBwb2ludEIgPSBwYXR0ZXJuc1sxXTsKCSAgICAgICAgICAgIHBvaW50QSA9IHBhdHRlcm5zWzBdOwoJICAgICAgICAgICAgcG9pbnRDID0gcGF0dGVybnNbMl07CgkgICAgICAgIH0KCSAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICBwb2ludEIgPSBwYXR0ZXJuc1syXTsKCSAgICAgICAgICAgIHBvaW50QSA9IHBhdHRlcm5zWzBdOwoJICAgICAgICAgICAgcG9pbnRDID0gcGF0dGVybnNbMV07CgkgICAgICAgIH0KCSAgICAgICAgLy8gVXNlIGNyb3NzIHByb2R1Y3QgdG8gZmlndXJlIG91dCB3aGV0aGVyIEEgYW5kIEMgYXJlIGNvcnJlY3Qgb3IgZmxpcHBlZC4KCSAgICAgICAgLy8gVGhpcyBhc2tzIHdoZXRoZXIgQkMgeCBCQSBoYXMgYSBwb3NpdGl2ZSB6IGNvbXBvbmVudCwgd2hpY2ggaXMgdGhlIGFycmFuZ2VtZW50CgkgICAgICAgIC8vIHdlIHdhbnQgZm9yIEEsIEIsIEMuIElmIGl0J3MgbmVnYXRpdmUsIHRoZW4gd2UndmUgZ290IGl0IGZsaXBwZWQgYXJvdW5kIGFuZAoJICAgICAgICAvLyBzaG91bGQgc3dhcCBBIGFuZCBDLgoJICAgICAgICBpZiAodGhpcy5jcm9zc1Byb2R1Y3RaKHBvaW50QSwgcG9pbnRCLCBwb2ludEMpIDwgMC4wKSB7CgkgICAgICAgICAgICB2YXIgdGVtcCA9IHBvaW50QTsKCSAgICAgICAgICAgIHBvaW50QSA9IHBvaW50QzsKCSAgICAgICAgICAgIHBvaW50QyA9IHRlbXA7CgkgICAgICAgIH0KCSAgICAgICAgcGF0dGVybnNbMF0gPSBwb2ludEE7CgkgICAgICAgIHBhdHRlcm5zWzFdID0gcG9pbnRCOwoJICAgICAgICBwYXR0ZXJuc1syXSA9IHBvaW50QzsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBwYXR0ZXJuMSBmaXJzdCBwYXR0ZXJuCgkgICAgICogQHBhcmFtIHBhdHRlcm4yIHNlY29uZCBwYXR0ZXJuCgkgICAgICogQHJldHVybiBkaXN0YW5jZSBiZXR3ZWVuIHR3byBwb2ludHMKCSAgICAgKi8KCSAgICBSZXN1bHRQb2ludC5kaXN0YW5jZSA9IGZ1bmN0aW9uIChwYXR0ZXJuMSwgcGF0dGVybjIpIHsKCSAgICAgICAgcmV0dXJuIE1hdGhVdGlsc18xJDEuZGVmYXVsdC5kaXN0YW5jZShwYXR0ZXJuMS54LCBwYXR0ZXJuMS55LCBwYXR0ZXJuMi54LCBwYXR0ZXJuMi55KTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgdGhlIHogY29tcG9uZW50IG9mIHRoZSBjcm9zcyBwcm9kdWN0IGJldHdlZW4gdmVjdG9ycyBCQyBhbmQgQkEuCgkgICAgICovCgkgICAgUmVzdWx0UG9pbnQuY3Jvc3NQcm9kdWN0WiA9IGZ1bmN0aW9uIChwb2ludEEsIHBvaW50QiwgcG9pbnRDKSB7CgkgICAgICAgIHZhciBiWCA9IHBvaW50Qi54OwoJICAgICAgICB2YXIgYlkgPSBwb2ludEIueTsKCSAgICAgICAgcmV0dXJuICgocG9pbnRDLnggLSBiWCkgKiAocG9pbnRBLnkgLSBiWSkpIC0gKChwb2ludEMueSAtIGJZKSAqIChwb2ludEEueCAtIGJYKSk7CgkgICAgfTsKCSAgICByZXR1cm4gUmVzdWx0UG9pbnQ7Cgl9KCkpOwoJUmVzdWx0UG9pbnQkMS5kZWZhdWx0ID0gUmVzdWx0UG9pbnQ7CgoJdmFyIEFsaWdubWVudFBhdHRlcm5GaW5kZXIkMSA9IHt9OwoKCXZhciBBbGlnbm1lbnRQYXR0ZXJuJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fZXh0ZW5kcyQxID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHsKCSAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwKCSAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHwKCSAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9OwoJICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICB9OwoJICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH0KCSAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpOwoJICAgIH07Cgl9KSgpOwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEFsaWdubWVudFBhdHRlcm4kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5xcmNvZGUuZGV0ZWN0b3IgeyovCgl2YXIgUmVzdWx0UG9pbnRfMSQzID0gUmVzdWx0UG9pbnQkMTsKCS8qKgoJICogPHA+RW5jYXBzdWxhdGVzIGFuIGFsaWdubWVudCBwYXR0ZXJuLCB3aGljaCBhcmUgdGhlIHNtYWxsZXIgc3F1YXJlIHBhdHRlcm5zIGZvdW5kIGluCgkgKiBhbGwgYnV0IHRoZSBzaW1wbGVzdCBRUiBDb2Rlcy48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEFsaWdubWVudFBhdHRlcm4gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJDEoQWxpZ25tZW50UGF0dGVybiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBBbGlnbm1lbnRQYXR0ZXJuKHBvc1ggLypmbG9hdCovLCBwb3NZIC8qZmxvYXQqLywgZXN0aW1hdGVkTW9kdWxlU2l6ZSAvKmZsb2F0Ki8pIHsKCSAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgcG9zWCwgcG9zWSkgfHwgdGhpczsKCSAgICAgICAgX3RoaXMuZXN0aW1hdGVkTW9kdWxlU2l6ZSA9IGVzdGltYXRlZE1vZHVsZVNpemU7CgkgICAgICAgIHJldHVybiBfdGhpczsKCSAgICB9CgkgICAgLyoqCgkgICAgICogPHA+RGV0ZXJtaW5lcyBpZiB0aGlzIGFsaWdubWVudCBwYXR0ZXJuICJhYm91dCBlcXVhbHMiIGFuIGFsaWdubWVudCBwYXR0ZXJuIGF0IHRoZSBzdGF0ZWQKCSAgICAgKiBwb3NpdGlvbiBhbmQgc2l6ZSAtLSBtZWFuaW5nLCBpdCBpcyBhdCBuZWFybHkgdGhlIHNhbWUgY2VudGVyIHdpdGggbmVhcmx5IHRoZSBzYW1lIHNpemUuPC9wPgoJICAgICAqLwoJICAgIEFsaWdubWVudFBhdHRlcm4ucHJvdG90eXBlLmFib3V0RXF1YWxzID0gZnVuY3Rpb24gKG1vZHVsZVNpemUgLypmbG9hdCovLCBpIC8qZmxvYXQqLywgaiAvKmZsb2F0Ki8pIHsKCSAgICAgICAgaWYgKE1hdGguYWJzKGkgLSB0aGlzLmdldFkoKSkgPD0gbW9kdWxlU2l6ZSAmJiBNYXRoLmFicyhqIC0gdGhpcy5nZXRYKCkpIDw9IG1vZHVsZVNpemUpIHsKCSAgICAgICAgICAgIHZhciBtb2R1bGVTaXplRGlmZiA9IE1hdGguYWJzKG1vZHVsZVNpemUgLSB0aGlzLmVzdGltYXRlZE1vZHVsZVNpemUpOwoJICAgICAgICAgICAgcmV0dXJuIG1vZHVsZVNpemVEaWZmIDw9IDEuMCB8fCBtb2R1bGVTaXplRGlmZiA8PSB0aGlzLmVzdGltYXRlZE1vZHVsZVNpemU7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQ29tYmluZXMgdGhpcyBvYmplY3QncyBjdXJyZW50IGVzdGltYXRlIG9mIGEgZmluZGVyIHBhdHRlcm4gcG9zaXRpb24gYW5kIG1vZHVsZSBzaXplCgkgICAgICogd2l0aCBhIG5ldyBlc3RpbWF0ZS4gSXQgcmV0dXJucyBhIG5ldyB7QGNvZGUgRmluZGVyUGF0dGVybn0gY29udGFpbmluZyBhbiBhdmVyYWdlIG9mIHRoZSB0d28uCgkgICAgICovCgkgICAgQWxpZ25tZW50UGF0dGVybi5wcm90b3R5cGUuY29tYmluZUVzdGltYXRlID0gZnVuY3Rpb24gKGkgLypmbG9hdCovLCBqIC8qZmxvYXQqLywgbmV3TW9kdWxlU2l6ZSAvKmZsb2F0Ki8pIHsKCSAgICAgICAgdmFyIGNvbWJpbmVkWCA9ICh0aGlzLmdldFgoKSArIGopIC8gMi4wOwoJICAgICAgICB2YXIgY29tYmluZWRZID0gKHRoaXMuZ2V0WSgpICsgaSkgLyAyLjA7CgkgICAgICAgIHZhciBjb21iaW5lZE1vZHVsZVNpemUgPSAodGhpcy5lc3RpbWF0ZWRNb2R1bGVTaXplICsgbmV3TW9kdWxlU2l6ZSkgLyAyLjA7CgkgICAgICAgIHJldHVybiBuZXcgQWxpZ25tZW50UGF0dGVybihjb21iaW5lZFgsIGNvbWJpbmVkWSwgY29tYmluZWRNb2R1bGVTaXplKTsKCSAgICB9OwoJICAgIHJldHVybiBBbGlnbm1lbnRQYXR0ZXJuOwoJfShSZXN1bHRQb2ludF8xJDMuZGVmYXVsdCkpOwoJQWxpZ25tZW50UGF0dGVybiQxLmRlZmF1bHQgPSBBbGlnbm1lbnRQYXR0ZXJuOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCgl2YXIgX192YWx1ZXMkMSA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX3ZhbHVlcykgfHwgZnVuY3Rpb24obykgewoJICAgIHZhciBzID0gdHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiBTeW1ib2wuaXRlcmF0b3IsIG0gPSBzICYmIG9bc10sIGkgPSAwOwoJICAgIGlmIChtKSByZXR1cm4gbS5jYWxsKG8pOwoJICAgIGlmIChvICYmIHR5cGVvZiBvLmxlbmd0aCA9PT0gIm51bWJlciIpIHJldHVybiB7CgkgICAgICAgIG5leHQ6IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgICAgIGlmIChvICYmIGkgPj0gby5sZW5ndGgpIG8gPSB2b2lkIDA7CgkgICAgICAgICAgICByZXR1cm4geyB2YWx1ZTogbyAmJiBvW2krK10sIGRvbmU6ICFvIH07CgkgICAgICAgIH0KCSAgICB9OwoJICAgIHRocm93IG5ldyBUeXBlRXJyb3IocyA/ICJPYmplY3QgaXMgbm90IGl0ZXJhYmxlLiIgOiAiU3ltYm9sLml0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLiIpOwoJfTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShBbGlnbm1lbnRQYXR0ZXJuRmluZGVyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBBbGlnbm1lbnRQYXR0ZXJuXzEgPSBBbGlnbm1lbnRQYXR0ZXJuJDE7Cgl2YXIgTm90Rm91bmRFeGNlcHRpb25fMSQzID0gTm90Rm91bmRFeGNlcHRpb24kMTsKCS8qaW1wb3J0IGphdmEudXRpbC5BcnJheUxpc3Q7Ki8KCS8qaW1wb3J0IGphdmEudXRpbC5MaXN0OyovCgkvKioKCSAqIDxwPlRoaXMgY2xhc3MgYXR0ZW1wdHMgdG8gZmluZCBhbGlnbm1lbnQgcGF0dGVybnMgaW4gYSBRUiBDb2RlLiBBbGlnbm1lbnQgcGF0dGVybnMgbG9vayBsaWtlIGZpbmRlcgoJICogcGF0dGVybnMgYnV0IGFyZSBzbWFsbGVyIGFuZCBhcHBlYXIgYXQgcmVndWxhciBpbnRlcnZhbHMgdGhyb3VnaG91dCB0aGUgaW1hZ2UuPC9wPgoJICoKCSAqIDxwPkF0IHRoZSBtb21lbnQgdGhpcyBvbmx5IGxvb2tzIGZvciB0aGUgYm90dG9tLXJpZ2h0IGFsaWdubWVudCBwYXR0ZXJuLjwvcD4KCSAqCgkgKiA8cD5UaGlzIGlzIG1vc3RseSBhIHNpbXBsaWZpZWQgY29weSBvZiB7QGxpbmsgRmluZGVyUGF0dGVybkZpbmRlcn0uIEl0IGlzIGNvcGllZCwKCSAqIHBhc3RlZCBhbmQgc3RyaXBwZWQgZG93biBoZXJlIGZvciBtYXhpbXVtIHBlcmZvcm1hbmNlIGJ1dCBkb2VzIHVuZm9ydHVuYXRlbHkgZHVwbGljYXRlCgkgKiBzb21lIGNvZGUuPC9wPgoJICoKCSAqIDxwPlRoaXMgY2xhc3MgaXMgdGhyZWFkLXNhZmUgYnV0IG5vdCByZWVudHJhbnQuIEVhY2ggdGhyZWFkIG11c3QgYWxsb2NhdGUgaXRzIG93biBvYmplY3QuPC9wPgoJICoKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIC8qKgoJICAgICAqIDxwPkNyZWF0ZXMgYSBmaW5kZXIgdGhhdCB3aWxsIGxvb2sgaW4gYSBwb3J0aW9uIG9mIHRoZSB3aG9sZSBpbWFnZS48L3A+CgkgICAgICoKCSAgICAgKiBAcGFyYW0gaW1hZ2UgaW1hZ2UgdG8gc2VhcmNoCgkgICAgICogQHBhcmFtIHN0YXJ0WCBsZWZ0IGNvbHVtbiBmcm9tIHdoaWNoIHRvIHN0YXJ0IHNlYXJjaGluZwoJICAgICAqIEBwYXJhbSBzdGFydFkgdG9wIHJvdyBmcm9tIHdoaWNoIHRvIHN0YXJ0IHNlYXJjaGluZwoJICAgICAqIEBwYXJhbSB3aWR0aCB3aWR0aCBvZiByZWdpb24gdG8gc2VhcmNoCgkgICAgICogQHBhcmFtIGhlaWdodCBoZWlnaHQgb2YgcmVnaW9uIHRvIHNlYXJjaAoJICAgICAqIEBwYXJhbSBtb2R1bGVTaXplIGVzdGltYXRlZCBtb2R1bGUgc2l6ZSBzbyBmYXIKCSAgICAgKi8KCSAgICBmdW5jdGlvbiBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyKGltYWdlLCBzdGFydFggLyppbnQqLywgc3RhcnRZIC8qaW50Ki8sIHdpZHRoIC8qaW50Ki8sIGhlaWdodCAvKmludCovLCBtb2R1bGVTaXplIC8qZmxvYXQqLywgcmVzdWx0UG9pbnRDYWxsYmFjaykgewoJICAgICAgICB0aGlzLmltYWdlID0gaW1hZ2U7CgkgICAgICAgIHRoaXMuc3RhcnRYID0gc3RhcnRYOwoJICAgICAgICB0aGlzLnN0YXJ0WSA9IHN0YXJ0WTsKCSAgICAgICAgdGhpcy53aWR0aCA9IHdpZHRoOwoJICAgICAgICB0aGlzLmhlaWdodCA9IGhlaWdodDsKCSAgICAgICAgdGhpcy5tb2R1bGVTaXplID0gbW9kdWxlU2l6ZTsKCSAgICAgICAgdGhpcy5yZXN1bHRQb2ludENhbGxiYWNrID0gcmVzdWx0UG9pbnRDYWxsYmFjazsKCSAgICAgICAgdGhpcy5wb3NzaWJsZUNlbnRlcnMgPSBbXTsgLy8gbmV3IEFycmF5PGFueT4oNSkpCgkgICAgICAgIC8vIFRZUEVTQ1JJUFRQT1JUOiBhcnJheSBpbml0aWFsaXphdGlvbiB3aXRob3V0IHNpemUgYXMgdGhlIGxlbmd0aCBpcyBjaGVja2VkIGJlbG93CgkgICAgICAgIHRoaXMuY3Jvc3NDaGVja1N0YXRlQ291bnQgPSBuZXcgSW50MzJBcnJheSgzKTsKCSAgICB9CgkgICAgLyoqCgkgICAgICogPHA+VGhpcyBtZXRob2QgYXR0ZW1wdHMgdG8gZmluZCB0aGUgYm90dG9tLXJpZ2h0IGFsaWdubWVudCBwYXR0ZXJuIGluIHRoZSBpbWFnZS4gSXQgaXMgYSBiaXQgbWVzc3kgc2luY2UKCSAgICAgKiBpdCdzIHByZXR0eSBwZXJmb3JtYW5jZS1jcml0aWNhbCBhbmQgc28gaXMgd3JpdHRlbiB0byBiZSBmYXN0IGZvcmVtb3N0LjwvcD4KCSAgICAgKgoJICAgICAqIEByZXR1cm4ge0BsaW5rIEFsaWdubWVudFBhdHRlcm59IGlmIGZvdW5kCgkgICAgICogQHRocm93cyBOb3RGb3VuZEV4Y2VwdGlvbiBpZiBub3QgZm91bmQKCSAgICAgKi8KCSAgICBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyLnByb3RvdHlwZS5maW5kID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgc3RhcnRYID0gdGhpcy5zdGFydFg7CgkgICAgICAgIHZhciBoZWlnaHQgPSB0aGlzLmhlaWdodDsKCSAgICAgICAgdmFyIHdpZHRoID0gdGhpcy53aWR0aDsKCSAgICAgICAgdmFyIG1heEogPSBzdGFydFggKyB3aWR0aDsKCSAgICAgICAgdmFyIG1pZGRsZUkgPSB0aGlzLnN0YXJ0WSArIChoZWlnaHQgLyAyKTsKCSAgICAgICAgLy8gV2UgYXJlIGxvb2tpbmcgZm9yIGJsYWNrL3doaXRlL2JsYWNrIG1vZHVsZXMgaW4gMToxOjEgcmF0aW8KCSAgICAgICAgLy8gdGhpcyB0cmFja3MgdGhlIG51bWJlciBvZiBibGFjay93aGl0ZS9ibGFjayBtb2R1bGVzIHNlZW4gc28gZmFyCgkgICAgICAgIHZhciBzdGF0ZUNvdW50ID0gbmV3IEludDMyQXJyYXkoMyk7CgkgICAgICAgIHZhciBpbWFnZSA9IHRoaXMuaW1hZ2U7CgkgICAgICAgIGZvciAodmFyIGlHZW4gPSAwOyBpR2VuIDwgaGVpZ2h0OyBpR2VuKyspIHsKCSAgICAgICAgICAgIC8vIFNlYXJjaCBmcm9tIG1pZGRsZSBvdXR3YXJkcwoJICAgICAgICAgICAgdmFyIGkgPSBtaWRkbGVJICsgKChpR2VuICYgMHgwMSkgPT09IDAgPyBNYXRoLmZsb29yKChpR2VuICsgMSkgLyAyKSA6IC1NYXRoLmZsb29yKChpR2VuICsgMSkgLyAyKSk7CgkgICAgICAgICAgICBzdGF0ZUNvdW50WzBdID0gMDsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbMV0gPSAwOwoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSA9IDA7CgkgICAgICAgICAgICB2YXIgaiA9IHN0YXJ0WDsKCSAgICAgICAgICAgIC8vIEJ1cm4gb2ZmIGxlYWRpbmcgd2hpdGUgcGl4ZWxzIGJlZm9yZSBhbnl0aGluZyBlbHNlOyBpZiB3ZSBzdGFydCBpbiB0aGUgbWlkZGxlIG9mCgkgICAgICAgICAgICAvLyBhIHdoaXRlIHJ1biwgaXQgZG9lc24ndCBtYWtlIHNlbnNlIHRvIGNvdW50IGl0cyBsZW5ndGgsIHNpbmNlIHdlIGRvbid0IGtub3cgaWYgdGhlCgkgICAgICAgICAgICAvLyB3aGl0ZSBydW4gY29udGludWVkIHRvIHRoZSBsZWZ0IG9mIHRoZSBzdGFydCBwb2ludAoJICAgICAgICAgICAgd2hpbGUgKGogPCBtYXhKICYmICFpbWFnZS5nZXQoaiwgaSkpIHsKCSAgICAgICAgICAgICAgICBqKys7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB2YXIgY3VycmVudFN0YXRlID0gMDsKCSAgICAgICAgICAgIHdoaWxlIChqIDwgbWF4SikgewoJICAgICAgICAgICAgICAgIGlmIChpbWFnZS5nZXQoaiwgaSkpIHsKCSAgICAgICAgICAgICAgICAgICAgLy8gQmxhY2sgcGl4ZWwKCSAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRTdGF0ZSA9PT0gMSkgeyAvLyBDb3VudGluZyBibGFjayBwaXhlbHMKCSAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbMV0rKzsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICBlbHNlIHsgLy8gQ291bnRpbmcgd2hpdGUgcGl4ZWxzCgkgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudFN0YXRlID09PSAyKSB7IC8vIEEgd2lubmVyPwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmZvdW5kUGF0dGVybkNyb3NzKHN0YXRlQ291bnQpKSB7IC8vIFllcwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29uZmlybWVkID0gdGhpcy5oYW5kbGVQb3NzaWJsZUNlbnRlcihzdGF0ZUNvdW50LCBpLCBqKTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbmZpcm1lZCAhPT0gbnVsbCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbmZpcm1lZDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzBdID0gc3RhdGVDb3VudFsyXTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzFdID0gMTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzJdID0gMDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50U3RhdGUgPSAxOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudFsrK2N1cnJlbnRTdGF0ZV0rKzsKCSAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBlbHNlIHsgLy8gV2hpdGUgcGl4ZWwKCSAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRTdGF0ZSA9PT0gMSkgeyAvLyBDb3VudGluZyBibGFjayBwaXhlbHMKCSAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRTdGF0ZSsrOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbY3VycmVudFN0YXRlXSsrOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBqKys7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBpZiAodGhpcy5mb3VuZFBhdHRlcm5Dcm9zcyhzdGF0ZUNvdW50KSkgewoJICAgICAgICAgICAgICAgIHZhciBjb25maXJtZWQgPSB0aGlzLmhhbmRsZVBvc3NpYmxlQ2VudGVyKHN0YXRlQ291bnQsIGksIG1heEopOwoJICAgICAgICAgICAgICAgIGlmIChjb25maXJtZWQgIT09IG51bGwpIHsKCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbmZpcm1lZDsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gSG1tLCBub3RoaW5nIHdlIHNhdyB3YXMgb2JzZXJ2ZWQgYW5kIGNvbmZpcm1lZCB0d2ljZS4gSWYgd2UgaGFkCgkgICAgICAgIC8vIGFueSBndWVzcyBhdCBhbGwsIHJldHVybiBpdC4KCSAgICAgICAgaWYgKHRoaXMucG9zc2libGVDZW50ZXJzLmxlbmd0aCAhPT0gMCkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMucG9zc2libGVDZW50ZXJzWzBdOwoJICAgICAgICB9CgkgICAgICAgIHRocm93IG5ldyBOb3RGb3VuZEV4Y2VwdGlvbl8xJDMuZGVmYXVsdCgpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogR2l2ZW4gYSBjb3VudCBvZiBibGFjay93aGl0ZS9ibGFjayBwaXhlbHMganVzdCBzZWVuIGFuZCBhbiBlbmQgcG9zaXRpb24sCgkgICAgICogZmlndXJlcyB0aGUgbG9jYXRpb24gb2YgdGhlIGNlbnRlciBvZiB0aGlzIGJsYWNrL3doaXRlL2JsYWNrIHJ1bi4KCSAgICAgKi8KCSAgICBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyLmNlbnRlckZyb21FbmQgPSBmdW5jdGlvbiAoc3RhdGVDb3VudCwgZW5kIC8qaW50Ki8pIHsKCSAgICAgICAgcmV0dXJuIChlbmQgLSBzdGF0ZUNvdW50WzJdKSAtIHN0YXRlQ291bnRbMV0gLyAyLjA7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gc3RhdGVDb3VudCBjb3VudCBvZiBibGFjay93aGl0ZS9ibGFjayBwaXhlbHMganVzdCByZWFkCgkgICAgICogQHJldHVybiB0cnVlIGlmZiB0aGUgcHJvcG9ydGlvbnMgb2YgdGhlIGNvdW50cyBpcyBjbG9zZSBlbm91Z2ggdG8gdGhlIDEvMS8xIHJhdGlvcwoJICAgICAqICAgICAgICAgdXNlZCBieSBhbGlnbm1lbnQgcGF0dGVybnMgdG8gYmUgY29uc2lkZXJlZCBhIG1hdGNoCgkgICAgICovCgkgICAgQWxpZ25tZW50UGF0dGVybkZpbmRlci5wcm90b3R5cGUuZm91bmRQYXR0ZXJuQ3Jvc3MgPSBmdW5jdGlvbiAoc3RhdGVDb3VudCkgewoJICAgICAgICB2YXIgbW9kdWxlU2l6ZSA9IHRoaXMubW9kdWxlU2l6ZTsKCSAgICAgICAgdmFyIG1heFZhcmlhbmNlID0gbW9kdWxlU2l6ZSAvIDIuMDsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAzOyBpKyspIHsKCSAgICAgICAgICAgIGlmIChNYXRoLmFicyhtb2R1bGVTaXplIC0gc3RhdGVDb3VudFtpXSkgPj0gbWF4VmFyaWFuY2UpIHsKCSAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRydWU7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiA8cD5BZnRlciBhIGhvcml6b250YWwgc2NhbiBmaW5kcyBhIHBvdGVudGlhbCBhbGlnbm1lbnQgcGF0dGVybiwgdGhpcyBtZXRob2QKCSAgICAgKiAiY3Jvc3MtY2hlY2tzIiBieSBzY2FubmluZyBkb3duIHZlcnRpY2FsbHkgdGhyb3VnaCB0aGUgY2VudGVyIG9mIHRoZSBwb3NzaWJsZQoJICAgICAqIGFsaWdubWVudCBwYXR0ZXJuIHRvIHNlZSBpZiB0aGUgc2FtZSBwcm9wb3J0aW9uIGlzIGRldGVjdGVkLjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBzdGFydEkgcm93IHdoZXJlIGFuIGFsaWdubWVudCBwYXR0ZXJuIHdhcyBkZXRlY3RlZAoJICAgICAqIEBwYXJhbSBjZW50ZXJKIGNlbnRlciBvZiB0aGUgc2VjdGlvbiB0aGF0IGFwcGVhcnMgdG8gY3Jvc3MgYW4gYWxpZ25tZW50IHBhdHRlcm4KCSAgICAgKiBAcGFyYW0gbWF4Q291bnQgbWF4aW11bSByZWFzb25hYmxlIG51bWJlciBvZiBtb2R1bGVzIHRoYXQgc2hvdWxkIGJlCgkgICAgICogb2JzZXJ2ZWQgaW4gYW55IHJlYWRpbmcgc3RhdGUsIGJhc2VkIG9uIHRoZSByZXN1bHRzIG9mIHRoZSBob3Jpem9udGFsIHNjYW4KCSAgICAgKiBAcmV0dXJuIHZlcnRpY2FsIGNlbnRlciBvZiBhbGlnbm1lbnQgcGF0dGVybiwgb3Ige0BsaW5rIEZsb2F0I05hTn0gaWYgbm90IGZvdW5kCgkgICAgICovCgkgICAgQWxpZ25tZW50UGF0dGVybkZpbmRlci5wcm90b3R5cGUuY3Jvc3NDaGVja1ZlcnRpY2FsID0gZnVuY3Rpb24gKHN0YXJ0SSAvKmludCovLCBjZW50ZXJKIC8qaW50Ki8sIG1heENvdW50IC8qaW50Ki8sIG9yaWdpbmFsU3RhdGVDb3VudFRvdGFsIC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIGltYWdlID0gdGhpcy5pbWFnZTsKCSAgICAgICAgdmFyIG1heEkgPSBpbWFnZS5nZXRIZWlnaHQoKTsKCSAgICAgICAgdmFyIHN0YXRlQ291bnQgPSB0aGlzLmNyb3NzQ2hlY2tTdGF0ZUNvdW50OwoJICAgICAgICBzdGF0ZUNvdW50WzBdID0gMDsKCSAgICAgICAgc3RhdGVDb3VudFsxXSA9IDA7CgkgICAgICAgIHN0YXRlQ291bnRbMl0gPSAwOwoJICAgICAgICAvLyBTdGFydCBjb3VudGluZyB1cCBmcm9tIGNlbnRlcgoJICAgICAgICB2YXIgaSA9IHN0YXJ0STsKCSAgICAgICAgd2hpbGUgKGkgPj0gMCAmJiBpbWFnZS5nZXQoY2VudGVySiwgaSkgJiYgc3RhdGVDb3VudFsxXSA8PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsxXSsrOwoJICAgICAgICAgICAgaS0tOwoJICAgICAgICB9CgkgICAgICAgIC8vIElmIGFscmVhZHkgdG9vIG1hbnkgbW9kdWxlcyBpbiB0aGlzIHN0YXRlIG9yIHJhbiBvZmYgdGhlIGVkZ2U6CgkgICAgICAgIGlmIChpIDwgMCB8fCBzdGF0ZUNvdW50WzFdID4gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgd2hpbGUgKGkgPj0gMCAmJiAhaW1hZ2UuZ2V0KGNlbnRlckosIGkpICYmIHN0YXRlQ291bnRbMF0gPD0gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbMF0rKzsKCSAgICAgICAgICAgIGktLTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoc3RhdGVDb3VudFswXSA+IG1heENvdW50KSB7CgkgICAgICAgICAgICByZXR1cm4gTmFOOwoJICAgICAgICB9CgkgICAgICAgIC8vIE5vdyBhbHNvIGNvdW50IGRvd24gZnJvbSBjZW50ZXIKCSAgICAgICAgaSA9IHN0YXJ0SSArIDE7CgkgICAgICAgIHdoaWxlIChpIDwgbWF4SSAmJiBpbWFnZS5nZXQoY2VudGVySiwgaSkgJiYgc3RhdGVDb3VudFsxXSA8PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsxXSsrOwoJICAgICAgICAgICAgaSsrOwoJICAgICAgICB9CgkgICAgICAgIGlmIChpID09PSBtYXhJIHx8IHN0YXRlQ291bnRbMV0gPiBtYXhDb3VudCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICB3aGlsZSAoaSA8IG1heEkgJiYgIWltYWdlLmdldChjZW50ZXJKLCBpKSAmJiBzdGF0ZUNvdW50WzJdIDw9IG1heENvdW50KSB7CgkgICAgICAgICAgICBzdGF0ZUNvdW50WzJdKys7CgkgICAgICAgICAgICBpKys7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHN0YXRlQ291bnRbMl0gPiBtYXhDb3VudCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICB2YXIgc3RhdGVDb3VudFRvdGFsID0gc3RhdGVDb3VudFswXSArIHN0YXRlQ291bnRbMV0gKyBzdGF0ZUNvdW50WzJdOwoJICAgICAgICBpZiAoNSAqIE1hdGguYWJzKHN0YXRlQ291bnRUb3RhbCAtIG9yaWdpbmFsU3RhdGVDb3VudFRvdGFsKSA+PSAyICogb3JpZ2luYWxTdGF0ZUNvdW50VG90YWwpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRoaXMuZm91bmRQYXR0ZXJuQ3Jvc3Moc3RhdGVDb3VudCkgPyBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyLmNlbnRlckZyb21FbmQoc3RhdGVDb3VudCwgaSkgOiBOYU47CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiA8cD5UaGlzIGlzIGNhbGxlZCB3aGVuIGEgaG9yaXpvbnRhbCBzY2FuIGZpbmRzIGEgcG9zc2libGUgYWxpZ25tZW50IHBhdHRlcm4uIEl0IHdpbGwKCSAgICAgKiBjcm9zcyBjaGVjayB3aXRoIGEgdmVydGljYWwgc2NhbiwgYW5kIGlmIHN1Y2Nlc3NmdWwsIHdpbGwgc2VlIGlmIHRoaXMgcGF0dGVybiBoYWQgYmVlbgoJICAgICAqIGZvdW5kIG9uIGEgcHJldmlvdXMgaG9yaXpvbnRhbCBzY2FuLiBJZiBzbywgd2UgY29uc2lkZXIgaXQgY29uZmlybWVkIGFuZCBjb25jbHVkZSB3ZSBoYXZlCgkgICAgICogZm91bmQgdGhlIGFsaWdubWVudCBwYXR0ZXJuLjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBzdGF0ZUNvdW50IHJlYWRpbmcgc3RhdGUgbW9kdWxlIGNvdW50cyBmcm9tIGhvcml6b250YWwgc2NhbgoJICAgICAqIEBwYXJhbSBpIHJvdyB3aGVyZSBhbGlnbm1lbnQgcGF0dGVybiBtYXkgYmUgZm91bmQKCSAgICAgKiBAcGFyYW0gaiBlbmQgb2YgcG9zc2libGUgYWxpZ25tZW50IHBhdHRlcm4gaW4gcm93CgkgICAgICogQHJldHVybiB7QGxpbmsgQWxpZ25tZW50UGF0dGVybn0gaWYgd2UgaGF2ZSBmb3VuZCB0aGUgc2FtZSBwYXR0ZXJuIHR3aWNlLCBvciBudWxsIGlmIG5vdAoJICAgICAqLwoJICAgIEFsaWdubWVudFBhdHRlcm5GaW5kZXIucHJvdG90eXBlLmhhbmRsZVBvc3NpYmxlQ2VudGVyID0gZnVuY3Rpb24gKHN0YXRlQ291bnQsIGkgLyppbnQqLywgaiAvKmludCovKSB7CgkgICAgICAgIHZhciBlXzEsIF9hOwoJICAgICAgICB2YXIgc3RhdGVDb3VudFRvdGFsID0gc3RhdGVDb3VudFswXSArIHN0YXRlQ291bnRbMV0gKyBzdGF0ZUNvdW50WzJdOwoJICAgICAgICB2YXIgY2VudGVySiA9IEFsaWdubWVudFBhdHRlcm5GaW5kZXIuY2VudGVyRnJvbUVuZChzdGF0ZUNvdW50LCBqKTsKCSAgICAgICAgdmFyIGNlbnRlckkgPSB0aGlzLmNyb3NzQ2hlY2tWZXJ0aWNhbChpLCAvKihpbnQpICovIGNlbnRlckosIDIgKiBzdGF0ZUNvdW50WzFdLCBzdGF0ZUNvdW50VG90YWwpOwoJICAgICAgICBpZiAoIWlzTmFOKGNlbnRlckkpKSB7CgkgICAgICAgICAgICB2YXIgZXN0aW1hdGVkTW9kdWxlU2l6ZSA9IChzdGF0ZUNvdW50WzBdICsgc3RhdGVDb3VudFsxXSArIHN0YXRlQ291bnRbMl0pIC8gMy4wOwoJICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICBmb3IgKHZhciBfYiA9IF9fdmFsdWVzJDEodGhpcy5wb3NzaWJsZUNlbnRlcnMpLCBfYyA9IF9iLm5leHQoKTsgIV9jLmRvbmU7IF9jID0gX2IubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgICAgIHZhciBjZW50ZXIgPSBfYy52YWx1ZTsKCSAgICAgICAgICAgICAgICAgICAgLy8gTG9vayBmb3IgYWJvdXQgdGhlIHNhbWUgY2VudGVyIGFuZCBtb2R1bGUgc2l6ZToKCSAgICAgICAgICAgICAgICAgICAgaWYgKGNlbnRlci5hYm91dEVxdWFscyhlc3RpbWF0ZWRNb2R1bGVTaXplLCBjZW50ZXJJLCBjZW50ZXJKKSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNlbnRlci5jb21iaW5lRXN0aW1hdGUoY2VudGVySSwgY2VudGVySiwgZXN0aW1hdGVkTW9kdWxlU2l6ZSk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBjYXRjaCAoZV8xXzEpIHsgZV8xID0geyBlcnJvcjogZV8xXzEgfTsgfQoJICAgICAgICAgICAgZmluYWxseSB7CgkgICAgICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKF9jICYmICFfYy5kb25lICYmIChfYSA9IF9iLnJldHVybikpIF9hLmNhbGwoX2IpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMSkgdGhyb3cgZV8xLmVycm9yOyB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICAvLyBIYWRuJ3QgZm91bmQgdGhpcyBiZWZvcmU7IHNhdmUgaXQKCSAgICAgICAgICAgIHZhciBwb2ludCA9IG5ldyBBbGlnbm1lbnRQYXR0ZXJuXzEuZGVmYXVsdChjZW50ZXJKLCBjZW50ZXJJLCBlc3RpbWF0ZWRNb2R1bGVTaXplKTsKCSAgICAgICAgICAgIHRoaXMucG9zc2libGVDZW50ZXJzLnB1c2gocG9pbnQpOwoJICAgICAgICAgICAgaWYgKHRoaXMucmVzdWx0UG9pbnRDYWxsYmFjayAhPT0gbnVsbCAmJiB0aGlzLnJlc3VsdFBvaW50Q2FsbGJhY2sgIT09IHVuZGVmaW5lZCkgewoJICAgICAgICAgICAgICAgIHRoaXMucmVzdWx0UG9pbnRDYWxsYmFjay5mb3VuZFBvc3NpYmxlUmVzdWx0UG9pbnQocG9pbnQpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBudWxsOwoJICAgIH07CgkgICAgcmV0dXJuIEFsaWdubWVudFBhdHRlcm5GaW5kZXI7Cgl9KCkpOwoJQWxpZ25tZW50UGF0dGVybkZpbmRlciQxLmRlZmF1bHQgPSBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyOwoKCXZhciBGaW5kZXJQYXR0ZXJuRmluZGVyJDEgPSB7fTsKCgl2YXIgRmluZGVyUGF0dGVybiQxID0ge307CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCXZhciBfX2V4dGVuZHMgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoRmluZGVyUGF0dGVybiQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKm5hbWVzcGFjZSBjb20uZ29vZ2xlLnp4aW5nLnFyY29kZS5kZXRlY3RvciB7Ki8KCXZhciBSZXN1bHRQb2ludF8xJDIgPSBSZXN1bHRQb2ludCQxOwoJLyoqCgkgKiA8cD5FbmNhcHN1bGF0ZXMgYSBmaW5kZXIgcGF0dGVybiwgd2hpY2ggYXJlIHRoZSB0aHJlZSBzcXVhcmUgcGF0dGVybnMgZm91bmQgaW4KCSAqIHRoZSBjb3JuZXJzIG9mIFFSIENvZGVzLiBJdCBhbHNvIGVuY2Fwc3VsYXRlcyBhIGNvdW50IG9mIHNpbWlsYXIgZmluZGVyIHBhdHRlcm5zLAoJICogYXMgYSBjb252ZW5pZW5jZSB0byB0aGUgZmluZGVyJ3MgYm9va2tlZXBpbmcuPC9wPgoJICoKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBGaW5kZXJQYXR0ZXJuID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikgewoJICAgIF9fZXh0ZW5kcyhGaW5kZXJQYXR0ZXJuLCBfc3VwZXIpOwoJICAgIC8vIEZpbmRlclBhdHRlcm4ocG9zWDogbnVtYmVyLypmbG9hdCovLCBwb3NZOiBudW1iZXIvKmZsb2F0Ki8sIGVzdGltYXRlZE1vZHVsZVNpemU6IG51bWJlci8qZmxvYXQqLykgewoJICAgIC8vICAgdGhpcyhwb3NYLCBwb3NZLCBlc3RpbWF0ZWRNb2R1bGVTaXplLCAxKQoJICAgIC8vIH0KCSAgICBmdW5jdGlvbiBGaW5kZXJQYXR0ZXJuKHBvc1ggLypmbG9hdCovLCBwb3NZIC8qZmxvYXQqLywgZXN0aW1hdGVkTW9kdWxlU2l6ZSAvKmZsb2F0Ki8sIGNvdW50IC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgcG9zWCwgcG9zWSkgfHwgdGhpczsKCSAgICAgICAgX3RoaXMuZXN0aW1hdGVkTW9kdWxlU2l6ZSA9IGVzdGltYXRlZE1vZHVsZVNpemU7CgkgICAgICAgIF90aGlzLmNvdW50ID0gY291bnQ7CgkgICAgICAgIGlmICh1bmRlZmluZWQgPT09IGNvdW50KSB7CgkgICAgICAgICAgICBfdGhpcy5jb3VudCA9IDE7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIF90aGlzOwoJICAgIH0KCSAgICBGaW5kZXJQYXR0ZXJuLnByb3RvdHlwZS5nZXRFc3RpbWF0ZWRNb2R1bGVTaXplID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5lc3RpbWF0ZWRNb2R1bGVTaXplOwoJICAgIH07CgkgICAgRmluZGVyUGF0dGVybi5wcm90b3R5cGUuZ2V0Q291bnQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmNvdW50OwoJICAgIH07CgkgICAgLyoKCSAgICB2b2lkIGluY3JlbWVudENvdW50KCkgewoJICAgICAgdGhpcy5jb3VudCsrCgkgICAgfQoJICAgICAqLwoJICAgIC8qKgoJICAgICAqIDxwPkRldGVybWluZXMgaWYgdGhpcyBmaW5kZXIgcGF0dGVybiAiYWJvdXQgZXF1YWxzIiBhIGZpbmRlciBwYXR0ZXJuIGF0IHRoZSBzdGF0ZWQKCSAgICAgKiBwb3NpdGlvbiBhbmQgc2l6ZSAtLSBtZWFuaW5nLCBpdCBpcyBhdCBuZWFybHkgdGhlIHNhbWUgY2VudGVyIHdpdGggbmVhcmx5IHRoZSBzYW1lIHNpemUuPC9wPgoJICAgICAqLwoJICAgIEZpbmRlclBhdHRlcm4ucHJvdG90eXBlLmFib3V0RXF1YWxzID0gZnVuY3Rpb24gKG1vZHVsZVNpemUgLypmbG9hdCovLCBpIC8qZmxvYXQqLywgaiAvKmZsb2F0Ki8pIHsKCSAgICAgICAgaWYgKE1hdGguYWJzKGkgLSB0aGlzLmdldFkoKSkgPD0gbW9kdWxlU2l6ZSAmJiBNYXRoLmFicyhqIC0gdGhpcy5nZXRYKCkpIDw9IG1vZHVsZVNpemUpIHsKCSAgICAgICAgICAgIHZhciBtb2R1bGVTaXplRGlmZiA9IE1hdGguYWJzKG1vZHVsZVNpemUgLSB0aGlzLmVzdGltYXRlZE1vZHVsZVNpemUpOwoJICAgICAgICAgICAgcmV0dXJuIG1vZHVsZVNpemVEaWZmIDw9IDEuMCB8fCBtb2R1bGVTaXplRGlmZiA8PSB0aGlzLmVzdGltYXRlZE1vZHVsZVNpemU7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQ29tYmluZXMgdGhpcyBvYmplY3QncyBjdXJyZW50IGVzdGltYXRlIG9mIGEgZmluZGVyIHBhdHRlcm4gcG9zaXRpb24gYW5kIG1vZHVsZSBzaXplCgkgICAgICogd2l0aCBhIG5ldyBlc3RpbWF0ZS4gSXQgcmV0dXJucyBhIG5ldyB7QGNvZGUgRmluZGVyUGF0dGVybn0gY29udGFpbmluZyBhIHdlaWdodGVkIGF2ZXJhZ2UKCSAgICAgKiBiYXNlZCBvbiBjb3VudC4KCSAgICAgKi8KCSAgICBGaW5kZXJQYXR0ZXJuLnByb3RvdHlwZS5jb21iaW5lRXN0aW1hdGUgPSBmdW5jdGlvbiAoaSAvKmZsb2F0Ki8sIGogLypmbG9hdCovLCBuZXdNb2R1bGVTaXplIC8qZmxvYXQqLykgewoJICAgICAgICB2YXIgY29tYmluZWRDb3VudCA9IHRoaXMuY291bnQgKyAxOwoJICAgICAgICB2YXIgY29tYmluZWRYID0gKHRoaXMuY291bnQgKiB0aGlzLmdldFgoKSArIGopIC8gY29tYmluZWRDb3VudDsKCSAgICAgICAgdmFyIGNvbWJpbmVkWSA9ICh0aGlzLmNvdW50ICogdGhpcy5nZXRZKCkgKyBpKSAvIGNvbWJpbmVkQ291bnQ7CgkgICAgICAgIHZhciBjb21iaW5lZE1vZHVsZVNpemUgPSAodGhpcy5jb3VudCAqIHRoaXMuZXN0aW1hdGVkTW9kdWxlU2l6ZSArIG5ld01vZHVsZVNpemUpIC8gY29tYmluZWRDb3VudDsKCSAgICAgICAgcmV0dXJuIG5ldyBGaW5kZXJQYXR0ZXJuKGNvbWJpbmVkWCwgY29tYmluZWRZLCBjb21iaW5lZE1vZHVsZVNpemUsIGNvbWJpbmVkQ291bnQpOwoJICAgIH07CgkgICAgcmV0dXJuIEZpbmRlclBhdHRlcm47Cgl9KFJlc3VsdFBvaW50XzEkMi5kZWZhdWx0KSk7CglGaW5kZXJQYXR0ZXJuJDEuZGVmYXVsdCA9IEZpbmRlclBhdHRlcm47CgoJdmFyIEZpbmRlclBhdHRlcm5JbmZvJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEZpbmRlclBhdHRlcm5JbmZvJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qKgoJICogPHA+RW5jYXBzdWxhdGVzIGluZm9ybWF0aW9uIGFib3V0IGZpbmRlciBwYXR0ZXJucyBpbiBhbiBpbWFnZSwgaW5jbHVkaW5nIHRoZSBsb2NhdGlvbiBvZgoJICogdGhlIHRocmVlIGZpbmRlciBwYXR0ZXJucywgYW5kIHRoZWlyIGVzdGltYXRlZCBtb2R1bGUgc2l6ZS48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEZpbmRlclBhdHRlcm5JbmZvID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIEZpbmRlclBhdHRlcm5JbmZvKHBhdHRlcm5DZW50ZXJzKSB7CgkgICAgICAgIHRoaXMuYm90dG9tTGVmdCA9IHBhdHRlcm5DZW50ZXJzWzBdOwoJICAgICAgICB0aGlzLnRvcExlZnQgPSBwYXR0ZXJuQ2VudGVyc1sxXTsKCSAgICAgICAgdGhpcy50b3BSaWdodCA9IHBhdHRlcm5DZW50ZXJzWzJdOwoJICAgIH0KCSAgICBGaW5kZXJQYXR0ZXJuSW5mby5wcm90b3R5cGUuZ2V0Qm90dG9tTGVmdCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYm90dG9tTGVmdDsKCSAgICB9OwoJICAgIEZpbmRlclBhdHRlcm5JbmZvLnByb3RvdHlwZS5nZXRUb3BMZWZ0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy50b3BMZWZ0OwoJICAgIH07CgkgICAgRmluZGVyUGF0dGVybkluZm8ucHJvdG90eXBlLmdldFRvcFJpZ2h0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy50b3BSaWdodDsKCSAgICB9OwoJICAgIHJldHVybiBGaW5kZXJQYXR0ZXJuSW5mbzsKCX0oKSk7CglGaW5kZXJQYXR0ZXJuSW5mbyQxLmRlZmF1bHQgPSBGaW5kZXJQYXR0ZXJuSW5mbzsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fdmFsdWVzID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fdmFsdWVzKSB8fCBmdW5jdGlvbihvKSB7CgkgICAgdmFyIHMgPSB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIFN5bWJvbC5pdGVyYXRvciwgbSA9IHMgJiYgb1tzXSwgaSA9IDA7CgkgICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7CgkgICAgaWYgKG8gJiYgdHlwZW9mIG8ubGVuZ3RoID09PSAibnVtYmVyIikgcmV0dXJuIHsKCSAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkgewoJICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDsKCSAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihzID8gIk9iamVjdCBpcyBub3QgaXRlcmFibGUuIiA6ICJTeW1ib2wuaXRlcmF0b3IgaXMgbm90IGRlZmluZWQuIik7Cgl9OwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEZpbmRlclBhdHRlcm5GaW5kZXIkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5xcmNvZGUuZGV0ZWN0b3IgeyovCgl2YXIgRGVjb2RlSGludFR5cGVfMSQyID0gRGVjb2RlSGludFR5cGUkMTsKCXZhciBSZXN1bHRQb2ludF8xJDEgPSBSZXN1bHRQb2ludCQxOwoJdmFyIEZpbmRlclBhdHRlcm5fMSA9IEZpbmRlclBhdHRlcm4kMTsKCXZhciBGaW5kZXJQYXR0ZXJuSW5mb18xID0gRmluZGVyUGF0dGVybkluZm8kMTsKCXZhciBOb3RGb3VuZEV4Y2VwdGlvbl8xJDIgPSBOb3RGb3VuZEV4Y2VwdGlvbiQxOwoJLyppbXBvcnQgamF2YS5pby5TZXJpYWxpemFibGU7Ki8KCS8qaW1wb3J0IGphdmEudXRpbC5BcnJheUxpc3Q7Ki8KCS8qaW1wb3J0IGphdmEudXRpbC5Db2xsZWN0aW9uczsqLwoJLyppbXBvcnQgamF2YS51dGlsLkNvbXBhcmF0b3I7Ki8KCS8qaW1wb3J0IGphdmEudXRpbC5MaXN0OyovCgkvKmltcG9ydCBqYXZhLnV0aWwuTWFwOyovCgkvKioKCSAqIDxwPlRoaXMgY2xhc3MgYXR0ZW1wdHMgdG8gZmluZCBmaW5kZXIgcGF0dGVybnMgaW4gYSBRUiBDb2RlLiBGaW5kZXIgcGF0dGVybnMgYXJlIHRoZSBzcXVhcmUKCSAqIG1hcmtlcnMgYXQgdGhyZWUgY29ybmVycyBvZiBhIFFSIENvZGUuPC9wPgoJICoKCSAqIDxwPlRoaXMgY2xhc3MgaXMgdGhyZWFkLXNhZmUgYnV0IG5vdCByZWVudHJhbnQuIEVhY2ggdGhyZWFkIG11c3QgYWxsb2NhdGUgaXRzIG93biBvYmplY3QuCgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEZpbmRlclBhdHRlcm5GaW5kZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgLyoqCgkgICAgICogPHA+Q3JlYXRlcyBhIGZpbmRlciB0aGF0IHdpbGwgc2VhcmNoIHRoZSBpbWFnZSBmb3IgdGhyZWUgZmluZGVyIHBhdHRlcm5zLjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBpbWFnZSBpbWFnZSB0byBzZWFyY2gKCSAgICAgKi8KCSAgICAvLyBwdWJsaWMgY29uc3RydWN0b3IoaW1hZ2U6IEJpdE1hdHJpeCkgewoJICAgIC8vICAgdGhpcyhpbWFnZSwgbnVsbCkKCSAgICAvLyB9CgkgICAgZnVuY3Rpb24gRmluZGVyUGF0dGVybkZpbmRlcihpbWFnZSwgcmVzdWx0UG9pbnRDYWxsYmFjaykgewoJICAgICAgICB0aGlzLmltYWdlID0gaW1hZ2U7CgkgICAgICAgIHRoaXMucmVzdWx0UG9pbnRDYWxsYmFjayA9IHJlc3VsdFBvaW50Q2FsbGJhY2s7CgkgICAgICAgIHRoaXMucG9zc2libGVDZW50ZXJzID0gW107CgkgICAgICAgIHRoaXMuY3Jvc3NDaGVja1N0YXRlQ291bnQgPSBuZXcgSW50MzJBcnJheSg1KTsKCSAgICAgICAgdGhpcy5yZXN1bHRQb2ludENhbGxiYWNrID0gcmVzdWx0UG9pbnRDYWxsYmFjazsKCSAgICB9CgkgICAgRmluZGVyUGF0dGVybkZpbmRlci5wcm90b3R5cGUuZ2V0SW1hZ2UgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmltYWdlOwoJICAgIH07CgkgICAgRmluZGVyUGF0dGVybkZpbmRlci5wcm90b3R5cGUuZ2V0UG9zc2libGVDZW50ZXJzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5wb3NzaWJsZUNlbnRlcnM7CgkgICAgfTsKCSAgICBGaW5kZXJQYXR0ZXJuRmluZGVyLnByb3RvdHlwZS5maW5kID0gZnVuY3Rpb24gKGhpbnRzKSB7CgkgICAgICAgIHZhciB0cnlIYXJkZXIgPSAoaGludHMgIT09IG51bGwgJiYgaGludHMgIT09IHVuZGVmaW5lZCkgJiYgdW5kZWZpbmVkICE9PSBoaW50cy5nZXQoRGVjb2RlSGludFR5cGVfMSQyLmRlZmF1bHQuVFJZX0hBUkRFUik7CgkgICAgICAgIHZhciBwdXJlQmFyY29kZSA9IChoaW50cyAhPT0gbnVsbCAmJiBoaW50cyAhPT0gdW5kZWZpbmVkKSAmJiB1bmRlZmluZWQgIT09IGhpbnRzLmdldChEZWNvZGVIaW50VHlwZV8xJDIuZGVmYXVsdC5QVVJFX0JBUkNPREUpOwoJICAgICAgICB2YXIgaW1hZ2UgPSB0aGlzLmltYWdlOwoJICAgICAgICB2YXIgbWF4SSA9IGltYWdlLmdldEhlaWdodCgpOwoJICAgICAgICB2YXIgbWF4SiA9IGltYWdlLmdldFdpZHRoKCk7CgkgICAgICAgIC8vIFdlIGFyZSBsb29raW5nIGZvciBibGFjay93aGl0ZS9ibGFjay93aGl0ZS9ibGFjayBtb2R1bGVzIGluCgkgICAgICAgIC8vIDE6MTozOjE6MSByYXRpbzsgdGhpcyB0cmFja3MgdGhlIG51bWJlciBvZiBzdWNoIG1vZHVsZXMgc2VlbiBzbyBmYXIKCSAgICAgICAgLy8gTGV0J3MgYXNzdW1lIHRoYXQgdGhlIG1heGltdW0gdmVyc2lvbiBRUiBDb2RlIHdlIHN1cHBvcnQgdGFrZXMgdXAgMS80IHRoZSBoZWlnaHQgb2YgdGhlCgkgICAgICAgIC8vIGltYWdlLCBhbmQgdGhlbiBhY2NvdW50IGZvciB0aGUgY2VudGVyIGJlaW5nIDMgbW9kdWxlcyBpbiBzaXplLiBUaGlzIGdpdmVzIHRoZSBzbWFsbGVzdAoJICAgICAgICAvLyBudW1iZXIgb2YgcGl4ZWxzIHRoZSBjZW50ZXIgY291bGQgYmUsIHNvIHNraXAgdGhpcyBvZnRlbi4gV2hlbiB0cnlpbmcgaGFyZGVyLCBsb29rIGZvciBhbGwKCSAgICAgICAgLy8gUVIgdmVyc2lvbnMgcmVnYXJkbGVzcyBvZiBob3cgZGVuc2UgdGhleSBhcmUuCgkgICAgICAgIHZhciBpU2tpcCA9IE1hdGguZmxvb3IoKDMgKiBtYXhJKSAvICg0ICogRmluZGVyUGF0dGVybkZpbmRlci5NQVhfTU9EVUxFUykpOwoJICAgICAgICBpZiAoaVNraXAgPCBGaW5kZXJQYXR0ZXJuRmluZGVyLk1JTl9TS0lQIHx8IHRyeUhhcmRlcikgewoJICAgICAgICAgICAgaVNraXAgPSBGaW5kZXJQYXR0ZXJuRmluZGVyLk1JTl9TS0lQOwoJICAgICAgICB9CgkgICAgICAgIHZhciBkb25lID0gZmFsc2U7CgkgICAgICAgIHZhciBzdGF0ZUNvdW50ID0gbmV3IEludDMyQXJyYXkoNSk7CgkgICAgICAgIGZvciAodmFyIGkgPSBpU2tpcCAtIDE7IGkgPCBtYXhJICYmICFkb25lOyBpICs9IGlTa2lwKSB7CgkgICAgICAgICAgICAvLyBHZXQgYSByb3cgb2YgYmxhY2svd2hpdGUgdmFsdWVzCgkgICAgICAgICAgICBzdGF0ZUNvdW50WzBdID0gMDsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbMV0gPSAwOwoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSA9IDA7CgkgICAgICAgICAgICBzdGF0ZUNvdW50WzNdID0gMDsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbNF0gPSAwOwoJICAgICAgICAgICAgdmFyIGN1cnJlbnRTdGF0ZSA9IDA7CgkgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IG1heEo7IGorKykgewoJICAgICAgICAgICAgICAgIGlmIChpbWFnZS5nZXQoaiwgaSkpIHsKCSAgICAgICAgICAgICAgICAgICAgLy8gQmxhY2sgcGl4ZWwKCSAgICAgICAgICAgICAgICAgICAgaWYgKChjdXJyZW50U3RhdGUgJiAxKSA9PT0gMSkgeyAvLyBDb3VudGluZyB3aGl0ZSBwaXhlbHMKCSAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRTdGF0ZSsrOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbY3VycmVudFN0YXRlXSsrOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBlbHNlIHsgLy8gV2hpdGUgcGl4ZWwKCSAgICAgICAgICAgICAgICAgICAgaWYgKChjdXJyZW50U3RhdGUgJiAxKSA9PT0gMCkgeyAvLyBDb3VudGluZyBibGFjayBwaXhlbHMKCSAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50U3RhdGUgPT09IDQpIHsgLy8gQSB3aW5uZXI/CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKEZpbmRlclBhdHRlcm5GaW5kZXIuZm91bmRQYXR0ZXJuQ3Jvc3Moc3RhdGVDb3VudCkpIHsgLy8gWWVzCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb25maXJtZWQgPSB0aGlzLmhhbmRsZVBvc3NpYmxlQ2VudGVyKHN0YXRlQ291bnQsIGksIGosIHB1cmVCYXJjb2RlKTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbmZpcm1lZCA9PT0gdHJ1ZSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gU3RhcnQgZXhhbWluaW5nIGV2ZXJ5IG90aGVyIGxpbmUuIENoZWNraW5nIGVhY2ggbGluZSB0dXJuZWQgb3V0IHRvIGJlIHRvbwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZXhwZW5zaXZlIGFuZCBkaWRuJ3QgaW1wcm92ZSBwZXJmb3JtYW5jZS4KCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlTa2lwID0gMjsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmhhc1NraXBwZWQgPT09IHRydWUpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb25lID0gdGhpcy5oYXZlTXVsdGlwbHlDb25maXJtZWRDZW50ZXJzKCk7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcm93U2tpcCA9IHRoaXMuZmluZFJvd1NraXAoKTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocm93U2tpcCA+IHN0YXRlQ291bnRbMl0pIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gU2tpcCByb3dzIGJldHdlZW4gcm93IG9mIGxvd2VyIGNvbmZpcm1lZCBjZW50ZXIKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYW5kIHRvcCBvZiBwcmVzdW1lZCB0aGlyZCBjb25maXJtZWQgY2VudGVyCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGJ1dCBiYWNrIHVwIGEgYml0IHRvIGdldCBhIGZ1bGwgY2hhbmNlIG9mIGRldGVjdGluZwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBpdCwgZW50aXJlIHdpZHRoIG9mIGNlbnRlciBvZiBmaW5kZXIgcGF0dGVybgoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBTa2lwIGJ5IHJvd1NraXAsIGJ1dCBiYWNrIG9mZiBieSBzdGF0ZUNvdW50WzJdIChzaXplIG9mIGxhc3QgY2VudGVyCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG9mIHBhdHRlcm4gd2Ugc2F3KSB0byBiZSBjb25zZXJ2YXRpdmUsIGFuZCBhbHNvIGJhY2sgb2ZmIGJ5IGlTa2lwIHdoaWNoCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGlzIGFib3V0IHRvIGJlIHJlLWFkZGVkCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkgKz0gcm93U2tpcCAtIHN0YXRlQ291bnRbMl0gLSBpU2tpcDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaiA9IG1heEogLSAxOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbMF0gPSBzdGF0ZUNvdW50WzJdOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudFsxXSA9IHN0YXRlQ291bnRbM107CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzJdID0gc3RhdGVDb3VudFs0XTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbM10gPSAxOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudFs0XSA9IDA7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50U3RhdGUgPSAzOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ2xlYXIgc3RhdGUgdG8gc3RhcnQgbG9va2luZyBhZ2FpbgoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50U3RhdGUgPSAwOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzBdID0gMDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudFsxXSA9IDA7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbMl0gPSAwOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzNdID0gMDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudFs0XSA9IDA7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgeyAvLyBObywgc2hpZnQgY291bnRzIGJhY2sgYnkgdHdvCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbMF0gPSBzdGF0ZUNvdW50WzJdOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzFdID0gc3RhdGVDb3VudFszXTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudFsyXSA9IHN0YXRlQ291bnRbNF07CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbM10gPSAxOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzRdID0gMDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFN0YXRlID0gMzsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WysrY3VycmVudFN0YXRlXSsrOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIGVsc2UgeyAvLyBDb3VudGluZyB3aGl0ZSBwaXhlbHMKCSAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbY3VycmVudFN0YXRlXSsrOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgaWYgKEZpbmRlclBhdHRlcm5GaW5kZXIuZm91bmRQYXR0ZXJuQ3Jvc3Moc3RhdGVDb3VudCkpIHsKCSAgICAgICAgICAgICAgICB2YXIgY29uZmlybWVkID0gdGhpcy5oYW5kbGVQb3NzaWJsZUNlbnRlcihzdGF0ZUNvdW50LCBpLCBtYXhKLCBwdXJlQmFyY29kZSk7CgkgICAgICAgICAgICAgICAgaWYgKGNvbmZpcm1lZCA9PT0gdHJ1ZSkgewoJICAgICAgICAgICAgICAgICAgICBpU2tpcCA9IHN0YXRlQ291bnRbMF07CgkgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmhhc1NraXBwZWQpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZvdW5kIGEgdGhpcmQgb25lCgkgICAgICAgICAgICAgICAgICAgICAgICBkb25lID0gdGhpcy5oYXZlTXVsdGlwbHlDb25maXJtZWRDZW50ZXJzKCk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHBhdHRlcm5JbmZvID0gdGhpcy5zZWxlY3RCZXN0UGF0dGVybnMoKTsKCSAgICAgICAgUmVzdWx0UG9pbnRfMSQxLmRlZmF1bHQub3JkZXJCZXN0UGF0dGVybnMocGF0dGVybkluZm8pOwoJICAgICAgICByZXR1cm4gbmV3IEZpbmRlclBhdHRlcm5JbmZvXzEuZGVmYXVsdChwYXR0ZXJuSW5mbyk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBHaXZlbiBhIGNvdW50IG9mIGJsYWNrL3doaXRlL2JsYWNrL3doaXRlL2JsYWNrIHBpeGVscyBqdXN0IHNlZW4gYW5kIGFuIGVuZCBwb3NpdGlvbiwKCSAgICAgKiBmaWd1cmVzIHRoZSBsb2NhdGlvbiBvZiB0aGUgY2VudGVyIG9mIHRoaXMgcnVuLgoJICAgICAqLwoJICAgIEZpbmRlclBhdHRlcm5GaW5kZXIuY2VudGVyRnJvbUVuZCA9IGZ1bmN0aW9uIChzdGF0ZUNvdW50LCBlbmQgLyppbnQqLykgewoJICAgICAgICByZXR1cm4gKGVuZCAtIHN0YXRlQ291bnRbNF0gLSBzdGF0ZUNvdW50WzNdKSAtIHN0YXRlQ291bnRbMl0gLyAyLjA7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gc3RhdGVDb3VudCBjb3VudCBvZiBibGFjay93aGl0ZS9ibGFjay93aGl0ZS9ibGFjayBwaXhlbHMganVzdCByZWFkCgkgICAgICogQHJldHVybiB0cnVlIGlmZiB0aGUgcHJvcG9ydGlvbnMgb2YgdGhlIGNvdW50cyBpcyBjbG9zZSBlbm91Z2ggdG8gdGhlIDEvMS8zLzEvMSByYXRpb3MKCSAgICAgKiAgICAgICAgIHVzZWQgYnkgZmluZGVyIHBhdHRlcm5zIHRvIGJlIGNvbnNpZGVyZWQgYSBtYXRjaAoJICAgICAqLwoJICAgIEZpbmRlclBhdHRlcm5GaW5kZXIuZm91bmRQYXR0ZXJuQ3Jvc3MgPSBmdW5jdGlvbiAoc3RhdGVDb3VudCkgewoJICAgICAgICB2YXIgdG90YWxNb2R1bGVTaXplID0gMDsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCA1OyBpKyspIHsKCSAgICAgICAgICAgIHZhciBjb3VudCA9IHN0YXRlQ291bnRbaV07CgkgICAgICAgICAgICBpZiAoY291bnQgPT09IDApIHsKCSAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB0b3RhbE1vZHVsZVNpemUgKz0gY291bnQ7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHRvdGFsTW9kdWxlU2l6ZSA8IDcpIHsKCSAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgbW9kdWxlU2l6ZSA9IHRvdGFsTW9kdWxlU2l6ZSAvIDcuMDsKCSAgICAgICAgdmFyIG1heFZhcmlhbmNlID0gbW9kdWxlU2l6ZSAvIDIuMDsKCSAgICAgICAgLy8gQWxsb3cgbGVzcyB0aGFuIDUwJSB2YXJpYW5jZSBmcm9tIDEtMS0zLTEtMSBwcm9wb3J0aW9ucwoJICAgICAgICByZXR1cm4gTWF0aC5hYnMobW9kdWxlU2l6ZSAtIHN0YXRlQ291bnRbMF0pIDwgbWF4VmFyaWFuY2UgJiYKCSAgICAgICAgICAgIE1hdGguYWJzKG1vZHVsZVNpemUgLSBzdGF0ZUNvdW50WzFdKSA8IG1heFZhcmlhbmNlICYmCgkgICAgICAgICAgICBNYXRoLmFicygzLjAgKiBtb2R1bGVTaXplIC0gc3RhdGVDb3VudFsyXSkgPCAzICogbWF4VmFyaWFuY2UgJiYKCSAgICAgICAgICAgIE1hdGguYWJzKG1vZHVsZVNpemUgLSBzdGF0ZUNvdW50WzNdKSA8IG1heFZhcmlhbmNlICYmCgkgICAgICAgICAgICBNYXRoLmFicyhtb2R1bGVTaXplIC0gc3RhdGVDb3VudFs0XSkgPCBtYXhWYXJpYW5jZTsKCSAgICB9OwoJICAgIEZpbmRlclBhdHRlcm5GaW5kZXIucHJvdG90eXBlLmdldENyb3NzQ2hlY2tTdGF0ZUNvdW50ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgY3Jvc3NDaGVja1N0YXRlQ291bnQgPSB0aGlzLmNyb3NzQ2hlY2tTdGF0ZUNvdW50OwoJICAgICAgICBjcm9zc0NoZWNrU3RhdGVDb3VudFswXSA9IDA7CgkgICAgICAgIGNyb3NzQ2hlY2tTdGF0ZUNvdW50WzFdID0gMDsKCSAgICAgICAgY3Jvc3NDaGVja1N0YXRlQ291bnRbMl0gPSAwOwoJICAgICAgICBjcm9zc0NoZWNrU3RhdGVDb3VudFszXSA9IDA7CgkgICAgICAgIGNyb3NzQ2hlY2tTdGF0ZUNvdW50WzRdID0gMDsKCSAgICAgICAgcmV0dXJuIGNyb3NzQ2hlY2tTdGF0ZUNvdW50OwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQWZ0ZXIgYSB2ZXJ0aWNhbCBhbmQgaG9yaXpvbnRhbCBzY2FuIGZpbmRzIGEgcG90ZW50aWFsIGZpbmRlciBwYXR0ZXJuLCB0aGlzIG1ldGhvZAoJICAgICAqICJjcm9zcy1jcm9zcy1jcm9zcy1jaGVja3MiIGJ5IHNjYW5uaW5nIGRvd24gZGlhZ29uYWxseSB0aHJvdWdoIHRoZSBjZW50ZXIgb2YgdGhlIHBvc3NpYmxlCgkgICAgICogZmluZGVyIHBhdHRlcm4gdG8gc2VlIGlmIHRoZSBzYW1lIHByb3BvcnRpb24gaXMgZGV0ZWN0ZWQuCgkgICAgICoKCSAgICAgKiBAcGFyYW0gc3RhcnRJIHJvdyB3aGVyZSBhIGZpbmRlciBwYXR0ZXJuIHdhcyBkZXRlY3RlZAoJICAgICAqIEBwYXJhbSBjZW50ZXJKIGNlbnRlciBvZiB0aGUgc2VjdGlvbiB0aGF0IGFwcGVhcnMgdG8gY3Jvc3MgYSBmaW5kZXIgcGF0dGVybgoJICAgICAqIEBwYXJhbSBtYXhDb3VudCBtYXhpbXVtIHJlYXNvbmFibGUgbnVtYmVyIG9mIG1vZHVsZXMgdGhhdCBzaG91bGQgYmUKCSAgICAgKiAgb2JzZXJ2ZWQgaW4gYW55IHJlYWRpbmcgc3RhdGUsIGJhc2VkIG9uIHRoZSByZXN1bHRzIG9mIHRoZSBob3Jpem9udGFsIHNjYW4KCSAgICAgKiBAcGFyYW0gb3JpZ2luYWxTdGF0ZUNvdW50VG90YWwgVGhlIG9yaWdpbmFsIHN0YXRlIGNvdW50IHRvdGFsLgoJICAgICAqIEByZXR1cm4gdHJ1ZSBpZiBwcm9wb3J0aW9ucyBhcmUgd2l0aGluZyBleHBlY3RlZCBsaW1pdHMKCSAgICAgKi8KCSAgICBGaW5kZXJQYXR0ZXJuRmluZGVyLnByb3RvdHlwZS5jcm9zc0NoZWNrRGlhZ29uYWwgPSBmdW5jdGlvbiAoc3RhcnRJIC8qaW50Ki8sIGNlbnRlckogLyppbnQqLywgbWF4Q291bnQgLyppbnQqLywgb3JpZ2luYWxTdGF0ZUNvdW50VG90YWwgLyppbnQqLykgewoJICAgICAgICB2YXIgc3RhdGVDb3VudCA9IHRoaXMuZ2V0Q3Jvc3NDaGVja1N0YXRlQ291bnQoKTsKCSAgICAgICAgLy8gU3RhcnQgY291bnRpbmcgdXAsIGxlZnQgZnJvbSBjZW50ZXIgZmluZGluZyBibGFjayBjZW50ZXIgbWFzcwoJICAgICAgICB2YXIgaSA9IDA7CgkgICAgICAgIHZhciBpbWFnZSA9IHRoaXMuaW1hZ2U7CgkgICAgICAgIHdoaWxlIChzdGFydEkgPj0gaSAmJiBjZW50ZXJKID49IGkgJiYgaW1hZ2UuZ2V0KGNlbnRlckogLSBpLCBzdGFydEkgLSBpKSkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSsrOwoJICAgICAgICAgICAgaSsrOwoJICAgICAgICB9CgkgICAgICAgIGlmIChzdGFydEkgPCBpIHx8IGNlbnRlckogPCBpKSB7CgkgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgIH0KCSAgICAgICAgLy8gQ29udGludWUgdXAsIGxlZnQgZmluZGluZyB3aGl0ZSBzcGFjZQoJICAgICAgICB3aGlsZSAoc3RhcnRJID49IGkgJiYgY2VudGVySiA+PSBpICYmICFpbWFnZS5nZXQoY2VudGVySiAtIGksIHN0YXJ0SSAtIGkpICYmCgkgICAgICAgICAgICBzdGF0ZUNvdW50WzFdIDw9IG1heENvdW50KSB7CgkgICAgICAgICAgICBzdGF0ZUNvdW50WzFdKys7CgkgICAgICAgICAgICBpKys7CgkgICAgICAgIH0KCSAgICAgICAgLy8gSWYgYWxyZWFkeSB0b28gbWFueSBtb2R1bGVzIGluIHRoaXMgc3RhdGUgb3IgcmFuIG9mZiB0aGUgZWRnZToKCSAgICAgICAgaWYgKHN0YXJ0SSA8IGkgfHwgY2VudGVySiA8IGkgfHwgc3RhdGVDb3VudFsxXSA+IG1heENvdW50KSB7CgkgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgIH0KCSAgICAgICAgLy8gQ29udGludWUgdXAsIGxlZnQgZmluZGluZyBibGFjayBib3JkZXIKCSAgICAgICAgd2hpbGUgKHN0YXJ0SSA+PSBpICYmIGNlbnRlckogPj0gaSAmJiBpbWFnZS5nZXQoY2VudGVySiAtIGksIHN0YXJ0SSAtIGkpICYmCgkgICAgICAgICAgICBzdGF0ZUNvdW50WzBdIDw9IG1heENvdW50KSB7CgkgICAgICAgICAgICBzdGF0ZUNvdW50WzBdKys7CgkgICAgICAgICAgICBpKys7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHN0YXRlQ291bnRbMF0gPiBtYXhDb3VudCkgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIHZhciBtYXhJID0gaW1hZ2UuZ2V0SGVpZ2h0KCk7CgkgICAgICAgIHZhciBtYXhKID0gaW1hZ2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgLy8gTm93IGFsc28gY291bnQgZG93biwgcmlnaHQgZnJvbSBjZW50ZXIKCSAgICAgICAgaSA9IDE7CgkgICAgICAgIHdoaWxlIChzdGFydEkgKyBpIDwgbWF4SSAmJiBjZW50ZXJKICsgaSA8IG1heEogJiYgaW1hZ2UuZ2V0KGNlbnRlckogKyBpLCBzdGFydEkgKyBpKSkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSsrOwoJICAgICAgICAgICAgaSsrOwoJICAgICAgICB9CgkgICAgICAgIC8vIFJhbiBvZmYgdGhlIGVkZ2U/CgkgICAgICAgIGlmIChzdGFydEkgKyBpID49IG1heEkgfHwgY2VudGVySiArIGkgPj0gbWF4SikgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIHdoaWxlIChzdGFydEkgKyBpIDwgbWF4SSAmJiBjZW50ZXJKICsgaSA8IG1heEogJiYgIWltYWdlLmdldChjZW50ZXJKICsgaSwgc3RhcnRJICsgaSkgJiYKCSAgICAgICAgICAgIHN0YXRlQ291bnRbM10gPCBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFszXSsrOwoJICAgICAgICAgICAgaSsrOwoJICAgICAgICB9CgkgICAgICAgIGlmIChzdGFydEkgKyBpID49IG1heEkgfHwgY2VudGVySiArIGkgPj0gbWF4SiB8fCBzdGF0ZUNvdW50WzNdID49IG1heENvdW50KSB7CgkgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgIH0KCSAgICAgICAgd2hpbGUgKHN0YXJ0SSArIGkgPCBtYXhJICYmIGNlbnRlckogKyBpIDwgbWF4SiAmJiBpbWFnZS5nZXQoY2VudGVySiArIGksIHN0YXJ0SSArIGkpICYmCgkgICAgICAgICAgICBzdGF0ZUNvdW50WzRdIDwgbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbNF0rKzsKCSAgICAgICAgICAgIGkrKzsKCSAgICAgICAgfQoJICAgICAgICBpZiAoc3RhdGVDb3VudFs0XSA+PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIC8vIElmIHdlIGZvdW5kIGEgZmluZGVyLXBhdHRlcm4tbGlrZSBzZWN0aW9uLCBidXQgaXRzIHNpemUgaXMgbW9yZSB0aGFuIDEwMCUgZGlmZmVyZW50IHRoYW4KCSAgICAgICAgLy8gdGhlIG9yaWdpbmFsLCBhc3N1bWUgaXQncyBhIGZhbHNlIHBvc2l0aXZlCgkgICAgICAgIHZhciBzdGF0ZUNvdW50VG90YWwgPSBzdGF0ZUNvdW50WzBdICsgc3RhdGVDb3VudFsxXSArIHN0YXRlQ291bnRbMl0gKyBzdGF0ZUNvdW50WzNdICsgc3RhdGVDb3VudFs0XTsKCSAgICAgICAgcmV0dXJuIE1hdGguYWJzKHN0YXRlQ291bnRUb3RhbCAtIG9yaWdpbmFsU3RhdGVDb3VudFRvdGFsKSA8IDIgKiBvcmlnaW5hbFN0YXRlQ291bnRUb3RhbCAmJgoJICAgICAgICAgICAgRmluZGVyUGF0dGVybkZpbmRlci5mb3VuZFBhdHRlcm5Dcm9zcyhzdGF0ZUNvdW50KTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPkFmdGVyIGEgaG9yaXpvbnRhbCBzY2FuIGZpbmRzIGEgcG90ZW50aWFsIGZpbmRlciBwYXR0ZXJuLCB0aGlzIG1ldGhvZAoJICAgICAqICJjcm9zcy1jaGVja3MiIGJ5IHNjYW5uaW5nIGRvd24gdmVydGljYWxseSB0aHJvdWdoIHRoZSBjZW50ZXIgb2YgdGhlIHBvc3NpYmxlCgkgICAgICogZmluZGVyIHBhdHRlcm4gdG8gc2VlIGlmIHRoZSBzYW1lIHByb3BvcnRpb24gaXMgZGV0ZWN0ZWQuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIHN0YXJ0SSByb3cgd2hlcmUgYSBmaW5kZXIgcGF0dGVybiB3YXMgZGV0ZWN0ZWQKCSAgICAgKiBAcGFyYW0gY2VudGVySiBjZW50ZXIgb2YgdGhlIHNlY3Rpb24gdGhhdCBhcHBlYXJzIHRvIGNyb3NzIGEgZmluZGVyIHBhdHRlcm4KCSAgICAgKiBAcGFyYW0gbWF4Q291bnQgbWF4aW11bSByZWFzb25hYmxlIG51bWJlciBvZiBtb2R1bGVzIHRoYXQgc2hvdWxkIGJlCgkgICAgICogb2JzZXJ2ZWQgaW4gYW55IHJlYWRpbmcgc3RhdGUsIGJhc2VkIG9uIHRoZSByZXN1bHRzIG9mIHRoZSBob3Jpem9udGFsIHNjYW4KCSAgICAgKiBAcmV0dXJuIHZlcnRpY2FsIGNlbnRlciBvZiBmaW5kZXIgcGF0dGVybiwgb3Ige0BsaW5rIEZsb2F0I05hTn0gaWYgbm90IGZvdW5kCgkgICAgICovCgkgICAgRmluZGVyUGF0dGVybkZpbmRlci5wcm90b3R5cGUuY3Jvc3NDaGVja1ZlcnRpY2FsID0gZnVuY3Rpb24gKHN0YXJ0SSAvKmludCovLCBjZW50ZXJKIC8qaW50Ki8sIG1heENvdW50IC8qaW50Ki8sIG9yaWdpbmFsU3RhdGVDb3VudFRvdGFsIC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIGltYWdlID0gdGhpcy5pbWFnZTsKCSAgICAgICAgdmFyIG1heEkgPSBpbWFnZS5nZXRIZWlnaHQoKTsKCSAgICAgICAgdmFyIHN0YXRlQ291bnQgPSB0aGlzLmdldENyb3NzQ2hlY2tTdGF0ZUNvdW50KCk7CgkgICAgICAgIC8vIFN0YXJ0IGNvdW50aW5nIHVwIGZyb20gY2VudGVyCgkgICAgICAgIHZhciBpID0gc3RhcnRJOwoJICAgICAgICB3aGlsZSAoaSA+PSAwICYmIGltYWdlLmdldChjZW50ZXJKLCBpKSkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSsrOwoJICAgICAgICAgICAgaS0tOwoJICAgICAgICB9CgkgICAgICAgIGlmIChpIDwgMCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICB3aGlsZSAoaSA+PSAwICYmICFpbWFnZS5nZXQoY2VudGVySiwgaSkgJiYgc3RhdGVDb3VudFsxXSA8PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsxXSsrOwoJICAgICAgICAgICAgaS0tOwoJICAgICAgICB9CgkgICAgICAgIC8vIElmIGFscmVhZHkgdG9vIG1hbnkgbW9kdWxlcyBpbiB0aGlzIHN0YXRlIG9yIHJhbiBvZmYgdGhlIGVkZ2U6CgkgICAgICAgIGlmIChpIDwgMCB8fCBzdGF0ZUNvdW50WzFdID4gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgd2hpbGUgKGkgPj0gMCAmJiBpbWFnZS5nZXQoY2VudGVySiwgaSkgJiYgc3RhdGVDb3VudFswXSA8PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFswXSsrOwoJICAgICAgICAgICAgaS0tOwoJICAgICAgICB9CgkgICAgICAgIGlmIChzdGF0ZUNvdW50WzBdID4gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgLy8gTm93IGFsc28gY291bnQgZG93biBmcm9tIGNlbnRlcgoJICAgICAgICBpID0gc3RhcnRJICsgMTsKCSAgICAgICAgd2hpbGUgKGkgPCBtYXhJICYmIGltYWdlLmdldChjZW50ZXJKLCBpKSkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSsrOwoJICAgICAgICAgICAgaSsrOwoJICAgICAgICB9CgkgICAgICAgIGlmIChpID09PSBtYXhJKSB7CgkgICAgICAgICAgICByZXR1cm4gTmFOOwoJICAgICAgICB9CgkgICAgICAgIHdoaWxlIChpIDwgbWF4SSAmJiAhaW1hZ2UuZ2V0KGNlbnRlckosIGkpICYmIHN0YXRlQ291bnRbM10gPCBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFszXSsrOwoJICAgICAgICAgICAgaSsrOwoJICAgICAgICB9CgkgICAgICAgIGlmIChpID09PSBtYXhJIHx8IHN0YXRlQ291bnRbM10gPj0gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgd2hpbGUgKGkgPCBtYXhJICYmIGltYWdlLmdldChjZW50ZXJKLCBpKSAmJiBzdGF0ZUNvdW50WzRdIDwgbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbNF0rKzsKCSAgICAgICAgICAgIGkrKzsKCSAgICAgICAgfQoJICAgICAgICBpZiAoc3RhdGVDb3VudFs0XSA+PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICAvLyBJZiB3ZSBmb3VuZCBhIGZpbmRlci1wYXR0ZXJuLWxpa2Ugc2VjdGlvbiwgYnV0IGl0cyBzaXplIGlzIG1vcmUgdGhhbiA0MCUgZGlmZmVyZW50IHRoYW4KCSAgICAgICAgLy8gdGhlIG9yaWdpbmFsLCBhc3N1bWUgaXQncyBhIGZhbHNlIHBvc2l0aXZlCgkgICAgICAgIHZhciBzdGF0ZUNvdW50VG90YWwgPSBzdGF0ZUNvdW50WzBdICsgc3RhdGVDb3VudFsxXSArIHN0YXRlQ291bnRbMl0gKyBzdGF0ZUNvdW50WzNdICsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbNF07CgkgICAgICAgIGlmICg1ICogTWF0aC5hYnMoc3RhdGVDb3VudFRvdGFsIC0gb3JpZ2luYWxTdGF0ZUNvdW50VG90YWwpID49IDIgKiBvcmlnaW5hbFN0YXRlQ291bnRUb3RhbCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gRmluZGVyUGF0dGVybkZpbmRlci5mb3VuZFBhdHRlcm5Dcm9zcyhzdGF0ZUNvdW50KSA/IEZpbmRlclBhdHRlcm5GaW5kZXIuY2VudGVyRnJvbUVuZChzdGF0ZUNvdW50LCBpKSA6IE5hTjsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPkxpa2Uge0BsaW5rICNjcm9zc0NoZWNrVmVydGljYWwoaW50LCBpbnQsIGludCwgaW50KX0sIGFuZCBpbiBmYWN0IGlzIGJhc2ljYWxseSBpZGVudGljYWwsCgkgICAgICogZXhjZXB0IGl0IHJlYWRzIGhvcml6b250YWxseSBpbnN0ZWFkIG9mIHZlcnRpY2FsbHkuIFRoaXMgaXMgdXNlZCB0byBjcm9zcy1jcm9zcwoJICAgICAqIGNoZWNrIGEgdmVydGljYWwgY3Jvc3MgY2hlY2sgYW5kIGxvY2F0ZSB0aGUgcmVhbCBjZW50ZXIgb2YgdGhlIGFsaWdubWVudCBwYXR0ZXJuLjwvcD4KCSAgICAgKi8KCSAgICBGaW5kZXJQYXR0ZXJuRmluZGVyLnByb3RvdHlwZS5jcm9zc0NoZWNrSG9yaXpvbnRhbCA9IGZ1bmN0aW9uIChzdGFydEogLyppbnQqLywgY2VudGVySSAvKmludCovLCBtYXhDb3VudCAvKmludCovLCBvcmlnaW5hbFN0YXRlQ291bnRUb3RhbCAvKmludCovKSB7CgkgICAgICAgIHZhciBpbWFnZSA9IHRoaXMuaW1hZ2U7CgkgICAgICAgIHZhciBtYXhKID0gaW1hZ2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgdmFyIHN0YXRlQ291bnQgPSB0aGlzLmdldENyb3NzQ2hlY2tTdGF0ZUNvdW50KCk7CgkgICAgICAgIHZhciBqID0gc3RhcnRKOwoJICAgICAgICB3aGlsZSAoaiA+PSAwICYmIGltYWdlLmdldChqLCBjZW50ZXJJKSkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSsrOwoJICAgICAgICAgICAgai0tOwoJICAgICAgICB9CgkgICAgICAgIGlmIChqIDwgMCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICB3aGlsZSAoaiA+PSAwICYmICFpbWFnZS5nZXQoaiwgY2VudGVySSkgJiYgc3RhdGVDb3VudFsxXSA8PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsxXSsrOwoJICAgICAgICAgICAgai0tOwoJICAgICAgICB9CgkgICAgICAgIGlmIChqIDwgMCB8fCBzdGF0ZUNvdW50WzFdID4gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgd2hpbGUgKGogPj0gMCAmJiBpbWFnZS5nZXQoaiwgY2VudGVySSkgJiYgc3RhdGVDb3VudFswXSA8PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFswXSsrOwoJICAgICAgICAgICAgai0tOwoJICAgICAgICB9CgkgICAgICAgIGlmIChzdGF0ZUNvdW50WzBdID4gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgaiA9IHN0YXJ0SiArIDE7CgkgICAgICAgIHdoaWxlIChqIDwgbWF4SiAmJiBpbWFnZS5nZXQoaiwgY2VudGVySSkpIHsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbMl0rKzsKCSAgICAgICAgICAgIGorKzsKCSAgICAgICAgfQoJICAgICAgICBpZiAoaiA9PT0gbWF4SikgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICB3aGlsZSAoaiA8IG1heEogJiYgIWltYWdlLmdldChqLCBjZW50ZXJJKSAmJiBzdGF0ZUNvdW50WzNdIDwgbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbM10rKzsKCSAgICAgICAgICAgIGorKzsKCSAgICAgICAgfQoJICAgICAgICBpZiAoaiA9PT0gbWF4SiB8fCBzdGF0ZUNvdW50WzNdID49IG1heENvdW50KSB7CgkgICAgICAgICAgICByZXR1cm4gTmFOOwoJICAgICAgICB9CgkgICAgICAgIHdoaWxlIChqIDwgbWF4SiAmJiBpbWFnZS5nZXQoaiwgY2VudGVySSkgJiYgc3RhdGVDb3VudFs0XSA8IG1heENvdW50KSB7CgkgICAgICAgICAgICBzdGF0ZUNvdW50WzRdKys7CgkgICAgICAgICAgICBqKys7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHN0YXRlQ291bnRbNF0gPj0gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgLy8gSWYgd2UgZm91bmQgYSBmaW5kZXItcGF0dGVybi1saWtlIHNlY3Rpb24sIGJ1dCBpdHMgc2l6ZSBpcyBzaWduaWZpY2FudGx5IGRpZmZlcmVudCB0aGFuCgkgICAgICAgIC8vIHRoZSBvcmlnaW5hbCwgYXNzdW1lIGl0J3MgYSBmYWxzZSBwb3NpdGl2ZQoJICAgICAgICB2YXIgc3RhdGVDb3VudFRvdGFsID0gc3RhdGVDb3VudFswXSArIHN0YXRlQ291bnRbMV0gKyBzdGF0ZUNvdW50WzJdICsgc3RhdGVDb3VudFszXSArCgkgICAgICAgICAgICBzdGF0ZUNvdW50WzRdOwoJICAgICAgICBpZiAoNSAqIE1hdGguYWJzKHN0YXRlQ291bnRUb3RhbCAtIG9yaWdpbmFsU3RhdGVDb3VudFRvdGFsKSA+PSBvcmlnaW5hbFN0YXRlQ291bnRUb3RhbCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gRmluZGVyUGF0dGVybkZpbmRlci5mb3VuZFBhdHRlcm5Dcm9zcyhzdGF0ZUNvdW50KSA/IEZpbmRlclBhdHRlcm5GaW5kZXIuY2VudGVyRnJvbUVuZChzdGF0ZUNvdW50LCBqKSA6IE5hTjsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPlRoaXMgaXMgY2FsbGVkIHdoZW4gYSBob3Jpem9udGFsIHNjYW4gZmluZHMgYSBwb3NzaWJsZSBhbGlnbm1lbnQgcGF0dGVybi4gSXQgd2lsbAoJICAgICAqIGNyb3NzIGNoZWNrIHdpdGggYSB2ZXJ0aWNhbCBzY2FuLCBhbmQgaWYgc3VjY2Vzc2Z1bCwgd2lsbCwgYWgsIGNyb3NzLWNyb3NzLWNoZWNrCgkgICAgICogd2l0aCBhbm90aGVyIGhvcml6b250YWwgc2Nhbi4gVGhpcyBpcyBuZWVkZWQgcHJpbWFyaWx5IHRvIGxvY2F0ZSB0aGUgcmVhbCBob3Jpem9udGFsCgkgICAgICogY2VudGVyIG9mIHRoZSBwYXR0ZXJuIGluIGNhc2VzIG9mIGV4dHJlbWUgc2tldy4KCSAgICAgKiBBbmQgdGhlbiB3ZSBjcm9zcy1jcm9zcy1jcm9zcyBjaGVjayB3aXRoIGFub3RoZXIgZGlhZ29uYWwgc2Nhbi48L3A+CgkgICAgICoKCSAgICAgKiA8cD5JZiB0aGF0IHN1Y2NlZWRzIHRoZSBmaW5kZXIgcGF0dGVybiBsb2NhdGlvbiBpcyBhZGRlZCB0byBhIGxpc3QgdGhhdCB0cmFja3MKCSAgICAgKiB0aGUgbnVtYmVyIG9mIHRpbWVzIGVhY2ggbG9jYXRpb24gaGFzIGJlZW4gbmVhcmx5LW1hdGNoZWQgYXMgYSBmaW5kZXIgcGF0dGVybi4KCSAgICAgKiBFYWNoIGFkZGl0aW9uYWwgZmluZCBpcyBtb3JlIGV2aWRlbmNlIHRoYXQgdGhlIGxvY2F0aW9uIGlzIGluIGZhY3QgYSBmaW5kZXIKCSAgICAgKiBwYXR0ZXJuIGNlbnRlcgoJICAgICAqCgkgICAgICogQHBhcmFtIHN0YXRlQ291bnQgcmVhZGluZyBzdGF0ZSBtb2R1bGUgY291bnRzIGZyb20gaG9yaXpvbnRhbCBzY2FuCgkgICAgICogQHBhcmFtIGkgcm93IHdoZXJlIGZpbmRlciBwYXR0ZXJuIG1heSBiZSBmb3VuZAoJICAgICAqIEBwYXJhbSBqIGVuZCBvZiBwb3NzaWJsZSBmaW5kZXIgcGF0dGVybiBpbiByb3cKCSAgICAgKiBAcGFyYW0gcHVyZUJhcmNvZGUgdHJ1ZSBpZiBpbiAicHVyZSBiYXJjb2RlIiBtb2RlCgkgICAgICogQHJldHVybiB0cnVlIGlmIGEgZmluZGVyIHBhdHRlcm4gY2FuZGlkYXRlIHdhcyBmb3VuZCB0aGlzIHRpbWUKCSAgICAgKi8KCSAgICBGaW5kZXJQYXR0ZXJuRmluZGVyLnByb3RvdHlwZS5oYW5kbGVQb3NzaWJsZUNlbnRlciA9IGZ1bmN0aW9uIChzdGF0ZUNvdW50LCBpIC8qaW50Ki8sIGogLyppbnQqLywgcHVyZUJhcmNvZGUpIHsKCSAgICAgICAgdmFyIHN0YXRlQ291bnRUb3RhbCA9IHN0YXRlQ291bnRbMF0gKyBzdGF0ZUNvdW50WzFdICsgc3RhdGVDb3VudFsyXSArIHN0YXRlQ291bnRbM10gKwoJICAgICAgICAgICAgc3RhdGVDb3VudFs0XTsKCSAgICAgICAgdmFyIGNlbnRlckogPSBGaW5kZXJQYXR0ZXJuRmluZGVyLmNlbnRlckZyb21FbmQoc3RhdGVDb3VudCwgaik7CgkgICAgICAgIHZhciBjZW50ZXJJID0gdGhpcy5jcm9zc0NoZWNrVmVydGljYWwoaSwgLyooaW50KSAqLyBNYXRoLmZsb29yKGNlbnRlckopLCBzdGF0ZUNvdW50WzJdLCBzdGF0ZUNvdW50VG90YWwpOwoJICAgICAgICBpZiAoIWlzTmFOKGNlbnRlckkpKSB7CgkgICAgICAgICAgICAvLyBSZS1jcm9zcyBjaGVjawoJICAgICAgICAgICAgY2VudGVySiA9IHRoaXMuY3Jvc3NDaGVja0hvcml6b250YWwoLyooaW50KSAqLyBNYXRoLmZsb29yKGNlbnRlckopLCAvKihpbnQpICovIE1hdGguZmxvb3IoY2VudGVySSksIHN0YXRlQ291bnRbMl0sIHN0YXRlQ291bnRUb3RhbCk7CgkgICAgICAgICAgICBpZiAoIWlzTmFOKGNlbnRlckopICYmCgkgICAgICAgICAgICAgICAgKCFwdXJlQmFyY29kZSB8fCB0aGlzLmNyb3NzQ2hlY2tEaWFnb25hbCgvKihpbnQpICovIE1hdGguZmxvb3IoY2VudGVySSksIC8qKGludCkgKi8gTWF0aC5mbG9vcihjZW50ZXJKKSwgc3RhdGVDb3VudFsyXSwgc3RhdGVDb3VudFRvdGFsKSkpIHsKCSAgICAgICAgICAgICAgICB2YXIgZXN0aW1hdGVkTW9kdWxlU2l6ZSA9IHN0YXRlQ291bnRUb3RhbCAvIDcuMDsKCSAgICAgICAgICAgICAgICB2YXIgZm91bmQgPSBmYWxzZTsKCSAgICAgICAgICAgICAgICB2YXIgcG9zc2libGVDZW50ZXJzID0gdGhpcy5wb3NzaWJsZUNlbnRlcnM7CgkgICAgICAgICAgICAgICAgZm9yICh2YXIgaW5kZXggPSAwLCBsZW5ndGhfMSA9IHBvc3NpYmxlQ2VudGVycy5sZW5ndGg7IGluZGV4IDwgbGVuZ3RoXzE7IGluZGV4KyspIHsKCSAgICAgICAgICAgICAgICAgICAgdmFyIGNlbnRlciA9IHBvc3NpYmxlQ2VudGVyc1tpbmRleF07CgkgICAgICAgICAgICAgICAgICAgIC8vIExvb2sgZm9yIGFib3V0IHRoZSBzYW1lIGNlbnRlciBhbmQgbW9kdWxlIHNpemU6CgkgICAgICAgICAgICAgICAgICAgIGlmIChjZW50ZXIuYWJvdXRFcXVhbHMoZXN0aW1hdGVkTW9kdWxlU2l6ZSwgY2VudGVySSwgY2VudGVySikpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHBvc3NpYmxlQ2VudGVyc1tpbmRleF0gPSBjZW50ZXIuY29tYmluZUVzdGltYXRlKGNlbnRlckksIGNlbnRlckosIGVzdGltYXRlZE1vZHVsZVNpemUpOwoJICAgICAgICAgICAgICAgICAgICAgICAgZm91bmQgPSB0cnVlOwoJICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgaWYgKCFmb3VuZCkgewoJICAgICAgICAgICAgICAgICAgICB2YXIgcG9pbnQgPSBuZXcgRmluZGVyUGF0dGVybl8xLmRlZmF1bHQoY2VudGVySiwgY2VudGVySSwgZXN0aW1hdGVkTW9kdWxlU2l6ZSk7CgkgICAgICAgICAgICAgICAgICAgIHBvc3NpYmxlQ2VudGVycy5wdXNoKHBvaW50KTsKCSAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMucmVzdWx0UG9pbnRDYWxsYmFjayAhPT0gbnVsbCAmJiB0aGlzLnJlc3VsdFBvaW50Q2FsbGJhY2sgIT09IHVuZGVmaW5lZCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXN1bHRQb2ludENhbGxiYWNrLmZvdW5kUG9zc2libGVSZXN1bHRQb2ludChwb2ludCk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBudW1iZXIgb2Ygcm93cyB3ZSBjb3VsZCBzYWZlbHkgc2tpcCBkdXJpbmcgc2Nhbm5pbmcsIGJhc2VkIG9uIHRoZSBmaXJzdAoJICAgICAqICAgICAgICAgdHdvIGZpbmRlciBwYXR0ZXJucyB0aGF0IGhhdmUgYmVlbiBsb2NhdGVkLiBJbiBzb21lIGNhc2VzIHRoZWlyIHBvc2l0aW9uIHdpbGwKCSAgICAgKiAgICAgICAgIGFsbG93IHVzIHRvIGluZmVyIHRoYXQgdGhlIHRoaXJkIHBhdHRlcm4gbXVzdCBsaWUgYmVsb3cgYSBjZXJ0YWluIHBvaW50IGZhcnRoZXIKCSAgICAgKiAgICAgICAgIGRvd24gaW4gdGhlIGltYWdlLgoJICAgICAqLwoJICAgIEZpbmRlclBhdHRlcm5GaW5kZXIucHJvdG90eXBlLmZpbmRSb3dTa2lwID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgZV8xLCBfYTsKCSAgICAgICAgdmFyIG1heCA9IHRoaXMucG9zc2libGVDZW50ZXJzLmxlbmd0aDsKCSAgICAgICAgaWYgKG1heCA8PSAxKSB7CgkgICAgICAgICAgICByZXR1cm4gMDsKCSAgICAgICAgfQoJICAgICAgICB2YXIgZmlyc3RDb25maXJtZWRDZW50ZXIgPSBudWxsOwoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgZm9yICh2YXIgX2IgPSBfX3ZhbHVlcyh0aGlzLnBvc3NpYmxlQ2VudGVycyksIF9jID0gX2IubmV4dCgpOyAhX2MuZG9uZTsgX2MgPSBfYi5uZXh0KCkpIHsKCSAgICAgICAgICAgICAgICB2YXIgY2VudGVyID0gX2MudmFsdWU7CgkgICAgICAgICAgICAgICAgaWYgKGNlbnRlci5nZXRDb3VudCgpID49IEZpbmRlclBhdHRlcm5GaW5kZXIuQ0VOVEVSX1FVT1JVTSkgewoJICAgICAgICAgICAgICAgICAgICBpZiAoZmlyc3RDb25maXJtZWRDZW50ZXIgPT0gbnVsbCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgZmlyc3RDb25maXJtZWRDZW50ZXIgPSBjZW50ZXI7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBXZSBoYXZlIHR3byBjb25maXJtZWQgY2VudGVycwoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gSG93IGZhciBkb3duIGNhbiB3ZSBza2lwIGJlZm9yZSByZXN1bWluZyBsb29raW5nIGZvciB0aGUgbmV4dAoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gcGF0dGVybj8gSW4gdGhlIHdvcnN0IGNhc2UsIG9ubHkgdGhlIGRpZmZlcmVuY2UgYmV0d2VlbiB0aGUKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIGRpZmZlcmVuY2UgaW4gdGhlIHggLyB5IGNvb3JkaW5hdGVzIG9mIHRoZSB0d28gY2VudGVycy4KCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoaXMgaXMgdGhlIGNhc2Ugd2hlcmUgeW91IGZpbmQgdG9wIGxlZnQgbGFzdC4KCSAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaGFzU2tpcHBlZCA9IHRydWU7CgkgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gLyooaW50KSAqLyBNYXRoLmZsb29yKChNYXRoLmFicyhmaXJzdENvbmZpcm1lZENlbnRlci5nZXRYKCkgLSBjZW50ZXIuZ2V0WCgpKSAtCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgTWF0aC5hYnMoZmlyc3RDb25maXJtZWRDZW50ZXIuZ2V0WSgpIC0gY2VudGVyLmdldFkoKSkpIC8gMik7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGVfMV8xKSB7IGVfMSA9IHsgZXJyb3I6IGVfMV8xIH07IH0KCSAgICAgICAgZmluYWxseSB7CgkgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgIGlmIChfYyAmJiAhX2MuZG9uZSAmJiAoX2EgPSBfYi5yZXR1cm4pKSBfYS5jYWxsKF9iKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGZpbmFsbHkgeyBpZiAoZV8xKSB0aHJvdyBlXzEuZXJyb3I7IH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gMDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gdHJ1ZSBpZmYgd2UgaGF2ZSBmb3VuZCBhdCBsZWFzdCAzIGZpbmRlciBwYXR0ZXJucyB0aGF0IGhhdmUgYmVlbiBkZXRlY3RlZAoJICAgICAqICAgICAgICAgYXQgbGVhc3Qge0BsaW5rICNDRU5URVJfUVVPUlVNfSB0aW1lcyBlYWNoLCBhbmQsIHRoZSBlc3RpbWF0ZWQgbW9kdWxlIHNpemUgb2YgdGhlCgkgICAgICogICAgICAgICBjYW5kaWRhdGVzIGlzICJwcmV0dHkgc2ltaWxhciIKCSAgICAgKi8KCSAgICBGaW5kZXJQYXR0ZXJuRmluZGVyLnByb3RvdHlwZS5oYXZlTXVsdGlwbHlDb25maXJtZWRDZW50ZXJzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgZV8yLCBfYSwgZV8zLCBfYjsKCSAgICAgICAgdmFyIGNvbmZpcm1lZENvdW50ID0gMDsKCSAgICAgICAgdmFyIHRvdGFsTW9kdWxlU2l6ZSA9IDAuMDsKCSAgICAgICAgdmFyIG1heCA9IHRoaXMucG9zc2libGVDZW50ZXJzLmxlbmd0aDsKCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIGZvciAodmFyIF9jID0gX192YWx1ZXModGhpcy5wb3NzaWJsZUNlbnRlcnMpLCBfZCA9IF9jLm5leHQoKTsgIV9kLmRvbmU7IF9kID0gX2MubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgdmFyIHBhdHRlcm4gPSBfZC52YWx1ZTsKCSAgICAgICAgICAgICAgICBpZiAocGF0dGVybi5nZXRDb3VudCgpID49IEZpbmRlclBhdHRlcm5GaW5kZXIuQ0VOVEVSX1FVT1JVTSkgewoJICAgICAgICAgICAgICAgICAgICBjb25maXJtZWRDb3VudCsrOwoJICAgICAgICAgICAgICAgICAgICB0b3RhbE1vZHVsZVNpemUgKz0gcGF0dGVybi5nZXRFc3RpbWF0ZWRNb2R1bGVTaXplKCk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChlXzJfMSkgeyBlXzIgPSB7IGVycm9yOiBlXzJfMSB9OyB9CgkgICAgICAgIGZpbmFsbHkgewoJICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICBpZiAoX2QgJiYgIV9kLmRvbmUgJiYgKF9hID0gX2MucmV0dXJuKSkgX2EuY2FsbChfYyk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMikgdGhyb3cgZV8yLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGNvbmZpcm1lZENvdW50IDwgMykgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIC8vIE9LLCB3ZSBoYXZlIGF0IGxlYXN0IDMgY29uZmlybWVkIGNlbnRlcnMsIGJ1dCwgaXQncyBwb3NzaWJsZSB0aGF0IG9uZSBpcyBhICJmYWxzZSBwb3NpdGl2ZSIKCSAgICAgICAgLy8gYW5kIHRoYXQgd2UgbmVlZCB0byBrZWVwIGxvb2tpbmcuIFdlIGRldGVjdCB0aGlzIGJ5IGFza2luZyBpZiB0aGUgZXN0aW1hdGVkIG1vZHVsZSBzaXplcwoJICAgICAgICAvLyB2YXJ5IHRvbyBtdWNoLiBXZSBhcmJpdHJhcmlseSBzYXkgdGhhdCB3aGVuIHRoZSB0b3RhbCBkZXZpYXRpb24gZnJvbSBhdmVyYWdlIGV4Y2VlZHMKCSAgICAgICAgLy8gNSUgb2YgdGhlIHRvdGFsIG1vZHVsZSBzaXplIGVzdGltYXRlcywgaXQncyB0b28gbXVjaC4KCSAgICAgICAgdmFyIGF2ZXJhZ2UgPSB0b3RhbE1vZHVsZVNpemUgLyBtYXg7CgkgICAgICAgIHZhciB0b3RhbERldmlhdGlvbiA9IDAuMDsKCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIGZvciAodmFyIF9lID0gX192YWx1ZXModGhpcy5wb3NzaWJsZUNlbnRlcnMpLCBfZiA9IF9lLm5leHQoKTsgIV9mLmRvbmU7IF9mID0gX2UubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgdmFyIHBhdHRlcm4gPSBfZi52YWx1ZTsKCSAgICAgICAgICAgICAgICB0b3RhbERldmlhdGlvbiArPSBNYXRoLmFicyhwYXR0ZXJuLmdldEVzdGltYXRlZE1vZHVsZVNpemUoKSAtIGF2ZXJhZ2UpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChlXzNfMSkgeyBlXzMgPSB7IGVycm9yOiBlXzNfMSB9OyB9CgkgICAgICAgIGZpbmFsbHkgewoJICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICBpZiAoX2YgJiYgIV9mLmRvbmUgJiYgKF9iID0gX2UucmV0dXJuKSkgX2IuY2FsbChfZSk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMykgdGhyb3cgZV8zLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRvdGFsRGV2aWF0aW9uIDw9IDAuMDUgKiB0b3RhbE1vZHVsZVNpemU7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIHRoZSAzIGJlc3Qge0BsaW5rIEZpbmRlclBhdHRlcm59cyBmcm9tIG91ciBsaXN0IG9mIGNhbmRpZGF0ZXMuIFRoZSAiYmVzdCIgYXJlCgkgICAgICogICAgICAgICB0aG9zZSB0aGF0IGhhdmUgYmVlbiBkZXRlY3RlZCBhdCBsZWFzdCB7QGxpbmsgI0NFTlRFUl9RVU9SVU19IHRpbWVzLCBhbmQgd2hvc2UgbW9kdWxlCgkgICAgICogICAgICAgICBzaXplIGRpZmZlcnMgZnJvbSB0aGUgYXZlcmFnZSBhbW9uZyB0aG9zZSBwYXR0ZXJucyB0aGUgbGVhc3QKCSAgICAgKiBAdGhyb3dzIE5vdEZvdW5kRXhjZXB0aW9uIGlmIDMgc3VjaCBmaW5kZXIgcGF0dGVybnMgZG8gbm90IGV4aXN0CgkgICAgICovCgkgICAgRmluZGVyUGF0dGVybkZpbmRlci5wcm90b3R5cGUuc2VsZWN0QmVzdFBhdHRlcm5zID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgZV80LCBfYSwgZV81LCBfYjsKCSAgICAgICAgdmFyIHN0YXJ0U2l6ZSA9IHRoaXMucG9zc2libGVDZW50ZXJzLmxlbmd0aDsKCSAgICAgICAgaWYgKHN0YXJ0U2l6ZSA8IDMpIHsKCSAgICAgICAgICAgIC8vIENvdWxkbid0IGZpbmQgZW5vdWdoIGZpbmRlciBwYXR0ZXJucwoJICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uXzEkMi5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHBvc3NpYmxlQ2VudGVycyA9IHRoaXMucG9zc2libGVDZW50ZXJzOwoJICAgICAgICB2YXIgYXZlcmFnZTsKCSAgICAgICAgLy8gRmlsdGVyIG91dGxpZXIgcG9zc2liaWxpdGllcyB3aG9zZSBtb2R1bGUgc2l6ZSBpcyB0b28gZGlmZmVyZW50CgkgICAgICAgIGlmIChzdGFydFNpemUgPiAzKSB7CgkgICAgICAgICAgICAvLyBCdXQgd2UgY2FuIG9ubHkgYWZmb3JkIHRvIGRvIHNvIGlmIHdlIGhhdmUgYXQgbGVhc3QgNCBwb3NzaWJpbGl0aWVzIHRvIGNob29zZSBmcm9tCgkgICAgICAgICAgICB2YXIgdG90YWxNb2R1bGVTaXplID0gMC4wOwoJICAgICAgICAgICAgdmFyIHNxdWFyZSA9IDAuMDsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgZm9yICh2YXIgX2MgPSBfX3ZhbHVlcyh0aGlzLnBvc3NpYmxlQ2VudGVycyksIF9kID0gX2MubmV4dCgpOyAhX2QuZG9uZTsgX2QgPSBfYy5uZXh0KCkpIHsKCSAgICAgICAgICAgICAgICAgICAgdmFyIGNlbnRlciA9IF9kLnZhbHVlOwoJICAgICAgICAgICAgICAgICAgICB2YXIgc2l6ZSA9IGNlbnRlci5nZXRFc3RpbWF0ZWRNb2R1bGVTaXplKCk7CgkgICAgICAgICAgICAgICAgICAgIHRvdGFsTW9kdWxlU2l6ZSArPSBzaXplOwoJICAgICAgICAgICAgICAgICAgICBzcXVhcmUgKz0gc2l6ZSAqIHNpemU7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgY2F0Y2ggKGVfNF8xKSB7IGVfNCA9IHsgZXJyb3I6IGVfNF8xIH07IH0KCSAgICAgICAgICAgIGZpbmFsbHkgewoJICAgICAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgICAgIGlmIChfZCAmJiAhX2QuZG9uZSAmJiAoX2EgPSBfYy5yZXR1cm4pKSBfYS5jYWxsKF9jKTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZmluYWxseSB7IGlmIChlXzQpIHRocm93IGVfNC5lcnJvcjsgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgYXZlcmFnZSA9IHRvdGFsTW9kdWxlU2l6ZSAvIHN0YXJ0U2l6ZTsKCSAgICAgICAgICAgIHZhciBzdGREZXYgPSBNYXRoLnNxcnQoc3F1YXJlIC8gc3RhcnRTaXplIC0gYXZlcmFnZSAqIGF2ZXJhZ2UpOwoJICAgICAgICAgICAgcG9zc2libGVDZW50ZXJzLnNvcnQoCgkgICAgICAgICAgICAvKioKCSAgICAgICAgICAgICAqIDxwPk9yZGVycyBieSBmdXJ0aGVzdCBmcm9tIGF2ZXJhZ2U8L3A+CgkgICAgICAgICAgICAgKi8KCSAgICAgICAgICAgIC8vIEZ1cnRoZXN0RnJvbUF2ZXJhZ2VDb21wYXJhdG9yIGltcGxlbWVudHMgQ29tcGFyYXRvcjxGaW5kZXJQYXR0ZXJuPgoJICAgICAgICAgICAgZnVuY3Rpb24gKGNlbnRlcjEsIGNlbnRlcjIpIHsKCSAgICAgICAgICAgICAgICB2YXIgZEEgPSBNYXRoLmFicyhjZW50ZXIyLmdldEVzdGltYXRlZE1vZHVsZVNpemUoKSAtIGF2ZXJhZ2UpOwoJICAgICAgICAgICAgICAgIHZhciBkQiA9IE1hdGguYWJzKGNlbnRlcjEuZ2V0RXN0aW1hdGVkTW9kdWxlU2l6ZSgpIC0gYXZlcmFnZSk7CgkgICAgICAgICAgICAgICAgcmV0dXJuIGRBIDwgZEIgPyAtMSA6IGRBID4gZEIgPyAxIDogMDsKCSAgICAgICAgICAgIH0pOwoJICAgICAgICAgICAgdmFyIGxpbWl0ID0gTWF0aC5tYXgoMC4yICogYXZlcmFnZSwgc3RkRGV2KTsKCSAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcG9zc2libGVDZW50ZXJzLmxlbmd0aCAmJiBwb3NzaWJsZUNlbnRlcnMubGVuZ3RoID4gMzsgaSsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIHBhdHRlcm4gPSBwb3NzaWJsZUNlbnRlcnNbaV07CgkgICAgICAgICAgICAgICAgaWYgKE1hdGguYWJzKHBhdHRlcm4uZ2V0RXN0aW1hdGVkTW9kdWxlU2l6ZSgpIC0gYXZlcmFnZSkgPiBsaW1pdCkgewoJICAgICAgICAgICAgICAgICAgICBwb3NzaWJsZUNlbnRlcnMuc3BsaWNlKGksIDEpOwoJICAgICAgICAgICAgICAgICAgICBpLS07CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGlmIChwb3NzaWJsZUNlbnRlcnMubGVuZ3RoID4gMykgewoJICAgICAgICAgICAgLy8gVGhyb3cgYXdheSBhbGwgYnV0IHRob3NlIGZpcnN0IHNpemUgY2FuZGlkYXRlIHBvaW50cyB3ZSBmb3VuZC4KCSAgICAgICAgICAgIHZhciB0b3RhbE1vZHVsZVNpemUgPSAwLjA7CgkgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgIGZvciAodmFyIHBvc3NpYmxlQ2VudGVyc18xID0gX192YWx1ZXMocG9zc2libGVDZW50ZXJzKSwgcG9zc2libGVDZW50ZXJzXzFfMSA9IHBvc3NpYmxlQ2VudGVyc18xLm5leHQoKTsgIXBvc3NpYmxlQ2VudGVyc18xXzEuZG9uZTsgcG9zc2libGVDZW50ZXJzXzFfMSA9IHBvc3NpYmxlQ2VudGVyc18xLm5leHQoKSkgewoJICAgICAgICAgICAgICAgICAgICB2YXIgcG9zc2libGVDZW50ZXIgPSBwb3NzaWJsZUNlbnRlcnNfMV8xLnZhbHVlOwoJICAgICAgICAgICAgICAgICAgICB0b3RhbE1vZHVsZVNpemUgKz0gcG9zc2libGVDZW50ZXIuZ2V0RXN0aW1hdGVkTW9kdWxlU2l6ZSgpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGNhdGNoIChlXzVfMSkgeyBlXzUgPSB7IGVycm9yOiBlXzVfMSB9OyB9CgkgICAgICAgICAgICBmaW5hbGx5IHsKCSAgICAgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgICAgICBpZiAocG9zc2libGVDZW50ZXJzXzFfMSAmJiAhcG9zc2libGVDZW50ZXJzXzFfMS5kb25lICYmIChfYiA9IHBvc3NpYmxlQ2VudGVyc18xLnJldHVybikpIF9iLmNhbGwocG9zc2libGVDZW50ZXJzXzEpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfNSkgdGhyb3cgZV81LmVycm9yOyB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBhdmVyYWdlID0gdG90YWxNb2R1bGVTaXplIC8gcG9zc2libGVDZW50ZXJzLmxlbmd0aDsKCSAgICAgICAgICAgIHBvc3NpYmxlQ2VudGVycy5zb3J0KAoJICAgICAgICAgICAgLyoqCgkgICAgICAgICAgICAgKiA8cD5PcmRlcnMgYnkge0BsaW5rIEZpbmRlclBhdHRlcm4jZ2V0Q291bnQoKX0sIGRlc2NlbmRpbmcuPC9wPgoJICAgICAgICAgICAgICovCgkgICAgICAgICAgICAvLyBDZW50ZXJDb21wYXJhdG9yIGltcGxlbWVudHMgQ29tcGFyYXRvcjxGaW5kZXJQYXR0ZXJuPgoJICAgICAgICAgICAgZnVuY3Rpb24gKGNlbnRlcjEsIGNlbnRlcjIpIHsKCSAgICAgICAgICAgICAgICBpZiAoY2VudGVyMi5nZXRDb3VudCgpID09PSBjZW50ZXIxLmdldENvdW50KCkpIHsKCSAgICAgICAgICAgICAgICAgICAgdmFyIGRBID0gTWF0aC5hYnMoY2VudGVyMi5nZXRFc3RpbWF0ZWRNb2R1bGVTaXplKCkgLSBhdmVyYWdlKTsKCSAgICAgICAgICAgICAgICAgICAgdmFyIGRCID0gTWF0aC5hYnMoY2VudGVyMS5nZXRFc3RpbWF0ZWRNb2R1bGVTaXplKCkgLSBhdmVyYWdlKTsKCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRBIDwgZEIgPyAxIDogZEEgPiBkQiA/IC0xIDogMDsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgIHJldHVybiBjZW50ZXIyLmdldENvdW50KCkgLSBjZW50ZXIxLmdldENvdW50KCk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfSk7CgkgICAgICAgICAgICBwb3NzaWJsZUNlbnRlcnMuc3BsaWNlKDMpOyAvLyB0aGlzIGlzIG5vdCByZWFseSBuZWNlc3NhcnkgYXMgd2Ugb25seSByZXR1cm4gZmlyc3QgMyBhbnl3YXkKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gWwoJICAgICAgICAgICAgcG9zc2libGVDZW50ZXJzWzBdLAoJICAgICAgICAgICAgcG9zc2libGVDZW50ZXJzWzFdLAoJICAgICAgICAgICAgcG9zc2libGVDZW50ZXJzWzJdCgkgICAgICAgIF07CgkgICAgfTsKCSAgICBGaW5kZXJQYXR0ZXJuRmluZGVyLkNFTlRFUl9RVU9SVU0gPSAyOwoJICAgIEZpbmRlclBhdHRlcm5GaW5kZXIuTUlOX1NLSVAgPSAzOyAvLyAxIHBpeGVsL21vZHVsZSB0aW1lcyAzIG1vZHVsZXMvY2VudGVyCgkgICAgRmluZGVyUGF0dGVybkZpbmRlci5NQVhfTU9EVUxFUyA9IDU3OyAvLyBzdXBwb3J0IHVwIHRvIHZlcnNpb24gMTAgZm9yIG1vYmlsZSBjbGllbnRzCgkgICAgcmV0dXJuIEZpbmRlclBhdHRlcm5GaW5kZXI7Cgl9KCkpOwoJRmluZGVyUGF0dGVybkZpbmRlciQxLmRlZmF1bHQgPSBGaW5kZXJQYXR0ZXJuRmluZGVyOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoRGV0ZWN0b3IkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIE1hdGhVdGlsc18xID0gTWF0aFV0aWxzJDE7Cgl2YXIgRGV0ZWN0b3JSZXN1bHRfMSA9IERldGVjdG9yUmVzdWx0JDE7CgkvLyBpbXBvcnQgR3JpZFNhbXBsZXIgZnJvbSAnLi4vLi4vY29tbW9uL0dyaWRTYW1wbGVyJzsKCXZhciBHcmlkU2FtcGxlckluc3RhbmNlXzEgPSBHcmlkU2FtcGxlckluc3RhbmNlJDE7Cgl2YXIgUGVyc3BlY3RpdmVUcmFuc2Zvcm1fMSA9IFBlcnNwZWN0aXZlVHJhbnNmb3JtJDE7Cgl2YXIgRGVjb2RlSGludFR5cGVfMSQxID0gRGVjb2RlSGludFR5cGUkMTsKCXZhciBOb3RGb3VuZEV4Y2VwdGlvbl8xJDEgPSBOb3RGb3VuZEV4Y2VwdGlvbiQxOwoJdmFyIFJlc3VsdFBvaW50XzEgPSBSZXN1bHRQb2ludCQxOwoJdmFyIFZlcnNpb25fMSA9IFZlcnNpb24kMTsKCXZhciBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyXzEgPSBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyJDE7Cgl2YXIgRmluZGVyUGF0dGVybkZpbmRlcl8xID0gRmluZGVyUGF0dGVybkZpbmRlciQxOwoJLyppbXBvcnQgamF2YS51dGlsLk1hcDsqLwoJLyoqCgkgKiA8cD5FbmNhcHN1bGF0ZXMgbG9naWMgdGhhdCBjYW4gZGV0ZWN0IGEgUVIgQ29kZSBpbiBhbiBpbWFnZSwgZXZlbiBpZiB0aGUgUVIgQ29kZQoJICogaXMgcm90YXRlZCBvciBza2V3ZWQsIG9yIHBhcnRpYWxseSBvYnNjdXJlZC48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIERldGVjdG9yID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIERldGVjdG9yKGltYWdlKSB7CgkgICAgICAgIHRoaXMuaW1hZ2UgPSBpbWFnZTsKCSAgICB9CgkgICAgRGV0ZWN0b3IucHJvdG90eXBlLmdldEltYWdlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5pbWFnZTsKCSAgICB9OwoJICAgIERldGVjdG9yLnByb3RvdHlwZS5nZXRSZXN1bHRQb2ludENhbGxiYWNrID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5yZXN1bHRQb2ludENhbGxiYWNrOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogPHA+RGV0ZWN0cyBhIFFSIENvZGUgaW4gYW4gaW1hZ2UuPC9wPgoJICAgICAqCgkgICAgICogQHJldHVybiB7QGxpbmsgRGV0ZWN0b3JSZXN1bHR9IGVuY2Fwc3VsYXRpbmcgcmVzdWx0cyBvZiBkZXRlY3RpbmcgYSBRUiBDb2RlCgkgICAgICogQHRocm93cyBOb3RGb3VuZEV4Y2VwdGlvbiBpZiBRUiBDb2RlIGNhbm5vdCBiZSBmb3VuZAoJICAgICAqIEB0aHJvd3MgRm9ybWF0RXhjZXB0aW9uIGlmIGEgUVIgQ29kZSBjYW5ub3QgYmUgZGVjb2RlZAoJICAgICAqLwoJICAgIC8vIHB1YmxpYyBkZXRlY3QoKTogRGV0ZWN0b3JSZXN1bHQgLyp0aHJvd3MgTm90Rm91bmRFeGNlcHRpb24sIEZvcm1hdEV4Y2VwdGlvbiovIHsKCSAgICAvLyAgIHJldHVybiBkZXRlY3QobnVsbCkKCSAgICAvLyB9CgkgICAgLyoqCgkgICAgICogPHA+RGV0ZWN0cyBhIFFSIENvZGUgaW4gYW4gaW1hZ2UuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGhpbnRzIG9wdGlvbmFsIGhpbnRzIHRvIGRldGVjdG9yCgkgICAgICogQHJldHVybiB7QGxpbmsgRGV0ZWN0b3JSZXN1bHR9IGVuY2Fwc3VsYXRpbmcgcmVzdWx0cyBvZiBkZXRlY3RpbmcgYSBRUiBDb2RlCgkgICAgICogQHRocm93cyBOb3RGb3VuZEV4Y2VwdGlvbiBpZiBRUiBDb2RlIGNhbm5vdCBiZSBmb3VuZAoJICAgICAqIEB0aHJvd3MgRm9ybWF0RXhjZXB0aW9uIGlmIGEgUVIgQ29kZSBjYW5ub3QgYmUgZGVjb2RlZAoJICAgICAqLwoJICAgIERldGVjdG9yLnByb3RvdHlwZS5kZXRlY3QgPSBmdW5jdGlvbiAoaGludHMpIHsKCSAgICAgICAgdGhpcy5yZXN1bHRQb2ludENhbGxiYWNrID0gKGhpbnRzID09PSBudWxsIHx8IGhpbnRzID09PSB1bmRlZmluZWQpID8gbnVsbCA6CgkgICAgICAgICAgICAvKihSZXN1bHRQb2ludENhbGxiYWNrKSAqLyBoaW50cy5nZXQoRGVjb2RlSGludFR5cGVfMSQxLmRlZmF1bHQuTkVFRF9SRVNVTFRfUE9JTlRfQ0FMTEJBQ0spOwoJICAgICAgICB2YXIgZmluZGVyID0gbmV3IEZpbmRlclBhdHRlcm5GaW5kZXJfMS5kZWZhdWx0KHRoaXMuaW1hZ2UsIHRoaXMucmVzdWx0UG9pbnRDYWxsYmFjayk7CgkgICAgICAgIHZhciBpbmZvID0gZmluZGVyLmZpbmQoaGludHMpOwoJICAgICAgICByZXR1cm4gdGhpcy5wcm9jZXNzRmluZGVyUGF0dGVybkluZm8oaW5mbyk7CgkgICAgfTsKCSAgICBEZXRlY3Rvci5wcm90b3R5cGUucHJvY2Vzc0ZpbmRlclBhdHRlcm5JbmZvID0gZnVuY3Rpb24gKGluZm8pIHsKCSAgICAgICAgdmFyIHRvcExlZnQgPSBpbmZvLmdldFRvcExlZnQoKTsKCSAgICAgICAgdmFyIHRvcFJpZ2h0ID0gaW5mby5nZXRUb3BSaWdodCgpOwoJICAgICAgICB2YXIgYm90dG9tTGVmdCA9IGluZm8uZ2V0Qm90dG9tTGVmdCgpOwoJICAgICAgICB2YXIgbW9kdWxlU2l6ZSA9IHRoaXMuY2FsY3VsYXRlTW9kdWxlU2l6ZSh0b3BMZWZ0LCB0b3BSaWdodCwgYm90dG9tTGVmdCk7CgkgICAgICAgIGlmIChtb2R1bGVTaXplIDwgMS4wKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMSQxLmRlZmF1bHQoJ05vIHBhdHRlcm4gZm91bmQgaW4gcHJvY2Nlc3MgZmluZGVyLicpOwoJICAgICAgICB9CgkgICAgICAgIHZhciBkaW1lbnNpb24gPSBEZXRlY3Rvci5jb21wdXRlRGltZW5zaW9uKHRvcExlZnQsIHRvcFJpZ2h0LCBib3R0b21MZWZ0LCBtb2R1bGVTaXplKTsKCSAgICAgICAgdmFyIHByb3Zpc2lvbmFsVmVyc2lvbiA9IFZlcnNpb25fMS5kZWZhdWx0LmdldFByb3Zpc2lvbmFsVmVyc2lvbkZvckRpbWVuc2lvbihkaW1lbnNpb24pOwoJICAgICAgICB2YXIgbW9kdWxlc0JldHdlZW5GUENlbnRlcnMgPSBwcm92aXNpb25hbFZlcnNpb24uZ2V0RGltZW5zaW9uRm9yVmVyc2lvbigpIC0gNzsKCSAgICAgICAgdmFyIGFsaWdubWVudFBhdHRlcm4gPSBudWxsOwoJICAgICAgICAvLyBBbnl0aGluZyBhYm92ZSB2ZXJzaW9uIDEgaGFzIGFuIGFsaWdubWVudCBwYXR0ZXJuCgkgICAgICAgIGlmIChwcm92aXNpb25hbFZlcnNpb24uZ2V0QWxpZ25tZW50UGF0dGVybkNlbnRlcnMoKS5sZW5ndGggPiAwKSB7CgkgICAgICAgICAgICAvLyBHdWVzcyB3aGVyZSBhICJib3R0b20gcmlnaHQiIGZpbmRlciBwYXR0ZXJuIHdvdWxkIGhhdmUgYmVlbgoJICAgICAgICAgICAgdmFyIGJvdHRvbVJpZ2h0WCA9IHRvcFJpZ2h0LmdldFgoKSAtIHRvcExlZnQuZ2V0WCgpICsgYm90dG9tTGVmdC5nZXRYKCk7CgkgICAgICAgICAgICB2YXIgYm90dG9tUmlnaHRZID0gdG9wUmlnaHQuZ2V0WSgpIC0gdG9wTGVmdC5nZXRZKCkgKyBib3R0b21MZWZ0LmdldFkoKTsKCSAgICAgICAgICAgIC8vIEVzdGltYXRlIHRoYXQgYWxpZ25tZW50IHBhdHRlcm4gaXMgY2xvc2VyIGJ5IDMgbW9kdWxlcwoJICAgICAgICAgICAgLy8gZnJvbSAiYm90dG9tIHJpZ2h0IiB0byBrbm93biB0b3AgbGVmdCBsb2NhdGlvbgoJICAgICAgICAgICAgdmFyIGNvcnJlY3Rpb25Ub1RvcExlZnQgPSAxLjAgLSAzLjAgLyBtb2R1bGVzQmV0d2VlbkZQQ2VudGVyczsKCSAgICAgICAgICAgIHZhciBlc3RBbGlnbm1lbnRYID0gLyooaW50KSAqLyBNYXRoLmZsb29yKHRvcExlZnQuZ2V0WCgpICsgY29ycmVjdGlvblRvVG9wTGVmdCAqIChib3R0b21SaWdodFggLSB0b3BMZWZ0LmdldFgoKSkpOwoJICAgICAgICAgICAgdmFyIGVzdEFsaWdubWVudFkgPSAvKihpbnQpICovIE1hdGguZmxvb3IodG9wTGVmdC5nZXRZKCkgKyBjb3JyZWN0aW9uVG9Ub3BMZWZ0ICogKGJvdHRvbVJpZ2h0WSAtIHRvcExlZnQuZ2V0WSgpKSk7CgkgICAgICAgICAgICAvLyBLaW5kIG9mIGFyYml0cmFyeSAtLSBleHBhbmQgc2VhcmNoIHJhZGl1cyBiZWZvcmUgZ2l2aW5nIHVwCgkgICAgICAgICAgICBmb3IgKHZhciBpID0gNDsgaSA8PSAxNjsgaSA8PD0gMSkgewoJICAgICAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgICAgIGFsaWdubWVudFBhdHRlcm4gPSB0aGlzLmZpbmRBbGlnbm1lbnRJblJlZ2lvbihtb2R1bGVTaXplLCBlc3RBbGlnbm1lbnRYLCBlc3RBbGlnbm1lbnRZLCBpKTsKCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGNhdGNoIChyZSAvKk5vdEZvdW5kRXhjZXB0aW9uKi8pIHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKCEocmUgaW5zdGFuY2VvZiBOb3RGb3VuZEV4Y2VwdGlvbl8xJDEuZGVmYXVsdCkpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IHJlOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIC8vIHRyeSBuZXh0IHJvdW5kCgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgLy8gSWYgd2UgZGlkbid0IGZpbmQgYWxpZ25tZW50IHBhdHRlcm4uLi4gd2VsbCB0cnkgYW55d2F5IHdpdGhvdXQgaXQKCSAgICAgICAgfQoJICAgICAgICB2YXIgdHJhbnNmb3JtID0gRGV0ZWN0b3IuY3JlYXRlVHJhbnNmb3JtKHRvcExlZnQsIHRvcFJpZ2h0LCBib3R0b21MZWZ0LCBhbGlnbm1lbnRQYXR0ZXJuLCBkaW1lbnNpb24pOwoJICAgICAgICB2YXIgYml0cyA9IERldGVjdG9yLnNhbXBsZUdyaWQodGhpcy5pbWFnZSwgdHJhbnNmb3JtLCBkaW1lbnNpb24pOwoJICAgICAgICB2YXIgcG9pbnRzOwoJICAgICAgICBpZiAoYWxpZ25tZW50UGF0dGVybiA9PT0gbnVsbCkgewoJICAgICAgICAgICAgcG9pbnRzID0gW2JvdHRvbUxlZnQsIHRvcExlZnQsIHRvcFJpZ2h0XTsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgIHBvaW50cyA9IFtib3R0b21MZWZ0LCB0b3BMZWZ0LCB0b3BSaWdodCwgYWxpZ25tZW50UGF0dGVybl07CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIG5ldyBEZXRlY3RvclJlc3VsdF8xLmRlZmF1bHQoYml0cywgcG9pbnRzKTsKCSAgICB9OwoJICAgIERldGVjdG9yLmNyZWF0ZVRyYW5zZm9ybSA9IGZ1bmN0aW9uICh0b3BMZWZ0LCB0b3BSaWdodCwgYm90dG9tTGVmdCwgYWxpZ25tZW50UGF0dGVybiwgZGltZW5zaW9uIC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIGRpbU1pbnVzVGhyZWUgPSBkaW1lbnNpb24gLSAzLjU7CgkgICAgICAgIHZhciBib3R0b21SaWdodFg7IC8qZmxvYXQqLwoJICAgICAgICB2YXIgYm90dG9tUmlnaHRZOyAvKmZsb2F0Ki8KCSAgICAgICAgdmFyIHNvdXJjZUJvdHRvbVJpZ2h0WDsgLypmbG9hdCovCgkgICAgICAgIHZhciBzb3VyY2VCb3R0b21SaWdodFk7IC8qZmxvYXQqLwoJICAgICAgICBpZiAoYWxpZ25tZW50UGF0dGVybiAhPT0gbnVsbCkgewoJICAgICAgICAgICAgYm90dG9tUmlnaHRYID0gYWxpZ25tZW50UGF0dGVybi5nZXRYKCk7CgkgICAgICAgICAgICBib3R0b21SaWdodFkgPSBhbGlnbm1lbnRQYXR0ZXJuLmdldFkoKTsKCSAgICAgICAgICAgIHNvdXJjZUJvdHRvbVJpZ2h0WCA9IGRpbU1pbnVzVGhyZWUgLSAzLjA7CgkgICAgICAgICAgICBzb3VyY2VCb3R0b21SaWdodFkgPSBzb3VyY2VCb3R0b21SaWdodFg7CgkgICAgICAgIH0KCSAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAvLyBEb24ndCBoYXZlIGFuIGFsaWdubWVudCBwYXR0ZXJuLCBqdXN0IG1ha2UgdXAgdGhlIGJvdHRvbS1yaWdodCBwb2ludAoJICAgICAgICAgICAgYm90dG9tUmlnaHRYID0gKHRvcFJpZ2h0LmdldFgoKSAtIHRvcExlZnQuZ2V0WCgpKSArIGJvdHRvbUxlZnQuZ2V0WCgpOwoJICAgICAgICAgICAgYm90dG9tUmlnaHRZID0gKHRvcFJpZ2h0LmdldFkoKSAtIHRvcExlZnQuZ2V0WSgpKSArIGJvdHRvbUxlZnQuZ2V0WSgpOwoJICAgICAgICAgICAgc291cmNlQm90dG9tUmlnaHRYID0gZGltTWludXNUaHJlZTsKCSAgICAgICAgICAgIHNvdXJjZUJvdHRvbVJpZ2h0WSA9IGRpbU1pbnVzVGhyZWU7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIFBlcnNwZWN0aXZlVHJhbnNmb3JtXzEuZGVmYXVsdC5xdWFkcmlsYXRlcmFsVG9RdWFkcmlsYXRlcmFsKDMuNSwgMy41LCBkaW1NaW51c1RocmVlLCAzLjUsIHNvdXJjZUJvdHRvbVJpZ2h0WCwgc291cmNlQm90dG9tUmlnaHRZLCAzLjUsIGRpbU1pbnVzVGhyZWUsIHRvcExlZnQuZ2V0WCgpLCB0b3BMZWZ0LmdldFkoKSwgdG9wUmlnaHQuZ2V0WCgpLCB0b3BSaWdodC5nZXRZKCksIGJvdHRvbVJpZ2h0WCwgYm90dG9tUmlnaHRZLCBib3R0b21MZWZ0LmdldFgoKSwgYm90dG9tTGVmdC5nZXRZKCkpOwoJICAgIH07CgkgICAgRGV0ZWN0b3Iuc2FtcGxlR3JpZCA9IGZ1bmN0aW9uIChpbWFnZSwgdHJhbnNmb3JtLCBkaW1lbnNpb24gLyppbnQqLykgewoJICAgICAgICB2YXIgc2FtcGxlciA9IEdyaWRTYW1wbGVySW5zdGFuY2VfMS5kZWZhdWx0LmdldEluc3RhbmNlKCk7CgkgICAgICAgIHJldHVybiBzYW1wbGVyLnNhbXBsZUdyaWRXaXRoVHJhbnNmb3JtKGltYWdlLCBkaW1lbnNpb24sIGRpbWVuc2lvbiwgdHJhbnNmb3JtKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPkNvbXB1dGVzIHRoZSBkaW1lbnNpb24gKG51bWJlciBvZiBtb2R1bGVzIG9uIGEgc2l6ZSkgb2YgdGhlIFFSIENvZGUgYmFzZWQgb24gdGhlIHBvc2l0aW9uCgkgICAgICogb2YgdGhlIGZpbmRlciBwYXR0ZXJucyBhbmQgZXN0aW1hdGVkIG1vZHVsZSBzaXplLjwvcD4KCSAgICAgKi8KCSAgICBEZXRlY3Rvci5jb21wdXRlRGltZW5zaW9uID0gZnVuY3Rpb24gKHRvcExlZnQsIHRvcFJpZ2h0LCBib3R0b21MZWZ0LCBtb2R1bGVTaXplIC8qZmxvYXQqLykgewoJICAgICAgICB2YXIgdGx0ckNlbnRlcnNEaW1lbnNpb24gPSBNYXRoVXRpbHNfMS5kZWZhdWx0LnJvdW5kKFJlc3VsdFBvaW50XzEuZGVmYXVsdC5kaXN0YW5jZSh0b3BMZWZ0LCB0b3BSaWdodCkgLyBtb2R1bGVTaXplKTsKCSAgICAgICAgdmFyIHRsYmxDZW50ZXJzRGltZW5zaW9uID0gTWF0aFV0aWxzXzEuZGVmYXVsdC5yb3VuZChSZXN1bHRQb2ludF8xLmRlZmF1bHQuZGlzdGFuY2UodG9wTGVmdCwgYm90dG9tTGVmdCkgLyBtb2R1bGVTaXplKTsKCSAgICAgICAgdmFyIGRpbWVuc2lvbiA9IE1hdGguZmxvb3IoKHRsdHJDZW50ZXJzRGltZW5zaW9uICsgdGxibENlbnRlcnNEaW1lbnNpb24pIC8gMikgKyA3OwoJICAgICAgICBzd2l0Y2ggKGRpbWVuc2lvbiAmIDB4MDMpIHsgLy8gbW9kIDQKCSAgICAgICAgICAgIGNhc2UgMDoKCSAgICAgICAgICAgICAgICBkaW1lbnNpb24rKzsKCSAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgIC8vIDE/IGRvIG5vdGhpbmcKCSAgICAgICAgICAgIGNhc2UgMjoKCSAgICAgICAgICAgICAgICBkaW1lbnNpb24tLTsKCSAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgIGNhc2UgMzoKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMSQxLmRlZmF1bHQoJ0RpbWVuc2lvbnMgY291bGQgYmUgbm90IGZvdW5kLicpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBkaW1lbnNpb247CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiA8cD5Db21wdXRlcyBhbiBhdmVyYWdlIGVzdGltYXRlZCBtb2R1bGUgc2l6ZSBiYXNlZCBvbiBlc3RpbWF0ZWQgZGVyaXZlZCBmcm9tIHRoZSBwb3NpdGlvbnMKCSAgICAgKiBvZiB0aGUgdGhyZWUgZmluZGVyIHBhdHRlcm5zLjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSB0b3BMZWZ0IGRldGVjdGVkIHRvcC1sZWZ0IGZpbmRlciBwYXR0ZXJuIGNlbnRlcgoJICAgICAqIEBwYXJhbSB0b3BSaWdodCBkZXRlY3RlZCB0b3AtcmlnaHQgZmluZGVyIHBhdHRlcm4gY2VudGVyCgkgICAgICogQHBhcmFtIGJvdHRvbUxlZnQgZGV0ZWN0ZWQgYm90dG9tLWxlZnQgZmluZGVyIHBhdHRlcm4gY2VudGVyCgkgICAgICogQHJldHVybiBlc3RpbWF0ZWQgbW9kdWxlIHNpemUKCSAgICAgKi8KCSAgICBEZXRlY3Rvci5wcm90b3R5cGUuY2FsY3VsYXRlTW9kdWxlU2l6ZSA9IGZ1bmN0aW9uICh0b3BMZWZ0LCB0b3BSaWdodCwgYm90dG9tTGVmdCkgewoJICAgICAgICAvLyBUYWtlIHRoZSBhdmVyYWdlCgkgICAgICAgIHJldHVybiAodGhpcy5jYWxjdWxhdGVNb2R1bGVTaXplT25lV2F5KHRvcExlZnQsIHRvcFJpZ2h0KSArCgkgICAgICAgICAgICB0aGlzLmNhbGN1bGF0ZU1vZHVsZVNpemVPbmVXYXkodG9wTGVmdCwgYm90dG9tTGVmdCkpIC8gMi4wOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogPHA+RXN0aW1hdGVzIG1vZHVsZSBzaXplIGJhc2VkIG9uIHR3byBmaW5kZXIgcGF0dGVybnMgLS0gaXQgdXNlcwoJICAgICAqIHtAbGluayAjc2l6ZU9mQmxhY2tXaGl0ZUJsYWNrUnVuQm90aFdheXMoaW50LCBpbnQsIGludCwgaW50KX0gdG8gZmlndXJlIHRoZQoJICAgICAqIHdpZHRoIG9mIGVhY2gsIG1lYXN1cmluZyBhbG9uZyB0aGUgYXhpcyBiZXR3ZWVuIHRoZWlyIGNlbnRlcnMuPC9wPgoJICAgICAqLwoJICAgIERldGVjdG9yLnByb3RvdHlwZS5jYWxjdWxhdGVNb2R1bGVTaXplT25lV2F5ID0gZnVuY3Rpb24gKHBhdHRlcm4sIG90aGVyUGF0dGVybikgewoJICAgICAgICB2YXIgbW9kdWxlU2l6ZUVzdDEgPSB0aGlzLnNpemVPZkJsYWNrV2hpdGVCbGFja1J1bkJvdGhXYXlzKC8qKGludCkgKi8gTWF0aC5mbG9vcihwYXR0ZXJuLmdldFgoKSksIAoJICAgICAgICAvKihpbnQpICovIE1hdGguZmxvb3IocGF0dGVybi5nZXRZKCkpLCAKCSAgICAgICAgLyooaW50KSAqLyBNYXRoLmZsb29yKG90aGVyUGF0dGVybi5nZXRYKCkpLCAKCSAgICAgICAgLyooaW50KSAqLyBNYXRoLmZsb29yKG90aGVyUGF0dGVybi5nZXRZKCkpKTsKCSAgICAgICAgdmFyIG1vZHVsZVNpemVFc3QyID0gdGhpcy5zaXplT2ZCbGFja1doaXRlQmxhY2tSdW5Cb3RoV2F5cygvKihpbnQpICovIE1hdGguZmxvb3Iob3RoZXJQYXR0ZXJuLmdldFgoKSksIAoJICAgICAgICAvKihpbnQpICovIE1hdGguZmxvb3Iob3RoZXJQYXR0ZXJuLmdldFkoKSksIAoJICAgICAgICAvKihpbnQpICovIE1hdGguZmxvb3IocGF0dGVybi5nZXRYKCkpLCAKCSAgICAgICAgLyooaW50KSAqLyBNYXRoLmZsb29yKHBhdHRlcm4uZ2V0WSgpKSk7CgkgICAgICAgIGlmIChpc05hTihtb2R1bGVTaXplRXN0MSkpIHsKCSAgICAgICAgICAgIHJldHVybiBtb2R1bGVTaXplRXN0MiAvIDcuMDsKCSAgICAgICAgfQoJICAgICAgICBpZiAoaXNOYU4obW9kdWxlU2l6ZUVzdDIpKSB7CgkgICAgICAgICAgICByZXR1cm4gbW9kdWxlU2l6ZUVzdDEgLyA3LjA7CgkgICAgICAgIH0KCSAgICAgICAgLy8gQXZlcmFnZSB0aGVtLCBhbmQgZGl2aWRlIGJ5IDcgc2luY2Ugd2UndmUgY291bnRlZCB0aGUgd2lkdGggb2YgMyBibGFjayBtb2R1bGVzLAoJICAgICAgICAvLyBhbmQgMSB3aGl0ZSBhbmQgMSBibGFjayBtb2R1bGUgb24gZWl0aGVyIHNpZGUuIEVyZ28sIGRpdmlkZSBzdW0gYnkgMTQuCgkgICAgICAgIHJldHVybiAobW9kdWxlU2l6ZUVzdDEgKyBtb2R1bGVTaXplRXN0MikgLyAxNC4wOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogU2VlIHtAbGluayAjc2l6ZU9mQmxhY2tXaGl0ZUJsYWNrUnVuKGludCwgaW50LCBpbnQsIGludCl9OyBjb21wdXRlcyB0aGUgdG90YWwgd2lkdGggb2YKCSAgICAgKiBhIGZpbmRlciBwYXR0ZXJuIGJ5IGxvb2tpbmcgZm9yIGEgYmxhY2std2hpdGUtYmxhY2sgcnVuIGZyb20gdGhlIGNlbnRlciBpbiB0aGUgZGlyZWN0aW9uCgkgICAgICogb2YgYW5vdGhlciBwb2ludCAoYW5vdGhlciBmaW5kZXIgcGF0dGVybiBjZW50ZXIpLCBhbmQgaW4gdGhlIG9wcG9zaXRlIGRpcmVjdGlvbiB0b28uCgkgICAgICovCgkgICAgRGV0ZWN0b3IucHJvdG90eXBlLnNpemVPZkJsYWNrV2hpdGVCbGFja1J1bkJvdGhXYXlzID0gZnVuY3Rpb24gKGZyb21YIC8qaW50Ki8sIGZyb21ZIC8qaW50Ki8sIHRvWCAvKmludCovLCB0b1kgLyppbnQqLykgewoJICAgICAgICB2YXIgcmVzdWx0ID0gdGhpcy5zaXplT2ZCbGFja1doaXRlQmxhY2tSdW4oZnJvbVgsIGZyb21ZLCB0b1gsIHRvWSk7CgkgICAgICAgIC8vIE5vdyBjb3VudCBvdGhlciB3YXkgLS0gZG9uJ3QgcnVuIG9mZiBpbWFnZSB0aG91Z2ggb2YgY291cnNlCgkgICAgICAgIHZhciBzY2FsZSA9IDEuMDsKCSAgICAgICAgdmFyIG90aGVyVG9YID0gZnJvbVggLSAodG9YIC0gZnJvbVgpOwoJICAgICAgICBpZiAob3RoZXJUb1ggPCAwKSB7CgkgICAgICAgICAgICBzY2FsZSA9IGZyb21YIC8gLyooZmxvYXQpICovIChmcm9tWCAtIG90aGVyVG9YKTsKCSAgICAgICAgICAgIG90aGVyVG9YID0gMDsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIGlmIChvdGhlclRvWCA+PSB0aGlzLmltYWdlLmdldFdpZHRoKCkpIHsKCSAgICAgICAgICAgIHNjYWxlID0gKHRoaXMuaW1hZ2UuZ2V0V2lkdGgoKSAtIDEgLSBmcm9tWCkgLyAvKihmbG9hdCkgKi8gKG90aGVyVG9YIC0gZnJvbVgpOwoJICAgICAgICAgICAgb3RoZXJUb1ggPSB0aGlzLmltYWdlLmdldFdpZHRoKCkgLSAxOwoJICAgICAgICB9CgkgICAgICAgIHZhciBvdGhlclRvWSA9IC8qKGludCkgKi8gTWF0aC5mbG9vcihmcm9tWSAtICh0b1kgLSBmcm9tWSkgKiBzY2FsZSk7CgkgICAgICAgIHNjYWxlID0gMS4wOwoJICAgICAgICBpZiAob3RoZXJUb1kgPCAwKSB7CgkgICAgICAgICAgICBzY2FsZSA9IGZyb21ZIC8gLyooZmxvYXQpICovIChmcm9tWSAtIG90aGVyVG9ZKTsKCSAgICAgICAgICAgIG90aGVyVG9ZID0gMDsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIGlmIChvdGhlclRvWSA+PSB0aGlzLmltYWdlLmdldEhlaWdodCgpKSB7CgkgICAgICAgICAgICBzY2FsZSA9ICh0aGlzLmltYWdlLmdldEhlaWdodCgpIC0gMSAtIGZyb21ZKSAvIC8qKGZsb2F0KSAqLyAob3RoZXJUb1kgLSBmcm9tWSk7CgkgICAgICAgICAgICBvdGhlclRvWSA9IHRoaXMuaW1hZ2UuZ2V0SGVpZ2h0KCkgLSAxOwoJICAgICAgICB9CgkgICAgICAgIG90aGVyVG9YID0gLyooaW50KSAqLyBNYXRoLmZsb29yKGZyb21YICsgKG90aGVyVG9YIC0gZnJvbVgpICogc2NhbGUpOwoJICAgICAgICByZXN1bHQgKz0gdGhpcy5zaXplT2ZCbGFja1doaXRlQmxhY2tSdW4oZnJvbVgsIGZyb21ZLCBvdGhlclRvWCwgb3RoZXJUb1kpOwoJICAgICAgICAvLyBNaWRkbGUgcGl4ZWwgaXMgZG91YmxlLWNvdW50ZWQgdGhpcyB3YXk7IHN1YnRyYWN0IDEKCSAgICAgICAgcmV0dXJuIHJlc3VsdCAtIDEuMDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPlRoaXMgbWV0aG9kIHRyYWNlcyBhIGxpbmUgZnJvbSBhIHBvaW50IGluIHRoZSBpbWFnZSwgaW4gdGhlIGRpcmVjdGlvbiB0b3dhcmRzIGFub3RoZXIgcG9pbnQuCgkgICAgICogSXQgYmVnaW5zIGluIGEgYmxhY2sgcmVnaW9uLCBhbmQga2VlcHMgZ29pbmcgdW50aWwgaXQgZmluZHMgd2hpdGUsIHRoZW4gYmxhY2ssIHRoZW4gd2hpdGUgYWdhaW4uCgkgICAgICogSXQgcmVwb3J0cyB0aGUgZGlzdGFuY2UgZnJvbSB0aGUgc3RhcnQgdG8gdGhpcyBwb2ludC48L3A+CgkgICAgICoKCSAgICAgKiA8cD5UaGlzIGlzIHVzZWQgd2hlbiBmaWd1cmluZyBvdXQgaG93IHdpZGUgYSBmaW5kZXIgcGF0dGVybiBpcywgd2hlbiB0aGUgZmluZGVyIHBhdHRlcm4KCSAgICAgKiBtYXkgYmUgc2tld2VkIG9yIHJvdGF0ZWQuPC9wPgoJICAgICAqLwoJICAgIERldGVjdG9yLnByb3RvdHlwZS5zaXplT2ZCbGFja1doaXRlQmxhY2tSdW4gPSBmdW5jdGlvbiAoZnJvbVggLyppbnQqLywgZnJvbVkgLyppbnQqLywgdG9YIC8qaW50Ki8sIHRvWSAvKmludCovKSB7CgkgICAgICAgIC8vIE1pbGQgdmFyaWFudCBvZiBCcmVzZW5oYW0ncyBhbGdvcml0aG0KCSAgICAgICAgLy8gc2VlIGh0dHA6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvQnJlc2VuaGFtJ3NfbGluZV9hbGdvcml0aG0KCSAgICAgICAgdmFyIHN0ZWVwID0gTWF0aC5hYnModG9ZIC0gZnJvbVkpID4gTWF0aC5hYnModG9YIC0gZnJvbVgpOwoJICAgICAgICBpZiAoc3RlZXApIHsKCSAgICAgICAgICAgIHZhciB0ZW1wID0gZnJvbVg7CgkgICAgICAgICAgICBmcm9tWCA9IGZyb21ZOwoJICAgICAgICAgICAgZnJvbVkgPSB0ZW1wOwoJICAgICAgICAgICAgdGVtcCA9IHRvWDsKCSAgICAgICAgICAgIHRvWCA9IHRvWTsKCSAgICAgICAgICAgIHRvWSA9IHRlbXA7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGR4ID0gTWF0aC5hYnModG9YIC0gZnJvbVgpOwoJICAgICAgICB2YXIgZHkgPSBNYXRoLmFicyh0b1kgLSBmcm9tWSk7CgkgICAgICAgIHZhciBlcnJvciA9IC1keCAvIDI7CgkgICAgICAgIHZhciB4c3RlcCA9IGZyb21YIDwgdG9YID8gMSA6IC0xOwoJICAgICAgICB2YXIgeXN0ZXAgPSBmcm9tWSA8IHRvWSA/IDEgOiAtMTsKCSAgICAgICAgLy8gSW4gYmxhY2sgcGl4ZWxzLCBsb29raW5nIGZvciB3aGl0ZSwgZmlyc3Qgb3Igc2Vjb25kIHRpbWUuCgkgICAgICAgIHZhciBzdGF0ZSA9IDA7CgkgICAgICAgIC8vIExvb3AgdXAgdW50aWwgeCA9PSB0b1gsIGJ1dCBub3QgYmV5b25kCgkgICAgICAgIHZhciB4TGltaXQgPSB0b1ggKyB4c3RlcDsKCSAgICAgICAgZm9yICh2YXIgeCA9IGZyb21YLCB5ID0gZnJvbVk7IHggIT09IHhMaW1pdDsgeCArPSB4c3RlcCkgewoJICAgICAgICAgICAgdmFyIHJlYWxYID0gc3RlZXAgPyB5IDogeDsKCSAgICAgICAgICAgIHZhciByZWFsWSA9IHN0ZWVwID8geCA6IHk7CgkgICAgICAgICAgICAvLyBEb2VzIGN1cnJlbnQgcGl4ZWwgbWVhbiB3ZSBoYXZlIG1vdmVkIHdoaXRlIHRvIGJsYWNrIG9yIHZpY2UgdmVyc2E/CgkgICAgICAgICAgICAvLyBTY2FubmluZyBibGFjayBpbiBzdGF0ZSAwLDIgYW5kIHdoaXRlIGluIHN0YXRlIDEsIHNvIGlmIHdlIGZpbmQgdGhlIHdyb25nCgkgICAgICAgICAgICAvLyBjb2xvciwgYWR2YW5jZSB0byBuZXh0IHN0YXRlIG9yIGVuZCBpZiB3ZSBhcmUgaW4gc3RhdGUgMiBhbHJlYWR5CgkgICAgICAgICAgICBpZiAoKHN0YXRlID09PSAxKSA9PT0gdGhpcy5pbWFnZS5nZXQocmVhbFgsIHJlYWxZKSkgewoJICAgICAgICAgICAgICAgIGlmIChzdGF0ZSA9PT0gMikgewoJICAgICAgICAgICAgICAgICAgICByZXR1cm4gTWF0aFV0aWxzXzEuZGVmYXVsdC5kaXN0YW5jZSh4LCB5LCBmcm9tWCwgZnJvbVkpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBzdGF0ZSsrOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZXJyb3IgKz0gZHk7CgkgICAgICAgICAgICBpZiAoZXJyb3IgPiAwKSB7CgkgICAgICAgICAgICAgICAgaWYgKHkgPT09IHRvWSkgewoJICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgeSArPSB5c3RlcDsKCSAgICAgICAgICAgICAgICBlcnJvciAtPSBkeDsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICAvLyBGb3VuZCBibGFjay13aGl0ZS1ibGFjazsgZ2l2ZSB0aGUgYmVuZWZpdCBvZiB0aGUgZG91YnQgdGhhdCB0aGUgbmV4dCBwaXhlbCBvdXRzaWRlIHRoZSBpbWFnZQoJICAgICAgICAvLyBpcyAid2hpdGUiIHNvIHRoaXMgbGFzdCBwb2ludCBhdCAodG9YK3hTdGVwLHRvWSkgaXMgdGhlIHJpZ2h0IGVuZGluZy4gVGhpcyBpcyByZWFsbHkgYQoJICAgICAgICAvLyBzbWFsbCBhcHByb3hpbWF0aW9uOyAodG9YK3hTdGVwLHRvWSt5U3RlcCkgbWlnaHQgYmUgcmVhbGx5IGNvcnJlY3QuIElnbm9yZSB0aGlzLgoJICAgICAgICBpZiAoc3RhdGUgPT09IDIpIHsKCSAgICAgICAgICAgIHJldHVybiBNYXRoVXRpbHNfMS5kZWZhdWx0LmRpc3RhbmNlKHRvWCArIHhzdGVwLCB0b1ksIGZyb21YLCBmcm9tWSk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gZWxzZSB3ZSBkaWRuJ3QgZmluZCBldmVuIGJsYWNrLXdoaXRlLWJsYWNrOyBubyBlc3RpbWF0ZSBpcyByZWFsbHkgcG9zc2libGUKCSAgICAgICAgcmV0dXJuIE5hTjsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPkF0dGVtcHRzIHRvIGxvY2F0ZSBhbiBhbGlnbm1lbnQgcGF0dGVybiBpbiBhIGxpbWl0ZWQgcmVnaW9uIG9mIHRoZSBpbWFnZSwgd2hpY2ggaXMKCSAgICAgKiBndWVzc2VkIHRvIGNvbnRhaW4gaXQuIFRoaXMgbWV0aG9kIHVzZXMge0BsaW5rIEFsaWdubWVudFBhdHRlcm59LjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBvdmVyYWxsRXN0TW9kdWxlU2l6ZSBlc3RpbWF0ZWQgbW9kdWxlIHNpemUgc28gZmFyCgkgICAgICogQHBhcmFtIGVzdEFsaWdubWVudFggeCBjb29yZGluYXRlIG9mIGNlbnRlciBvZiBhcmVhIHByb2JhYmx5IGNvbnRhaW5pbmcgYWxpZ25tZW50IHBhdHRlcm4KCSAgICAgKiBAcGFyYW0gZXN0QWxpZ25tZW50WSB5IGNvb3JkaW5hdGUgb2YgYWJvdmUKCSAgICAgKiBAcGFyYW0gYWxsb3dhbmNlRmFjdG9yIG51bWJlciBvZiBwaXhlbHMgaW4gYWxsIGRpcmVjdGlvbnMgdG8gc2VhcmNoIGZyb20gdGhlIGNlbnRlcgoJICAgICAqIEByZXR1cm4ge0BsaW5rIEFsaWdubWVudFBhdHRlcm59IGlmIGZvdW5kLCBvciBudWxsIG90aGVyd2lzZQoJICAgICAqIEB0aHJvd3MgTm90Rm91bmRFeGNlcHRpb24gaWYgYW4gdW5leHBlY3RlZCBlcnJvciBvY2N1cnMgZHVyaW5nIGRldGVjdGlvbgoJICAgICAqLwoJICAgIERldGVjdG9yLnByb3RvdHlwZS5maW5kQWxpZ25tZW50SW5SZWdpb24gPSBmdW5jdGlvbiAob3ZlcmFsbEVzdE1vZHVsZVNpemUgLypmbG9hdCovLCBlc3RBbGlnbm1lbnRYIC8qaW50Ki8sIGVzdEFsaWdubWVudFkgLyppbnQqLywgYWxsb3dhbmNlRmFjdG9yIC8qZmxvYXQqLykgewoJICAgICAgICAvLyBMb29rIGZvciBhbiBhbGlnbm1lbnQgcGF0dGVybiAoMyBtb2R1bGVzIGluIHNpemUpIGFyb3VuZCB3aGVyZSBpdAoJICAgICAgICAvLyBzaG91bGQgYmUKCSAgICAgICAgdmFyIGFsbG93YW5jZSA9IC8qKGludCkgKi8gTWF0aC5mbG9vcihhbGxvd2FuY2VGYWN0b3IgKiBvdmVyYWxsRXN0TW9kdWxlU2l6ZSk7CgkgICAgICAgIHZhciBhbGlnbm1lbnRBcmVhTGVmdFggPSBNYXRoLm1heCgwLCBlc3RBbGlnbm1lbnRYIC0gYWxsb3dhbmNlKTsKCSAgICAgICAgdmFyIGFsaWdubWVudEFyZWFSaWdodFggPSBNYXRoLm1pbih0aGlzLmltYWdlLmdldFdpZHRoKCkgLSAxLCBlc3RBbGlnbm1lbnRYICsgYWxsb3dhbmNlKTsKCSAgICAgICAgaWYgKGFsaWdubWVudEFyZWFSaWdodFggLSBhbGlnbm1lbnRBcmVhTGVmdFggPCBvdmVyYWxsRXN0TW9kdWxlU2l6ZSAqIDMpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBOb3RGb3VuZEV4Y2VwdGlvbl8xJDEuZGVmYXVsdCgnQWxpZ25tZW50IHRvcCBleGNlZWRzIGVzdGltYXRlZCBtb2R1bGUgc2l6ZS4nKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgYWxpZ25tZW50QXJlYVRvcFkgPSBNYXRoLm1heCgwLCBlc3RBbGlnbm1lbnRZIC0gYWxsb3dhbmNlKTsKCSAgICAgICAgdmFyIGFsaWdubWVudEFyZWFCb3R0b21ZID0gTWF0aC5taW4odGhpcy5pbWFnZS5nZXRIZWlnaHQoKSAtIDEsIGVzdEFsaWdubWVudFkgKyBhbGxvd2FuY2UpOwoJICAgICAgICBpZiAoYWxpZ25tZW50QXJlYUJvdHRvbVkgLSBhbGlnbm1lbnRBcmVhVG9wWSA8IG92ZXJhbGxFc3RNb2R1bGVTaXplICogMykgewoJICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uXzEkMS5kZWZhdWx0KCdBbGlnbm1lbnQgYm90dG9tIGV4Y2VlZHMgZXN0aW1hdGVkIG1vZHVsZSBzaXplLicpOwoJICAgICAgICB9CgkgICAgICAgIHZhciBhbGlnbm1lbnRGaW5kZXIgPSBuZXcgQWxpZ25tZW50UGF0dGVybkZpbmRlcl8xLmRlZmF1bHQodGhpcy5pbWFnZSwgYWxpZ25tZW50QXJlYUxlZnRYLCBhbGlnbm1lbnRBcmVhVG9wWSwgYWxpZ25tZW50QXJlYVJpZ2h0WCAtIGFsaWdubWVudEFyZWFMZWZ0WCwgYWxpZ25tZW50QXJlYUJvdHRvbVkgLSBhbGlnbm1lbnRBcmVhVG9wWSwgb3ZlcmFsbEVzdE1vZHVsZVNpemUsIHRoaXMucmVzdWx0UG9pbnRDYWxsYmFjayk7CgkgICAgICAgIHJldHVybiBhbGlnbm1lbnRGaW5kZXIuZmluZCgpOwoJICAgIH07CgkgICAgcmV0dXJuIERldGVjdG9yOwoJfSgpKTsKCURldGVjdG9yJDEuZGVmYXVsdCA9IERldGVjdG9yOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoUVJDb2RlUmVhZGVyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcucXJjb2RlIHsqLwoJdmFyIEJhcmNvZGVGb3JtYXRfMSA9IEJhcmNvZGVGb3JtYXQkMTsKCXZhciBCaXRNYXRyaXhfMSA9IEJpdE1hdHJpeCQxOwoJdmFyIERlY29kZUhpbnRUeXBlXzEgPSBEZWNvZGVIaW50VHlwZSQxOwoJdmFyIE5vdEZvdW5kRXhjZXB0aW9uXzEgPSBOb3RGb3VuZEV4Y2VwdGlvbiQxOwoJdmFyIFJlc3VsdF8xID0gUmVzdWx0JDE7Cgl2YXIgUmVzdWx0TWV0YWRhdGFUeXBlXzEgPSBSZXN1bHRNZXRhZGF0YVR5cGUkMTsKCS8vIGltcG9ydCBEZXRlY3RvclJlc3VsdCBmcm9tICcuLi9jb21tb24vRGV0ZWN0b3JSZXN1bHQnOwoJdmFyIERlY29kZXJfMSA9IERlY29kZXIkMTsKCXZhciBRUkNvZGVEZWNvZGVyTWV0YURhdGFfMSA9IFFSQ29kZURlY29kZXJNZXRhRGF0YSQxOwoJdmFyIERldGVjdG9yXzEgPSBEZXRlY3RvciQxOwoJLyppbXBvcnQgamF2YS51dGlsLkxpc3Q7Ki8KCS8qaW1wb3J0IGphdmEudXRpbC5NYXA7Ki8KCS8qKgoJICogVGhpcyBpbXBsZW1lbnRhdGlvbiBjYW4gZGV0ZWN0IGFuZCBkZWNvZGUgUVIgQ29kZXMgaW4gYW4gaW1hZ2UuCgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIFFSQ29kZVJlYWRlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBRUkNvZGVSZWFkZXIoKSB7CgkgICAgICAgIHRoaXMuZGVjb2RlciA9IG5ldyBEZWNvZGVyXzEuZGVmYXVsdCgpOwoJICAgIH0KCSAgICBRUkNvZGVSZWFkZXIucHJvdG90eXBlLmdldERlY29kZXIgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmRlY29kZXI7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBMb2NhdGVzIGFuZCBkZWNvZGVzIGEgUVIgY29kZSBpbiBhbiBpbWFnZS4KCSAgICAgKgoJICAgICAqIEByZXR1cm4gYSByZXByZXNlbnRpbmc6IHN0cmluZyB0aGUgY29udGVudCBlbmNvZGVkIGJ5IHRoZSBRUiBjb2RlCgkgICAgICogQHRocm93cyBOb3RGb3VuZEV4Y2VwdGlvbiBpZiBhIFFSIGNvZGUgY2Fubm90IGJlIGZvdW5kCgkgICAgICogQHRocm93cyBGb3JtYXRFeGNlcHRpb24gaWYgYSBRUiBjb2RlIGNhbm5vdCBiZSBkZWNvZGVkCgkgICAgICogQHRocm93cyBDaGVja3N1bUV4Y2VwdGlvbiBpZiBlcnJvciBjb3JyZWN0aW9uIGZhaWxzCgkgICAgICovCgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIC8vIHB1YmxpYyBkZWNvZGUoaW1hZ2U6IEJpbmFyeUJpdG1hcCk6IFJlc3VsdCAvKnRocm93cyBOb3RGb3VuZEV4Y2VwdGlvbiwgQ2hlY2tzdW1FeGNlcHRpb24sIEZvcm1hdEV4Y2VwdGlvbiAqLyB7CgkgICAgLy8gICByZXR1cm4gdGhpcy5kZWNvZGUoaW1hZ2UsIG51bGwpCgkgICAgLy8gfQoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBRUkNvZGVSZWFkZXIucHJvdG90eXBlLmRlY29kZSA9IGZ1bmN0aW9uIChpbWFnZSwgaGludHMpIHsKCSAgICAgICAgdmFyIGRlY29kZXJSZXN1bHQ7CgkgICAgICAgIHZhciBwb2ludHM7CgkgICAgICAgIGlmIChoaW50cyAhPT0gdW5kZWZpbmVkICYmIGhpbnRzICE9PSBudWxsICYmIHVuZGVmaW5lZCAhPT0gaGludHMuZ2V0KERlY29kZUhpbnRUeXBlXzEuZGVmYXVsdC5QVVJFX0JBUkNPREUpKSB7CgkgICAgICAgICAgICB2YXIgYml0cyA9IFFSQ29kZVJlYWRlci5leHRyYWN0UHVyZUJpdHMoaW1hZ2UuZ2V0QmxhY2tNYXRyaXgoKSk7CgkgICAgICAgICAgICBkZWNvZGVyUmVzdWx0ID0gdGhpcy5kZWNvZGVyLmRlY29kZUJpdE1hdHJpeChiaXRzLCBoaW50cyk7CgkgICAgICAgICAgICBwb2ludHMgPSBRUkNvZGVSZWFkZXIuTk9fUE9JTlRTOwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgdmFyIGRldGVjdG9yUmVzdWx0ID0gbmV3IERldGVjdG9yXzEuZGVmYXVsdChpbWFnZS5nZXRCbGFja01hdHJpeCgpKS5kZXRlY3QoaGludHMpOwoJICAgICAgICAgICAgZGVjb2RlclJlc3VsdCA9IHRoaXMuZGVjb2Rlci5kZWNvZGVCaXRNYXRyaXgoZGV0ZWN0b3JSZXN1bHQuZ2V0Qml0cygpLCBoaW50cyk7CgkgICAgICAgICAgICBwb2ludHMgPSBkZXRlY3RvclJlc3VsdC5nZXRQb2ludHMoKTsKCSAgICAgICAgfQoJICAgICAgICAvLyBJZiB0aGUgY29kZSB3YXMgbWlycm9yZWQ6IHN3YXAgdGhlIGJvdHRvbS1sZWZ0IGFuZCB0aGUgdG9wLXJpZ2h0IHBvaW50cy4KCSAgICAgICAgaWYgKGRlY29kZXJSZXN1bHQuZ2V0T3RoZXIoKSBpbnN0YW5jZW9mIFFSQ29kZURlY29kZXJNZXRhRGF0YV8xLmRlZmF1bHQpIHsKCSAgICAgICAgICAgIGRlY29kZXJSZXN1bHQuZ2V0T3RoZXIoKS5hcHBseU1pcnJvcmVkQ29ycmVjdGlvbihwb2ludHMpOwoJICAgICAgICB9CgkgICAgICAgIHZhciByZXN1bHQgPSBuZXcgUmVzdWx0XzEuZGVmYXVsdChkZWNvZGVyUmVzdWx0LmdldFRleHQoKSwgZGVjb2RlclJlc3VsdC5nZXRSYXdCeXRlcygpLCB1bmRlZmluZWQsIHBvaW50cywgQmFyY29kZUZvcm1hdF8xLmRlZmF1bHQuUVJfQ09ERSwgdW5kZWZpbmVkKTsKCSAgICAgICAgdmFyIGJ5dGVTZWdtZW50cyA9IGRlY29kZXJSZXN1bHQuZ2V0Qnl0ZVNlZ21lbnRzKCk7CgkgICAgICAgIGlmIChieXRlU2VnbWVudHMgIT09IG51bGwpIHsKCSAgICAgICAgICAgIHJlc3VsdC5wdXRNZXRhZGF0YShSZXN1bHRNZXRhZGF0YVR5cGVfMS5kZWZhdWx0LkJZVEVfU0VHTUVOVFMsIGJ5dGVTZWdtZW50cyk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGVjTGV2ZWwgPSBkZWNvZGVyUmVzdWx0LmdldEVDTGV2ZWwoKTsKCSAgICAgICAgaWYgKGVjTGV2ZWwgIT09IG51bGwpIHsKCSAgICAgICAgICAgIHJlc3VsdC5wdXRNZXRhZGF0YShSZXN1bHRNZXRhZGF0YVR5cGVfMS5kZWZhdWx0LkVSUk9SX0NPUlJFQ1RJT05fTEVWRUwsIGVjTGV2ZWwpOwoJICAgICAgICB9CgkgICAgICAgIGlmIChkZWNvZGVyUmVzdWx0Lmhhc1N0cnVjdHVyZWRBcHBlbmQoKSkgewoJICAgICAgICAgICAgcmVzdWx0LnB1dE1ldGFkYXRhKFJlc3VsdE1ldGFkYXRhVHlwZV8xLmRlZmF1bHQuU1RSVUNUVVJFRF9BUFBFTkRfU0VRVUVOQ0UsIGRlY29kZXJSZXN1bHQuZ2V0U3RydWN0dXJlZEFwcGVuZFNlcXVlbmNlTnVtYmVyKCkpOwoJICAgICAgICAgICAgcmVzdWx0LnB1dE1ldGFkYXRhKFJlc3VsdE1ldGFkYXRhVHlwZV8xLmRlZmF1bHQuU1RSVUNUVVJFRF9BUFBFTkRfUEFSSVRZLCBkZWNvZGVyUmVzdWx0LmdldFN0cnVjdHVyZWRBcHBlbmRQYXJpdHkoKSk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBRUkNvZGVSZWFkZXIucHJvdG90eXBlLnJlc2V0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICAvLyBkbyBub3RoaW5nCgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBUaGlzIG1ldGhvZCBkZXRlY3RzIGEgY29kZSBpbiBhICJwdXJlIiBpbWFnZSAtLSB0aGF0IGlzLCBwdXJlIG1vbm9jaHJvbWUgaW1hZ2UKCSAgICAgKiB3aGljaCBjb250YWlucyBvbmx5IGFuIHVucm90YXRlZCwgdW5za2V3ZWQsIGltYWdlIG9mIGEgY29kZSwgd2l0aCBzb21lIHdoaXRlIGJvcmRlcgoJICAgICAqIGFyb3VuZCBpdC4gVGhpcyBpcyBhIHNwZWNpYWxpemVkIG1ldGhvZCB0aGF0IHdvcmtzIGV4Y2VwdGlvbmFsbHkgZmFzdCBpbiB0aGlzIHNwZWNpYWwKCSAgICAgKiBjYXNlLgoJICAgICAqCgkgICAgICogQHNlZSBjb20uZ29vZ2xlLnp4aW5nLmRhdGFtYXRyaXguRGF0YU1hdHJpeFJlYWRlciNleHRyYWN0UHVyZUJpdHMoQml0TWF0cml4KQoJICAgICAqLwoJICAgIFFSQ29kZVJlYWRlci5leHRyYWN0UHVyZUJpdHMgPSBmdW5jdGlvbiAoaW1hZ2UpIHsKCSAgICAgICAgdmFyIGxlZnRUb3BCbGFjayA9IGltYWdlLmdldFRvcExlZnRPbkJpdCgpOwoJICAgICAgICB2YXIgcmlnaHRCb3R0b21CbGFjayA9IGltYWdlLmdldEJvdHRvbVJpZ2h0T25CaXQoKTsKCSAgICAgICAgaWYgKGxlZnRUb3BCbGFjayA9PT0gbnVsbCB8fCByaWdodEJvdHRvbUJsYWNrID09PSBudWxsKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIG1vZHVsZVNpemUgPSB0aGlzLm1vZHVsZVNpemUobGVmdFRvcEJsYWNrLCBpbWFnZSk7CgkgICAgICAgIHZhciB0b3AgPSBsZWZ0VG9wQmxhY2tbMV07CgkgICAgICAgIHZhciBib3R0b20gPSByaWdodEJvdHRvbUJsYWNrWzFdOwoJICAgICAgICB2YXIgbGVmdCA9IGxlZnRUb3BCbGFja1swXTsKCSAgICAgICAgdmFyIHJpZ2h0ID0gcmlnaHRCb3R0b21CbGFja1swXTsKCSAgICAgICAgLy8gU2FuaXR5IGNoZWNrIQoJICAgICAgICBpZiAobGVmdCA+PSByaWdodCB8fCB0b3AgPj0gYm90dG9tKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGJvdHRvbSAtIHRvcCAhPT0gcmlnaHQgLSBsZWZ0KSB7CgkgICAgICAgICAgICAvLyBTcGVjaWFsIGNhc2UsIHdoZXJlIGJvdHRvbS1yaWdodCBtb2R1bGUgd2Fzbid0IGJsYWNrIHNvIHdlIGZvdW5kIHNvbWV0aGluZyBlbHNlIGluIHRoZSBsYXN0IHJvdwoJICAgICAgICAgICAgLy8gQXNzdW1lIGl0J3MgYSBzcXVhcmUsIHNvIHVzZSBoZWlnaHQgYXMgdGhlIHdpZHRoCgkgICAgICAgICAgICByaWdodCA9IGxlZnQgKyAoYm90dG9tIC0gdG9wKTsKCSAgICAgICAgICAgIGlmIChyaWdodCA+PSBpbWFnZS5nZXRXaWR0aCgpKSB7CgkgICAgICAgICAgICAgICAgLy8gQWJvcnQgaWYgdGhhdCB3b3VsZCBub3QgbWFrZSBzZW5zZSAtLSBvZmYgaW1hZ2UKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgdmFyIG1hdHJpeFdpZHRoID0gTWF0aC5yb3VuZCgocmlnaHQgLSBsZWZ0ICsgMSkgLyBtb2R1bGVTaXplKTsKCSAgICAgICAgdmFyIG1hdHJpeEhlaWdodCA9IE1hdGgucm91bmQoKGJvdHRvbSAtIHRvcCArIDEpIC8gbW9kdWxlU2l6ZSk7CgkgICAgICAgIGlmIChtYXRyaXhXaWR0aCA8PSAwIHx8IG1hdHJpeEhlaWdodCA8PSAwKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKG1hdHJpeEhlaWdodCAhPT0gbWF0cml4V2lkdGgpIHsKCSAgICAgICAgICAgIC8vIE9ubHkgcG9zc2libHkgZGVjb2RlIHNxdWFyZSByZWdpb25zCgkgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gUHVzaCBpbiB0aGUgImJvcmRlciIgYnkgaGFsZiB0aGUgbW9kdWxlIHdpZHRoIHNvIHRoYXQgd2Ugc3RhcnQKCSAgICAgICAgLy8gc2FtcGxpbmcgaW4gdGhlIG1pZGRsZSBvZiB0aGUgbW9kdWxlLiBKdXN0IGluIGNhc2UgdGhlIGltYWdlIGlzIGEKCSAgICAgICAgLy8gbGl0dGxlIG9mZiwgdGhpcyB3aWxsIGhlbHAgcmVjb3Zlci4KCSAgICAgICAgdmFyIG51ZGdlID0gLyooaW50KSAqLyBNYXRoLmZsb29yKG1vZHVsZVNpemUgLyAyLjApOwoJICAgICAgICB0b3AgKz0gbnVkZ2U7CgkgICAgICAgIGxlZnQgKz0gbnVkZ2U7CgkgICAgICAgIC8vIEJ1dCBjYXJlZnVsIHRoYXQgdGhpcyBkb2VzIG5vdCBzYW1wbGUgb2ZmIHRoZSBlZGdlCgkgICAgICAgIC8vICJyaWdodCIgaXMgdGhlIGZhcnRoZXN0LXJpZ2h0IHZhbGlkIHBpeGVsIGxvY2F0aW9uIC0tIHJpZ2h0KzEgaXMgbm90IG5lY2Vzc2FyaWx5CgkgICAgICAgIC8vIFRoaXMgaXMgcG9zaXRpdmUgYnkgaG93IG11Y2ggdGhlIGlubmVyIHggbG9vcCBiZWxvdyB3b3VsZCBiZSB0b28gbGFyZ2UKCSAgICAgICAgdmFyIG51ZGdlZFRvb0ZhclJpZ2h0ID0gbGVmdCArIC8qKGludCkgKi8gTWF0aC5mbG9vcigobWF0cml4V2lkdGggLSAxKSAqIG1vZHVsZVNpemUpIC0gcmlnaHQ7CgkgICAgICAgIGlmIChudWRnZWRUb29GYXJSaWdodCA+IDApIHsKCSAgICAgICAgICAgIGlmIChudWRnZWRUb29GYXJSaWdodCA+IG51ZGdlKSB7CgkgICAgICAgICAgICAgICAgLy8gTmVpdGhlciB3YXkgZml0czsgYWJvcnQKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBsZWZ0IC09IG51ZGdlZFRvb0ZhclJpZ2h0OwoJICAgICAgICB9CgkgICAgICAgIC8vIFNlZSBsb2dpYyBhYm92ZQoJICAgICAgICB2YXIgbnVkZ2VkVG9vRmFyRG93biA9IHRvcCArIC8qKGludCkgKi8gTWF0aC5mbG9vcigobWF0cml4SGVpZ2h0IC0gMSkgKiBtb2R1bGVTaXplKSAtIGJvdHRvbTsKCSAgICAgICAgaWYgKG51ZGdlZFRvb0ZhckRvd24gPiAwKSB7CgkgICAgICAgICAgICBpZiAobnVkZ2VkVG9vRmFyRG93biA+IG51ZGdlKSB7CgkgICAgICAgICAgICAgICAgLy8gTmVpdGhlciB3YXkgZml0czsgYWJvcnQKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB0b3AgLT0gbnVkZ2VkVG9vRmFyRG93bjsKCSAgICAgICAgfQoJICAgICAgICAvLyBOb3cganVzdCByZWFkIG9mZiB0aGUgYml0cwoJICAgICAgICB2YXIgYml0cyA9IG5ldyBCaXRNYXRyaXhfMS5kZWZhdWx0KG1hdHJpeFdpZHRoLCBtYXRyaXhIZWlnaHQpOwoJICAgICAgICBmb3IgKHZhciB5ID0gMDsgeSA8IG1hdHJpeEhlaWdodDsgeSsrKSB7CgkgICAgICAgICAgICB2YXIgaU9mZnNldCA9IHRvcCArIC8qKGludCkgKi8gTWF0aC5mbG9vcih5ICogbW9kdWxlU2l6ZSk7CgkgICAgICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IG1hdHJpeFdpZHRoOyB4KyspIHsKCSAgICAgICAgICAgICAgICBpZiAoaW1hZ2UuZ2V0KGxlZnQgKyAvKihpbnQpICovIE1hdGguZmxvb3IoeCAqIG1vZHVsZVNpemUpLCBpT2Zmc2V0KSkgewoJICAgICAgICAgICAgICAgICAgICBiaXRzLnNldCh4LCB5KTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGJpdHM7CgkgICAgfTsKCSAgICBRUkNvZGVSZWFkZXIubW9kdWxlU2l6ZSA9IGZ1bmN0aW9uIChsZWZ0VG9wQmxhY2ssIGltYWdlKSB7CgkgICAgICAgIHZhciBoZWlnaHQgPSBpbWFnZS5nZXRIZWlnaHQoKTsKCSAgICAgICAgdmFyIHdpZHRoID0gaW1hZ2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgdmFyIHggPSBsZWZ0VG9wQmxhY2tbMF07CgkgICAgICAgIHZhciB5ID0gbGVmdFRvcEJsYWNrWzFdOwoJICAgICAgICB2YXIgaW5CbGFjayA9IHRydWU7CgkgICAgICAgIHZhciB0cmFuc2l0aW9ucyA9IDA7CgkgICAgICAgIHdoaWxlICh4IDwgd2lkdGggJiYgeSA8IGhlaWdodCkgewoJICAgICAgICAgICAgaWYgKGluQmxhY2sgIT09IGltYWdlLmdldCh4LCB5KSkgewoJICAgICAgICAgICAgICAgIGlmICgrK3RyYW5zaXRpb25zID09PSA1KSB7CgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBpbkJsYWNrID0gIWluQmxhY2s7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB4Kys7CgkgICAgICAgICAgICB5Kys7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHggPT09IHdpZHRoIHx8IHkgPT09IGhlaWdodCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiAoeCAtIGxlZnRUb3BCbGFja1swXSkgLyA3LjA7CgkgICAgfTsKCSAgICBRUkNvZGVSZWFkZXIuTk9fUE9JTlRTID0gbmV3IEFycmF5KCk7CgkgICAgcmV0dXJuIFFSQ29kZVJlYWRlcjsKCX0oKSk7Cgl2YXIgX2RlZmF1bHQgPSBRUkNvZGVSZWFkZXIkMS5kZWZhdWx0ID0gUVJDb2RlUmVhZGVyOwoKCXZhciB0b0dyYXlzY2FsZUJ1ZmZlciA9IGZ1bmN0aW9uIHRvR3JheXNjYWxlQnVmZmVyKGltYWdlQnVmZmVyLCB3aWR0aCwgaGVpZ2h0KSB7CgkgIHZhciBncmF5c2NhbGVCdWZmZXIgPSBuZXcgVWludDhDbGFtcGVkQXJyYXkod2lkdGggKiBoZWlnaHQpOwoKCSAgZm9yICh2YXIgaSA9IDAsIGogPSAwLCBsZW5ndGhfMSA9IGltYWdlQnVmZmVyLmxlbmd0aDsgaSA8IGxlbmd0aF8xOyBpICs9IDQsIGorKykgewoJICAgIHZhciBncmF5ID0gdm9pZCAwOwoJICAgIHZhciBhbHBoYSA9IGltYWdlQnVmZmVyW2kgKyAzXTsgLy8gVGhlIGNvbG9yIG9mIGZ1bGx5LXRyYW5zcGFyZW50IHBpeGVscyBpcyBpcnJlbGV2YW50LiBUaGV5IGFyZSBvZnRlbiwgdGVjaG5pY2FsbHksIGZ1bGx5LXRyYW5zcGFyZW50CgkgICAgLy8gYmxhY2sgKDAgYWxwaGEsIGFuZCB0aGVuIDAgUkdCKS4gVGhleSBhcmUgb2Z0ZW4gdXNlZCwgb2YgY291cnNlIGFzIHRoZSAid2hpdGUiIGFyZWEgaW4gYQoJICAgIC8vIGJhcmNvZGUgaW1hZ2UuIEZvcmNlIGFueSBzdWNoIHBpeGVsIHRvIGJlIHdoaXRlOgoKCSAgICBpZiAoYWxwaGEgPT09IDApIHsKCSAgICAgIGdyYXkgPSAweEZGOwoJICAgIH0gZWxzZSB7CgkgICAgICB2YXIgcGl4ZWxSID0gaW1hZ2VCdWZmZXJbaV07CgkgICAgICB2YXIgcGl4ZWxHID0gaW1hZ2VCdWZmZXJbaSArIDFdOwoJICAgICAgdmFyIHBpeGVsQiA9IGltYWdlQnVmZmVyW2kgKyAyXTsgLy8gLjI5OVIgKyAwLjU4N0cgKyAwLjExNEIgKFlVVi9ZSVEgZm9yIFBBTCBhbmQgTlRTQyksCgkgICAgICAvLyAoMzA2KlIpID4+IDEwIGlzIGFwcHJveGltYXRlbHkgZXF1YWwgdG8gUiowLjI5OSwgYW5kIHNvIG9uLgoJICAgICAgLy8gMHgyMDAgPj4gMTAgaXMgMC41LCBpdCBpbXBsZW1lbnRzIHJvdW5kaW5nLgoKCSAgICAgIGdyYXkgPSAzMDYgKiBwaXhlbFIgKyA2MDEgKiBwaXhlbEcgKyAxMTcgKiBwaXhlbEIgKyAweDIwMCA+PiAxMDsKCSAgICB9CgoJICAgIGdyYXlzY2FsZUJ1ZmZlcltqXSA9IGdyYXk7CgkgIH0KCgkgIHJldHVybiBncmF5c2NhbGVCdWZmZXI7Cgl9OwoKCXZhciByZWFkZXIgPSBuZXcgX2RlZmF1bHQoKTsKCXNlbGYuYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIGZ1bmN0aW9uIChlKSB7CgkgIC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tcmVzdHJpY3RlZC1nbG9iYWxzCgkgIHRyeSB7CgkgICAgdmFyIGx1bWluYW5jZXMgPSB0b0dyYXlzY2FsZUJ1ZmZlcihlLmRhdGEuZGF0YSwgZS5kYXRhLndpZHRoLCBlLmRhdGEuaGVpZ2h0KTsKCSAgICB2YXIgbHVtaW5hbmNlU291cmNlID0gbmV3IF9kZWZhdWx0JDEobHVtaW5hbmNlcywgZS5kYXRhLndpZHRoLCBlLmRhdGEuaGVpZ2h0KTsKCSAgICB2YXIgaHlicmlkQmluYXJpemVyID0gbmV3IF9kZWZhdWx0JDIobHVtaW5hbmNlU291cmNlKTsKCSAgICB2YXIgYmluYXJ5Qml0bWFwID0gbmV3IF9kZWZhdWx0JDMoaHlicmlkQmluYXJpemVyKTsKCSAgICB2YXIgZGVjb2RlZCA9IHJlYWRlci5kZWNvZGUoYmluYXJ5Qml0bWFwKTsKCSAgICBwb3N0TWVzc2FnZShkZWNvZGVkKTsKCSAgfSBjYXRjaCAoZXJyKSB7CgkgICAgcG9zdE1lc3NhZ2UobnVsbCk7CgkgIH0KCX0pOwoKfSkoKTsKCg==",null,!1),Qx=["constraints","onError","onLoad","onScan","resolution","qrArea"];function Vh(e,g){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);g&&(l=l.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,l)}return t}function Wh(e){for(var g=1;g<arguments.length;g++){var t=arguments[g]!=null?arguments[g]:{};g%2?Vh(Object(t),!0).forEach(function(l){Bx(e,l,t[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Vh(Object(t)).forEach(function(l){Object.defineProperty(e,l,Object.getOwnPropertyDescriptor(t,l))})}return e}var jx=function(){return new Ux},vh=function(g){g&&(g.getVideoTracks&&g.getAudioTracks?(g.getVideoTracks().forEach(function(t){g.removeTrack(t),t.stop()}),g.getAudioTracks().forEach(function(t){g.removeTrack(t),t.stop()})):g.stop())},Jm=function(g){var t=g.constraints,l=g.onError,n=g.onLoad,I=g.onScan,o=g.resolution,C=g.qrArea,a=Rx(g,Qx),r=u.useRef(null),i=u.useRef(null),s=u.useRef(document.createElement("canvas")),c=u.useRef(null),d=u.useRef(),Z=u.useState(null),G=vx(Z,2),y=G[0],p=G[1],h=u.useRef(!1),b=u.useRef();u.useEffect(function(){b.current=jx();var k=b.current;return k.onmessage=function(m){I&&I(m.data?Wh(Wh({},m.data),{},{canvas:s.current}):null),h.current=!1},function(){k.terminate()}},[I]);var B=JSON.stringify(C),S=u.useCallback(function(){var k=JSON.parse(B),m=b.current,v=i.current&&i.current.readyState===i.current.HAVE_ENOUGH_DATA;if(!h.current&&v){h.current=!0;var R=i.current.videoWidth,W=i.current.videoHeight,J=R>W?R:W,f=Math.floor(o/J*100)/100;W=Math.floor(f*W),R=Math.floor(f*R),s.current.width=R,s.current.height=W,c.current=s.current.getContext("2d"),c.current.drawImage(i.current,0,0,R,W);var V;k&&k.length===2&&k[0]>0&&k[1]>0?V=c.current.getImageData(Math.floor((R-k[0])/2),Math.floor((W-k[1])/2),k[0],k[1]):V=c.current.getImageData(0,0,R,W),m.postMessage(V)}d.current=requestAnimationFrame(S)},[o,B]),X=JSON.stringify(t);return u.useEffect(function(){var k=JSON.parse(X),m=!0;return navigator.mediaDevices.getUserMedia(k).then(function(v){if(!m)vh(v);else{r.current=v;try{i.current&&(i.current.srcObject=v,i.current.setAttribute("playsinline",!0))}catch{p(window.URL.createObjectURL(v))}n&&n(),d.current=requestAnimationFrame(S)}}).catch(function(v){return m?l(v):null}),function(){cancelAnimationFrame(d.current),m=!1,vh(r.current),y&&window.URL.revokeObjectURL(y)}},[S,X,l,n,y]),u.createElement("video",Iu({autoPlay:!0,playsInline:!0,src:y,ref:i},a))};Jm.propTypes={constraints:Pn.object,onError:Pn.func.isRequired,onLoad:Pn.func,onScan:Pn.func.isRequired,resolution:Pn.number,qrArea:Pn.array};Jm.defaultProps={constraints:{audio:!1,video:!0},resolution:640,qrArea:[]};const XW=({setScanQR:e})=>{const[g,t]=u.useState(""),[l,n]=u.useState(""),[I,o]=u.useState({qr_code_data:"",latitude:"",longitude:""}),C=async s=>{if(s){const c=s.text;o({qr_code_data:c,latitude:String(g),longitude:String(l)})}},a=async()=>{(await BK(I)).msg==="Attendance marked successfully."&&e(!1)};u.useEffect(()=>{"geolocation"in navigator?navigator.geolocation.getCurrentPosition(function(s){t(s.coords.latitude),n(s.coords.longitude)}):console.log("Geolocation is not available in your browser.")},[]);const r=s=>{console.error(s)},i={height:300,width:400};return A.jsxs("section",{className:"w-full px-2",children:[A.jsx("button",{onClick:()=>e(!1),className:"px-2 py-1 rounded-full border-2 text-gray-light border-gray-light hover:border-primary-black hover:text-primary-black transition-effect",children:A.jsx("i",{className:"fa-solid fa-arrow-left-long"})}),A.jsx("section",{className:"flex-center mt-4",children:A.jsxs("div",{className:"pane_section w-fit flex flex-col items-center justify-center bg-white rounded-md shadow-lg p-5 gap-5 md:p-10",children:[A.jsx("div",{className:"w-full flex-center",children:A.jsx(Jm,{delay:100,style:i,constraints:{audio:!1,video:{facingMode:"environment"}},onError:r,onScan:C})}),A.jsx("p",{className:I.qr_code_data?"bg-blue-400 px-3 rounded-md text-primary-white":"bg-red-400 px-3 rounded-md text-primary-white",children:I.qr_code_data?"QR Scanned Successfuly":"QR Not Detected!"}),A.jsx("button",{disabled:!I.qr_code_data,onClick:a,className:I.qr_code_data?"btn":"btn opacity-10 hover:text-primary-white hover:bg-primary-black",children:"Mark Attendance"})]})})]})};XW.propTypes={setScanQR:w.func.isRequired};const Px=()=>{const[e,g]=u.useState(!1),[t,l]=u.useState(!1),[n,I]=u.useState(!0),[o,C]=u.useState({student:"",email:"",totalDays:"",presentDays:"",absentDays:""});u.useEffect(()=>{a()},[t,e]);const a=async()=>{try{const i=await GK();C({student:i.student_name,email:i.student_email,totalDays:i.total_days,presentDays:i.present_days,absentDays:i.absent_days}),I(!1)}catch(i){console.error("API request failed:",i)}};let r;return e?r=A.jsx(SW,{setGenerateQR:g}):t?r=A.jsx(XW,{setScanQR:l}):r=A.jsxs(A.Fragment,{children:[A.jsxs("section",{className:"panel_section flex flex-col items-center md:items-stretch md:flex-row gap-8 md:gap-4 md:justify-between flex-wrap",children:[A.jsx("div",{className:"hidden md:block w-full md:w-[200px] lg:w-[300px]",children:A.jsx(vV,{})}),A.jsxs("div",{className:"w-full md:w-[calc(100%-250px)] lg:w-[calc(100%-400px)] flex flex-col gap-4 lg:gap-10 justify-between",children:[A.jsxs("div",{className:"flex items-center justify-between",children:[A.jsx(pn,{loading:n,title:"Total Days",value:o.totalDays}),A.jsx(pn,{loading:n,title:"Present Days",value:o.presentDays}),A.jsx(pn,{loading:n,title:"Absent Days",value:o.absentDays})]}),A.jsxs("div",{children:[A.jsx("h1",{className:"mb-4 text-xl max-sm:text-center font-medium",children:"Quick access links"}),A.jsxs("div",{className:"flex max-sm:flex-wrap max-sm:justify-center gap-2 md:gap-8 items-center",children:[A.jsx("button",{onClick:()=>g(!0),className:"toggle_btn hover:bg-transparent hover:text-primary-black border-2 hover:border-2 hover:border-primary-black transition-effect",children:"Generate QR"}),A.jsx("button",{onClick:()=>l(!0),className:"toggle_btn_bordered hover:bg-primary-black hover:text-primary-white border-2 hover:border-2 hover:border-transparent transition-effect",children:"QR Scanner"})]})]})]})]}),A.jsxs("section",{className:"panel_section",children:[A.jsx("h1",{className:"mb-2 text-xl md:text-3xl text-center md:text-left font-bold",children:"Your Attendance"}),A.jsx(QF,{loading:n})]})]}),A.jsxs("section",{className:"w-full px-2 mt-24 md:mt-28",children:[A.jsx(cm,{role:"student",name:o.student,email:o.email}),r]})},Ox=()=>{const e=Il(),[g,t]=u.useState({password:"",password2:""}),l=async n=>{n.preventDefault(),localStorage.getItem("forgetRole")==="admin"&&await bk(g)&&(localStorage.removeItem("forgetToken"),localStorage.removeItem("forgetRole"),e("/")),localStorage.getItem("forgetRole")==="student"&&await Zk(g)&&(localStorage.removeItem("forgetToken"),localStorage.removeItem("forgetRole"),e("/"))};return A.jsx("section",{className:"h-screen flex-center",children:A.jsxs("div",{className:"w-full md:w-[500px] mx-auto bg-white md:p-8 rounded-lg shadow-lg text-primary-black font-medium",children:[A.jsx("h1",{className:"text-xl capitalize font-medium text-center mb-4",children:"Change Password"}),A.jsxs("form",{onSubmit:l,className:"flex flex-col gap-4",children:[A.jsxs("label",{children:[A.jsx("span",{children:"New Password"}),A.jsx("input",{type:"password",value:g.password,onChange:n=>t({...g,password:n.target.value}),placeholder:"Enter your new password",required:!0,className:"form_input"})]}),A.jsxs("label",{children:[A.jsx("span",{children:"Confirm New Password"}),A.jsx("input",{type:"password",value:g.password2,onChange:n=>t({...g,password2:n.target.value}),placeholder:"Re-enter your new password",required:!0,className:"form_input"})]}),A.jsx("button",{type:"submit",className:"btn mt-2 bg-primary-black",children:"Confirm"})]})]})})},$x=()=>({token:iy()}).token?A.jsx(hA,{}):A.jsx(Wr,{to:"*"}),qx=()=>({token:sy()}).token?A.jsx(hA,{}):A.jsx(Wr,{to:"*"}),_x=()=>A.jsxs("header",{className:"absolute z-10 w-full lg:w-[92%] mx-auto top-0 left-0 right-0 flex-between py-2 px-3 ",children:[A.jsxs("div",{className:"flex-center gap-1",children:[A.jsx("img",{src:"/images/logo.png",alt:"icon",className:"w-12 md:w-12"}),A.jsx("h1",{className:"font-bold tracking-wide text-2xl",children:"StudentAttendanceMark"})]}),A.jsx(po,{to:"https://github.com/ruffinh22/sites",target:"_blank",className:"btn_bordered",children:"GitHub"})]}),eE=()=>A.jsx("footer",{className:"py-4 md:py-8 flex-center border-t-2 border-gray-light",children:A.jsx("h1",{className:"text-base md:text-lg font-medium",children:"Made with 🖤 by Ruffin H."})}),gE=e=>{const g={token:iy(),token1:sy()};return g.token&&e?A.jsx(Wr,{to:"/admin/dashboard"}):g.token1&&e?A.jsx(Wr,{to:"/student/dashboard"}):A.jsxs(A.Fragment,{children:[A.jsx(_x,{}),A.jsx(hA,{}),A.jsx(eE,{})]})},tE=()=>{const e=Il();return A.jsxs("section",{className:"md:h-screen flex flex-col md:flex-row justify-center items-center w-full md:w-[90%] mx-auto py-10 px-3",children:[A.jsx("img",{src:"/images/bulb.png",alt:"bulb image",className:"w-[200px] md:w-fit"}),A.jsxs("div",{className:"max-sm:mt-4 flex justify-center md:justify-normal items-center md:items-start flex-col gap-4 md:gap-10",children:[A.jsxs("p",{className:"text-lg",children:[A.jsx("span",{className:"underline underline-offset-8 font-medium",children:"404"})," ","| Page not Found"]}),A.jsxs("h1",{className:"text-4xl text-center md:text-left md:text-6xl font-semibold",children:["there is ",A.jsx("br",{}),"light in here too"]}),A.jsx("p",{className:"text-lg text-center md:text-left",children:"But the page is missing or you assembled the link incorrectly"}),A.jsx("button",{onClick:()=>e("/"),className:"w-fit btn",children:"Go Home"})]})]})},lE=()=>{const[e,g]=u.useState(!0),t=()=>{g(!e)};return A.jsxs("div",{children:[A.jsx("audio",{autoPlay:!0,loop:!0,controls:!1,src:"bossa.mp3"})," ",A.jsx("button",{onClick:t,children:e?"Pause Music":"Play Music"})]})};function nE(){const e=localStorage.getItem("forgetToken")||null,[g,t]=u.useState(!1),l=()=>{t(!0)};return u.useEffect(()=>{l()},[]),A.jsxs("main",{className:"App",children:[g&&A.jsx(lE,{}),A.jsxs(e2,{children:[A.jsxs(it,{element:A.jsx(gE,{restricted:!0}),children:[A.jsx(it,{path:"/",element:A.jsx(p2,{})}),A.jsx(it,{path:"/admin/login",element:A.jsx(pk,{})}),A.jsx(it,{path:"/student/login",element:A.jsx(Gk,{})})]}),A.jsx(it,{element:A.jsx($x,{}),children:A.jsx(it,{path:"/admin/dashboard",element:A.jsx(UF,{})})}),A.jsx(it,{element:A.jsx(qx,{}),children:A.jsx(it,{path:"/student/dashboard",element:A.jsx(Px,{})})}),A.jsx(it,{path:localStorage.getItem("forgetRole")==="admin"?`/reset-password/${e}`:`/reset-password-student/${e}`,element:A.jsx(Ox,{})}),A.jsx(it,{path:"*",element:A.jsx(tE,{})})]})]})}fd.createRoot(document.getElementById("root")).render(A.jsx(D.StrictMode,{children:A.jsx(IY,{children:A.jsxs(C2,{children:[A.jsx(dk,{}),A.jsx(nE,{})]})})}));
